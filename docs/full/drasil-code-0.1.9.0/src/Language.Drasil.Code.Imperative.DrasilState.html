<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE TemplateHaskell, TupleSections #-}</span><span>
</span><span id="line-2"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Language.Drasil.Code.Imperative.DrasilState</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-3"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier">GenState</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#DrasilState"><span class="hs-identifier">DrasilState</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#designLog"><span class="hs-identifier">designLog</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#MatchedSpaces"><span class="hs-identifier">MatchedSpaces</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#ModExportMap"><span class="hs-identifier">ModExportMap</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-4"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#ClassDefinitionMap"><span class="hs-identifier">ClassDefinitionMap</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#modExportMap"><span class="hs-identifier">modExportMap</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#clsDefMap"><span class="hs-identifier">clsDefMap</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#addToDesignLog"><span class="hs-identifier">addToDesignLog</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#addLoggedSpace"><span class="hs-identifier">addLoggedSpace</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-5"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#genICName"><span class="hs-identifier">genICName</span></a></span><span>
</span><span id="line-6"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Language.Drasil</span></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Drasil.GOOL</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ScopeTag</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">CodeType</span></span><span class="hs-special">)</span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.Chunk.ConstraintMap.html"><span class="hs-identifier">Language.Drasil.Chunk.ConstraintMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Chunk.ConstraintMap.html#ConstraintCE"><span class="hs-identifier">ConstraintCE</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.Code.ExtLibImport.html"><span class="hs-identifier">Language.Drasil.Code.ExtLibImport</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Code.ExtLibImport.html#ExtLibState"><span class="hs-identifier">ExtLibState</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html"><span class="hs-identifier">Language.Drasil.Choices</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Choices.html#Choices"><span class="hs-identifier">Choices</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#Architecture"><span class="hs-identifier">Architecture</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#DataInfo"><span class="hs-identifier">DataInfo</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>  </span><span class="annot"><a href="Language.Drasil.Choices.html#AuxFile"><span class="hs-identifier">AuxFile</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#Modularity"><span class="hs-identifier">Modularity</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#ImplementationType"><span class="hs-identifier">ImplementationType</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#Comments"><span class="hs-identifier">Comments</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#Verbosity"><span class="hs-identifier">Verbosity</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>  </span><span class="annot"><a href="Language.Drasil.Choices.html#MatchedConceptMap"><span class="hs-identifier">MatchedConceptMap</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#ConstantRepr"><span class="hs-identifier">ConstantRepr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#ConstantStructure"><span class="hs-identifier">ConstantStructure</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#ConstraintBehaviour"><span class="hs-identifier">ConstraintBehaviour</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#Logging"><span class="hs-identifier">Logging</span></a></span><span class="hs-special">,</span><span> </span><span>
</span><span id="line-16"></span><span>  </span><span class="annot"><a href="Language.Drasil.Choices.html#Structure"><span class="hs-identifier">Structure</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#InternalConcept"><span class="hs-identifier">InternalConcept</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.CodeSpec.html"><span class="hs-identifier">Language.Drasil.CodeSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.CodeSpec.html#Input"><span class="hs-identifier">Input</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.CodeSpec.html#Const"><span class="hs-identifier">Const</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.CodeSpec.html#Derived"><span class="hs-identifier">Derived</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.CodeSpec.html#Output"><span class="hs-identifier">Output</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.CodeSpec.html#Def"><span class="hs-identifier">Def</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>  </span><span class="annot"><a href="Language.Drasil.CodeSpec.html#CodeSpec"><span class="hs-identifier">CodeSpec</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>  </span><span class="annot"><a href="Language.Drasil.CodeSpec.html#getConstraints"><span class="hs-identifier">getConstraints</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html"><span class="hs-identifier">Language.Drasil.Mod</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#Mod"><span class="hs-identifier">Mod</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Name"><span class="hs-identifier">Name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Version"><span class="hs-identifier">Version</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Class"><span class="hs-identifier">Class</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>  </span><span class="annot"><a href="Language.Drasil.Mod.html#StateVariable"><span class="hs-identifier">StateVariable</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#fname"><span class="hs-identifier">fname</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(^.)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">makeLenses</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">over</span></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.State</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">State</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">gets</span></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">nub</span></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Set</span></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Map</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">fromList</span></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.PrettyPrint.HughesPJ</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Doc</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">($$)</span></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="hs-comment">-- | Type for the mapping between 'Space's and 'CodeType's.</span><span>
</span><span id="line-30"></span><span class="hs-keyword">type</span><span> </span><span id="MatchedSpaces"><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#MatchedSpaces"><span class="hs-identifier hs-var">MatchedSpaces</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Space</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CodeType</span></span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span class="hs-comment">-- | Map from calculation function name to the 'ExtLibState' containing the contents of the function.</span><span>
</span><span id="line-33"></span><span class="hs-keyword">type</span><span> </span><span id="ExtLibMap"><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#ExtLibMap"><span class="hs-identifier hs-var">ExtLibMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="Language.Drasil.Code.ExtLibImport.html#ExtLibState"><span class="hs-identifier hs-type">ExtLibState</span></a></span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span class="hs-comment">-- | Variable/function name maps to module name.</span><span>
</span><span id="line-36"></span><span class="hs-keyword">type</span><span> </span><span id="ModExportMap"><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#ModExportMap"><span class="hs-identifier hs-var">ModExportMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span class="hs-comment">-- | Variable/function name maps to class name.</span><span>
</span><span id="line-39"></span><span class="hs-keyword">type</span><span> </span><span id="ClassDefinitionMap"><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#ClassDefinitionMap"><span class="hs-identifier hs-var">ClassDefinitionMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-comment">-- | Abbreviation used throughout generator.</span><span>
</span><span id="line-42"></span><span class="hs-keyword">type</span><span> </span><span id="GenState"><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-var">GenState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#DrasilState"><span class="hs-identifier hs-type">DrasilState</span></a></span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span class="hs-comment">-- | Private State, used to push these options around the generator.</span><span>
</span><span id="line-45"></span><span class="hs-keyword">data</span><span> </span><span id="DrasilState"><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#DrasilState"><span class="hs-identifier hs-var">DrasilState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="DrasilState"><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#DrasilState"><span class="hs-identifier hs-var">DrasilState</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-46"></span><span>  </span><span id="codeSpec"><span class="annot"><span class="annottext">DrasilState -&gt; CodeSpec
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#codeSpec"><span class="hs-identifier hs-var hs-var">codeSpec</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Drasil.CodeSpec.html#CodeSpec"><span class="hs-identifier hs-type">CodeSpec</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-comment">-- Choices</span><span>
</span><span id="line-48"></span><span>  </span><span id="modular"><span class="annot"><span class="annottext">DrasilState -&gt; Modularity
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#modular"><span class="hs-identifier hs-var hs-var">modular</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#Modularity"><span class="hs-identifier hs-type">Modularity</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-49"></span><span>  </span><span id="implType"><span class="annot"><span class="annottext">DrasilState -&gt; ImplementationType
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#implType"><span class="hs-identifier hs-var hs-var">implType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#ImplementationType"><span class="hs-identifier hs-type">ImplementationType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-50"></span><span>  </span><span id="inStruct"><span class="annot"><span class="annottext">DrasilState -&gt; Structure
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#inStruct"><span class="hs-identifier hs-var hs-var">inStruct</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#Structure"><span class="hs-identifier hs-type">Structure</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-51"></span><span>  </span><span id="conStruct"><span class="annot"><span class="annottext">DrasilState -&gt; ConstantStructure
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#conStruct"><span class="hs-identifier hs-var hs-var">conStruct</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#ConstantStructure"><span class="hs-identifier hs-type">ConstantStructure</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-52"></span><span>  </span><span id="conRepr"><span class="annot"><span class="annottext">DrasilState -&gt; ConstantRepr
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#conRepr"><span class="hs-identifier hs-var hs-var">conRepr</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#ConstantRepr"><span class="hs-identifier hs-type">ConstantRepr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-53"></span><span>  </span><span id="concMatches"><span class="annot"><span class="annottext">DrasilState -&gt; MatchedConceptMap
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#concMatches"><span class="hs-identifier hs-var hs-var">concMatches</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#MatchedConceptMap"><span class="hs-identifier hs-type">MatchedConceptMap</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-54"></span><span>  </span><span id="spaceMatches"><span class="annot"><span class="annottext">DrasilState -&gt; MatchedSpaces
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#spaceMatches"><span class="hs-identifier hs-var hs-var">spaceMatches</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#MatchedSpaces"><span class="hs-identifier hs-type">MatchedSpaces</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-55"></span><span>  </span><span id="onSfwrC"><span class="annot"><span class="annottext">DrasilState -&gt; ConstraintBehaviour
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#onSfwrC"><span class="hs-identifier hs-var hs-var">onSfwrC</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#ConstraintBehaviour"><span class="hs-identifier hs-type">ConstraintBehaviour</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-56"></span><span>  </span><span id="onPhysC"><span class="annot"><span class="annottext">DrasilState -&gt; ConstraintBehaviour
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#onPhysC"><span class="hs-identifier hs-var hs-var">onPhysC</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#ConstraintBehaviour"><span class="hs-identifier hs-type">ConstraintBehaviour</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-57"></span><span>  </span><span id="commented"><span class="annot"><span class="annottext">DrasilState -&gt; [Comments]
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#commented"><span class="hs-identifier hs-var hs-var">commented</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Choices.html#Comments"><span class="hs-identifier hs-type">Comments</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-58"></span><span>  </span><span id="doxOutput"><span class="annot"><span class="annottext">DrasilState -&gt; Verbosity
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#doxOutput"><span class="hs-identifier hs-var hs-var">doxOutput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#Verbosity"><span class="hs-identifier hs-type">Verbosity</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-59"></span><span>  </span><span id="date"><span class="annot"><span class="annottext">DrasilState -&gt; String
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#date"><span class="hs-identifier hs-var hs-var">date</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span>
</span><span id="line-60"></span><span>  </span><span id="logName"><span class="annot"><span class="annottext">DrasilState -&gt; String
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#logName"><span class="hs-identifier hs-var hs-var">logName</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span>
</span><span id="line-61"></span><span>  </span><span id="logKind"><span class="annot"><span class="annottext">DrasilState -&gt; [Logging]
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#logKind"><span class="hs-identifier hs-var hs-var">logKind</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Choices.html#Logging"><span class="hs-identifier hs-type">Logging</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-62"></span><span>  </span><span id="auxiliaries"><span class="annot"><span class="annottext">DrasilState -&gt; [AuxFile]
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#auxiliaries"><span class="hs-identifier hs-var hs-var">auxiliaries</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Choices.html#AuxFile"><span class="hs-identifier hs-type">AuxFile</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-63"></span><span>  </span><span id="sampleData"><span class="annot"><span class="annottext">DrasilState -&gt; [Expr]
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#sampleData"><span class="hs-identifier hs-var hs-var">sampleData</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Expr</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-64"></span><span>  </span><span id="dsICNames"><span class="annot"><span class="annottext">DrasilState -&gt; InternalConcept -&gt; String
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#dsICNames"><span class="hs-identifier hs-var hs-var">dsICNames</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#InternalConcept"><span class="hs-identifier hs-type">InternalConcept</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-65"></span><span>  </span><span class="hs-comment">-- Reference materials</span><span>
</span><span id="line-66"></span><span>  </span><span id="modules"><span class="annot"><span class="annottext">DrasilState -&gt; [Mod]
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#modules"><span class="hs-identifier hs-var hs-var">modules</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Mod.html#Mod"><span class="hs-identifier hs-type">Mod</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-67"></span><span>  </span><span id="extLibNames"><span class="annot"><span class="annottext">DrasilState -&gt; [(String, String)]
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#extLibNames"><span class="hs-identifier hs-var hs-var">extLibNames</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Language.Drasil.Mod.html#Version"><span class="hs-identifier hs-type">Version</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-68"></span><span>  </span><span id="extLibMap"><span class="annot"><span class="annottext">DrasilState -&gt; ExtLibMap
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#extLibMap"><span class="hs-identifier hs-var hs-var">extLibMap</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#ExtLibMap"><span class="hs-identifier hs-type">ExtLibMap</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-69"></span><span>  </span><span id="libPaths"><span class="annot"><span class="annottext">DrasilState -&gt; [String]
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#libPaths"><span class="hs-identifier hs-var hs-var">libPaths</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-70"></span><span>  </span><span id="eMap"><span class="annot"><span class="annottext">DrasilState -&gt; ModExportMap
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#eMap"><span class="hs-identifier hs-var hs-var">eMap</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#ModExportMap"><span class="hs-identifier hs-type">ModExportMap</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-71"></span><span>  </span><span id="libEMap"><span class="annot"><span class="annottext">DrasilState -&gt; ModExportMap
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#libEMap"><span class="hs-identifier hs-var hs-var">libEMap</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#ModExportMap"><span class="hs-identifier hs-type">ModExportMap</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-72"></span><span>  </span><span id="clsMap"><span class="annot"><span class="annottext">DrasilState -&gt; ModExportMap
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#clsMap"><span class="hs-identifier hs-var hs-var">clsMap</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#ClassDefinitionMap"><span class="hs-identifier hs-type">ClassDefinitionMap</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-73"></span><span>  </span><span id="defSet"><span class="annot"><span class="annottext">DrasilState -&gt; Set String
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#defSet"><span class="hs-identifier hs-var hs-var">defSet</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-74"></span><span>  </span><span id="getVal"><span class="annot"><span class="annottext">DrasilState -&gt; Int
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#getVal"><span class="hs-identifier hs-var hs-var">getVal</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-comment">-- Stateful</span><span>
</span><span id="line-77"></span><span>  </span><span id="currentModule"><span class="annot"><span class="annottext">DrasilState -&gt; String
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#currentModule"><span class="hs-identifier hs-var hs-var">currentModule</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span>
</span><span id="line-78"></span><span>  </span><span id="currentClass"><span class="annot"><span class="annottext">DrasilState -&gt; String
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#currentClass"><span class="hs-identifier hs-var hs-var">currentClass</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span>
</span><span id="line-79"></span><span>  </span><span id="_designLog"><span class="annot"><span class="annottext">DrasilState -&gt; Doc
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#_designLog"><span class="hs-identifier hs-var hs-var">_designLog</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span class="hs-special">,</span><span>
</span><span id="line-80"></span><span>  </span><span id="_loggedSpaces"><span class="annot"><span class="annottext">DrasilState -&gt; [(Space, CodeType)]
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#_loggedSpaces"><span class="hs-identifier hs-var hs-var">_loggedSpaces</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Space</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CodeType</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-81"></span><span class="hs-special">}</span><span>
</span><span id="line-82"></span><span id="loggedSpaces"><span id="designLog"><span class="hs-identifier">makeLenses</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">DrasilState</span></span></span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="hs-comment">-- | Adds a message to the design log if the given 'Space'-'CodeType' match has not</span><span>
</span><span id="line-85"></span><span class="hs-comment">-- already been logged.</span><span>
</span><span id="line-86"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#addToDesignLog"><span class="hs-identifier hs-type">addToDesignLog</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Space</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CodeType</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#DrasilState"><span class="hs-identifier hs-type">DrasilState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#DrasilState"><span class="hs-identifier hs-type">DrasilState</span></a></span><span>
</span><span id="line-87"></span><span id="addToDesignLog"><span class="annot"><span class="annottext">addToDesignLog :: Space -&gt; CodeType -&gt; Doc -&gt; DrasilState -&gt; DrasilState
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#addToDesignLog"><span class="hs-identifier hs-var hs-var">addToDesignLog</span></a></span></span><span> </span><span id="local-6989586621679265397"><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621679265397"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679265396"><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679265396"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679265395"><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679265395"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679265394"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679265394"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621679265397"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679265396"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679265394"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="annot"><span class="annottext">forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Lens' DrasilState [(Space, CodeType)]
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#loggedSpaces"><span class="hs-identifier hs-var">loggedSpaces</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679265394"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-identifier hs-var">over</span></span><span> </span><span class="annot"><span class="annottext">Lens' DrasilState Doc
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#designLog"><span class="hs-identifier hs-var">designLog</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">$$</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679265395"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679265394"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="hs-comment">-- | Adds a 'Space'-'CodeType' pair to the loggedSpaces list in 'DrasilState' to prevent a duplicate</span><span>
</span><span id="line-91"></span><span class="hs-comment">-- log from being generated for that 'Space'-'CodeType' pair.</span><span>
</span><span id="line-92"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#addLoggedSpace"><span class="hs-identifier hs-type">addLoggedSpace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Space</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CodeType</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#DrasilState"><span class="hs-identifier hs-type">DrasilState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#DrasilState"><span class="hs-identifier hs-type">DrasilState</span></a></span><span>
</span><span id="line-93"></span><span id="addLoggedSpace"><span class="annot"><span class="annottext">addLoggedSpace :: Space -&gt; CodeType -&gt; DrasilState -&gt; DrasilState
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#addLoggedSpace"><span class="hs-identifier hs-var hs-var">addLoggedSpace</span></a></span></span><span> </span><span id="local-6989586621679265392"><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621679265392"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679265391"><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679265391"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-identifier hs-var">over</span></span><span> </span><span class="annot"><span class="annottext">Lens' DrasilState [(Space, CodeType)]
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#loggedSpaces"><span class="hs-identifier hs-var">loggedSpaces</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621679265392"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679265391"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span class="hs-comment">-- | Builds the module export map, mapping each function and state variable name</span><span>
</span><span id="line-96"></span><span class="hs-comment">-- in the generated code to the name of the generated module that exports it.</span><span>
</span><span id="line-97"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#modExportMap"><span class="hs-identifier hs-type">modExportMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Drasil.CodeSpec.html#CodeSpec"><span class="hs-identifier hs-type">CodeSpec</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#Choices"><span class="hs-identifier hs-type">Choices</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Mod.html#Mod"><span class="hs-identifier hs-type">Mod</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#ModExportMap"><span class="hs-identifier hs-type">ModExportMap</span></a></span><span>
</span><span id="line-98"></span><span id="modExportMap"><span class="annot"><span class="annottext">modExportMap :: CodeSpec -&gt; Choices -&gt; [Mod] -&gt; ModExportMap
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#modExportMap"><span class="hs-identifier hs-var hs-var">modExportMap</span></a></span></span><span> </span><span id="local-6989586621679265390"><span class="annot"><span class="annottext">cs :: CodeSpec
</span><a href="#local-6989586621679265390"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.Drasil.CodeSpec.html#CodeSpec"><span class="hs-identifier hs-type">CodeSpec</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-99"></span><span>  </span><span class="annot"><span class="annottext">pName :: CodeSpec -&gt; String
</span><a href="Language.Drasil.CodeSpec.html#pName"><span class="hs-identifier hs-var">pName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679265373"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679265373"><span class="hs-identifier hs-var">prn</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-100"></span><span>  </span><span class="annot"><span class="annottext">inputs :: CodeSpec -&gt; [Input]
</span><a href="Language.Drasil.CodeSpec.html#inputs"><span class="hs-identifier hs-var">inputs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679265371"><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679265371"><span class="hs-identifier hs-var">ins</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-101"></span><span>  </span><span class="annot"><span class="annottext">extInputs :: CodeSpec -&gt; [Input]
</span><a href="Language.Drasil.CodeSpec.html#extInputs"><span class="hs-identifier hs-var">extInputs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679265369"><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679265369"><span class="hs-identifier hs-var">extIns</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-102"></span><span>  </span><span class="annot"><span class="annottext">derivedInputs :: CodeSpec -&gt; [Def]
</span><a href="Language.Drasil.CodeSpec.html#derivedInputs"><span class="hs-identifier hs-var">derivedInputs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679265367"><span class="annot"><span class="annottext">[Def]
</span><a href="#local-6989586621679265367"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-103"></span><span>  </span><span class="annot"><span class="annottext">constants :: CodeSpec -&gt; [Def]
</span><a href="Language.Drasil.CodeSpec.html#constants"><span class="hs-identifier hs-var">constants</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679265365"><span class="annot"><span class="annottext">[Def]
</span><a href="#local-6989586621679265365"><span class="hs-identifier hs-var">cns</span></a></span></span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-special">}</span><span> </span><span id="local-6989586621679265364"><span class="annot"><span class="annottext">chs :: Choices
</span><a href="#local-6989586621679265364"><span class="hs-identifier hs-var">chs</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.Drasil.Choices.html#Choices"><span class="hs-identifier hs-type">Choices</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-105"></span><span>    </span><span class="annot"><span class="annottext">architecture :: Choices -&gt; Architecture
</span><a href="Language.Drasil.Choices.html#architecture"><span class="hs-identifier hs-var">architecture</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679265361"><span class="annot"><span class="annottext">Architecture
</span><a href="#local-6989586621679265361"><span class="hs-identifier hs-var">m</span></a></span></span><span>
</span><span id="line-106"></span><span>  </span><span class="hs-special">}</span><span> </span><span id="local-6989586621679265360"><span class="annot"><span class="annottext">[Mod]
</span><a href="#local-6989586621679265360"><span class="hs-identifier hs-var">ms</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">fromList</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">nub</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">Mod -&gt; [(String, String)]
</span><a href="#local-6989586621679265358"><span class="hs-identifier hs-var">mpair</span></a></span><span> </span><span class="annot"><span class="annottext">[Mod]
</span><a href="#local-6989586621679265360"><span class="hs-identifier hs-var">ms</span></a></span><span>
</span><span id="line-107"></span><span>    </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Choices -&gt; [Input] -&gt; [(String, String)]
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#getExpInput"><span class="hs-identifier hs-var">getExpInput</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679265373"><span class="hs-identifier hs-var">prn</span></a></span><span> </span><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265364"><span class="hs-identifier hs-var">chs</span></a></span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679265371"><span class="hs-identifier hs-var">ins</span></a></span><span>
</span><span id="line-108"></span><span>    </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Choices -&gt; [Def] -&gt; [(String, String)]
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#getExpConstants"><span class="hs-identifier hs-var">getExpConstants</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679265373"><span class="hs-identifier hs-var">prn</span></a></span><span> </span><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265364"><span class="hs-identifier hs-var">chs</span></a></span><span> </span><span class="annot"><span class="annottext">[Def]
</span><a href="#local-6989586621679265365"><span class="hs-identifier hs-var">cns</span></a></span><span>
</span><span id="line-109"></span><span>    </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Choices -&gt; [Def] -&gt; [(String, String)]
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#getExpDerived"><span class="hs-identifier hs-var">getExpDerived</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679265373"><span class="hs-identifier hs-var">prn</span></a></span><span> </span><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265364"><span class="hs-identifier hs-var">chs</span></a></span><span> </span><span class="annot"><span class="annottext">[Def]
</span><a href="#local-6989586621679265367"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-110"></span><span>    </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Choices -&gt; [ConstraintCE] -&gt; [(String, String)]
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#getExpConstraints"><span class="hs-identifier hs-var">getExpConstraints</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679265373"><span class="hs-identifier hs-var">prn</span></a></span><span> </span><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265364"><span class="hs-identifier hs-var">chs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall c. HasUID c =&gt; ConstraintCEMap -&gt; [c] -&gt; [ConstraintCE]
</span><a href="Language.Drasil.CodeSpec.html#getConstraints"><span class="hs-identifier hs-var">getConstraints</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeSpec -&gt; ConstraintCEMap
</span><a href="Language.Drasil.CodeSpec.html#cMap"><span class="hs-identifier hs-var">cMap</span></a></span><span> </span><span class="annot"><span class="annottext">CodeSpec
</span><a href="#local-6989586621679265390"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679265371"><span class="hs-identifier hs-var">ins</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span>    </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Choices -&gt; [Input] -&gt; [(String, String)]
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#getExpInputFormat"><span class="hs-identifier hs-var">getExpInputFormat</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679265373"><span class="hs-identifier hs-var">prn</span></a></span><span> </span><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265364"><span class="hs-identifier hs-var">chs</span></a></span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679265369"><span class="hs-identifier hs-var">extIns</span></a></span><span>
</span><span id="line-112"></span><span>    </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Choices -&gt; [Def] -&gt; [(String, String)]
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#getExpCalcs"><span class="hs-identifier hs-var">getExpCalcs</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679265373"><span class="hs-identifier hs-var">prn</span></a></span><span> </span><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265364"><span class="hs-identifier hs-var">chs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeSpec -&gt; [Def]
</span><a href="Language.Drasil.CodeSpec.html#execOrder"><span class="hs-identifier hs-var">execOrder</span></a></span><span> </span><span class="annot"><span class="annottext">CodeSpec
</span><a href="#local-6989586621679265390"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>    </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Choices -&gt; [Input] -&gt; [(String, String)]
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#getExpOutput"><span class="hs-identifier hs-var">getExpOutput</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679265373"><span class="hs-identifier hs-var">prn</span></a></span><span> </span><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265364"><span class="hs-identifier hs-var">chs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeSpec -&gt; [Input]
</span><a href="Language.Drasil.CodeSpec.html#outputs"><span class="hs-identifier hs-var">outputs</span></a></span><span> </span><span class="annot"><span class="annottext">CodeSpec
</span><a href="#local-6989586621679265390"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679265358"><span class="annot"><span class="annottext">mpair :: Mod -&gt; [(String, String)]
</span><a href="#local-6989586621679265358"><span class="hs-identifier hs-var hs-var">mpair</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#Mod"><span class="hs-identifier hs-type">Mod</span></a></span><span> </span><span id="local-6989586621679265340"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679265340"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679265339"><span class="annot"><span class="annottext">[Class]
</span><a href="#local-6989586621679265339"><span class="hs-identifier hs-var">cls</span></a></span></span><span> </span><span id="local-6989586621679265338"><span class="annot"><span class="annottext">[Func]
</span><a href="#local-6989586621679265338"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span>
</span><span id="line-115"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Modularity -&gt; String -&gt; String
</span><a href="#local-6989586621679265337"><span class="hs-identifier hs-var">defModName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Architecture -&gt; Modularity
</span><a href="Language.Drasil.Choices.html#modularity"><span class="hs-identifier hs-var">modularity</span></a></span><span> </span><span class="annot"><span class="annottext">Architecture
</span><a href="#local-6989586621679265361"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679265340"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Class -&gt; String
</span><a href="Language.Drasil.Mod.html#className"><span class="hs-identifier hs-var">className</span></a></span><span> </span><span class="annot"><span class="annottext">[Class]
</span><a href="#local-6989586621679265339"><span class="hs-identifier hs-var">cls</span></a></span><span>
</span><span id="line-117"></span><span>            </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall c. CodeIdea c =&gt; c -&gt; String
</span><span class="hs-identifier hs-var">codeName</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">StateVariable -&gt; Input
</span><a href="Language.Drasil.Mod.html#stVar"><span class="hs-identifier hs-var">stVar</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ScopeTag
</span><span class="hs-identifier hs-var">Pub</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">StateVariable -&gt; ScopeTag
</span><a href="Language.Drasil.Mod.html#svScope"><span class="hs-identifier hs-var">svScope</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Class -&gt; [StateVariable]
</span><a href="Language.Drasil.Mod.html#stateVars"><span class="hs-identifier hs-var">stateVars</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Class]
</span><a href="#local-6989586621679265339"><span class="hs-identifier hs-var">cls</span></a></span><span>
</span><span id="line-118"></span><span>            </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Func -&gt; String
</span><a href="Language.Drasil.Mod.html#fname"><span class="hs-identifier hs-var">fname</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Func]
</span><a href="#local-6989586621679265338"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">Class -&gt; [Func]
</span><a href="Language.Drasil.Mod.html#methods"><span class="hs-identifier hs-var">methods</span></a></span><span> </span><span class="annot"><span class="annottext">[Class]
</span><a href="#local-6989586621679265339"><span class="hs-identifier hs-var">cls</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span>        </span><span id="local-6989586621679265337"><span class="annot"><span class="annottext">defModName :: Modularity -&gt; String -&gt; String
</span><a href="#local-6989586621679265337"><span class="hs-identifier hs-var hs-var">defModName</span></a></span></span><span> </span><span class="annot"><span class="annottext">Modularity
</span><a href="Language.Drasil.Choices.html#Unmodular"><span class="hs-identifier hs-var">Unmodular</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679265373"><span class="hs-identifier hs-var">prn</span></a></span><span>
</span><span id="line-120"></span><span>        </span><span class="annot"><a href="#local-6989586621679265337"><span class="hs-identifier hs-var">defModName</span></a></span><span> </span><span class="annot"><span class="annottext">Modularity
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679265326"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679265326"><span class="hs-identifier hs-var">nm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679265326"><span class="hs-identifier hs-var">nm</span></a></span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span class="hs-comment">-- | Builds the class definition map, mapping each generated method and state</span><span>
</span><span id="line-123"></span><span class="hs-comment">-- variable name to the name of the generated class where it is defined.</span><span>
</span><span id="line-124"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#clsDefMap"><span class="hs-identifier hs-type">clsDefMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Drasil.CodeSpec.html#CodeSpec"><span class="hs-identifier hs-type">CodeSpec</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#Choices"><span class="hs-identifier hs-type">Choices</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Mod.html#Mod"><span class="hs-identifier hs-type">Mod</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#ClassDefinitionMap"><span class="hs-identifier hs-type">ClassDefinitionMap</span></a></span><span>
</span><span id="line-125"></span><span id="clsDefMap"><span class="annot"><span class="annottext">clsDefMap :: CodeSpec -&gt; Choices -&gt; [Mod] -&gt; ModExportMap
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#clsDefMap"><span class="hs-identifier hs-var hs-var">clsDefMap</span></a></span></span><span> </span><span id="local-6989586621679265325"><span class="annot"><span class="annottext">cs :: CodeSpec
</span><a href="#local-6989586621679265325"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.Drasil.CodeSpec.html#CodeSpec"><span class="hs-identifier hs-type">CodeSpec</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-126"></span><span>  </span><span class="annot"><span class="annottext">inputs :: CodeSpec -&gt; [Input]
</span><a href="Language.Drasil.CodeSpec.html#inputs"><span class="hs-identifier hs-var">inputs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679265315"><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679265315"><span class="hs-identifier hs-var">ins</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-127"></span><span>  </span><span class="annot"><span class="annottext">extInputs :: CodeSpec -&gt; [Input]
</span><a href="Language.Drasil.CodeSpec.html#extInputs"><span class="hs-identifier hs-var">extInputs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679265314"><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679265314"><span class="hs-identifier hs-var">extIns</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-128"></span><span>  </span><span class="annot"><span class="annottext">derivedInputs :: CodeSpec -&gt; [Def]
</span><a href="Language.Drasil.CodeSpec.html#derivedInputs"><span class="hs-identifier hs-var">derivedInputs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679265313"><span class="annot"><span class="annottext">[Def]
</span><a href="#local-6989586621679265313"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-129"></span><span>  </span><span class="annot"><span class="annottext">constants :: CodeSpec -&gt; [Def]
</span><a href="Language.Drasil.CodeSpec.html#constants"><span class="hs-identifier hs-var">constants</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679265312"><span class="annot"><span class="annottext">[Def]
</span><a href="#local-6989586621679265312"><span class="hs-identifier hs-var">cns</span></a></span></span><span>
</span><span id="line-130"></span><span>  </span><span class="hs-special">}</span><span> </span><span id="local-6989586621679265311"><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265311"><span class="hs-identifier hs-var">chs</span></a></span></span><span> </span><span id="local-6989586621679265310"><span class="annot"><span class="annottext">[Mod]
</span><a href="#local-6989586621679265310"><span class="hs-identifier hs-var">ms</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">fromList</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">nub</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">Mod -&gt; [(String, String)]
</span><a href="#local-6989586621679265309"><span class="hs-identifier hs-var">modClasses</span></a></span><span> </span><span class="annot"><span class="annottext">[Mod]
</span><a href="#local-6989586621679265310"><span class="hs-identifier hs-var">ms</span></a></span><span>
</span><span id="line-131"></span><span>    </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Choices -&gt; [Input] -&gt; [(String, String)]
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#getInputCls"><span class="hs-identifier hs-var">getInputCls</span></a></span><span> </span><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265311"><span class="hs-identifier hs-var">chs</span></a></span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679265315"><span class="hs-identifier hs-var">ins</span></a></span><span>
</span><span id="line-132"></span><span>    </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Choices -&gt; [Def] -&gt; [(String, String)]
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#getConstantsCls"><span class="hs-identifier hs-var">getConstantsCls</span></a></span><span> </span><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265311"><span class="hs-identifier hs-var">chs</span></a></span><span> </span><span class="annot"><span class="annottext">[Def]
</span><a href="#local-6989586621679265312"><span class="hs-identifier hs-var">cns</span></a></span><span>
</span><span id="line-133"></span><span>    </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Choices -&gt; [Def] -&gt; [(String, String)]
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#getDerivedCls"><span class="hs-identifier hs-var">getDerivedCls</span></a></span><span> </span><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265311"><span class="hs-identifier hs-var">chs</span></a></span><span> </span><span class="annot"><span class="annottext">[Def]
</span><a href="#local-6989586621679265313"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-134"></span><span>    </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Choices -&gt; [ConstraintCE] -&gt; [(String, String)]
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#getConstraintsCls"><span class="hs-identifier hs-var">getConstraintsCls</span></a></span><span> </span><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265311"><span class="hs-identifier hs-var">chs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall c. HasUID c =&gt; ConstraintCEMap -&gt; [c] -&gt; [ConstraintCE]
</span><a href="Language.Drasil.CodeSpec.html#getConstraints"><span class="hs-identifier hs-var">getConstraints</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeSpec -&gt; ConstraintCEMap
</span><a href="Language.Drasil.CodeSpec.html#cMap"><span class="hs-identifier hs-var">cMap</span></a></span><span> </span><span class="annot"><span class="annottext">CodeSpec
</span><a href="#local-6989586621679265325"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679265315"><span class="hs-identifier hs-var">ins</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span>    </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Choices -&gt; [Input] -&gt; [(String, String)]
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#getInputFormatCls"><span class="hs-identifier hs-var">getInputFormatCls</span></a></span><span> </span><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265311"><span class="hs-identifier hs-var">chs</span></a></span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679265314"><span class="hs-identifier hs-var">extIns</span></a></span><span>
</span><span id="line-136"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679265309"><span class="annot"><span class="annottext">modClasses :: Mod -&gt; [(String, String)]
</span><a href="#local-6989586621679265309"><span class="hs-identifier hs-var hs-var">modClasses</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#Mod"><span class="hs-identifier hs-type">Mod</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679265301"><span class="annot"><span class="annottext">[Class]
</span><a href="#local-6989586621679265301"><span class="hs-identifier hs-var">cls</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Func]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679265300"><span class="annot"><span class="annottext">Class
</span><a href="#local-6989586621679265300"><span class="hs-identifier hs-var">cl</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-137"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679265299"><span class="annot"><span class="annottext">cln :: String
</span><a href="#local-6989586621679265299"><span class="hs-identifier hs-var hs-var">cln</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Class -&gt; String
</span><a href="Language.Drasil.Mod.html#className"><span class="hs-identifier hs-var">className</span></a></span><span> </span><span class="annot"><span class="annottext">Class
</span><a href="#local-6989586621679265300"><span class="hs-identifier hs-var">cl</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-138"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679265299"><span class="hs-identifier hs-var">cln</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679265299"><span class="hs-identifier hs-var">cln</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679265298"><span class="annot"><span class="annottext">StateVariable
</span><a href="#local-6989586621679265298"><span class="hs-identifier hs-var">sv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall c. CodeIdea c =&gt; c -&gt; String
</span><span class="hs-identifier hs-var">codeName</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateVariable -&gt; Input
</span><a href="Language.Drasil.Mod.html#stVar"><span class="hs-identifier hs-var">stVar</span></a></span><span> </span><span class="annot"><span class="annottext">StateVariable
</span><a href="#local-6989586621679265298"><span class="hs-identifier hs-var">sv</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679265299"><span class="hs-identifier hs-var">cln</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Class -&gt; [StateVariable]
</span><a href="Language.Drasil.Mod.html#stateVars"><span class="hs-identifier hs-var">stateVars</span></a></span><span> </span><span class="annot"><span class="annottext">Class
</span><a href="#local-6989586621679265300"><span class="hs-identifier hs-var">cl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span>              </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679265297"><span class="annot"><span class="annottext">Func
</span><a href="#local-6989586621679265297"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Func -&gt; String
</span><a href="Language.Drasil.Mod.html#fname"><span class="hs-identifier hs-var">fname</span></a></span><span> </span><span class="annot"><span class="annottext">Func
</span><a href="#local-6989586621679265297"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679265299"><span class="hs-identifier hs-var">cln</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Class -&gt; [Func]
</span><a href="Language.Drasil.Mod.html#methods"><span class="hs-identifier hs-var">methods</span></a></span><span> </span><span class="annot"><span class="annottext">Class
</span><a href="#local-6989586621679265300"><span class="hs-identifier hs-var">cl</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Class]
</span><a href="#local-6989586621679265301"><span class="hs-identifier hs-var">cls</span></a></span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span class="hs-comment">-- | Module exports.</span><span>
</span><span id="line-142"></span><span class="hs-keyword">type</span><span> </span><span id="ModExp"><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#ModExp"><span class="hs-identifier hs-var">ModExp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span class="hs-comment">-- | Class definitions.</span><span>
</span><span id="line-144"></span><span class="hs-keyword">type</span><span> </span><span id="ClassDef"><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#ClassDef"><span class="hs-identifier hs-var">ClassDef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="hs-comment">-- | Gets exported inputs for InputParameters module.</span><span>
</span><span id="line-147"></span><span class="hs-comment">-- If there are no inputs, no input variables are exported.</span><span>
</span><span id="line-148"></span><span class="hs-comment">-- If 'Unbundled', no input variables are exported.</span><span>
</span><span id="line-149"></span><span class="hs-comment">-- If 'Unmodular' and 'Bundled', module is named after program.</span><span>
</span><span id="line-150"></span><span class="hs-comment">-- If 'Modular' and 'Bundled', inputs are exported by InputParameters module.</span><span>
</span><span id="line-151"></span><span class="hs-comment">-- In 'Unmodular' 'Bundled' and 'Modular' 'Bundled' cases, an InputParameters</span><span>
</span><span id="line-152"></span><span class="hs-comment">-- constructor is generated, thus &quot;InputParameters&quot; is added to map.</span><span>
</span><span id="line-153"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#getExpInput"><span class="hs-identifier hs-type">getExpInput</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#Choices"><span class="hs-identifier hs-type">Choices</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.CodeSpec.html#Input"><span class="hs-identifier hs-type">Input</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#ModExp"><span class="hs-identifier hs-type">ModExp</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-154"></span><span id="getExpInput"><span class="annot"><span class="annottext">getExpInput :: String -&gt; Choices -&gt; [Input] -&gt; [(String, String)]
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#getExpInput"><span class="hs-identifier hs-var hs-var">getExpInput</span></a></span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Choices
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-155"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#getExpInput"><span class="hs-identifier hs-var">getExpInput</span></a></span><span> </span><span id="local-6989586621679265294"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679265294"><span class="hs-identifier hs-var">prn</span></a></span></span><span> </span><span id="local-6989586621679265293"><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265293"><span class="hs-identifier hs-var">chs</span></a></span></span><span> </span><span id="local-6989586621679265292"><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679265292"><span class="hs-identifier hs-var">ins</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Modularity -&gt; Structure -&gt; [(String, String)]
</span><a href="#local-6989586621679265291"><span class="hs-identifier hs-var">inExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Architecture -&gt; Modularity
</span><a href="Language.Drasil.Choices.html#modularity"><span class="hs-identifier hs-var">modularity</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Choices -&gt; Architecture
</span><a href="Language.Drasil.Choices.html#architecture"><span class="hs-identifier hs-var">architecture</span></a></span><span> </span><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265293"><span class="hs-identifier hs-var">chs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataInfo -&gt; Structure
</span><a href="Language.Drasil.Choices.html#inputStructure"><span class="hs-identifier hs-var">inputStructure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Choices -&gt; DataInfo
</span><a href="Language.Drasil.Choices.html#dataInfo"><span class="hs-identifier hs-var">dataInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265293"><span class="hs-identifier hs-var">chs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-156"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679265291"><span class="annot"><span class="annottext">inExp :: Modularity -&gt; Structure -&gt; [(String, String)]
</span><a href="#local-6989586621679265291"><span class="hs-identifier hs-var hs-var">inExp</span></a></span></span><span> </span><span class="annot"><span class="annottext">Modularity
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Structure
</span><a href="Language.Drasil.Choices.html#Unbundled"><span class="hs-identifier hs-var">Unbundled</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-157"></span><span>        </span><span class="annot"><a href="#local-6989586621679265291"><span class="hs-identifier hs-var">inExp</span></a></span><span> </span><span class="annot"><span class="annottext">Modularity
</span><a href="Language.Drasil.Choices.html#Unmodular"><span class="hs-identifier hs-var">Unmodular</span></a></span><span> </span><span class="annot"><span class="annottext">Structure
</span><a href="Language.Drasil.Choices.html#Bundled"><span class="hs-identifier hs-var">Bundled</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679265286"><span class="hs-identifier hs-var">ipName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679265294"><span class="hs-identifier hs-var">prn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">forall {t}. t -&gt; [(String, t)]
</span><a href="#local-6989586621679265285"><span class="hs-identifier hs-var">inVarDefs</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679265294"><span class="hs-identifier hs-var">prn</span></a></span><span>
</span><span id="line-158"></span><span>        </span><span class="annot"><a href="#local-6989586621679265291"><span class="hs-identifier hs-var">inExp</span></a></span><span> </span><span class="annot"><span class="annottext">Modularity
</span><a href="Language.Drasil.Choices.html#Modular"><span class="hs-identifier hs-var">Modular</span></a></span><span> </span><span class="annot"><span class="annottext">Structure
</span><a href="Language.Drasil.Choices.html#Bundled"><span class="hs-identifier hs-var">Bundled</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679265286"><span class="hs-identifier hs-var">ipName</span></a></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679265286"><span class="hs-identifier hs-var">ipName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">forall {t}. t -&gt; [(String, t)]
</span><a href="#local-6989586621679265285"><span class="hs-identifier hs-var">inVarDefs</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679265286"><span class="hs-identifier hs-var">ipName</span></a></span><span>
</span><span id="line-159"></span><span>        </span><span id="local-6989586621679265285"><span class="annot"><span class="annottext">inVarDefs :: t -&gt; [(String, t)]
</span><a href="#local-6989586621679265285"><span class="hs-identifier hs-var hs-var">inVarDefs</span></a></span></span><span> </span><span id="local-6989586621679265282"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679265282"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679265282"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall c. CodeIdea c =&gt; c -&gt; String
</span><span class="hs-identifier hs-var">codeName</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679265292"><span class="hs-identifier hs-var">ins</span></a></span><span>
</span><span id="line-160"></span><span>        </span><span id="local-6989586621679265286"><span class="annot"><span class="annottext">ipName :: String
</span><a href="#local-6989586621679265286"><span class="hs-identifier hs-var hs-var">ipName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Choices -&gt; InternalConcept -&gt; String
</span><a href="Language.Drasil.Choices.html#icNames"><span class="hs-identifier hs-var">icNames</span></a></span><span> </span><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265293"><span class="hs-identifier hs-var">chs</span></a></span><span> </span><span class="annot"><span class="annottext">InternalConcept
</span><a href="Language.Drasil.Choices.html#InputParameters"><span class="hs-identifier hs-var">InputParameters</span></a></span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="hs-comment">-- | Gets input variables for classes for InputParameters module.</span><span>
</span><span id="line-163"></span><span class="hs-comment">-- If no inputs, input variables will not be defined in any class.</span><span>
</span><span id="line-164"></span><span class="hs-comment">-- If 'Unbundled', input variables will not be defined in any class.</span><span>
</span><span id="line-165"></span><span class="hs-comment">-- If 'Bundled', input variables and input constructor are defined in InputParameters.</span><span>
</span><span id="line-166"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#getInputCls"><span class="hs-identifier hs-type">getInputCls</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#Choices"><span class="hs-identifier hs-type">Choices</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.CodeSpec.html#Input"><span class="hs-identifier hs-type">Input</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#ClassDef"><span class="hs-identifier hs-type">ClassDef</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-167"></span><span id="getInputCls"><span class="annot"><span class="annottext">getInputCls :: Choices -&gt; [Input] -&gt; [(String, String)]
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#getInputCls"><span class="hs-identifier hs-var hs-var">getInputCls</span></a></span></span><span> </span><span class="annot"><span class="annottext">Choices
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-168"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#getInputCls"><span class="hs-identifier hs-var">getInputCls</span></a></span><span> </span><span id="local-6989586621679265279"><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265279"><span class="hs-identifier hs-var">chs</span></a></span></span><span> </span><span id="local-6989586621679265278"><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679265278"><span class="hs-identifier hs-var">ins</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Structure -&gt; [(String, String)]
</span><a href="#local-6989586621679265277"><span class="hs-identifier hs-var">inCls</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataInfo -&gt; Structure
</span><a href="Language.Drasil.Choices.html#inputStructure"><span class="hs-identifier hs-var">inputStructure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Choices -&gt; DataInfo
</span><a href="Language.Drasil.Choices.html#dataInfo"><span class="hs-identifier hs-var">dataInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265279"><span class="hs-identifier hs-var">chs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679265277"><span class="annot"><span class="annottext">inCls :: Structure -&gt; [(String, String)]
</span><a href="#local-6989586621679265277"><span class="hs-identifier hs-var hs-var">inCls</span></a></span></span><span> </span><span class="annot"><span class="annottext">Structure
</span><a href="Language.Drasil.Choices.html#Unbundled"><span class="hs-identifier hs-var">Unbundled</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-170"></span><span>        </span><span class="annot"><a href="#local-6989586621679265277"><span class="hs-identifier hs-var">inCls</span></a></span><span> </span><span class="annot"><span class="annottext">Structure
</span><a href="Language.Drasil.Choices.html#Bundled"><span class="hs-identifier hs-var">Bundled</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679265276"><span class="hs-identifier hs-var">ipName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679265276"><span class="hs-identifier hs-var">ipName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(String, String)]
</span><a href="#local-6989586621679265275"><span class="hs-identifier hs-var">inVarDefs</span></a></span><span>
</span><span id="line-171"></span><span>        </span><span id="local-6989586621679265275"><span class="annot"><span class="annottext">inVarDefs :: [(String, String)]
</span><a href="#local-6989586621679265275"><span class="hs-identifier hs-var hs-var">inVarDefs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679265276"><span class="hs-identifier hs-var">ipName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall c. CodeIdea c =&gt; c -&gt; String
</span><span class="hs-identifier hs-var">codeName</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679265278"><span class="hs-identifier hs-var">ins</span></a></span><span>
</span><span id="line-172"></span><span>        </span><span id="local-6989586621679265276"><span class="annot"><span class="annottext">ipName :: String
</span><a href="#local-6989586621679265276"><span class="hs-identifier hs-var hs-var">ipName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Choices -&gt; InternalConcept -&gt; String
</span><a href="Language.Drasil.Choices.html#icNames"><span class="hs-identifier hs-var">icNames</span></a></span><span> </span><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265279"><span class="hs-identifier hs-var">chs</span></a></span><span> </span><span class="annot"><span class="annottext">InternalConcept
</span><a href="Language.Drasil.Choices.html#InputParameters"><span class="hs-identifier hs-var">InputParameters</span></a></span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span class="hs-comment">-- | Gets constants to be exported for InputParameters or Constants module.</span><span>
</span><span id="line-175"></span><span class="hs-comment">-- If there are no constants, constants will not be exported.</span><span>
</span><span id="line-176"></span><span class="hs-comment">-- If 'Unmodular' and 'Bundled', constants will be exported by the module named after the program.</span><span>
</span><span id="line-177"></span><span class="hs-comment">-- If 'Modular' and 'Store' 'Bundled', constants will be exported by the Constants module.</span><span>
</span><span id="line-178"></span><span class="hs-comment">-- If 'Modular' 'WithInputs' and inputs are 'Bundled', constants will be exported by the InputParameters module.</span><span>
</span><span id="line-179"></span><span class="hs-comment">-- If 'Unbundled', constants are not exported by any module.</span><span>
</span><span id="line-180"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#getExpConstants"><span class="hs-identifier hs-type">getExpConstants</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#Choices"><span class="hs-identifier hs-type">Choices</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.CodeSpec.html#Const"><span class="hs-identifier hs-type">Const</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#ModExp"><span class="hs-identifier hs-type">ModExp</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-181"></span><span id="getExpConstants"><span class="annot"><span class="annottext">getExpConstants :: String -&gt; Choices -&gt; [Def] -&gt; [(String, String)]
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#getExpConstants"><span class="hs-identifier hs-var hs-var">getExpConstants</span></a></span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Choices
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-182"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#getExpConstants"><span class="hs-identifier hs-var">getExpConstants</span></a></span><span> </span><span id="local-6989586621679265273"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679265273"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679265272"><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265272"><span class="hs-identifier hs-var">chs</span></a></span></span><span> </span><span id="local-6989586621679265271"><span class="annot"><span class="annottext">[Def]
</span><a href="#local-6989586621679265271"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Modularity -&gt; ConstantStructure -&gt; Structure -&gt; [(String, String)]
</span><a href="#local-6989586621679265270"><span class="hs-identifier hs-var">cExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Architecture -&gt; Modularity
</span><a href="Language.Drasil.Choices.html#modularity"><span class="hs-identifier hs-var">modularity</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Choices -&gt; Architecture
</span><a href="Language.Drasil.Choices.html#architecture"><span class="hs-identifier hs-var">architecture</span></a></span><span> </span><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265272"><span class="hs-identifier hs-var">chs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataInfo -&gt; ConstantStructure
</span><a href="Language.Drasil.Choices.html#constStructure"><span class="hs-identifier hs-var">constStructure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Choices -&gt; DataInfo
</span><a href="Language.Drasil.Choices.html#dataInfo"><span class="hs-identifier hs-var">dataInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265272"><span class="hs-identifier hs-var">chs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataInfo -&gt; Structure
</span><a href="Language.Drasil.Choices.html#inputStructure"><span class="hs-identifier hs-var">inputStructure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Choices -&gt; DataInfo
</span><a href="Language.Drasil.Choices.html#dataInfo"><span class="hs-identifier hs-var">dataInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265272"><span class="hs-identifier hs-var">chs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679265270"><span class="annot"><span class="annottext">cExp :: Modularity -&gt; ConstantStructure -&gt; Structure -&gt; [(String, String)]
</span><a href="#local-6989586621679265270"><span class="hs-identifier hs-var hs-var">cExp</span></a></span></span><span> </span><span class="annot"><span class="annottext">Modularity
</span><a href="Language.Drasil.Choices.html#Unmodular"><span class="hs-identifier hs-var">Unmodular</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Choices.html#Store"><span class="hs-identifier hs-type">Store</span></a></span><span> </span><span class="annot"><span class="annottext">Structure
</span><a href="Language.Drasil.Choices.html#Bundled"><span class="hs-identifier hs-var">Bundled</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Structure
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {b}. [b] -&gt; [(String, b)]
</span><a href="#local-6989586621679265267"><span class="hs-identifier hs-var">zipCs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a]
</span><span class="hs-identifier hs-var">repeat</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679265273"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-185"></span><span>        </span><span class="annot"><a href="#local-6989586621679265270"><span class="hs-identifier hs-var">cExp</span></a></span><span> </span><span class="annot"><span class="annottext">Modularity
</span><a href="Language.Drasil.Choices.html#Unmodular"><span class="hs-identifier hs-var">Unmodular</span></a></span><span> </span><span class="annot"><span class="annottext">ConstantStructure
</span><a href="Language.Drasil.Choices.html#WithInputs"><span class="hs-identifier hs-var">WithInputs</span></a></span><span> </span><span class="annot"><span class="annottext">Structure
</span><a href="Language.Drasil.Choices.html#Bundled"><span class="hs-identifier hs-var">Bundled</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {b}. [b] -&gt; [(String, b)]
</span><a href="#local-6989586621679265267"><span class="hs-identifier hs-var">zipCs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a]
</span><span class="hs-identifier hs-var">repeat</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679265273"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-186"></span><span>        </span><span class="annot"><a href="#local-6989586621679265270"><span class="hs-identifier hs-var">cExp</span></a></span><span> </span><span class="annot"><span class="annottext">Modularity
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Choices.html#Store"><span class="hs-identifier hs-type">Store</span></a></span><span> </span><span class="annot"><span class="annottext">Structure
</span><a href="Language.Drasil.Choices.html#Bundled"><span class="hs-identifier hs-var">Bundled</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Structure
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {b}. [b] -&gt; [(String, b)]
</span><a href="#local-6989586621679265267"><span class="hs-identifier hs-var">zipCs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a]
</span><span class="hs-identifier hs-var">repeat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Choices -&gt; InternalConcept -&gt; String
</span><a href="Language.Drasil.Choices.html#icNames"><span class="hs-identifier hs-var">icNames</span></a></span><span> </span><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265272"><span class="hs-identifier hs-var">chs</span></a></span><span> </span><span class="annot"><span class="annottext">InternalConcept
</span><a href="Language.Drasil.Choices.html#Constants"><span class="hs-identifier hs-var">Constants</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span>        </span><span class="annot"><a href="#local-6989586621679265270"><span class="hs-identifier hs-var">cExp</span></a></span><span> </span><span class="annot"><span class="annottext">Modularity
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ConstantStructure
</span><a href="Language.Drasil.Choices.html#WithInputs"><span class="hs-identifier hs-var">WithInputs</span></a></span><span> </span><span class="annot"><span class="annottext">Structure
</span><a href="Language.Drasil.Choices.html#Bundled"><span class="hs-identifier hs-var">Bundled</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {b}. [b] -&gt; [(String, b)]
</span><a href="#local-6989586621679265267"><span class="hs-identifier hs-var">zipCs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a]
</span><span class="hs-identifier hs-var">repeat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Choices -&gt; InternalConcept -&gt; String
</span><a href="Language.Drasil.Choices.html#icNames"><span class="hs-identifier hs-var">icNames</span></a></span><span> </span><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265272"><span class="hs-identifier hs-var">chs</span></a></span><span> </span><span class="annot"><span class="annottext">InternalConcept
</span><a href="Language.Drasil.Choices.html#InputParameters"><span class="hs-identifier hs-var">InputParameters</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>        </span><span class="annot"><a href="#local-6989586621679265270"><span class="hs-identifier hs-var">cExp</span></a></span><span> </span><span class="annot"><span class="annottext">Modularity
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ConstantStructure
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Structure
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-189"></span><span>        </span><span id="local-6989586621679265267"><span class="annot"><span class="annottext">zipCs :: [b] -&gt; [(String, b)]
</span><a href="#local-6989586621679265267"><span class="hs-identifier hs-var hs-var">zipCs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall c. CodeIdea c =&gt; c -&gt; String
</span><span class="hs-identifier hs-var">codeName</span></span><span> </span><span class="annot"><span class="annottext">[Def]
</span><a href="#local-6989586621679265271"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span class="hs-comment">-- | Gets state variables for constants in a class for InputParameters or Constants module.</span><span>
</span><span id="line-192"></span><span class="hs-comment">-- If there are no constants, state variables for the constants are not defined in any class.</span><span>
</span><span id="line-193"></span><span class="hs-comment">-- If constants are 'Bundled', state variables for the constants are in Constants.</span><span>
</span><span id="line-194"></span><span class="hs-comment">-- If constants are 'Bundled' 'WithInputs', state variables for the constants are in InputParameters.</span><span>
</span><span id="line-195"></span><span class="hs-comment">-- If constants are 'Unbundled', state variables for the constants are not defined in any class.</span><span>
</span><span id="line-196"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#getConstantsCls"><span class="hs-identifier hs-type">getConstantsCls</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#Choices"><span class="hs-identifier hs-type">Choices</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.CodeSpec.html#Const"><span class="hs-identifier hs-type">Const</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#ClassDef"><span class="hs-identifier hs-type">ClassDef</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-197"></span><span id="getConstantsCls"><span class="annot"><span class="annottext">getConstantsCls :: Choices -&gt; [Def] -&gt; [(String, String)]
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#getConstantsCls"><span class="hs-identifier hs-var hs-var">getConstantsCls</span></a></span></span><span> </span><span class="annot"><span class="annottext">Choices
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-198"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#getConstantsCls"><span class="hs-identifier hs-var">getConstantsCls</span></a></span><span> </span><span id="local-6989586621679265262"><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265262"><span class="hs-identifier hs-var">chs</span></a></span></span><span> </span><span id="local-6989586621679265261"><span class="annot"><span class="annottext">[Def]
</span><a href="#local-6989586621679265261"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConstantStructure -&gt; Structure -&gt; [(String, String)]
</span><a href="#local-6989586621679265260"><span class="hs-identifier hs-var">cnCls</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataInfo -&gt; ConstantStructure
</span><a href="Language.Drasil.Choices.html#constStructure"><span class="hs-identifier hs-var">constStructure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Choices -&gt; DataInfo
</span><a href="Language.Drasil.Choices.html#dataInfo"><span class="hs-identifier hs-var">dataInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265262"><span class="hs-identifier hs-var">chs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataInfo -&gt; Structure
</span><a href="Language.Drasil.Choices.html#inputStructure"><span class="hs-identifier hs-var">inputStructure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Choices -&gt; DataInfo
</span><a href="Language.Drasil.Choices.html#dataInfo"><span class="hs-identifier hs-var">dataInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265262"><span class="hs-identifier hs-var">chs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679265260"><span class="annot"><span class="annottext">cnCls :: ConstantStructure -&gt; Structure -&gt; [(String, String)]
</span><a href="#local-6989586621679265260"><span class="hs-identifier hs-var hs-var">cnCls</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Choices.html#Store"><span class="hs-identifier hs-type">Store</span></a></span><span> </span><span class="annot"><span class="annottext">Structure
</span><a href="Language.Drasil.Choices.html#Bundled"><span class="hs-identifier hs-var">Bundled</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Structure
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InternalConcept -&gt; [(String, String)]
</span><a href="#local-6989586621679265259"><span class="hs-identifier hs-var">zipCs</span></a></span><span> </span><span class="annot"><span class="annottext">InternalConcept
</span><a href="Language.Drasil.Choices.html#Constants"><span class="hs-identifier hs-var">Constants</span></a></span><span>
</span><span id="line-200"></span><span>        </span><span class="annot"><a href="#local-6989586621679265260"><span class="hs-identifier hs-var">cnCls</span></a></span><span> </span><span class="annot"><span class="annottext">ConstantStructure
</span><a href="Language.Drasil.Choices.html#WithInputs"><span class="hs-identifier hs-var">WithInputs</span></a></span><span> </span><span class="annot"><span class="annottext">Structure
</span><a href="Language.Drasil.Choices.html#Bundled"><span class="hs-identifier hs-var">Bundled</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InternalConcept -&gt; [(String, String)]
</span><a href="#local-6989586621679265259"><span class="hs-identifier hs-var">zipCs</span></a></span><span> </span><span class="annot"><span class="annottext">InternalConcept
</span><a href="Language.Drasil.Choices.html#InputParameters"><span class="hs-identifier hs-var">InputParameters</span></a></span><span>
</span><span id="line-201"></span><span>        </span><span class="annot"><a href="#local-6989586621679265260"><span class="hs-identifier hs-var">cnCls</span></a></span><span> </span><span class="annot"><span class="annottext">ConstantStructure
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Structure
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-202"></span><span>        </span><span id="local-6989586621679265259"><span class="annot"><span class="annottext">zipCs :: InternalConcept -&gt; [(String, String)]
</span><a href="#local-6989586621679265259"><span class="hs-identifier hs-var hs-var">zipCs</span></a></span></span><span> </span><span id="local-6989586621679265257"><span class="annot"><span class="annottext">InternalConcept
</span><a href="#local-6989586621679265257"><span class="hs-identifier hs-var">ic</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Choices -&gt; InternalConcept -&gt; String
</span><a href="Language.Drasil.Choices.html#icNames"><span class="hs-identifier hs-var">icNames</span></a></span><span> </span><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265262"><span class="hs-identifier hs-var">chs</span></a></span><span> </span><span class="annot"><span class="annottext">InternalConcept
</span><a href="#local-6989586621679265257"><span class="hs-identifier hs-var">ic</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall c. CodeIdea c =&gt; c -&gt; String
</span><span class="hs-identifier hs-var">codeName</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Def]
</span><a href="#local-6989586621679265261"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span class="hs-comment">-- | Get derived input functions (for @derived_values@).</span><span>
</span><span id="line-205"></span><span class="hs-comment">-- If there are no derived inputs, a derived inputs function is not generated.</span><span>
</span><span id="line-206"></span><span class="hs-comment">-- If inputs are 'Bundled', derived_values will be a private method, not exported.</span><span>
</span><span id="line-207"></span><span class="hs-comment">-- If inputs are 'Unbundled', derived_values will be exported.</span><span>
</span><span id="line-208"></span><span class="hs-comment">-- Similar logic for input_constraints and get_input below.</span><span>
</span><span id="line-209"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#getExpDerived"><span class="hs-identifier hs-type">getExpDerived</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#Choices"><span class="hs-identifier hs-type">Choices</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.CodeSpec.html#Derived"><span class="hs-identifier hs-type">Derived</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#ModExp"><span class="hs-identifier hs-type">ModExp</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-210"></span><span id="getExpDerived"><span class="annot"><span class="annottext">getExpDerived :: String -&gt; Choices -&gt; [Def] -&gt; [(String, String)]
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#getExpDerived"><span class="hs-identifier hs-var hs-var">getExpDerived</span></a></span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Choices
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-211"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#getExpDerived"><span class="hs-identifier hs-var">getExpDerived</span></a></span><span> </span><span id="local-6989586621679265256"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679265256"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679265255"><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265255"><span class="hs-identifier hs-var">chs</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Def]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Modularity -&gt; Structure -&gt; [(String, String)]
</span><a href="#local-6989586621679265254"><span class="hs-identifier hs-var">dMod</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Architecture -&gt; Modularity
</span><a href="Language.Drasil.Choices.html#modularity"><span class="hs-identifier hs-var">modularity</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Choices -&gt; Architecture
</span><a href="Language.Drasil.Choices.html#architecture"><span class="hs-identifier hs-var">architecture</span></a></span><span> </span><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265255"><span class="hs-identifier hs-var">chs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataInfo -&gt; Structure
</span><a href="Language.Drasil.Choices.html#inputStructure"><span class="hs-identifier hs-var">inputStructure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Choices -&gt; DataInfo
</span><a href="Language.Drasil.Choices.html#dataInfo"><span class="hs-identifier hs-var">dataInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265255"><span class="hs-identifier hs-var">chs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679265254"><span class="annot"><span class="annottext">dMod :: Modularity -&gt; Structure -&gt; [(String, String)]
</span><a href="#local-6989586621679265254"><span class="hs-identifier hs-var hs-var">dMod</span></a></span></span><span> </span><span class="annot"><span class="annottext">Modularity
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Structure
</span><a href="Language.Drasil.Choices.html#Bundled"><span class="hs-identifier hs-var">Bundled</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-213"></span><span>        </span><span class="annot"><a href="#local-6989586621679265254"><span class="hs-identifier hs-var">dMod</span></a></span><span> </span><span class="annot"><span class="annottext">Modularity
</span><a href="Language.Drasil.Choices.html#Unmodular"><span class="hs-identifier hs-var">Unmodular</span></a></span><span> </span><span class="annot"><span class="annottext">Structure
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679265253"><span class="hs-identifier hs-var">dvNm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679265256"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-214"></span><span>        </span><span class="annot"><a href="#local-6989586621679265254"><span class="hs-identifier hs-var">dMod</span></a></span><span> </span><span class="annot"><span class="annottext">Modularity
</span><a href="Language.Drasil.Choices.html#Modular"><span class="hs-identifier hs-var">Modular</span></a></span><span> </span><span class="annot"><span class="annottext">Structure
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679265253"><span class="hs-identifier hs-var">dvNm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Choices -&gt; InternalConcept -&gt; String
</span><a href="Language.Drasil.Choices.html#icNames"><span class="hs-identifier hs-var">icNames</span></a></span><span> </span><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265255"><span class="hs-identifier hs-var">chs</span></a></span><span> </span><span class="annot"><span class="annottext">InternalConcept
</span><a href="Language.Drasil.Choices.html#InputParameters"><span class="hs-identifier hs-var">InputParameters</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-215"></span><span>        </span><span id="local-6989586621679265253"><span class="annot"><span class="annottext">dvNm :: String
</span><a href="#local-6989586621679265253"><span class="hs-identifier hs-var hs-var">dvNm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Choices -&gt; InternalConcept -&gt; String
</span><a href="Language.Drasil.Choices.html#icNames"><span class="hs-identifier hs-var">icNames</span></a></span><span> </span><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265255"><span class="hs-identifier hs-var">chs</span></a></span><span> </span><span class="annot"><span class="annottext">InternalConcept
</span><a href="Language.Drasil.Choices.html#DerivedValuesFn"><span class="hs-identifier hs-var">DerivedValuesFn</span></a></span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span class="hs-comment">-- | Get derived values defined in a class (for @derived_values@).</span><span>
</span><span id="line-218"></span><span class="hs-comment">-- If there are no derived inputs, derived_values is not defined in any class.</span><span>
</span><span id="line-219"></span><span class="hs-comment">-- If inputs are 'Bundled', derived_values is defined in an InputParameters class.</span><span>
</span><span id="line-220"></span><span class="hs-comment">-- Otherwise, derived_values is not defined in any class.</span><span>
</span><span id="line-221"></span><span class="hs-comment">-- Similar logic for input_constraints and get_input below.</span><span>
</span><span id="line-222"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#getDerivedCls"><span class="hs-identifier hs-type">getDerivedCls</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#Choices"><span class="hs-identifier hs-type">Choices</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.CodeSpec.html#Derived"><span class="hs-identifier hs-type">Derived</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#ClassDef"><span class="hs-identifier hs-type">ClassDef</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-223"></span><span id="getDerivedCls"><span class="annot"><span class="annottext">getDerivedCls :: Choices -&gt; [Def] -&gt; [(String, String)]
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#getDerivedCls"><span class="hs-identifier hs-var hs-var">getDerivedCls</span></a></span></span><span> </span><span class="annot"><span class="annottext">Choices
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-224"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#getDerivedCls"><span class="hs-identifier hs-var">getDerivedCls</span></a></span><span> </span><span id="local-6989586621679265251"><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265251"><span class="hs-identifier hs-var">chs</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Def]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Structure -&gt; [(String, String)]
</span><a href="#local-6989586621679265250"><span class="hs-identifier hs-var">dCls</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataInfo -&gt; Structure
</span><a href="Language.Drasil.Choices.html#inputStructure"><span class="hs-identifier hs-var">inputStructure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Choices -&gt; DataInfo
</span><a href="Language.Drasil.Choices.html#dataInfo"><span class="hs-identifier hs-var">dataInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265251"><span class="hs-identifier hs-var">chs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-225"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679265250"><span class="annot"><span class="annottext">dCls :: Structure -&gt; [(String, String)]
</span><a href="#local-6989586621679265250"><span class="hs-identifier hs-var hs-var">dCls</span></a></span></span><span> </span><span class="annot"><span class="annottext">Structure
</span><a href="Language.Drasil.Choices.html#Bundled"><span class="hs-identifier hs-var">Bundled</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Choices -&gt; InternalConcept -&gt; String
</span><a href="Language.Drasil.Choices.html#icNames"><span class="hs-identifier hs-var">icNames</span></a></span><span> </span><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265251"><span class="hs-identifier hs-var">chs</span></a></span><span> </span><span class="annot"><span class="annottext">InternalConcept
</span><a href="Language.Drasil.Choices.html#DerivedValuesFn"><span class="hs-identifier hs-var">DerivedValuesFn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Choices -&gt; InternalConcept -&gt; String
</span><a href="Language.Drasil.Choices.html#icNames"><span class="hs-identifier hs-var">icNames</span></a></span><span> </span><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265251"><span class="hs-identifier hs-var">chs</span></a></span><span> </span><span class="annot"><span class="annottext">InternalConcept
</span><a href="Language.Drasil.Choices.html#InputParameters"><span class="hs-identifier hs-var">InputParameters</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-226"></span><span>        </span><span class="annot"><a href="#local-6989586621679265250"><span class="hs-identifier hs-var">dCls</span></a></span><span> </span><span class="annot"><span class="annottext">Structure
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span class="hs-comment">-- | Get input constraints to be exported (for @input_constraints@).</span><span>
</span><span id="line-229"></span><span class="hs-comment">-- See 'getExpDerived' for full logic details.</span><span>
</span><span id="line-230"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#getExpConstraints"><span class="hs-identifier hs-type">getExpConstraints</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#Choices"><span class="hs-identifier hs-type">Choices</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Chunk.ConstraintMap.html#ConstraintCE"><span class="hs-identifier hs-type">ConstraintCE</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#ModExp"><span class="hs-identifier hs-type">ModExp</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-231"></span><span id="getExpConstraints"><span class="annot"><span class="annottext">getExpConstraints :: String -&gt; Choices -&gt; [ConstraintCE] -&gt; [(String, String)]
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#getExpConstraints"><span class="hs-identifier hs-var hs-var">getExpConstraints</span></a></span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Choices
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-232"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#getExpConstraints"><span class="hs-identifier hs-var">getExpConstraints</span></a></span><span> </span><span id="local-6989586621679265249"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679265249"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679265248"><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265248"><span class="hs-identifier hs-var">chs</span></a></span></span><span> </span><span class="annot"><span class="annottext">[ConstraintCE]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Modularity -&gt; Structure -&gt; [(String, String)]
</span><a href="#local-6989586621679265247"><span class="hs-identifier hs-var">cMod</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Architecture -&gt; Modularity
</span><a href="Language.Drasil.Choices.html#modularity"><span class="hs-identifier hs-var">modularity</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Choices -&gt; Architecture
</span><a href="Language.Drasil.Choices.html#architecture"><span class="hs-identifier hs-var">architecture</span></a></span><span> </span><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265248"><span class="hs-identifier hs-var">chs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataInfo -&gt; Structure
</span><a href="Language.Drasil.Choices.html#inputStructure"><span class="hs-identifier hs-var">inputStructure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Choices -&gt; DataInfo
</span><a href="Language.Drasil.Choices.html#dataInfo"><span class="hs-identifier hs-var">dataInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265248"><span class="hs-identifier hs-var">chs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679265247"><span class="annot"><span class="annottext">cMod :: Modularity -&gt; Structure -&gt; [(String, String)]
</span><a href="#local-6989586621679265247"><span class="hs-identifier hs-var hs-var">cMod</span></a></span></span><span> </span><span class="annot"><span class="annottext">Modularity
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Structure
</span><a href="Language.Drasil.Choices.html#Bundled"><span class="hs-identifier hs-var">Bundled</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-234"></span><span>        </span><span class="annot"><a href="#local-6989586621679265247"><span class="hs-identifier hs-var">cMod</span></a></span><span> </span><span class="annot"><span class="annottext">Modularity
</span><a href="Language.Drasil.Choices.html#Unmodular"><span class="hs-identifier hs-var">Unmodular</span></a></span><span> </span><span class="annot"><span class="annottext">Structure
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679265246"><span class="hs-identifier hs-var">icNm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679265249"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-235"></span><span>        </span><span class="annot"><a href="#local-6989586621679265247"><span class="hs-identifier hs-var">cMod</span></a></span><span> </span><span class="annot"><span class="annottext">Modularity
</span><a href="Language.Drasil.Choices.html#Modular"><span class="hs-identifier hs-var">Modular</span></a></span><span> </span><span class="annot"><span class="annottext">Structure
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679265246"><span class="hs-identifier hs-var">icNm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Choices -&gt; InternalConcept -&gt; String
</span><a href="Language.Drasil.Choices.html#icNames"><span class="hs-identifier hs-var">icNames</span></a></span><span> </span><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265248"><span class="hs-identifier hs-var">chs</span></a></span><span> </span><span class="annot"><span class="annottext">InternalConcept
</span><a href="Language.Drasil.Choices.html#InputParameters"><span class="hs-identifier hs-var">InputParameters</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-236"></span><span>        </span><span id="local-6989586621679265246"><span class="annot"><span class="annottext">icNm :: String
</span><a href="#local-6989586621679265246"><span class="hs-identifier hs-var hs-var">icNm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">Choices -&gt; InternalConcept -&gt; String
</span><a href="Language.Drasil.Choices.html#icNames"><span class="hs-identifier hs-var">icNames</span></a></span><span> </span><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265248"><span class="hs-identifier hs-var">chs</span></a></span><span> </span><span class="annot"><span class="annottext">InternalConcept
</span><a href="Language.Drasil.Choices.html#InputConstraintsFn"><span class="hs-identifier hs-var">InputConstraintsFn</span></a></span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span class="hs-comment">-- | Get constraints defined in a class (for @input_constraints@).</span><span>
</span><span id="line-239"></span><span class="hs-comment">-- See 'getDerivedCls' for full logic details.</span><span>
</span><span id="line-240"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#getConstraintsCls"><span class="hs-identifier hs-type">getConstraintsCls</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#Choices"><span class="hs-identifier hs-type">Choices</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Chunk.ConstraintMap.html#ConstraintCE"><span class="hs-identifier hs-type">ConstraintCE</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#ClassDef"><span class="hs-identifier hs-type">ClassDef</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-241"></span><span id="getConstraintsCls"><span class="annot"><span class="annottext">getConstraintsCls :: Choices -&gt; [ConstraintCE] -&gt; [(String, String)]
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#getConstraintsCls"><span class="hs-identifier hs-var hs-var">getConstraintsCls</span></a></span></span><span> </span><span class="annot"><span class="annottext">Choices
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-242"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#getConstraintsCls"><span class="hs-identifier hs-var">getConstraintsCls</span></a></span><span> </span><span id="local-6989586621679265244"><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265244"><span class="hs-identifier hs-var">chs</span></a></span></span><span> </span><span class="annot"><span class="annottext">[ConstraintCE]
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Structure -&gt; [(String, String)]
</span><a href="#local-6989586621679265243"><span class="hs-identifier hs-var">cCls</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataInfo -&gt; Structure
</span><a href="Language.Drasil.Choices.html#inputStructure"><span class="hs-identifier hs-var">inputStructure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Choices -&gt; DataInfo
</span><a href="Language.Drasil.Choices.html#dataInfo"><span class="hs-identifier hs-var">dataInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265244"><span class="hs-identifier hs-var">chs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679265243"><span class="annot"><span class="annottext">cCls :: Structure -&gt; [(String, String)]
</span><a href="#local-6989586621679265243"><span class="hs-identifier hs-var hs-var">cCls</span></a></span></span><span> </span><span class="annot"><span class="annottext">Structure
</span><a href="Language.Drasil.Choices.html#Bundled"><span class="hs-identifier hs-var">Bundled</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Choices -&gt; InternalConcept -&gt; String
</span><a href="Language.Drasil.Choices.html#icNames"><span class="hs-identifier hs-var">icNames</span></a></span><span> </span><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265244"><span class="hs-identifier hs-var">chs</span></a></span><span> </span><span class="annot"><span class="annottext">InternalConcept
</span><a href="Language.Drasil.Choices.html#InputConstraintsFn"><span class="hs-identifier hs-var">InputConstraintsFn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Choices -&gt; InternalConcept -&gt; String
</span><a href="Language.Drasil.Choices.html#icNames"><span class="hs-identifier hs-var">icNames</span></a></span><span> </span><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265244"><span class="hs-identifier hs-var">chs</span></a></span><span> </span><span class="annot"><span class="annottext">InternalConcept
</span><a href="Language.Drasil.Choices.html#InputParameters"><span class="hs-identifier hs-var">InputParameters</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-244"></span><span>        </span><span class="annot"><a href="#local-6989586621679265243"><span class="hs-identifier hs-var">cCls</span></a></span><span> </span><span class="annot"><span class="annottext">Structure
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span class="hs-comment">-- | Get input format to be exported (for @get_input@).</span><span>
</span><span id="line-247"></span><span class="hs-comment">-- See 'getExpDerived' for full logic details.</span><span>
</span><span id="line-248"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#getExpInputFormat"><span class="hs-identifier hs-type">getExpInputFormat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#Choices"><span class="hs-identifier hs-type">Choices</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.CodeSpec.html#Input"><span class="hs-identifier hs-type">Input</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#ModExp"><span class="hs-identifier hs-type">ModExp</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-249"></span><span id="getExpInputFormat"><span class="annot"><span class="annottext">getExpInputFormat :: String -&gt; Choices -&gt; [Input] -&gt; [(String, String)]
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#getExpInputFormat"><span class="hs-identifier hs-var hs-var">getExpInputFormat</span></a></span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Choices
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-250"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#getExpInputFormat"><span class="hs-identifier hs-var">getExpInputFormat</span></a></span><span> </span><span id="local-6989586621679265242"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679265242"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679265241"><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265241"><span class="hs-identifier hs-var">chs</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Input]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Modularity -&gt; Structure -&gt; [(String, String)]
</span><a href="#local-6989586621679265240"><span class="hs-identifier hs-var">fMod</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Architecture -&gt; Modularity
</span><a href="Language.Drasil.Choices.html#modularity"><span class="hs-identifier hs-var">modularity</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Choices -&gt; Architecture
</span><a href="Language.Drasil.Choices.html#architecture"><span class="hs-identifier hs-var">architecture</span></a></span><span> </span><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265241"><span class="hs-identifier hs-var">chs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataInfo -&gt; Structure
</span><a href="Language.Drasil.Choices.html#inputStructure"><span class="hs-identifier hs-var">inputStructure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Choices -&gt; DataInfo
</span><a href="Language.Drasil.Choices.html#dataInfo"><span class="hs-identifier hs-var">dataInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265241"><span class="hs-identifier hs-var">chs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-251"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679265240"><span class="annot"><span class="annottext">fMod :: Modularity -&gt; Structure -&gt; [(String, String)]
</span><a href="#local-6989586621679265240"><span class="hs-identifier hs-var hs-var">fMod</span></a></span></span><span> </span><span class="annot"><span class="annottext">Modularity
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Structure
</span><a href="Language.Drasil.Choices.html#Bundled"><span class="hs-identifier hs-var">Bundled</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-252"></span><span>        </span><span class="annot"><a href="#local-6989586621679265240"><span class="hs-identifier hs-var">fMod</span></a></span><span> </span><span class="annot"><span class="annottext">Modularity
</span><a href="Language.Drasil.Choices.html#Unmodular"><span class="hs-identifier hs-var">Unmodular</span></a></span><span> </span><span class="annot"><span class="annottext">Structure
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679265239"><span class="hs-identifier hs-var">giNm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679265242"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-253"></span><span>        </span><span class="annot"><a href="#local-6989586621679265240"><span class="hs-identifier hs-var">fMod</span></a></span><span> </span><span class="annot"><span class="annottext">Modularity
</span><a href="Language.Drasil.Choices.html#Modular"><span class="hs-identifier hs-var">Modular</span></a></span><span> </span><span class="annot"><span class="annottext">Structure
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679265239"><span class="hs-identifier hs-var">giNm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Choices -&gt; InternalConcept -&gt; String
</span><a href="Language.Drasil.Choices.html#icNames"><span class="hs-identifier hs-var">icNames</span></a></span><span> </span><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265241"><span class="hs-identifier hs-var">chs</span></a></span><span> </span><span class="annot"><span class="annottext">InternalConcept
</span><a href="Language.Drasil.Choices.html#InputParameters"><span class="hs-identifier hs-var">InputParameters</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-254"></span><span>        </span><span id="local-6989586621679265239"><span class="annot"><span class="annottext">giNm :: String
</span><a href="#local-6989586621679265239"><span class="hs-identifier hs-var hs-var">giNm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Choices -&gt; InternalConcept -&gt; String
</span><a href="Language.Drasil.Choices.html#icNames"><span class="hs-identifier hs-var">icNames</span></a></span><span> </span><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265241"><span class="hs-identifier hs-var">chs</span></a></span><span> </span><span class="annot"><span class="annottext">InternalConcept
</span><a href="Language.Drasil.Choices.html#GetInput"><span class="hs-identifier hs-var">GetInput</span></a></span><span>
</span><span id="line-255"></span><span>
</span><span id="line-256"></span><span class="hs-comment">-- | Get input format defined in a class (for @get_input@).</span><span>
</span><span id="line-257"></span><span class="hs-comment">-- See 'getDerivedCls' for full logic details.</span><span>
</span><span id="line-258"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#getInputFormatCls"><span class="hs-identifier hs-type">getInputFormatCls</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#Choices"><span class="hs-identifier hs-type">Choices</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.CodeSpec.html#Input"><span class="hs-identifier hs-type">Input</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#ClassDef"><span class="hs-identifier hs-type">ClassDef</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-259"></span><span id="getInputFormatCls"><span class="annot"><span class="annottext">getInputFormatCls :: Choices -&gt; [Input] -&gt; [(String, String)]
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#getInputFormatCls"><span class="hs-identifier hs-var hs-var">getInputFormatCls</span></a></span></span><span> </span><span class="annot"><span class="annottext">Choices
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-260"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#getInputFormatCls"><span class="hs-identifier hs-var">getInputFormatCls</span></a></span><span> </span><span id="local-6989586621679265237"><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265237"><span class="hs-identifier hs-var">chs</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Input]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Structure -&gt; [(String, String)]
</span><a href="#local-6989586621679265236"><span class="hs-identifier hs-var">ifCls</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataInfo -&gt; Structure
</span><a href="Language.Drasil.Choices.html#inputStructure"><span class="hs-identifier hs-var">inputStructure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Choices -&gt; DataInfo
</span><a href="Language.Drasil.Choices.html#dataInfo"><span class="hs-identifier hs-var">dataInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265237"><span class="hs-identifier hs-var">chs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679265236"><span class="annot"><span class="annottext">ifCls :: Structure -&gt; [(String, String)]
</span><a href="#local-6989586621679265236"><span class="hs-identifier hs-var hs-var">ifCls</span></a></span></span><span> </span><span class="annot"><span class="annottext">Structure
</span><a href="Language.Drasil.Choices.html#Bundled"><span class="hs-identifier hs-var">Bundled</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Choices -&gt; InternalConcept -&gt; String
</span><a href="Language.Drasil.Choices.html#icNames"><span class="hs-identifier hs-var">icNames</span></a></span><span> </span><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265237"><span class="hs-identifier hs-var">chs</span></a></span><span> </span><span class="annot"><span class="annottext">InternalConcept
</span><a href="Language.Drasil.Choices.html#GetInput"><span class="hs-identifier hs-var">GetInput</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Choices -&gt; InternalConcept -&gt; String
</span><a href="Language.Drasil.Choices.html#icNames"><span class="hs-identifier hs-var">icNames</span></a></span><span> </span><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265237"><span class="hs-identifier hs-var">chs</span></a></span><span> </span><span class="annot"><span class="annottext">InternalConcept
</span><a href="Language.Drasil.Choices.html#InputParameters"><span class="hs-identifier hs-var">InputParameters</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-262"></span><span>        </span><span class="annot"><a href="#local-6989586621679265236"><span class="hs-identifier hs-var">ifCls</span></a></span><span> </span><span class="annot"><span class="annottext">Structure
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-263"></span><span>
</span><span id="line-264"></span><span class="hs-comment">-- | Gets exported calculations.</span><span>
</span><span id="line-265"></span><span class="hs-comment">-- Functions are exported by module named after program if 'Unmodular'.</span><span>
</span><span id="line-266"></span><span class="hs-comment">-- Function is exported by Calculations module if program is 'Modular'.</span><span>
</span><span id="line-267"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#getExpCalcs"><span class="hs-identifier hs-type">getExpCalcs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#Choices"><span class="hs-identifier hs-type">Choices</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.CodeSpec.html#Def"><span class="hs-identifier hs-type">Def</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#ModExp"><span class="hs-identifier hs-type">ModExp</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-268"></span><span id="getExpCalcs"><span class="annot"><span class="annottext">getExpCalcs :: String -&gt; Choices -&gt; [Def] -&gt; [(String, String)]
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#getExpCalcs"><span class="hs-identifier hs-var hs-var">getExpCalcs</span></a></span></span><span> </span><span id="local-6989586621679265235"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679265235"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679265234"><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265234"><span class="hs-identifier hs-var">chs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679265233"><span class="annot"><span class="annottext">Def
</span><a href="#local-6989586621679265233"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall c. CodeIdea c =&gt; c -&gt; String
</span><span class="hs-identifier hs-var">codeName</span></span><span> </span><span class="annot"><span class="annottext">Def
</span><a href="#local-6989586621679265233"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679265232"><span class="hs-identifier hs-var">calMod</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-269"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679265232"><span class="annot"><span class="annottext">calMod :: String
</span><a href="#local-6989586621679265232"><span class="hs-identifier hs-var hs-var">calMod</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Modularity -&gt; String
</span><a href="#local-6989586621679265231"><span class="hs-identifier hs-var">cMod</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Architecture -&gt; Modularity
</span><a href="Language.Drasil.Choices.html#modularity"><span class="hs-identifier hs-var">modularity</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Choices -&gt; Architecture
</span><a href="Language.Drasil.Choices.html#architecture"><span class="hs-identifier hs-var">architecture</span></a></span><span> </span><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265234"><span class="hs-identifier hs-var">chs</span></a></span><span>
</span><span id="line-270"></span><span>        </span><span id="local-6989586621679265231"><span class="annot"><span class="annottext">cMod :: Modularity -&gt; String
</span><a href="#local-6989586621679265231"><span class="hs-identifier hs-var hs-var">cMod</span></a></span></span><span> </span><span class="annot"><span class="annottext">Modularity
</span><a href="Language.Drasil.Choices.html#Unmodular"><span class="hs-identifier hs-var">Unmodular</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679265235"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-271"></span><span>        </span><span class="annot"><a href="#local-6989586621679265231"><span class="hs-identifier hs-var">cMod</span></a></span><span> </span><span class="annot"><span class="annottext">Modularity
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Choices -&gt; InternalConcept -&gt; String
</span><a href="Language.Drasil.Choices.html#icNames"><span class="hs-identifier hs-var">icNames</span></a></span><span> </span><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265234"><span class="hs-identifier hs-var">chs</span></a></span><span> </span><span class="annot"><span class="annottext">InternalConcept
</span><a href="Language.Drasil.Choices.html#Calculations"><span class="hs-identifier hs-var">Calculations</span></a></span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span class="hs-comment">-- | Get exported outputs (for @write_output@).</span><span>
</span><span id="line-274"></span><span class="hs-comment">-- No output function is exported if there are no outputs.</span><span>
</span><span id="line-275"></span><span class="hs-comment">-- Function is exported by module named after program if 'Unmodular'.</span><span>
</span><span id="line-276"></span><span class="hs-comment">-- Function is exported by OutputFormat module if program is 'Modular'.</span><span>
</span><span id="line-277"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#getExpOutput"><span class="hs-identifier hs-type">getExpOutput</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#Choices"><span class="hs-identifier hs-type">Choices</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.CodeSpec.html#Output"><span class="hs-identifier hs-type">Output</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#ModExp"><span class="hs-identifier hs-type">ModExp</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-278"></span><span id="getExpOutput"><span class="annot"><span class="annottext">getExpOutput :: String -&gt; Choices -&gt; [Input] -&gt; [(String, String)]
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#getExpOutput"><span class="hs-identifier hs-var hs-var">getExpOutput</span></a></span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Choices
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-279"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#getExpOutput"><span class="hs-identifier hs-var">getExpOutput</span></a></span><span> </span><span id="local-6989586621679265229"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679265229"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679265228"><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265228"><span class="hs-identifier hs-var">chs</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Input]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Choices -&gt; InternalConcept -&gt; String
</span><a href="Language.Drasil.Choices.html#icNames"><span class="hs-identifier hs-var">icNames</span></a></span><span> </span><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265228"><span class="hs-identifier hs-var">chs</span></a></span><span> </span><span class="annot"><span class="annottext">InternalConcept
</span><a href="Language.Drasil.Choices.html#WriteOutput"><span class="hs-identifier hs-var">WriteOutput</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Modularity -&gt; String
</span><a href="#local-6989586621679265226"><span class="hs-identifier hs-var">oMod</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Architecture -&gt; Modularity
</span><a href="Language.Drasil.Choices.html#modularity"><span class="hs-identifier hs-var">modularity</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Choices -&gt; Architecture
</span><a href="Language.Drasil.Choices.html#architecture"><span class="hs-identifier hs-var">architecture</span></a></span><span> </span><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265228"><span class="hs-identifier hs-var">chs</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-280"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679265226"><span class="annot"><span class="annottext">oMod :: Modularity -&gt; String
</span><a href="#local-6989586621679265226"><span class="hs-identifier hs-var hs-var">oMod</span></a></span></span><span> </span><span class="annot"><span class="annottext">Modularity
</span><a href="Language.Drasil.Choices.html#Unmodular"><span class="hs-identifier hs-var">Unmodular</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679265229"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-281"></span><span>        </span><span class="annot"><a href="#local-6989586621679265226"><span class="hs-identifier hs-var">oMod</span></a></span><span> </span><span class="annot"><span class="annottext">Modularity
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Choices -&gt; InternalConcept -&gt; String
</span><a href="Language.Drasil.Choices.html#icNames"><span class="hs-identifier hs-var">icNames</span></a></span><span> </span><span class="annot"><span class="annottext">Choices
</span><a href="#local-6989586621679265228"><span class="hs-identifier hs-var">chs</span></a></span><span> </span><span class="annot"><span class="annottext">InternalConcept
</span><a href="Language.Drasil.Choices.html#OutputFormat"><span class="hs-identifier hs-var">OutputFormat</span></a></span><span>
</span><span id="line-282"></span><span>
</span><span id="line-283"></span><span class="hs-comment">-- | Get InternalConcept name using DrasilState</span><span>
</span><span id="line-284"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#genICName"><span class="hs-identifier hs-type">genICName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#InternalConcept"><span class="hs-identifier hs-type">InternalConcept</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-285"></span><span id="genICName"><span class="annot"><span class="annottext">genICName :: InternalConcept -&gt; GenState String
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#genICName"><span class="hs-identifier hs-var hs-var">genICName</span></a></span></span><span> </span><span id="local-6989586621679265224"><span class="annot"><span class="annottext">InternalConcept
</span><a href="#local-6989586621679265224"><span class="hs-identifier hs-var">ic</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; InternalConcept -&gt; String
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#dsICNames"><span class="hs-operator hs-var">`dsICNames`</span></a></span><span> </span><span class="annot"><span class="annottext">InternalConcept
</span><a href="#local-6989586621679265224"><span class="hs-identifier hs-var">ic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-286"></span></pre></body></html>