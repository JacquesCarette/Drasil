<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE TemplateHaskell #-}</span><span>
</span><span id="line-2"></span><span class="annot"><span class="hs-comment">-- | Defines types and functions to create a chunk database within Drasil.</span></span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Changes to ChunkDB should be reflected in the 'Creating Your Project </span><span>
</span><span id="line-5"></span><span class="hs-comment">-- in Drasil' tutorial found on the wiki:</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- https://github.com/JacquesCarette/Drasil/wiki/Creating-Your-Project-in-Drasil</span><span>
</span><span id="line-7"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Database.Drasil.ChunkDB</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-8"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Types</span></span><span>
</span><span id="line-9"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** 'ChunkDB'</span></span><span>
</span><span id="line-10"></span><span>  </span><span class="annot"><span class="hs-comment">-- | Main database type</span></span><span>
</span><span id="line-11"></span><span>  </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#ChunkDB"><span class="hs-identifier">ChunkDB</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Database.Drasil.ChunkDB.html#symbolTable"><span class="hs-identifier">symbolTable</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#termTable"><span class="hs-identifier">termTable</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#conceptChunkTable"><span class="hs-identifier">conceptChunkTable</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#_unitTable"><span class="hs-identifier">_unitTable</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#_dataDefnTable"><span class="hs-identifier">_dataDefnTable</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>    </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#_insmodelTable"><span class="hs-identifier">_insmodelTable</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#_gendefTable"><span class="hs-identifier">_gendefTable</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#_theoryModelTable"><span class="hs-identifier">_theoryModelTable</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#_conceptinsTable"><span class="hs-identifier">_conceptinsTable</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>    </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#_citationTable"><span class="hs-identifier">_citationTable</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#_labelledcontentTable"><span class="hs-identifier">_labelledcontentTable</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#_traceTable"><span class="hs-identifier">_traceTable</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#_refbyTable"><span class="hs-identifier">_refbyTable</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#_refTable"><span class="hs-identifier">_refTable</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#CDB"><span class="hs-identifier">CDB</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>  </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#TermAbbr"><span class="hs-identifier">TermAbbr</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#DomDefn"><span class="hs-identifier">DomDefn</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Maps</span></span><span>
</span><span id="line-17"></span><span>  </span><span class="annot"><span class="hs-comment">-- | Exported for external use.</span></span><span>
</span><span id="line-18"></span><span>  </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#RefbyMap"><span class="hs-identifier">RefbyMap</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#TraceMap"><span class="hs-identifier">TraceMap</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#UMap"><span class="hs-identifier">UMap</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Functions</span></span><span>
</span><span id="line-20"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Constructors</span></span><span>
</span><span id="line-21"></span><span>  </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#cdb%27"><span class="hs-identifier">cdb'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#idMap"><span class="hs-identifier">idMap</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#symbolMap"><span class="hs-identifier">symbolMap</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#termMap"><span class="hs-identifier">termMap</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#conceptMap"><span class="hs-identifier">conceptMap</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#unitMap"><span class="hs-identifier">unitMap</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#traceMap"><span class="hs-identifier">traceMap</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#generateRefbyMap"><span class="hs-identifier">generateRefbyMap</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- idMap, termMap for docLang</span><span>
</span><span id="line-22"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Lookup Functions</span></span><span>
</span><span id="line-23"></span><span>  </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#asOrderedList"><span class="hs-identifier">asOrderedList</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#collectUnits"><span class="hs-identifier">collectUnits</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>  </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#termResolve"><span class="hs-identifier">termResolve</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#termResolve%27"><span class="hs-identifier">termResolve'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#defResolve"><span class="hs-identifier">defResolve</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#symbResolve"><span class="hs-identifier">symbResolve</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>  </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#traceLookup"><span class="hs-identifier">traceLookup</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#refbyLookup"><span class="hs-identifier">refbyLookup</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>  </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#datadefnLookup"><span class="hs-identifier">datadefnLookup</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#insmodelLookup"><span class="hs-identifier">insmodelLookup</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#gendefLookup"><span class="hs-identifier">gendefLookup</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#theoryModelLookup"><span class="hs-identifier">theoryModelLookup</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>  </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#conceptinsLookup"><span class="hs-identifier">conceptinsLookup</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#refResolve"><span class="hs-identifier">refResolve</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Lenses</span></span><span>
</span><span id="line-29"></span><span>  </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#unitTable"><span class="hs-identifier">unitTable</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#traceTable"><span class="hs-identifier">traceTable</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#refbyTable"><span class="hs-identifier">refbyTable</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#citationTable"><span class="hs-identifier">citationTable</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>  </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#dataDefnTable"><span class="hs-identifier">dataDefnTable</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#insmodelTable"><span class="hs-identifier">insmodelTable</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#gendefTable"><span class="hs-identifier">gendefTable</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#theoryModelTable"><span class="hs-identifier">theoryModelTable</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>  </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#conceptinsTable"><span class="hs-identifier">conceptinsTable</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#labelledcontentTable"><span class="hs-identifier">labelledcontentTable</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#refTable"><span class="hs-identifier">refTable</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>  </span><span class="annot"><span class="hs-comment">-- **  Helpers</span></span><span>
</span><span id="line-33"></span><span>  </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#addCdb"><span class="hs-identifier">addCdb</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#defResolve%27"><span class="hs-identifier">defResolve'</span></a></span><span>
</span><span id="line-34"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Language.Drasil</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">HasUID</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">UID</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Quantity</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">MayHaveUnit</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Idea</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>  </span><span class="annot"><span class="hs-identifier">IdeaDict</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Concept</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ConceptChunk</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">IsUnit</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">UnitDefn</span></span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>  </span><span class="annot"><span class="hs-identifier">Reference</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ConceptInstance</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">LabelledContent</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Citation</span></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>  </span><span class="annot"><span class="hs-identifier">nw</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">cw</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">unitWrapper</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">NP</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">NamedIdea</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">DefinedQuantityDict</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">dqdWr</span></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>  </span><span class="annot"><span class="hs-identifier">Sentence</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Definition</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">defn</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ConceptDomain</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">cdom</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Theory.Drasil</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">DataDefinition</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">GenDefn</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">InstanceModel</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">TheoryModel</span></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(^.)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">makeLenses</span></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">sortOn</span></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromMaybe</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">mapMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Utils.Drasil</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">invert</span></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Debug.Trace</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">trace</span></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-comment">-- | The misnomers below (for the following Map types) are not actually a bad thing. We want to ensure data can't</span><span>
</span><span id="line-51"></span><span class="hs-comment">-- be added to a map if it's not coming from a chunk, and there's no point confusing</span><span>
</span><span id="line-52"></span><span class="hs-comment">-- what the map is for. One is for symbols + their units, and the others are for</span><span>
</span><span id="line-53"></span><span class="hs-comment">-- what they state.</span><span>
</span><span id="line-54"></span><span class="hs-keyword">type</span><span> </span><span id="UMap"><span class="annot"><a href="Database.Drasil.ChunkDB.html#UMap"><span class="hs-identifier hs-var">UMap</span></a></span></span><span> </span><span id="local-6989586621679063787"><span class="annot"><a href="#local-6989586621679063787"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679063787"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span class="hs-comment">-- | A bit of a misnomer as it's really a map of all quantities, for retrieving</span><span>
</span><span id="line-57"></span><span class="hs-comment">-- symbols and their units.</span><span>
</span><span id="line-58"></span><span class="hs-keyword">type</span><span> </span><span id="SymbolMap"><span class="annot"><a href="Database.Drasil.ChunkDB.html#SymbolMap"><span class="hs-identifier hs-var">SymbolMap</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#UMap"><span class="hs-identifier hs-type">UMap</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">DefinedQuantityDict</span></span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="annot"><span class="hs-comment">-- | A map of all concepts, normally used for retrieving definitions.</span></span><span>
</span><span id="line-61"></span><span class="hs-keyword">type</span><span> </span><span id="ConceptMap"><span class="annot"><a href="Database.Drasil.ChunkDB.html#ConceptMap"><span class="hs-identifier hs-var">ConceptMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#UMap"><span class="hs-identifier hs-type">UMap</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ConceptChunk</span></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="annot"><span class="hs-comment">-- | A map of all the units used. Should be restricted to base units/synonyms.</span></span><span>
</span><span id="line-64"></span><span class="hs-keyword">type</span><span> </span><span id="UnitMap"><span class="annot"><a href="Database.Drasil.ChunkDB.html#UnitMap"><span class="hs-identifier hs-var">UnitMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#UMap"><span class="hs-identifier hs-type">UMap</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">UnitDefn</span></span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span class="hs-comment">-- | Again a bit of a misnomer as it's really a map of all 'NamedIdea's.</span><span>
</span><span id="line-67"></span><span class="hs-comment">-- Until these are built through automated means, there will</span><span>
</span><span id="line-68"></span><span class="hs-comment">-- likely be some 'manual' duplication of terms as this map will contain all</span><span>
</span><span id="line-69"></span><span class="hs-comment">-- quantities, concepts, etc.</span><span>
</span><span id="line-70"></span><span class="hs-keyword">type</span><span> </span><span id="TermMap"><span class="annot"><a href="Database.Drasil.ChunkDB.html#TermMap"><span class="hs-identifier hs-var">TermMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#UMap"><span class="hs-identifier hs-type">UMap</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IdeaDict</span></span><span>
</span><span id="line-71"></span><span class="annot"><span class="hs-comment">-- | A traceability map, used to hold the relation between one 'UID' and a list of other 'UID's.</span></span><span>
</span><span id="line-72"></span><span class="hs-keyword">type</span><span> </span><span id="TraceMap"><span class="annot"><a href="Database.Drasil.ChunkDB.html#TraceMap"><span class="hs-identifier hs-var">TraceMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span class="hs-special">]</span><span>
</span><span id="line-73"></span><span class="annot"><span class="hs-comment">-- | A reference map, used to hold a 'UID' and where it is referenced ('UID's).</span></span><span>
</span><span id="line-74"></span><span class="hs-keyword">type</span><span> </span><span id="RefbyMap"><span class="annot"><a href="Database.Drasil.ChunkDB.html#RefbyMap"><span class="hs-identifier hs-var">RefbyMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span class="hs-special">]</span><span>
</span><span id="line-75"></span><span class="annot"><span class="hs-comment">-- | Data definitions map. Contains all data definitions ('DataDefinition').</span></span><span>
</span><span id="line-76"></span><span class="hs-keyword">type</span><span> </span><span id="DatadefnMap"><span class="annot"><a href="Database.Drasil.ChunkDB.html#DatadefnMap"><span class="hs-identifier hs-var">DatadefnMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#UMap"><span class="hs-identifier hs-type">UMap</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">DataDefinition</span></span><span>
</span><span id="line-77"></span><span class="annot"><span class="hs-comment">-- | Instance model map. Contains all instance models ('InstanceModel').</span></span><span>
</span><span id="line-78"></span><span class="hs-keyword">type</span><span> </span><span id="InsModelMap"><span class="annot"><a href="Database.Drasil.ChunkDB.html#InsModelMap"><span class="hs-identifier hs-var">InsModelMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#UMap"><span class="hs-identifier hs-type">UMap</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">InstanceModel</span></span><span>
</span><span id="line-79"></span><span class="annot"><span class="hs-comment">-- | General definitions map. Contains all general definitions ('GenDefn').</span></span><span>
</span><span id="line-80"></span><span class="hs-keyword">type</span><span> </span><span id="GendefMap"><span class="annot"><a href="Database.Drasil.ChunkDB.html#GendefMap"><span class="hs-identifier hs-var">GendefMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#UMap"><span class="hs-identifier hs-type">UMap</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">GenDefn</span></span><span>
</span><span id="line-81"></span><span class="annot"><span class="hs-comment">-- | Theory model map. Contains all theoretical models ('TheoryModel').</span></span><span>
</span><span id="line-82"></span><span class="hs-keyword">type</span><span> </span><span id="TheoryModelMap"><span class="annot"><a href="Database.Drasil.ChunkDB.html#TheoryModelMap"><span class="hs-identifier hs-var">TheoryModelMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#UMap"><span class="hs-identifier hs-type">UMap</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TheoryModel</span></span><span>
</span><span id="line-83"></span><span class="annot"><span class="hs-comment">-- | Concept instance map. May hold similar information to a 'ConceptMap', but may also be referred to.</span></span><span>
</span><span id="line-84"></span><span class="hs-keyword">type</span><span> </span><span id="ConceptInstanceMap"><span class="annot"><a href="Database.Drasil.ChunkDB.html#ConceptInstanceMap"><span class="hs-identifier hs-var">ConceptInstanceMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#UMap"><span class="hs-identifier hs-type">UMap</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ConceptInstance</span></span><span>
</span><span id="line-85"></span><span class="annot"><span class="hs-comment">-- | A map of all 'LabelledContent's.</span></span><span>
</span><span id="line-86"></span><span class="hs-keyword">type</span><span> </span><span id="LabelledContentMap"><span class="annot"><a href="Database.Drasil.ChunkDB.html#LabelledContentMap"><span class="hs-identifier hs-var">LabelledContentMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#UMap"><span class="hs-identifier hs-type">UMap</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">LabelledContent</span></span><span>
</span><span id="line-87"></span><span class="annot"><span class="hs-comment">-- | A map of all 'Reference's.</span></span><span>
</span><span id="line-88"></span><span class="hs-keyword">type</span><span> </span><span id="ReferenceMap"><span class="annot"><a href="Database.Drasil.ChunkDB.html#ReferenceMap"><span class="hs-identifier hs-var">ReferenceMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#UMap"><span class="hs-identifier hs-type">UMap</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Reference</span></span><span>
</span><span id="line-89"></span><span class="annot"><span class="hs-comment">-- | Citation map.</span></span><span>
</span><span id="line-90"></span><span class="hs-keyword">type</span><span> </span><span id="CitationMap"><span class="annot"><a href="Database.Drasil.ChunkDB.html#CitationMap"><span class="hs-identifier hs-var">CitationMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#UMap"><span class="hs-identifier hs-type">UMap</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Citation</span></span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span class="hs-comment">-- | General chunk database map constructor. Creates a 'UMap' from a function</span><span>
</span><span id="line-93"></span><span class="hs-comment">-- that converts something with 'UID's into another type and a list of something</span><span>
</span><span id="line-94"></span><span class="hs-comment">-- with 'UID's.</span><span>
</span><span id="line-95"></span><span id="local-6989586621679063522"><span id="local-6989586621679063524"><span class="annot"><a href="Database.Drasil.ChunkDB.html#cdbMap"><span class="hs-identifier hs-type">cdbMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasUID</span></span><span> </span><span class="annot"><a href="#local-6989586621679063522"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679063522"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063524"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679063522"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679063524"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-96"></span><span id="cdbMap"><span class="annot"><span class="annottext">cdbMap :: forall a b.
HasUID a =&gt;
String -&gt; (a -&gt; b) -&gt; [a] -&gt; Map UID (b, Int)
</span><a href="Database.Drasil.ChunkDB.html#cdbMap"><span class="hs-identifier hs-var hs-var">cdbMap</span></a></span></span><span> </span><span id="local-6989586621679063797"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679063797"><span class="hs-identifier hs-var">mn</span></a></span></span><span> </span><span id="local-6989586621679063798"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679063798"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679063799"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679063799"><span class="hs-identifier hs-var">rawChunks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(UID -&gt; (b, Int) -&gt; (b, Int) -&gt; (b, Int))
-&gt; [(UID, (b, Int))] -&gt; Map UID (b, Int)
forall k a. Ord k =&gt; (k -&gt; a -&gt; a -&gt; a) -&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromListWithKey</span></span><span> </span><span class="annot"><span class="annottext">UID -&gt; (b, Int) -&gt; (b, Int) -&gt; (b, Int)
forall {a} {a} {p}. Show a =&gt; a -&gt; a -&gt; p -&gt; a
</span><a href="#local-6989586621679063801"><span class="hs-identifier hs-var">preferNew</span></a></span><span> </span><span class="annot"><span class="annottext">[(UID, (b, Int))]
</span><a href="#local-6989586621679063802"><span class="hs-identifier hs-var">kvs</span></a></span><span>
</span><span id="line-97"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-98"></span><span>    </span><span id="local-6989586621679063802"><span class="annot"><span class="annottext">kvs :: [(UID, (b, Int))]
</span><a href="#local-6989586621679063802"><span class="hs-identifier hs-var hs-var">kvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; a -&gt; (UID, (b, Int))) -&gt; [Int] -&gt; [a] -&gt; [(UID, (b, Int))]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679063813"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679063813"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679063814"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679063814"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679063814"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Getting UID a UID -&gt; UID
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting UID a UID
forall c. HasUID c =&gt; Getter c UID
Getter a UID
</span><span class="hs-identifier hs-var">uid</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679063798"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679063814"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679063813"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679063799"><span class="hs-identifier hs-var">rawChunks</span></a></span><span>
</span><span id="line-99"></span><span>    </span><span id="local-6989586621679063801"><span class="annot"><span class="annottext">preferNew :: a -&gt; a -&gt; p -&gt; a
</span><a href="#local-6989586621679063801"><span class="hs-identifier hs-var hs-var">preferNew</span></a></span></span><span> </span><span id="local-6989586621679063818"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679063818"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span id="local-6989586621679063819"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679063819"><span class="hs-identifier hs-var">new</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; a -&gt; a
forall a. String -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">trace</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;'&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679063818"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;' is inserted twice in '&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679063797"><span class="hs-identifier hs-var">mn</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;'!&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679063819"><span class="hs-identifier hs-var">new</span></a></span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span class="annot"><span class="hs-comment">-- | Smart constructor for a 'SymbolMap'.</span></span><span>
</span><span id="line-102"></span><span id="local-6989586621679063548"><span class="annot"><a href="Database.Drasil.ChunkDB.html#symbolMap"><span class="hs-identifier hs-type">symbolMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Quantity</span></span><span> </span><span class="annot"><a href="#local-6989586621679063548"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MayHaveUnit</span></span><span> </span><span class="annot"><a href="#local-6989586621679063548"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Concept</span></span><span> </span><span class="annot"><a href="#local-6989586621679063548"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679063548"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#SymbolMap"><span class="hs-identifier hs-type">SymbolMap</span></a></span></span><span>
</span><span id="line-103"></span><span id="symbolMap"><span class="annot"><span class="annottext">symbolMap :: forall c.
(Quantity c, MayHaveUnit c, Concept c) =&gt;
[c] -&gt; SymbolMap
</span><a href="Database.Drasil.ChunkDB.html#symbolMap"><span class="hs-identifier hs-var hs-var">symbolMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (c -&gt; DefinedQuantityDict) -&gt; [c] -&gt; SymbolMap
forall a b.
HasUID a =&gt;
String -&gt; (a -&gt; b) -&gt; [a] -&gt; Map UID (b, Int)
</span><a href="Database.Drasil.ChunkDB.html#cdbMap"><span class="hs-identifier hs-var">cdbMap</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SymbolMap&quot;</span></span><span> </span><span class="annot"><span class="annottext">c -&gt; DefinedQuantityDict
forall c.
(Quantity c, Concept c, MayHaveUnit c) =&gt;
c -&gt; DefinedQuantityDict
</span><span class="hs-identifier hs-var">dqdWr</span></span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span class="annot"><span class="hs-comment">-- | Smart constructor for a 'TermMap'.</span></span><span>
</span><span id="line-106"></span><span id="local-6989586621679063563"><span class="annot"><a href="Database.Drasil.ChunkDB.html#termMap"><span class="hs-identifier hs-type">termMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Idea</span></span><span> </span><span class="annot"><a href="#local-6989586621679063563"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679063563"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#TermMap"><span class="hs-identifier hs-type">TermMap</span></a></span></span><span>
</span><span id="line-107"></span><span id="termMap"><span class="annot"><span class="annottext">termMap :: forall c. Idea c =&gt; [c] -&gt; TermMap
</span><a href="Database.Drasil.ChunkDB.html#termMap"><span class="hs-identifier hs-var hs-var">termMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (c -&gt; IdeaDict) -&gt; [c] -&gt; TermMap
forall a b.
HasUID a =&gt;
String -&gt; (a -&gt; b) -&gt; [a] -&gt; Map UID (b, Int)
</span><a href="Database.Drasil.ChunkDB.html#cdbMap"><span class="hs-identifier hs-var">cdbMap</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;TermMap&quot;</span></span><span> </span><span class="annot"><span class="annottext">c -&gt; IdeaDict
forall c. Idea c =&gt; c -&gt; IdeaDict
</span><span class="hs-identifier hs-var">nw</span></span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span class="annot"><span class="hs-comment">-- | Smart constructor for a 'ConceptMap'.</span></span><span>
</span><span id="line-110"></span><span id="local-6989586621679063568"><span class="annot"><a href="Database.Drasil.ChunkDB.html#conceptMap"><span class="hs-identifier hs-type">conceptMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Concept</span></span><span> </span><span class="annot"><a href="#local-6989586621679063568"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679063568"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#ConceptMap"><span class="hs-identifier hs-type">ConceptMap</span></a></span></span><span>
</span><span id="line-111"></span><span id="conceptMap"><span class="annot"><span class="annottext">conceptMap :: forall c. Concept c =&gt; [c] -&gt; ConceptMap
</span><a href="Database.Drasil.ChunkDB.html#conceptMap"><span class="hs-identifier hs-var hs-var">conceptMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (c -&gt; ConceptChunk) -&gt; [c] -&gt; ConceptMap
forall a b.
HasUID a =&gt;
String -&gt; (a -&gt; b) -&gt; [a] -&gt; Map UID (b, Int)
</span><a href="Database.Drasil.ChunkDB.html#cdbMap"><span class="hs-identifier hs-var">cdbMap</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ConceptMap&quot;</span></span><span> </span><span class="annot"><span class="annottext">c -&gt; ConceptChunk
forall c. Concept c =&gt; c -&gt; ConceptChunk
</span><span class="hs-identifier hs-var">cw</span></span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="annot"><span class="hs-comment">-- | Smart constructor for a 'UnitMap'.</span></span><span>
</span><span id="line-114"></span><span id="local-6989586621679063573"><span class="annot"><a href="Database.Drasil.ChunkDB.html#unitMap"><span class="hs-identifier hs-type">unitMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IsUnit</span></span><span> </span><span class="annot"><a href="#local-6989586621679063573"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679063573"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#UnitMap"><span class="hs-identifier hs-type">UnitMap</span></a></span></span><span>
</span><span id="line-115"></span><span id="unitMap"><span class="annot"><span class="annottext">unitMap :: forall u. IsUnit u =&gt; [u] -&gt; UnitMap
</span><a href="Database.Drasil.ChunkDB.html#unitMap"><span class="hs-identifier hs-var hs-var">unitMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (u -&gt; UnitDefn) -&gt; [u] -&gt; UnitMap
forall a b.
HasUID a =&gt;
String -&gt; (a -&gt; b) -&gt; [a] -&gt; Map UID (b, Int)
</span><a href="Database.Drasil.ChunkDB.html#cdbMap"><span class="hs-identifier hs-var">cdbMap</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;UnitMap&quot;</span></span><span> </span><span class="annot"><span class="annottext">u -&gt; UnitDefn
forall u. IsUnit u =&gt; u -&gt; UnitDefn
</span><span class="hs-identifier hs-var">unitWrapper</span></span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span class="annot"><span class="hs-comment">-- | General smart constructor for making a 'UMap' out of anything that has a 'UID'. </span></span><span>
</span><span id="line-118"></span><span id="local-6989586621679063580"><span class="annot"><a href="Database.Drasil.ChunkDB.html#idMap"><span class="hs-identifier hs-type">idMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasUID</span></span><span> </span><span class="annot"><a href="#local-6989586621679063580"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679063580"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679063580"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-119"></span><span id="idMap"><span class="annot"><span class="annottext">idMap :: forall a. HasUID a =&gt; String -&gt; [a] -&gt; Map UID (a, Int)
</span><a href="Database.Drasil.ChunkDB.html#idMap"><span class="hs-identifier hs-var hs-var">idMap</span></a></span></span><span> </span><span id="local-6989586621679063853"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679063853"><span class="hs-identifier hs-var">mn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (a -&gt; a) -&gt; [a] -&gt; Map UID (a, Int)
forall a b.
HasUID a =&gt;
String -&gt; (a -&gt; b) -&gt; [a] -&gt; Map UID (b, Int)
</span><a href="Database.Drasil.ChunkDB.html#cdbMap"><span class="hs-identifier hs-var">cdbMap</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679063853"><span class="hs-identifier hs-var">mn</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span class="annot"><span class="hs-comment">-- | Smart constructor for a 'TraceMap' given a traceability matrix.</span></span><span>
</span><span id="line-122"></span><span class="annot"><a href="Database.Drasil.ChunkDB.html#traceMap"><span class="hs-identifier hs-type">traceMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#TraceMap"><span class="hs-identifier hs-type">TraceMap</span></a></span><span>
</span><span id="line-123"></span><span id="traceMap"><span class="annot"><span class="annottext">traceMap :: [(UID, [UID])] -&gt; TraceMap
</span><a href="Database.Drasil.ChunkDB.html#traceMap"><span class="hs-identifier hs-var hs-var">traceMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(UID, [UID])] -&gt; TraceMap
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span class="annot"><span class="hs-comment">-- | Gets a unit if it exists, or Nothing.        </span></span><span>
</span><span id="line-126"></span><span id="local-6989586621679063586"><span class="annot"><a href="Database.Drasil.ChunkDB.html#getUnitLup"><span class="hs-identifier hs-type">getUnitLup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasUID</span></span><span> </span><span class="annot"><a href="#local-6989586621679063586"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#ChunkDB"><span class="hs-identifier hs-type">ChunkDB</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063586"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">UnitDefn</span></span></span><span>
</span><span id="line-127"></span><span id="getUnitLup"><span class="annot"><span class="annottext">getUnitLup :: forall c. HasUID c =&gt; ChunkDB -&gt; c -&gt; Maybe UnitDefn
</span><a href="Database.Drasil.ChunkDB.html#getUnitLup"><span class="hs-identifier hs-var hs-var">getUnitLup</span></a></span></span><span> </span><span id="local-6989586621679063863"><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679063863"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679063864"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679063864"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DefinedQuantityDict -&gt; Maybe UnitDefn
forall u. MayHaveUnit u =&gt; u -&gt; Maybe UnitDefn
</span><span class="hs-identifier hs-var">getUnit</span></span><span> </span><span class="annot"><span class="annottext">(DefinedQuantityDict -&gt; Maybe UnitDefn)
-&gt; DefinedQuantityDict -&gt; Maybe UnitDefn
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ChunkDB -&gt; UID -&gt; DefinedQuantityDict
</span><a href="Database.Drasil.ChunkDB.html#symbResolve"><span class="hs-identifier hs-var">symbResolve</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679063863"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679063864"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">c -&gt; Getting UID c UID -&gt; UID
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting UID c UID
forall c. HasUID c =&gt; Getter c UID
Getter c UID
</span><span class="hs-identifier hs-var">uid</span></span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="annot"><span class="hs-comment">-- | Looks up a 'UID' in a 'UMap' table. If nothing is found, an error is thrown.</span></span><span>
</span><span id="line-130"></span><span id="local-6989586621679063593"><span class="annot"><a href="Database.Drasil.ChunkDB.html#uMapLookup"><span class="hs-identifier hs-type">uMapLookup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#UMap"><span class="hs-identifier hs-type">UMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063593"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063593"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-131"></span><span id="uMapLookup"><span class="annot"><span class="annottext">uMapLookup :: forall a. String -&gt; String -&gt; UID -&gt; UMap a -&gt; a
</span><a href="Database.Drasil.ChunkDB.html#uMapLookup"><span class="hs-identifier hs-var hs-var">uMapLookup</span></a></span></span><span> </span><span id="local-6989586621679063868"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679063868"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span id="local-6989586621679063869"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679063869"><span class="hs-identifier hs-var">ms</span></a></span></span><span> </span><span id="local-6989586621679063870"><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679063870"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621679063871"><span class="annot"><span class="annottext">UMap a
</span><a href="#local-6989586621679063871"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (a, Int) -&gt; a
forall {b} {b}. Maybe (b, b) -&gt; b
</span><a href="#local-6989586621679063872"><span class="hs-identifier hs-var">getFM</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (a, Int) -&gt; a) -&gt; Maybe (a, Int) -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UID -&gt; UMap a -&gt; Maybe (a, Int)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679063870"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">UMap a
</span><a href="#local-6989586621679063871"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-132"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679063872"><span class="annot"><span class="annottext">getFM :: Maybe (b, b) -&gt; b
</span><a href="#local-6989586621679063872"><span class="hs-identifier hs-var hs-var">getFM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; ((b, b) -&gt; b) -&gt; Maybe (b, b) -&gt; b
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; b
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; b) -&gt; String -&gt; b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679063868"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">UID -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679063870"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; not found in &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679063869"><span class="hs-identifier hs-var">ms</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(b, b) -&gt; b
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span class="annot"><span class="hs-comment">-- | Looks up a 'UID' in the symbol table from the 'ChunkDB'. If nothing is found, an error is thrown.</span></span><span>
</span><span id="line-135"></span><span class="annot"><a href="Database.Drasil.ChunkDB.html#symbResolve"><span class="hs-identifier hs-type">symbResolve</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#ChunkDB"><span class="hs-identifier hs-type">ChunkDB</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DefinedQuantityDict</span></span><span>
</span><span id="line-136"></span><span id="symbResolve"><span class="annot"><span class="annottext">symbResolve :: ChunkDB -&gt; UID -&gt; DefinedQuantityDict
</span><a href="Database.Drasil.ChunkDB.html#symbResolve"><span class="hs-identifier hs-var hs-var">symbResolve</span></a></span></span><span> </span><span id="local-6989586621679063880"><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679063880"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679063881"><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679063881"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; UID -&gt; SymbolMap -&gt; DefinedQuantityDict
forall a. String -&gt; String -&gt; UID -&gt; UMap a -&gt; a
</span><a href="Database.Drasil.ChunkDB.html#uMapLookup"><span class="hs-identifier hs-var">uMapLookup</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Symbol&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SymbolMap&quot;</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679063881"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">(SymbolMap -&gt; DefinedQuantityDict)
-&gt; SymbolMap -&gt; DefinedQuantityDict
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ChunkDB -&gt; SymbolMap
</span><a href="Database.Drasil.ChunkDB.html#symbolTable"><span class="hs-identifier hs-var">symbolTable</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679063880"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span class="hs-keyword">data</span><span> </span><span id="TermAbbr"><span class="annot"><a href="Database.Drasil.ChunkDB.html#TermAbbr"><span class="hs-identifier hs-var">TermAbbr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TermAbbr"><span class="annot"><a href="Database.Drasil.ChunkDB.html#TermAbbr"><span class="hs-identifier hs-var">TermAbbr</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="longForm"><span class="annot"><span class="annottext">TermAbbr -&gt; NP
</span><a href="Database.Drasil.ChunkDB.html#longForm"><span class="hs-identifier hs-var hs-var">longForm</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NP</span></span><span class="hs-special">,</span><span> </span><span id="shortForm"><span class="annot"><span class="annottext">TermAbbr -&gt; Maybe String
</span><a href="Database.Drasil.ChunkDB.html#shortForm"><span class="hs-identifier hs-var hs-var">shortForm</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span class="hs-comment">-- | Search for _any_ chunk that is an instance of 'Idea' and process its &quot;term&quot;</span><span>
</span><span id="line-141"></span><span class="hs-comment">-- and abbreviation.</span><span>
</span><span id="line-142"></span><span id="local-6989586621679063609"><span class="annot"><a href="Database.Drasil.ChunkDB.html#termResolve"><span class="hs-identifier hs-type">termResolve</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NP</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063609"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#ChunkDB"><span class="hs-identifier hs-type">ChunkDB</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063609"><span class="hs-identifier hs-type">c</span></a></span></span><span>
</span><span id="line-143"></span><span id="termResolve"><span class="annot"><span class="annottext">termResolve :: forall c. (NP -&gt; Maybe String -&gt; c) -&gt; ChunkDB -&gt; UID -&gt; c
</span><a href="Database.Drasil.ChunkDB.html#termResolve"><span class="hs-identifier hs-var hs-var">termResolve</span></a></span></span><span> </span><span id="local-6989586621679063915"><span class="annot"><span class="annottext">NP -&gt; Maybe String -&gt; c
</span><a href="#local-6989586621679063915"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679063916"><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679063916"><span class="hs-identifier hs-var">db</span></a></span></span><span> </span><span id="local-6989586621679063917"><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679063917"><span class="hs-identifier hs-var">trg</span></a></span></span><span>
</span><span id="line-144"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679063918"><span class="annot"><span class="annottext">IdeaDict
</span><a href="#local-6989586621679063918"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UID -&gt; TermMap -&gt; Maybe (IdeaDict, Int)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679063917"><span class="hs-identifier hs-var">trg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB -&gt; TermMap
</span><a href="Database.Drasil.ChunkDB.html#termTable"><span class="hs-identifier hs-var">termTable</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679063916"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IdeaDict -&gt; c
forall {c}. Idea c =&gt; c -&gt; c
</span><a href="#local-6989586621679063919"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">IdeaDict
</span><a href="#local-6989586621679063918"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-145"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679063920"><span class="annot"><span class="annottext">DefinedQuantityDict
</span><a href="#local-6989586621679063920"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UID -&gt; SymbolMap -&gt; Maybe (DefinedQuantityDict, Int)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679063917"><span class="hs-identifier hs-var">trg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB -&gt; SymbolMap
</span><a href="Database.Drasil.ChunkDB.html#symbolTable"><span class="hs-identifier hs-var">symbolTable</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679063916"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DefinedQuantityDict -&gt; c
forall {c}. Idea c =&gt; c -&gt; c
</span><a href="#local-6989586621679063919"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">DefinedQuantityDict
</span><a href="#local-6989586621679063920"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-146"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679063921"><span class="annot"><span class="annottext">ConceptChunk
</span><a href="#local-6989586621679063921"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UID -&gt; ConceptMap -&gt; Maybe (ConceptChunk, Int)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679063917"><span class="hs-identifier hs-var">trg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB -&gt; ConceptMap
</span><a href="Database.Drasil.ChunkDB.html#conceptChunkTable"><span class="hs-identifier hs-var">conceptChunkTable</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679063916"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConceptChunk -&gt; c
forall {c}. Idea c =&gt; c -&gt; c
</span><a href="#local-6989586621679063919"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">ConceptChunk
</span><a href="#local-6989586621679063921"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-147"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679063922"><span class="annot"><span class="annottext">UnitDefn
</span><a href="#local-6989586621679063922"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UID -&gt; UnitMap -&gt; Maybe (UnitDefn, Int)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679063917"><span class="hs-identifier hs-var">trg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB -&gt; UnitMap
</span><a href="Database.Drasil.ChunkDB.html#_unitTable"><span class="hs-identifier hs-var">_unitTable</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679063916"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnitDefn -&gt; c
forall {c}. Idea c =&gt; c -&gt; c
</span><a href="#local-6989586621679063919"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">UnitDefn
</span><a href="#local-6989586621679063922"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-148"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679063923"><span class="annot"><span class="annottext">DataDefinition
</span><a href="#local-6989586621679063923"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UID -&gt; Map UID (DataDefinition, Int) -&gt; Maybe (DataDefinition, Int)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679063917"><span class="hs-identifier hs-var">trg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB -&gt; Map UID (DataDefinition, Int)
</span><a href="Database.Drasil.ChunkDB.html#_dataDefnTable"><span class="hs-identifier hs-var">_dataDefnTable</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679063916"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataDefinition -&gt; c
forall {c}. Idea c =&gt; c -&gt; c
</span><a href="#local-6989586621679063919"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">DataDefinition
</span><a href="#local-6989586621679063923"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-149"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679063924"><span class="annot"><span class="annottext">InstanceModel
</span><a href="#local-6989586621679063924"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UID -&gt; Map UID (InstanceModel, Int) -&gt; Maybe (InstanceModel, Int)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679063917"><span class="hs-identifier hs-var">trg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB -&gt; Map UID (InstanceModel, Int)
</span><a href="Database.Drasil.ChunkDB.html#_insmodelTable"><span class="hs-identifier hs-var">_insmodelTable</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679063916"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstanceModel -&gt; c
forall {c}. Idea c =&gt; c -&gt; c
</span><a href="#local-6989586621679063919"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">InstanceModel
</span><a href="#local-6989586621679063924"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-150"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679063925"><span class="annot"><span class="annottext">GenDefn
</span><a href="#local-6989586621679063925"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UID -&gt; Map UID (GenDefn, Int) -&gt; Maybe (GenDefn, Int)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679063917"><span class="hs-identifier hs-var">trg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB -&gt; Map UID (GenDefn, Int)
</span><a href="Database.Drasil.ChunkDB.html#_gendefTable"><span class="hs-identifier hs-var">_gendefTable</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679063916"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenDefn -&gt; c
forall {c}. Idea c =&gt; c -&gt; c
</span><a href="#local-6989586621679063919"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">GenDefn
</span><a href="#local-6989586621679063925"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-151"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679063926"><span class="annot"><span class="annottext">TheoryModel
</span><a href="#local-6989586621679063926"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UID -&gt; Map UID (TheoryModel, Int) -&gt; Maybe (TheoryModel, Int)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679063917"><span class="hs-identifier hs-var">trg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB -&gt; Map UID (TheoryModel, Int)
</span><a href="Database.Drasil.ChunkDB.html#_theoryModelTable"><span class="hs-identifier hs-var">_theoryModelTable</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679063916"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TheoryModel -&gt; c
forall {c}. Idea c =&gt; c -&gt; c
</span><a href="#local-6989586621679063919"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">TheoryModel
</span><a href="#local-6989586621679063926"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-152"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679063927"><span class="annot"><span class="annottext">ConceptInstance
</span><a href="#local-6989586621679063927"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UID
-&gt; Map UID (ConceptInstance, Int) -&gt; Maybe (ConceptInstance, Int)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679063917"><span class="hs-identifier hs-var">trg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB -&gt; Map UID (ConceptInstance, Int)
</span><a href="Database.Drasil.ChunkDB.html#_conceptinsTable"><span class="hs-identifier hs-var">_conceptinsTable</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679063916"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConceptInstance -&gt; c
forall {c}. Idea c =&gt; c -&gt; c
</span><a href="#local-6989586621679063919"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">ConceptInstance
</span><a href="#local-6989586621679063927"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-153"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; c
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; c) -&gt; String -&gt; c
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Term: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">UID -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679063917"><span class="hs-identifier hs-var">trg</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; not found in TermMap&quot;</span></span><span>
</span><span id="line-154"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679063919"><span class="annot"><span class="annottext">go :: c -&gt; c
</span><a href="#local-6989586621679063919"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679063937"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679063937"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NP -&gt; Maybe String -&gt; c
</span><a href="#local-6989586621679063915"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679063937"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">c -&gt; Getting NP c NP -&gt; NP
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting NP c NP
forall c. NamedIdea c =&gt; Lens' c NP
Lens' c NP
</span><span class="hs-identifier hs-var">term</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">c -&gt; Maybe String
forall c. Idea c =&gt; c -&gt; Maybe String
</span><span class="hs-identifier hs-var">getA</span></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679063937"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span class="annot"><span class="hs-comment">-- | Find a chunks &quot;term&quot; and abbreviation, if it exists.</span></span><span>
</span><span id="line-157"></span><span class="annot"><a href="Database.Drasil.ChunkDB.html#termResolve%27"><span class="hs-identifier hs-type">termResolve'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#ChunkDB"><span class="hs-identifier hs-type">ChunkDB</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#TermAbbr"><span class="hs-identifier hs-type">TermAbbr</span></a></span><span>
</span><span id="line-158"></span><span id="termResolve%27"><span class="annot"><span class="annottext">termResolve' :: ChunkDB -&gt; UID -&gt; TermAbbr
</span><a href="Database.Drasil.ChunkDB.html#termResolve%27"><span class="hs-identifier hs-var hs-var">termResolve'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NP -&gt; Maybe String -&gt; TermAbbr) -&gt; ChunkDB -&gt; UID -&gt; TermAbbr
forall c. (NP -&gt; Maybe String -&gt; c) -&gt; ChunkDB -&gt; UID -&gt; c
</span><a href="Database.Drasil.ChunkDB.html#termResolve"><span class="hs-identifier hs-var">termResolve</span></a></span><span> </span><span class="annot"><span class="annottext">NP -&gt; Maybe String -&gt; TermAbbr
</span><a href="Database.Drasil.ChunkDB.html#TermAbbr"><span class="hs-identifier hs-var">TermAbbr</span></a></span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span class="annot"><span class="hs-comment">-- | Looks up a 'UID' in the reference table from the 'ChunkDB'. If nothing is found, an error is thrown.</span></span><span>
</span><span id="line-161"></span><span class="annot"><a href="Database.Drasil.ChunkDB.html#refResolve"><span class="hs-identifier hs-type">refResolve</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#ReferenceMap"><span class="hs-identifier hs-type">ReferenceMap</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Reference</span></span><span>
</span><span id="line-162"></span><span id="refResolve"><span class="annot"><span class="annottext">refResolve :: UID -&gt; ReferenceMap -&gt; Reference
</span><a href="Database.Drasil.ChunkDB.html#refResolve"><span class="hs-identifier hs-var hs-var">refResolve</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; UID -&gt; ReferenceMap -&gt; Reference
forall a. String -&gt; String -&gt; UID -&gt; UMap a -&gt; a
</span><a href="Database.Drasil.ChunkDB.html#uMapLookup"><span class="hs-identifier hs-var">uMapLookup</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Reference&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ReferenceMap&quot;</span></span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span class="annot"><span class="hs-comment">-- | Looks up a 'UID' in the unit table. If nothing is found, an error is thrown.</span></span><span>
</span><span id="line-165"></span><span class="annot"><a href="Database.Drasil.ChunkDB.html#unitLookup"><span class="hs-identifier hs-type">unitLookup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#UnitMap"><span class="hs-identifier hs-type">UnitMap</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UnitDefn</span></span><span>
</span><span id="line-166"></span><span id="unitLookup"><span class="annot"><span class="annottext">unitLookup :: UID -&gt; UnitMap -&gt; UnitDefn
</span><a href="Database.Drasil.ChunkDB.html#unitLookup"><span class="hs-identifier hs-var hs-var">unitLookup</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; UID -&gt; UnitMap -&gt; UnitDefn
forall a. String -&gt; String -&gt; UID -&gt; UMap a -&gt; a
</span><a href="Database.Drasil.ChunkDB.html#uMapLookup"><span class="hs-identifier hs-var">uMapLookup</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unit&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;UnitMap&quot;</span></span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span class="hs-keyword">data</span><span> </span><span id="DomDefn"><span class="annot"><a href="Database.Drasil.ChunkDB.html#DomDefn"><span class="hs-identifier hs-var">DomDefn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="DomDefn"><span class="annot"><a href="Database.Drasil.ChunkDB.html#DomDefn"><span class="hs-identifier hs-var">DomDefn</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="domain"><span class="annot"><span class="annottext">DomDefn -&gt; [UID]
</span><a href="Database.Drasil.ChunkDB.html#domain"><span class="hs-identifier hs-var hs-var">domain</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span id="definition"><span class="annot"><span class="annottext">DomDefn -&gt; Sentence
</span><a href="Database.Drasil.ChunkDB.html#definition"><span class="hs-identifier hs-var hs-var">definition</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Sentence</span></span><span class="hs-special">}</span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span class="annot"><span class="hs-comment">-- | Looks up a 'UID' in all tables with concepts from the 'ChunkDB'. If nothing is found, an error is thrown.</span></span><span>
</span><span id="line-171"></span><span id="local-6989586621679063622"><span class="annot"><a href="Database.Drasil.ChunkDB.html#defResolve"><span class="hs-identifier hs-type">defResolve</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Sentence</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063622"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#ChunkDB"><span class="hs-identifier hs-type">ChunkDB</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063622"><span class="hs-identifier hs-type">c</span></a></span></span><span>
</span><span id="line-172"></span><span id="defResolve"><span class="annot"><span class="annottext">defResolve :: forall c. ([UID] -&gt; Sentence -&gt; c) -&gt; ChunkDB -&gt; UID -&gt; c
</span><a href="Database.Drasil.ChunkDB.html#defResolve"><span class="hs-identifier hs-var hs-var">defResolve</span></a></span></span><span> </span><span id="local-6989586621679063982"><span class="annot"><span class="annottext">[UID] -&gt; Sentence -&gt; c
</span><a href="#local-6989586621679063982"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679063983"><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679063983"><span class="hs-identifier hs-var">db</span></a></span></span><span> </span><span id="local-6989586621679063984"><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679063984"><span class="hs-identifier hs-var">x</span></a></span></span><span>
</span><span id="line-173"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679063985"><span class="annot"><span class="annottext">DefinedQuantityDict
</span><a href="#local-6989586621679063985"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UID -&gt; SymbolMap -&gt; Maybe (DefinedQuantityDict, Int)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679063984"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB -&gt; SymbolMap
</span><a href="Database.Drasil.ChunkDB.html#symbolTable"><span class="hs-identifier hs-var">symbolTable</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679063983"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DefinedQuantityDict -&gt; c
forall {s}. (ConceptDomain s, Definition s) =&gt; s -&gt; c
</span><a href="#local-6989586621679063986"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">DefinedQuantityDict
</span><a href="#local-6989586621679063985"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-174"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679063987"><span class="annot"><span class="annottext">ConceptChunk
</span><a href="#local-6989586621679063987"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UID -&gt; ConceptMap -&gt; Maybe (ConceptChunk, Int)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679063984"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB -&gt; ConceptMap
</span><a href="Database.Drasil.ChunkDB.html#conceptChunkTable"><span class="hs-identifier hs-var">conceptChunkTable</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679063983"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConceptChunk -&gt; c
forall {s}. (ConceptDomain s, Definition s) =&gt; s -&gt; c
</span><a href="#local-6989586621679063986"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">ConceptChunk
</span><a href="#local-6989586621679063987"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-175"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679063988"><span class="annot"><span class="annottext">UnitDefn
</span><a href="#local-6989586621679063988"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UID -&gt; UnitMap -&gt; Maybe (UnitDefn, Int)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679063984"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB -&gt; UnitMap
</span><a href="Database.Drasil.ChunkDB.html#_unitTable"><span class="hs-identifier hs-var">_unitTable</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679063983"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnitDefn -&gt; c
forall {s}. (ConceptDomain s, Definition s) =&gt; s -&gt; c
</span><a href="#local-6989586621679063986"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">UnitDefn
</span><a href="#local-6989586621679063988"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-176"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679063989"><span class="annot"><span class="annottext">InstanceModel
</span><a href="#local-6989586621679063989"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UID -&gt; Map UID (InstanceModel, Int) -&gt; Maybe (InstanceModel, Int)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679063984"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB -&gt; Map UID (InstanceModel, Int)
</span><a href="Database.Drasil.ChunkDB.html#_insmodelTable"><span class="hs-identifier hs-var">_insmodelTable</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679063983"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstanceModel -&gt; c
forall {s}. (ConceptDomain s, Definition s) =&gt; s -&gt; c
</span><a href="#local-6989586621679063986"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">InstanceModel
</span><a href="#local-6989586621679063989"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-177"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679063990"><span class="annot"><span class="annottext">GenDefn
</span><a href="#local-6989586621679063990"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UID -&gt; Map UID (GenDefn, Int) -&gt; Maybe (GenDefn, Int)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679063984"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB -&gt; Map UID (GenDefn, Int)
</span><a href="Database.Drasil.ChunkDB.html#_gendefTable"><span class="hs-identifier hs-var">_gendefTable</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679063983"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenDefn -&gt; c
forall {s}. (ConceptDomain s, Definition s) =&gt; s -&gt; c
</span><a href="#local-6989586621679063986"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">GenDefn
</span><a href="#local-6989586621679063990"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-178"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679063991"><span class="annot"><span class="annottext">TheoryModel
</span><a href="#local-6989586621679063991"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UID -&gt; Map UID (TheoryModel, Int) -&gt; Maybe (TheoryModel, Int)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679063984"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB -&gt; Map UID (TheoryModel, Int)
</span><a href="Database.Drasil.ChunkDB.html#_theoryModelTable"><span class="hs-identifier hs-var">_theoryModelTable</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679063983"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TheoryModel -&gt; c
forall {s}. (ConceptDomain s, Definition s) =&gt; s -&gt; c
</span><a href="#local-6989586621679063986"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">TheoryModel
</span><a href="#local-6989586621679063991"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-179"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679063992"><span class="annot"><span class="annottext">ConceptInstance
</span><a href="#local-6989586621679063992"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UID
-&gt; Map UID (ConceptInstance, Int) -&gt; Maybe (ConceptInstance, Int)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679063984"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB -&gt; Map UID (ConceptInstance, Int)
</span><a href="Database.Drasil.ChunkDB.html#_conceptinsTable"><span class="hs-identifier hs-var">_conceptinsTable</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679063983"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConceptInstance -&gt; c
forall {s}. (ConceptDomain s, Definition s) =&gt; s -&gt; c
</span><a href="#local-6989586621679063986"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">ConceptInstance
</span><a href="#local-6989586621679063992"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-180"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; c
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; c) -&gt; String -&gt; c
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Definition: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">UID -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679063984"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; not found in ConceptMap&quot;</span></span><span>
</span><span id="line-181"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679063986"><span class="annot"><span class="annottext">go :: s -&gt; c
</span><a href="#local-6989586621679063986"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679063998"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679063998"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[UID] -&gt; Sentence -&gt; c
</span><a href="#local-6989586621679063982"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s -&gt; [UID]
forall c. ConceptDomain c =&gt; c -&gt; [UID]
</span><span class="hs-identifier hs-var">cdom</span></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679063998"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679063998"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">s -&gt; Getting Sentence s Sentence -&gt; Sentence
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting Sentence s Sentence
forall c. Definition c =&gt; Lens' c Sentence
Lens' s Sentence
</span><span class="hs-identifier hs-var">defn</span></span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span class="annot"><a href="Database.Drasil.ChunkDB.html#defResolve%27"><span class="hs-identifier hs-type">defResolve'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#ChunkDB"><span class="hs-identifier hs-type">ChunkDB</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#DomDefn"><span class="hs-identifier hs-type">DomDefn</span></a></span><span>
</span><span id="line-184"></span><span id="defResolve%27"><span class="annot"><span class="annottext">defResolve' :: ChunkDB -&gt; UID -&gt; DomDefn
</span><a href="Database.Drasil.ChunkDB.html#defResolve%27"><span class="hs-identifier hs-var hs-var">defResolve'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([UID] -&gt; Sentence -&gt; DomDefn) -&gt; ChunkDB -&gt; UID -&gt; DomDefn
forall c. ([UID] -&gt; Sentence -&gt; c) -&gt; ChunkDB -&gt; UID -&gt; c
</span><a href="Database.Drasil.ChunkDB.html#defResolve"><span class="hs-identifier hs-var">defResolve</span></a></span><span> </span><span class="annot"><span class="annottext">[UID] -&gt; Sentence -&gt; DomDefn
</span><a href="Database.Drasil.ChunkDB.html#DomDefn"><span class="hs-identifier hs-var">DomDefn</span></a></span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span class="annot"><span class="hs-comment">-- | Looks up a 'UID' in the datadefinition table. If nothing is found, an error is thrown.</span></span><span>
</span><span id="line-187"></span><span class="annot"><a href="Database.Drasil.ChunkDB.html#datadefnLookup"><span class="hs-identifier hs-type">datadefnLookup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#DatadefnMap"><span class="hs-identifier hs-type">DatadefnMap</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DataDefinition</span></span><span>
</span><span id="line-188"></span><span id="datadefnLookup"><span class="annot"><span class="annottext">datadefnLookup :: UID -&gt; Map UID (DataDefinition, Int) -&gt; DataDefinition
</span><a href="Database.Drasil.ChunkDB.html#datadefnLookup"><span class="hs-identifier hs-var hs-var">datadefnLookup</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; String -&gt; UID -&gt; Map UID (DataDefinition, Int) -&gt; DataDefinition
forall a. String -&gt; String -&gt; UID -&gt; UMap a -&gt; a
</span><a href="Database.Drasil.ChunkDB.html#uMapLookup"><span class="hs-identifier hs-var">uMapLookup</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;DataDefinition&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;DatadefnMap&quot;</span></span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span class="annot"><span class="hs-comment">-- | Looks up a 'UID' in the instance model table. If nothing is found, an error is thrown.</span></span><span>
</span><span id="line-191"></span><span class="annot"><a href="Database.Drasil.ChunkDB.html#insmodelLookup"><span class="hs-identifier hs-type">insmodelLookup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#InsModelMap"><span class="hs-identifier hs-type">InsModelMap</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">InstanceModel</span></span><span>
</span><span id="line-192"></span><span id="insmodelLookup"><span class="annot"><span class="annottext">insmodelLookup :: UID -&gt; Map UID (InstanceModel, Int) -&gt; InstanceModel
</span><a href="Database.Drasil.ChunkDB.html#insmodelLookup"><span class="hs-identifier hs-var hs-var">insmodelLookup</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; String -&gt; UID -&gt; Map UID (InstanceModel, Int) -&gt; InstanceModel
forall a. String -&gt; String -&gt; UID -&gt; UMap a -&gt; a
</span><a href="Database.Drasil.ChunkDB.html#uMapLookup"><span class="hs-identifier hs-var">uMapLookup</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;InstanceModel&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;InsModelMap&quot;</span></span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span class="annot"><span class="hs-comment">-- | Looks up a 'UID' in the general definition table. If nothing is found, an error is thrown.</span></span><span>
</span><span id="line-195"></span><span class="annot"><a href="Database.Drasil.ChunkDB.html#gendefLookup"><span class="hs-identifier hs-type">gendefLookup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#GendefMap"><span class="hs-identifier hs-type">GendefMap</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GenDefn</span></span><span>
</span><span id="line-196"></span><span id="gendefLookup"><span class="annot"><span class="annottext">gendefLookup :: UID -&gt; Map UID (GenDefn, Int) -&gt; GenDefn
</span><a href="Database.Drasil.ChunkDB.html#gendefLookup"><span class="hs-identifier hs-var hs-var">gendefLookup</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; UID -&gt; Map UID (GenDefn, Int) -&gt; GenDefn
forall a. String -&gt; String -&gt; UID -&gt; UMap a -&gt; a
</span><a href="Database.Drasil.ChunkDB.html#uMapLookup"><span class="hs-identifier hs-var">uMapLookup</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;GenDefn&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;GenDefnMap&quot;</span></span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span class="annot"><span class="hs-comment">-- | Looks up a 'UID' in the theory model table. If nothing is found, an error is thrown.</span></span><span>
</span><span id="line-199"></span><span class="annot"><a href="Database.Drasil.ChunkDB.html#theoryModelLookup"><span class="hs-identifier hs-type">theoryModelLookup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#TheoryModelMap"><span class="hs-identifier hs-type">TheoryModelMap</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TheoryModel</span></span><span>
</span><span id="line-200"></span><span id="theoryModelLookup"><span class="annot"><span class="annottext">theoryModelLookup :: UID -&gt; Map UID (TheoryModel, Int) -&gt; TheoryModel
</span><a href="Database.Drasil.ChunkDB.html#theoryModelLookup"><span class="hs-identifier hs-var hs-var">theoryModelLookup</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; String -&gt; UID -&gt; Map UID (TheoryModel, Int) -&gt; TheoryModel
forall a. String -&gt; String -&gt; UID -&gt; UMap a -&gt; a
</span><a href="Database.Drasil.ChunkDB.html#uMapLookup"><span class="hs-identifier hs-var">uMapLookup</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;TheoryModel&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;TheoryModelMap&quot;</span></span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span class="annot"><span class="hs-comment">-- | Looks up a 'UID' in the concept instance table. If nothing is found, an error is thrown.</span></span><span>
</span><span id="line-203"></span><span class="annot"><a href="Database.Drasil.ChunkDB.html#conceptinsLookup"><span class="hs-identifier hs-type">conceptinsLookup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#ConceptInstanceMap"><span class="hs-identifier hs-type">ConceptInstanceMap</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ConceptInstance</span></span><span>
</span><span id="line-204"></span><span id="conceptinsLookup"><span class="annot"><span class="annottext">conceptinsLookup :: UID -&gt; Map UID (ConceptInstance, Int) -&gt; ConceptInstance
</span><a href="Database.Drasil.ChunkDB.html#conceptinsLookup"><span class="hs-identifier hs-var hs-var">conceptinsLookup</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; String
-&gt; UID
-&gt; Map UID (ConceptInstance, Int)
-&gt; ConceptInstance
forall a. String -&gt; String -&gt; UID -&gt; UMap a -&gt; a
</span><a href="Database.Drasil.ChunkDB.html#uMapLookup"><span class="hs-identifier hs-var">uMapLookup</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ConceptInstance&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ConceptInstanceMap&quot;</span></span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span class="annot"><span class="hs-comment">-- | Gets an ordered list of @a@ from any @a@ that is of type 'UMap'.</span></span><span>
</span><span id="line-207"></span><span id="local-6989586621679063629"><span class="annot"><a href="Database.Drasil.ChunkDB.html#asOrderedList"><span class="hs-identifier hs-type">asOrderedList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#UMap"><span class="hs-identifier hs-type">UMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063629"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679063629"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-208"></span><span id="asOrderedList"><span class="annot"><span class="annottext">asOrderedList :: forall a. UMap a -&gt; [a]
</span><a href="Database.Drasil.ChunkDB.html#asOrderedList"><span class="hs-identifier hs-var hs-var">asOrderedList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((a, Int) -&gt; a) -&gt; [(a, Int)] -&gt; [a]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(a, Int) -&gt; a
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">([(a, Int)] -&gt; [a]) -&gt; (UMap a -&gt; [(a, Int)]) -&gt; UMap a -&gt; [a]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((a, Int) -&gt; Int) -&gt; [(a, Int)] -&gt; [(a, Int)]
forall b a. Ord b =&gt; (a -&gt; b) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sortOn</span></span><span> </span><span class="annot"><span class="annottext">(a, Int) -&gt; Int
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">([(a, Int)] -&gt; [(a, Int)])
-&gt; (UMap a -&gt; [(a, Int)]) -&gt; UMap a -&gt; [(a, Int)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((UID, (a, Int)) -&gt; (a, Int)) -&gt; [(UID, (a, Int))] -&gt; [(a, Int)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(UID, (a, Int)) -&gt; (a, Int)
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">([(UID, (a, Int))] -&gt; [(a, Int)])
-&gt; (UMap a -&gt; [(UID, (a, Int))]) -&gt; UMap a -&gt; [(a, Int)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">UMap a -&gt; [(UID, (a, Int))]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">Map.toList</span></span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span class="hs-comment">-- | Our chunk databases. \Must contain all maps needed in an example.\</span><span>
</span><span id="line-211"></span><span class="hs-comment">-- In turn, these maps must contain every chunk definition or concept </span><span>
</span><span id="line-212"></span><span class="hs-comment">-- used in its respective example, else an error is thrown.</span><span>
</span><span id="line-213"></span><span class="hs-keyword">data</span><span> </span><span id="ChunkDB"><span class="annot"><a href="Database.Drasil.ChunkDB.html#ChunkDB"><span class="hs-identifier hs-var">ChunkDB</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="CDB"><span class="annot"><a href="Database.Drasil.ChunkDB.html#CDB"><span class="hs-identifier hs-var">CDB</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-214"></span><span>  </span><span class="hs-comment">-- CHUNKS</span><span>
</span><span id="line-215"></span><span>    </span><span id="symbolTable"><span class="annot"><span class="annottext">ChunkDB -&gt; SymbolMap
</span><a href="Database.Drasil.ChunkDB.html#symbolTable"><span class="hs-identifier hs-var hs-var">symbolTable</span></a></span></span><span>           </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#SymbolMap"><span class="hs-identifier hs-type">SymbolMap</span></a></span><span>
</span><span id="line-216"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="termTable"><span class="annot"><span class="annottext">ChunkDB -&gt; TermMap
</span><a href="Database.Drasil.ChunkDB.html#termTable"><span class="hs-identifier hs-var hs-var">termTable</span></a></span></span><span>             </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#TermMap"><span class="hs-identifier hs-type">TermMap</span></a></span><span>
</span><span id="line-217"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="conceptChunkTable"><span class="annot"><span class="annottext">ChunkDB -&gt; ConceptMap
</span><a href="Database.Drasil.ChunkDB.html#conceptChunkTable"><span class="hs-identifier hs-var hs-var">conceptChunkTable</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#ConceptMap"><span class="hs-identifier hs-type">ConceptMap</span></a></span><span>
</span><span id="line-218"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_unitTable"><span class="annot"><span class="annottext">ChunkDB -&gt; UnitMap
</span><a href="Database.Drasil.ChunkDB.html#_unitTable"><span class="hs-identifier hs-var hs-var">_unitTable</span></a></span></span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#UnitMap"><span class="hs-identifier hs-type">UnitMap</span></a></span><span>
</span><span id="line-219"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_dataDefnTable"><span class="annot"><span class="annottext">ChunkDB -&gt; Map UID (DataDefinition, Int)
</span><a href="Database.Drasil.ChunkDB.html#_dataDefnTable"><span class="hs-identifier hs-var hs-var">_dataDefnTable</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#DatadefnMap"><span class="hs-identifier hs-type">DatadefnMap</span></a></span><span>
</span><span id="line-220"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_insmodelTable"><span class="annot"><span class="annottext">ChunkDB -&gt; Map UID (InstanceModel, Int)
</span><a href="Database.Drasil.ChunkDB.html#_insmodelTable"><span class="hs-identifier hs-var hs-var">_insmodelTable</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#InsModelMap"><span class="hs-identifier hs-type">InsModelMap</span></a></span><span>
</span><span id="line-221"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_gendefTable"><span class="annot"><span class="annottext">ChunkDB -&gt; Map UID (GenDefn, Int)
</span><a href="Database.Drasil.ChunkDB.html#_gendefTable"><span class="hs-identifier hs-var hs-var">_gendefTable</span></a></span></span><span>          </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#GendefMap"><span class="hs-identifier hs-type">GendefMap</span></a></span><span>
</span><span id="line-222"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_theoryModelTable"><span class="annot"><span class="annottext">ChunkDB -&gt; Map UID (TheoryModel, Int)
</span><a href="Database.Drasil.ChunkDB.html#_theoryModelTable"><span class="hs-identifier hs-var hs-var">_theoryModelTable</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#TheoryModelMap"><span class="hs-identifier hs-type">TheoryModelMap</span></a></span><span>
</span><span id="line-223"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_conceptinsTable"><span class="annot"><span class="annottext">ChunkDB -&gt; Map UID (ConceptInstance, Int)
</span><a href="Database.Drasil.ChunkDB.html#_conceptinsTable"><span class="hs-identifier hs-var hs-var">_conceptinsTable</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#ConceptInstanceMap"><span class="hs-identifier hs-type">ConceptInstanceMap</span></a></span><span>
</span><span id="line-224"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_citationTable"><span class="annot"><span class="annottext">ChunkDB -&gt; CitationMap
</span><a href="Database.Drasil.ChunkDB.html#_citationTable"><span class="hs-identifier hs-var hs-var">_citationTable</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#CitationMap"><span class="hs-identifier hs-type">CitationMap</span></a></span><span>
</span><span id="line-225"></span><span>  </span><span class="hs-comment">-- NOT CHUNKS</span><span>
</span><span id="line-226"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_labelledcontentTable"><span class="annot"><span class="annottext">ChunkDB -&gt; LabelledContentMap
</span><a href="Database.Drasil.ChunkDB.html#_labelledcontentTable"><span class="hs-identifier hs-var hs-var">_labelledcontentTable</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#LabelledContentMap"><span class="hs-identifier hs-type">LabelledContentMap</span></a></span><span> </span><span class="hs-comment">-- TODO: LabelledContent needs to be rebuilt. See JacquesCarette/Drasil#4023.</span><span>
</span><span id="line-227"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_refTable"><span class="annot"><span class="annottext">ChunkDB -&gt; ReferenceMap
</span><a href="Database.Drasil.ChunkDB.html#_refTable"><span class="hs-identifier hs-var hs-var">_refTable</span></a></span></span><span>             </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#ReferenceMap"><span class="hs-identifier hs-type">ReferenceMap</span></a></span><span> </span><span class="hs-comment">-- TODO: References need to be rebuilt. See JacquesCarette/Drasil#4022.</span><span>
</span><span id="line-228"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_traceTable"><span class="annot"><span class="annottext">ChunkDB -&gt; TraceMap
</span><a href="Database.Drasil.ChunkDB.html#_traceTable"><span class="hs-identifier hs-var hs-var">_traceTable</span></a></span></span><span>           </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#TraceMap"><span class="hs-identifier hs-type">TraceMap</span></a></span><span>
</span><span id="line-229"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_refbyTable"><span class="annot"><span class="annottext">ChunkDB -&gt; TraceMap
</span><a href="Database.Drasil.ChunkDB.html#_refbyTable"><span class="hs-identifier hs-var hs-var">_refbyTable</span></a></span></span><span>           </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#RefbyMap"><span class="hs-identifier hs-type">RefbyMap</span></a></span><span>
</span><span id="line-230"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-231"></span><span id="unitTable"><span id="traceTable"><span id="refbyTable"><span id="citationTable"><span id="dataDefnTable"><span id="insmodelTable"><span id="gendefTable"><span id="theoryModelTable"><span id="conceptinsTable"><span id="labelledcontentTable"><span id="refTable"><span class="hs-identifier">makeLenses</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">ChunkDB</span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span class="hs-comment">-- | Smart constructor for chunk databases. Takes in the following:</span><span>
</span><span id="line-234"></span><span class="hs-comment">--</span><span>
</span><span id="line-235"></span><span class="hs-comment">--     * ['Quantity'] (for 'SymbolMap'), </span><span>
</span><span id="line-236"></span><span class="hs-comment">--     * 'NamedIdea's (for 'TermMap'),</span><span>
</span><span id="line-237"></span><span class="hs-comment">--     * 'Concept's (for 'ConceptMap'),</span><span>
</span><span id="line-238"></span><span class="hs-comment">--     * Units (something that 'IsUnit' for 'UnitMap'),</span><span>
</span><span id="line-239"></span><span class="hs-comment">--     * 'DataDefinition's (for 'DatadefnMap'),</span><span>
</span><span id="line-240"></span><span class="hs-comment">--     * 'InstanceModel's (for 'InsModelMap'),</span><span>
</span><span id="line-241"></span><span class="hs-comment">--     * 'GenDefn's (for 'GendefMap'),</span><span>
</span><span id="line-242"></span><span class="hs-comment">--     * 'TheoryModel's (for 'TheoryModelMap'),</span><span>
</span><span id="line-243"></span><span class="hs-comment">--     * 'ConceptInstance's (for 'ConceptInstanceMap'),</span><span>
</span><span id="line-244"></span><span class="hs-comment">--     * 'LabelledContent's (for 'LabelledContentMap').</span><span>
</span><span id="line-245"></span><span class="hs-comment">-- Creates an empty ChunkDB without basic data. cdb in MetaDatabase.Drasil</span><span>
</span><span id="line-246"></span><span class="hs-comment">-- should be preferred over this function as it includes the basic data needed</span><span>
</span><span id="line-247"></span><span class="hs-comment">-- for Drasil.</span><span>
</span><span id="line-248"></span><span id="local-6989586621679063658"><span id="local-6989586621679063659"><span id="local-6989586621679063660"><span class="annot"><a href="Database.Drasil.ChunkDB.html#cdb%27"><span class="hs-identifier hs-type">cdb'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Quantity</span></span><span> </span><span class="annot"><a href="#local-6989586621679063658"><span class="hs-identifier hs-type">q</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MayHaveUnit</span></span><span> </span><span class="annot"><a href="#local-6989586621679063658"><span class="hs-identifier hs-type">q</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Concept</span></span><span> </span><span class="annot"><a href="#local-6989586621679063658"><span class="hs-identifier hs-type">q</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Concept</span></span><span> </span><span class="annot"><a href="#local-6989586621679063659"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsUnit</span></span><span> </span><span class="annot"><a href="#local-6989586621679063660"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-249"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679063658"><span class="hs-identifier hs-type">q</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">IdeaDict</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679063659"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679063660"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">DataDefinition</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">InstanceModel</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-250"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">GenDefn</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">TheoryModel</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">ConceptInstance</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-251"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">LabelledContent</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Reference</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Citation</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#ChunkDB"><span class="hs-identifier hs-type">ChunkDB</span></a></span></span></span></span><span>
</span><span id="line-252"></span><span id="cdb%27"><span class="annot"><span class="annottext">cdb' :: forall q c u.
(Quantity q, MayHaveUnit q, Concept q, Concept c, IsUnit u) =&gt;
[q]
-&gt; [IdeaDict]
-&gt; [c]
-&gt; [u]
-&gt; [DataDefinition]
-&gt; [InstanceModel]
-&gt; [GenDefn]
-&gt; [TheoryModel]
-&gt; [ConceptInstance]
-&gt; [LabelledContent]
-&gt; [Reference]
-&gt; [Citation]
-&gt; ChunkDB
</span><a href="Database.Drasil.ChunkDB.html#cdb%27"><span class="hs-identifier hs-var hs-var">cdb'</span></a></span></span><span> </span><span id="local-6989586621679064229"><span class="annot"><span class="annottext">[q]
</span><a href="#local-6989586621679064229"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679064230"><span class="annot"><span class="annottext">[IdeaDict]
</span><a href="#local-6989586621679064230"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679064231"><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621679064231"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679064232"><span class="annot"><span class="annottext">[u]
</span><a href="#local-6989586621679064232"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621679064233"><span class="annot"><span class="annottext">[DataDefinition]
</span><a href="#local-6989586621679064233"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679064234"><span class="annot"><span class="annottext">[InstanceModel]
</span><a href="#local-6989586621679064234"><span class="hs-identifier hs-var">ins</span></a></span></span><span> </span><span id="local-6989586621679064235"><span class="annot"><span class="annottext">[GenDefn]
</span><a href="#local-6989586621679064235"><span class="hs-identifier hs-var">gd</span></a></span></span><span> </span><span id="local-6989586621679064236"><span class="annot"><span class="annottext">[TheoryModel]
</span><a href="#local-6989586621679064236"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span id="local-6989586621679064237"><span class="annot"><span class="annottext">[ConceptInstance]
</span><a href="#local-6989586621679064237"><span class="hs-identifier hs-var">ci</span></a></span></span><span> </span><span id="local-6989586621679064238"><span class="annot"><span class="annottext">[LabelledContent]
</span><a href="#local-6989586621679064238"><span class="hs-identifier hs-var">lc</span></a></span></span><span> </span><span id="local-6989586621679064239"><span class="annot"><span class="annottext">[Reference]
</span><a href="#local-6989586621679064239"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679064240"><span class="annot"><span class="annottext">[Citation]
</span><a href="#local-6989586621679064240"><span class="hs-identifier hs-var">cits</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-253"></span><span>  </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#CDB"><span class="hs-identifier hs-type">CDB</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-254"></span><span>    </span><span class="hs-comment">-- CHUNKS</span><span>
</span><span id="line-255"></span><span>    </span><span class="annot"><span class="annottext">symbolTable :: SymbolMap
</span><a href="Database.Drasil.ChunkDB.html#symbolTable"><span class="hs-identifier hs-var">symbolTable</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[q] -&gt; SymbolMap
forall c.
(Quantity c, MayHaveUnit c, Concept c) =&gt;
[c] -&gt; SymbolMap
</span><a href="Database.Drasil.ChunkDB.html#symbolMap"><span class="hs-identifier hs-var">symbolMap</span></a></span><span> </span><span class="annot"><span class="annottext">[q]
</span><a href="#local-6989586621679064229"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-256"></span><span>    </span><span class="annot"><span class="annottext">termTable :: TermMap
</span><a href="Database.Drasil.ChunkDB.html#termTable"><span class="hs-identifier hs-var">termTable</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[IdeaDict] -&gt; TermMap
forall c. Idea c =&gt; [c] -&gt; TermMap
</span><a href="Database.Drasil.ChunkDB.html#termMap"><span class="hs-identifier hs-var">termMap</span></a></span><span> </span><span class="annot"><span class="annottext">[IdeaDict]
</span><a href="#local-6989586621679064230"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-257"></span><span>    </span><span class="annot"><span class="annottext">conceptChunkTable :: ConceptMap
</span><a href="Database.Drasil.ChunkDB.html#conceptChunkTable"><span class="hs-identifier hs-var">conceptChunkTable</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[c] -&gt; ConceptMap
forall c. Concept c =&gt; [c] -&gt; ConceptMap
</span><a href="Database.Drasil.ChunkDB.html#conceptMap"><span class="hs-identifier hs-var">conceptMap</span></a></span><span> </span><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621679064231"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-258"></span><span>    </span><span class="annot"><span class="annottext">_unitTable :: UnitMap
</span><a href="Database.Drasil.ChunkDB.html#_unitTable"><span class="hs-identifier hs-var">_unitTable</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[u] -&gt; UnitMap
forall u. IsUnit u =&gt; [u] -&gt; UnitMap
</span><a href="Database.Drasil.ChunkDB.html#unitMap"><span class="hs-identifier hs-var">unitMap</span></a></span><span> </span><span class="annot"><span class="annottext">[u]
</span><a href="#local-6989586621679064232"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-259"></span><span>    </span><span class="annot"><span class="annottext">_dataDefnTable :: Map UID (DataDefinition, Int)
</span><a href="Database.Drasil.ChunkDB.html#_dataDefnTable"><span class="hs-identifier hs-var">_dataDefnTable</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [DataDefinition] -&gt; Map UID (DataDefinition, Int)
forall a. HasUID a =&gt; String -&gt; [a] -&gt; Map UID (a, Int)
</span><a href="Database.Drasil.ChunkDB.html#idMap"><span class="hs-identifier hs-var">idMap</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;DataDefnMap&quot;</span></span><span> </span><span class="annot"><span class="annottext">[DataDefinition]
</span><a href="#local-6989586621679064233"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-260"></span><span>    </span><span class="annot"><span class="annottext">_insmodelTable :: Map UID (InstanceModel, Int)
</span><a href="Database.Drasil.ChunkDB.html#_insmodelTable"><span class="hs-identifier hs-var">_insmodelTable</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [InstanceModel] -&gt; Map UID (InstanceModel, Int)
forall a. HasUID a =&gt; String -&gt; [a] -&gt; Map UID (a, Int)
</span><a href="Database.Drasil.ChunkDB.html#idMap"><span class="hs-identifier hs-var">idMap</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;InsModelMap&quot;</span></span><span> </span><span class="annot"><span class="annottext">[InstanceModel]
</span><a href="#local-6989586621679064234"><span class="hs-identifier hs-var">ins</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-261"></span><span>    </span><span class="annot"><span class="annottext">_gendefTable :: Map UID (GenDefn, Int)
</span><a href="Database.Drasil.ChunkDB.html#_gendefTable"><span class="hs-identifier hs-var">_gendefTable</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [GenDefn] -&gt; Map UID (GenDefn, Int)
forall a. HasUID a =&gt; String -&gt; [a] -&gt; Map UID (a, Int)
</span><a href="Database.Drasil.ChunkDB.html#idMap"><span class="hs-identifier hs-var">idMap</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;GenDefnmap&quot;</span></span><span> </span><span class="annot"><span class="annottext">[GenDefn]
</span><a href="#local-6989586621679064235"><span class="hs-identifier hs-var">gd</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-262"></span><span>    </span><span class="annot"><span class="annottext">_theoryModelTable :: Map UID (TheoryModel, Int)
</span><a href="Database.Drasil.ChunkDB.html#_theoryModelTable"><span class="hs-identifier hs-var">_theoryModelTable</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [TheoryModel] -&gt; Map UID (TheoryModel, Int)
forall a. HasUID a =&gt; String -&gt; [a] -&gt; Map UID (a, Int)
</span><a href="Database.Drasil.ChunkDB.html#idMap"><span class="hs-identifier hs-var">idMap</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;TheoryModelMap&quot;</span></span><span> </span><span class="annot"><span class="annottext">[TheoryModel]
</span><a href="#local-6989586621679064236"><span class="hs-identifier hs-var">tm</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-263"></span><span>    </span><span class="annot"><span class="annottext">_conceptinsTable :: Map UID (ConceptInstance, Int)
</span><a href="Database.Drasil.ChunkDB.html#_conceptinsTable"><span class="hs-identifier hs-var">_conceptinsTable</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [ConceptInstance] -&gt; Map UID (ConceptInstance, Int)
forall a. HasUID a =&gt; String -&gt; [a] -&gt; Map UID (a, Int)
</span><a href="Database.Drasil.ChunkDB.html#idMap"><span class="hs-identifier hs-var">idMap</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ConcInsMap&quot;</span></span><span> </span><span class="annot"><span class="annottext">[ConceptInstance]
</span><a href="#local-6989586621679064237"><span class="hs-identifier hs-var">ci</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-264"></span><span>    </span><span class="annot"><span class="annottext">_citationTable :: CitationMap
</span><a href="Database.Drasil.ChunkDB.html#_citationTable"><span class="hs-identifier hs-var">_citationTable</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [Citation] -&gt; CitationMap
forall a. HasUID a =&gt; String -&gt; [a] -&gt; Map UID (a, Int)
</span><a href="Database.Drasil.ChunkDB.html#idMap"><span class="hs-identifier hs-var">idMap</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;CiteMap&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Citation]
</span><a href="#local-6989586621679064240"><span class="hs-identifier hs-var">cits</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-265"></span><span>    </span><span class="hs-comment">-- NOT CHUNKS</span><span>
</span><span id="line-266"></span><span>    </span><span class="annot"><span class="annottext">_labelledcontentTable :: LabelledContentMap
</span><a href="Database.Drasil.ChunkDB.html#_labelledcontentTable"><span class="hs-identifier hs-var">_labelledcontentTable</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [LabelledContent] -&gt; LabelledContentMap
forall a. HasUID a =&gt; String -&gt; [a] -&gt; Map UID (a, Int)
</span><a href="Database.Drasil.ChunkDB.html#idMap"><span class="hs-identifier hs-var">idMap</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;LLCMap&quot;</span></span><span> </span><span class="annot"><span class="annottext">[LabelledContent]
</span><a href="#local-6989586621679064238"><span class="hs-identifier hs-var">lc</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-267"></span><span>    </span><span class="annot"><span class="annottext">_traceTable :: TraceMap
</span><a href="Database.Drasil.ChunkDB.html#_traceTable"><span class="hs-identifier hs-var">_traceTable</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TraceMap
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span class="hs-special">,</span><span>
</span><span id="line-268"></span><span>    </span><span class="annot"><span class="annottext">_refbyTable :: TraceMap
</span><a href="Database.Drasil.ChunkDB.html#_refbyTable"><span class="hs-identifier hs-var">_refbyTable</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TraceMap
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span class="hs-special">,</span><span>
</span><span id="line-269"></span><span>    </span><span class="annot"><span class="annottext">_refTable :: ReferenceMap
</span><a href="Database.Drasil.ChunkDB.html#_refTable"><span class="hs-identifier hs-var">_refTable</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [Reference] -&gt; ReferenceMap
forall a. HasUID a =&gt; String -&gt; [a] -&gt; Map UID (a, Int)
</span><a href="Database.Drasil.ChunkDB.html#idMap"><span class="hs-identifier hs-var">idMap</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;RefMap&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Reference]
</span><a href="#local-6989586621679064239"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-270"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-271"></span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span class="annot"><a href="Database.Drasil.ChunkDB.html#addCdb"><span class="hs-identifier hs-type">addCdb</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#ChunkDB"><span class="hs-identifier hs-type">ChunkDB</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#ChunkDB"><span class="hs-identifier hs-type">ChunkDB</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#ChunkDB"><span class="hs-identifier hs-type">ChunkDB</span></a></span><span>
</span><span id="line-274"></span><span id="addCdb"><span class="annot"><span class="annottext">addCdb :: ChunkDB -&gt; ChunkDB -&gt; ChunkDB
</span><a href="Database.Drasil.ChunkDB.html#addCdb"><span class="hs-identifier hs-var hs-var">addCdb</span></a></span></span><span> </span><span id="local-6989586621679064242"><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679064242"><span class="hs-identifier hs-var">cdb1</span></a></span></span><span> </span><span id="local-6989586621679064243"><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679064243"><span class="hs-identifier hs-var">cdb2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-275"></span><span>  </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#CDB"><span class="hs-identifier hs-type">CDB</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-276"></span><span>    </span><span class="hs-comment">-- CHUNKS</span><span>
</span><span id="line-277"></span><span>    </span><span class="annot"><span class="annottext">symbolTable :: SymbolMap
</span><a href="Database.Drasil.ChunkDB.html#symbolTable"><span class="hs-identifier hs-var">symbolTable</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SymbolMap -&gt; SymbolMap -&gt; SymbolMap
forall {k} {a}.
(Ord k, Show k) =&gt;
String -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="#local-6989586621679064244"><span class="hs-identifier hs-var">concatCdbMap</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SymbolMap&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB -&gt; SymbolMap
</span><a href="Database.Drasil.ChunkDB.html#symbolTable"><span class="hs-identifier hs-var">symbolTable</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679064242"><span class="hs-identifier hs-var">cdb1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB -&gt; SymbolMap
</span><a href="Database.Drasil.ChunkDB.html#symbolTable"><span class="hs-identifier hs-var">symbolTable</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679064243"><span class="hs-identifier hs-var">cdb2</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-278"></span><span>    </span><span class="annot"><span class="annottext">termTable :: TermMap
</span><a href="Database.Drasil.ChunkDB.html#termTable"><span class="hs-identifier hs-var">termTable</span></a></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; TermMap -&gt; TermMap -&gt; TermMap
forall {k} {a}.
(Ord k, Show k) =&gt;
String -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="#local-6989586621679064244"><span class="hs-identifier hs-var">concatCdbMap</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;TermMap&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB -&gt; TermMap
</span><a href="Database.Drasil.ChunkDB.html#termTable"><span class="hs-identifier hs-var">termTable</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679064242"><span class="hs-identifier hs-var">cdb1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB -&gt; TermMap
</span><a href="Database.Drasil.ChunkDB.html#termTable"><span class="hs-identifier hs-var">termTable</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679064243"><span class="hs-identifier hs-var">cdb2</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-279"></span><span>    </span><span class="annot"><span class="annottext">conceptChunkTable :: ConceptMap
</span><a href="Database.Drasil.ChunkDB.html#conceptChunkTable"><span class="hs-identifier hs-var">conceptChunkTable</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ConceptMap -&gt; ConceptMap -&gt; ConceptMap
forall {k} {a}.
(Ord k, Show k) =&gt;
String -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="#local-6989586621679064244"><span class="hs-identifier hs-var">concatCdbMap</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ConceptMap&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB -&gt; ConceptMap
</span><a href="Database.Drasil.ChunkDB.html#conceptChunkTable"><span class="hs-identifier hs-var">conceptChunkTable</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679064242"><span class="hs-identifier hs-var">cdb1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB -&gt; ConceptMap
</span><a href="Database.Drasil.ChunkDB.html#conceptChunkTable"><span class="hs-identifier hs-var">conceptChunkTable</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679064243"><span class="hs-identifier hs-var">cdb2</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-280"></span><span>    </span><span class="annot"><span class="annottext">_unitTable :: UnitMap
</span><a href="Database.Drasil.ChunkDB.html#_unitTable"><span class="hs-identifier hs-var">_unitTable</span></a></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; UnitMap -&gt; UnitMap -&gt; UnitMap
forall {k} {a}.
(Ord k, Show k) =&gt;
String -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="#local-6989586621679064244"><span class="hs-identifier hs-var">concatCdbMap</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;UnitMap&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB -&gt; UnitMap
</span><a href="Database.Drasil.ChunkDB.html#_unitTable"><span class="hs-identifier hs-var">_unitTable</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679064242"><span class="hs-identifier hs-var">cdb1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB -&gt; UnitMap
</span><a href="Database.Drasil.ChunkDB.html#_unitTable"><span class="hs-identifier hs-var">_unitTable</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679064243"><span class="hs-identifier hs-var">cdb2</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-281"></span><span>    </span><span class="annot"><span class="annottext">_dataDefnTable :: Map UID (DataDefinition, Int)
</span><a href="Database.Drasil.ChunkDB.html#_dataDefnTable"><span class="hs-identifier hs-var">_dataDefnTable</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; Map UID (DataDefinition, Int)
-&gt; Map UID (DataDefinition, Int)
-&gt; Map UID (DataDefinition, Int)
forall {k} {a}.
(Ord k, Show k) =&gt;
String -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="#local-6989586621679064244"><span class="hs-identifier hs-var">concatCdbMap</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB -&gt; Map UID (DataDefinition, Int)
</span><a href="Database.Drasil.ChunkDB.html#_dataDefnTable"><span class="hs-identifier hs-var">_dataDefnTable</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679064242"><span class="hs-identifier hs-var">cdb1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB -&gt; Map UID (DataDefinition, Int)
</span><a href="Database.Drasil.ChunkDB.html#_dataDefnTable"><span class="hs-identifier hs-var">_dataDefnTable</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679064243"><span class="hs-identifier hs-var">cdb2</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-282"></span><span>    </span><span class="annot"><span class="annottext">_insmodelTable :: Map UID (InstanceModel, Int)
</span><a href="Database.Drasil.ChunkDB.html#_insmodelTable"><span class="hs-identifier hs-var">_insmodelTable</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; Map UID (InstanceModel, Int)
-&gt; Map UID (InstanceModel, Int)
-&gt; Map UID (InstanceModel, Int)
forall {k} {a}.
(Ord k, Show k) =&gt;
String -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="#local-6989586621679064244"><span class="hs-identifier hs-var">concatCdbMap</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB -&gt; Map UID (InstanceModel, Int)
</span><a href="Database.Drasil.ChunkDB.html#_insmodelTable"><span class="hs-identifier hs-var">_insmodelTable</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679064242"><span class="hs-identifier hs-var">cdb1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB -&gt; Map UID (InstanceModel, Int)
</span><a href="Database.Drasil.ChunkDB.html#_insmodelTable"><span class="hs-identifier hs-var">_insmodelTable</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679064243"><span class="hs-identifier hs-var">cdb2</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-283"></span><span>    </span><span class="annot"><span class="annottext">_gendefTable :: Map UID (GenDefn, Int)
</span><a href="Database.Drasil.ChunkDB.html#_gendefTable"><span class="hs-identifier hs-var">_gendefTable</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; Map UID (GenDefn, Int)
-&gt; Map UID (GenDefn, Int)
-&gt; Map UID (GenDefn, Int)
forall {k} {a}.
(Ord k, Show k) =&gt;
String -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="#local-6989586621679064244"><span class="hs-identifier hs-var">concatCdbMap</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB -&gt; Map UID (GenDefn, Int)
</span><a href="Database.Drasil.ChunkDB.html#_gendefTable"><span class="hs-identifier hs-var">_gendefTable</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679064242"><span class="hs-identifier hs-var">cdb1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB -&gt; Map UID (GenDefn, Int)
</span><a href="Database.Drasil.ChunkDB.html#_gendefTable"><span class="hs-identifier hs-var">_gendefTable</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679064243"><span class="hs-identifier hs-var">cdb2</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-284"></span><span>    </span><span class="annot"><span class="annottext">_theoryModelTable :: Map UID (TheoryModel, Int)
</span><a href="Database.Drasil.ChunkDB.html#_theoryModelTable"><span class="hs-identifier hs-var">_theoryModelTable</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; Map UID (TheoryModel, Int)
-&gt; Map UID (TheoryModel, Int)
-&gt; Map UID (TheoryModel, Int)
forall {k} {a}.
(Ord k, Show k) =&gt;
String -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="#local-6989586621679064244"><span class="hs-identifier hs-var">concatCdbMap</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB -&gt; Map UID (TheoryModel, Int)
</span><a href="Database.Drasil.ChunkDB.html#_theoryModelTable"><span class="hs-identifier hs-var">_theoryModelTable</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679064242"><span class="hs-identifier hs-var">cdb1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB -&gt; Map UID (TheoryModel, Int)
</span><a href="Database.Drasil.ChunkDB.html#_theoryModelTable"><span class="hs-identifier hs-var">_theoryModelTable</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679064243"><span class="hs-identifier hs-var">cdb2</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-285"></span><span>    </span><span class="annot"><span class="annottext">_conceptinsTable :: Map UID (ConceptInstance, Int)
</span><a href="Database.Drasil.ChunkDB.html#_conceptinsTable"><span class="hs-identifier hs-var">_conceptinsTable</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; Map UID (ConceptInstance, Int)
-&gt; Map UID (ConceptInstance, Int)
-&gt; Map UID (ConceptInstance, Int)
forall {k} {a}.
(Ord k, Show k) =&gt;
String -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="#local-6989586621679064244"><span class="hs-identifier hs-var">concatCdbMap</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB -&gt; Map UID (ConceptInstance, Int)
</span><a href="Database.Drasil.ChunkDB.html#_conceptinsTable"><span class="hs-identifier hs-var">_conceptinsTable</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679064242"><span class="hs-identifier hs-var">cdb1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB -&gt; Map UID (ConceptInstance, Int)
</span><a href="Database.Drasil.ChunkDB.html#_conceptinsTable"><span class="hs-identifier hs-var">_conceptinsTable</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679064243"><span class="hs-identifier hs-var">cdb2</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-286"></span><span>    </span><span class="annot"><span class="annottext">_citationTable :: CitationMap
</span><a href="Database.Drasil.ChunkDB.html#_citationTable"><span class="hs-identifier hs-var">_citationTable</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; CitationMap -&gt; CitationMap -&gt; CitationMap
forall {k} {a}.
(Ord k, Show k) =&gt;
String -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="#local-6989586621679064244"><span class="hs-identifier hs-var">concatCdbMap</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB -&gt; CitationMap
</span><a href="Database.Drasil.ChunkDB.html#_citationTable"><span class="hs-identifier hs-var">_citationTable</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679064242"><span class="hs-identifier hs-var">cdb1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB -&gt; CitationMap
</span><a href="Database.Drasil.ChunkDB.html#_citationTable"><span class="hs-identifier hs-var">_citationTable</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679064243"><span class="hs-identifier hs-var">cdb2</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-287"></span><span>    </span><span class="hs-comment">-- NOT CHUNKS</span><span>
</span><span id="line-288"></span><span>    </span><span class="annot"><span class="annottext">_labelledcontentTable :: LabelledContentMap
</span><a href="Database.Drasil.ChunkDB.html#_labelledcontentTable"><span class="hs-identifier hs-var">_labelledcontentTable</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; LabelledContentMap -&gt; LabelledContentMap -&gt; LabelledContentMap
forall {k} {a}.
(Ord k, Show k) =&gt;
String -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="#local-6989586621679064244"><span class="hs-identifier hs-var">concatCdbMap</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB -&gt; LabelledContentMap
</span><a href="Database.Drasil.ChunkDB.html#_labelledcontentTable"><span class="hs-identifier hs-var">_labelledcontentTable</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679064242"><span class="hs-identifier hs-var">cdb1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB -&gt; LabelledContentMap
</span><a href="Database.Drasil.ChunkDB.html#_labelledcontentTable"><span class="hs-identifier hs-var">_labelledcontentTable</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679064243"><span class="hs-identifier hs-var">cdb2</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-289"></span><span>    </span><span class="annot"><span class="annottext">_traceTable :: TraceMap
</span><a href="Database.Drasil.ChunkDB.html#_traceTable"><span class="hs-identifier hs-var">_traceTable</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; TraceMap -&gt; TraceMap -&gt; TraceMap
forall {k} {a}.
(Ord k, Show k) =&gt;
String -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="#local-6989586621679064244"><span class="hs-identifier hs-var">concatCdbMap</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB -&gt; TraceMap
</span><a href="Database.Drasil.ChunkDB.html#_traceTable"><span class="hs-identifier hs-var">_traceTable</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679064242"><span class="hs-identifier hs-var">cdb1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB -&gt; TraceMap
</span><a href="Database.Drasil.ChunkDB.html#_traceTable"><span class="hs-identifier hs-var">_traceTable</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679064243"><span class="hs-identifier hs-var">cdb2</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-290"></span><span>    </span><span class="annot"><span class="annottext">_refbyTable :: TraceMap
</span><a href="Database.Drasil.ChunkDB.html#_refbyTable"><span class="hs-identifier hs-var">_refbyTable</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; TraceMap -&gt; TraceMap -&gt; TraceMap
forall {k} {a}.
(Ord k, Show k) =&gt;
String -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="#local-6989586621679064244"><span class="hs-identifier hs-var">concatCdbMap</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB -&gt; TraceMap
</span><a href="Database.Drasil.ChunkDB.html#_refbyTable"><span class="hs-identifier hs-var">_refbyTable</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679064242"><span class="hs-identifier hs-var">cdb1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB -&gt; TraceMap
</span><a href="Database.Drasil.ChunkDB.html#_refbyTable"><span class="hs-identifier hs-var">_refbyTable</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679064243"><span class="hs-identifier hs-var">cdb2</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-291"></span><span>    </span><span class="annot"><span class="annottext">_refTable :: ReferenceMap
</span><a href="Database.Drasil.ChunkDB.html#_refTable"><span class="hs-identifier hs-var">_refTable</span></a></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ReferenceMap -&gt; ReferenceMap -&gt; ReferenceMap
forall {k} {a}.
(Ord k, Show k) =&gt;
String -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="#local-6989586621679064244"><span class="hs-identifier hs-var">concatCdbMap</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB -&gt; ReferenceMap
</span><a href="Database.Drasil.ChunkDB.html#_refTable"><span class="hs-identifier hs-var">_refTable</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679064242"><span class="hs-identifier hs-var">cdb1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB -&gt; ReferenceMap
</span><a href="Database.Drasil.ChunkDB.html#_refTable"><span class="hs-identifier hs-var">_refTable</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679064243"><span class="hs-identifier hs-var">cdb2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-292"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-293"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-294"></span><span>    </span><span id="local-6989586621679064244"><span class="annot"><span class="annottext">concatCdbMap :: String -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="#local-6989586621679064244"><span class="hs-identifier hs-var hs-var">concatCdbMap</span></a></span></span><span> </span><span id="local-6989586621679064252"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679064252"><span class="hs-identifier hs-var">mn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(k -&gt; a -&gt; a -&gt; a) -&gt; Map k a -&gt; Map k a -&gt; Map k a
forall k a.
Ord k =&gt;
(k -&gt; a -&gt; a -&gt; a) -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.unionWithKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; k -&gt; a -&gt; a -&gt; a
forall {a} {a} {p}. Show a =&gt; String -&gt; a -&gt; a -&gt; p -&gt; a
</span><a href="#local-6989586621679064254"><span class="hs-identifier hs-var">preferNew</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679064252"><span class="hs-identifier hs-var">mn</span></a></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-295"></span><span>    </span><span id="local-6989586621679064254"><span class="annot"><span class="annottext">preferNew :: String -&gt; a -&gt; a -&gt; p -&gt; a
</span><a href="#local-6989586621679064254"><span class="hs-identifier hs-var hs-var">preferNew</span></a></span></span><span> </span><span id="local-6989586621679064257"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679064257"><span class="hs-identifier hs-var">mn</span></a></span></span><span> </span><span id="local-6989586621679064258"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064258"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span id="local-6989586621679064259"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064259"><span class="hs-identifier hs-var">new</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; a -&gt; a
forall a. String -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">trace</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;'&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064258"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;' is inserted twice in '&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679064257"><span class="hs-identifier hs-var">mn</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;' while adding to basis!&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064259"><span class="hs-identifier hs-var">new</span></a></span><span>
</span><span id="line-296"></span><span>
</span><span id="line-297"></span><span class="annot"><span class="hs-comment">-- | Gets the units of a 'Quantity' as 'UnitDefn's.</span></span><span>
</span><span id="line-298"></span><span id="local-6989586621679063676"><span class="annot"><a href="Database.Drasil.ChunkDB.html#collectUnits"><span class="hs-identifier hs-type">collectUnits</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Quantity</span></span><span> </span><span class="annot"><a href="#local-6989586621679063676"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#ChunkDB"><span class="hs-identifier hs-type">ChunkDB</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679063676"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">UnitDefn</span></span><span class="hs-special">]</span></span><span>
</span><span id="line-299"></span><span id="collectUnits"><span class="annot"><span class="annottext">collectUnits :: forall c. Quantity c =&gt; ChunkDB -&gt; [c] -&gt; [UnitDefn]
</span><a href="Database.Drasil.ChunkDB.html#collectUnits"><span class="hs-identifier hs-var hs-var">collectUnits</span></a></span></span><span> </span><span id="local-6989586621679064272"><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679064272"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(UID -&gt; UnitDefn) -&gt; [UID] -&gt; [UnitDefn]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnitDefn -&gt; UnitDefn
forall u. IsUnit u =&gt; u -&gt; UnitDefn
</span><span class="hs-identifier hs-var">unitWrapper</span></span><span> </span><span class="annot"><span class="annottext">(UnitDefn -&gt; UnitDefn) -&gt; (UID -&gt; UnitDefn) -&gt; UID -&gt; UnitDefn
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(UID -&gt; UnitMap -&gt; UnitDefn) -&gt; UnitMap -&gt; UID -&gt; UnitDefn
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">UID -&gt; UnitMap -&gt; UnitDefn
</span><a href="Database.Drasil.ChunkDB.html#unitLookup"><span class="hs-identifier hs-var">unitLookup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679064272"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB -&gt; Getting UnitMap ChunkDB UnitMap -&gt; UnitMap
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting UnitMap ChunkDB UnitMap
Lens' ChunkDB UnitMap
</span><a href="Database.Drasil.ChunkDB.html#unitTable"><span class="hs-identifier hs-var">unitTable</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-300"></span><span> </span><span class="annot"><span class="annottext">([UID] -&gt; [UnitDefn]) -&gt; ([c] -&gt; [UID]) -&gt; [c] -&gt; [UnitDefn]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(UnitDefn -&gt; [UID]) -&gt; [UnitDefn] -&gt; [UID]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">UnitDefn -&gt; [UID]
forall u. IsUnit u =&gt; u -&gt; [UID]
</span><span class="hs-identifier hs-var">getUnits</span></span><span> </span><span class="annot"><span class="annottext">([UnitDefn] -&gt; [UID]) -&gt; ([c] -&gt; [UnitDefn]) -&gt; [c] -&gt; [UID]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(c -&gt; Maybe UnitDefn) -&gt; [c] -&gt; [UnitDefn]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB -&gt; c -&gt; Maybe UnitDefn
forall c. HasUID c =&gt; ChunkDB -&gt; c -&gt; Maybe UnitDefn
</span><a href="Database.Drasil.ChunkDB.html#getUnitLup"><span class="hs-identifier hs-var">getUnitLup</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679064272"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span class="annot"><span class="hs-comment">-- | Trace a 'UID' to related 'UID's.</span></span><span>
</span><span id="line-303"></span><span class="annot"><a href="Database.Drasil.ChunkDB.html#traceLookup"><span class="hs-identifier hs-type">traceLookup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#TraceMap"><span class="hs-identifier hs-type">TraceMap</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span class="hs-special">]</span><span>
</span><span id="line-304"></span><span id="traceLookup"><span class="annot"><span class="annottext">traceLookup :: UID -&gt; TraceMap -&gt; [UID]
</span><a href="Database.Drasil.ChunkDB.html#traceLookup"><span class="hs-identifier hs-var hs-var">traceLookup</span></a></span></span><span> </span><span id="local-6989586621679064276"><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679064276"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[UID] -&gt; Maybe [UID] -&gt; [UID]
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(Maybe [UID] -&gt; [UID])
-&gt; (TraceMap -&gt; Maybe [UID]) -&gt; TraceMap -&gt; [UID]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">UID -&gt; TraceMap -&gt; Maybe [UID]
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679064276"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-305"></span><span>
</span><span id="line-306"></span><span class="annot"><span class="hs-comment">-- | Translates a traceability map into a reference map.</span></span><span>
</span><span id="line-307"></span><span class="annot"><a href="Database.Drasil.ChunkDB.html#generateRefbyMap"><span class="hs-identifier hs-type">generateRefbyMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#TraceMap"><span class="hs-identifier hs-type">TraceMap</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#RefbyMap"><span class="hs-identifier hs-type">RefbyMap</span></a></span><span>
</span><span id="line-308"></span><span id="generateRefbyMap"><span class="annot"><span class="annottext">generateRefbyMap :: TraceMap -&gt; TraceMap
</span><a href="Database.Drasil.ChunkDB.html#generateRefbyMap"><span class="hs-identifier hs-var hs-var">generateRefbyMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TraceMap -&gt; TraceMap
forall v k. Ord v =&gt; Map k [v] -&gt; Map v [k]
</span><span class="hs-identifier hs-var">invert</span></span><span>
</span><span id="line-309"></span><span>
</span><span id="line-310"></span><span class="annot"><span class="hs-comment">-- | Trace a 'UID' to referenced 'UID's.</span></span><span>
</span><span id="line-311"></span><span class="annot"><a href="Database.Drasil.ChunkDB.html#refbyLookup"><span class="hs-identifier hs-type">refbyLookup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Drasil.ChunkDB.html#RefbyMap"><span class="hs-identifier hs-type">RefbyMap</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span class="hs-special">]</span><span>
</span><span id="line-312"></span><span id="refbyLookup"><span class="annot"><span class="annottext">refbyLookup :: UID -&gt; TraceMap -&gt; [UID]
</span><a href="Database.Drasil.ChunkDB.html#refbyLookup"><span class="hs-identifier hs-var hs-var">refbyLookup</span></a></span></span><span> </span><span id="local-6989586621679064277"><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679064277"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[UID] -&gt; Maybe [UID] -&gt; [UID]
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(Maybe [UID] -&gt; [UID])
-&gt; (TraceMap -&gt; Maybe [UID]) -&gt; TraceMap -&gt; [UID]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">UID -&gt; TraceMap -&gt; Maybe [UID]
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679064277"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-313"></span></pre></body></html>