<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Language.Drasil.Code.Imperative.Modules</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-4"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genMain"><span class="hs-identifier">genMain</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genMainProc"><span class="hs-identifier">genMainProc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genMainFunc"><span class="hs-identifier">genMainFunc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genMainFuncProc"><span class="hs-identifier">genMainFuncProc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genInputClass"><span class="hs-identifier">genInputClass</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-5"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genInputDerived"><span class="hs-identifier">genInputDerived</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genInputDerivedProc"><span class="hs-identifier">genInputDerivedProc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genInputMod"><span class="hs-identifier">genInputMod</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genInputModProc"><span class="hs-identifier">genInputModProc</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-6"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genInputConstraints"><span class="hs-identifier">genInputConstraints</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genInputConstraintsProc"><span class="hs-identifier">genInputConstraintsProc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genInputFormat"><span class="hs-identifier">genInputFormat</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-7"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genInputFormatProc"><span class="hs-identifier">genInputFormatProc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genConstMod"><span class="hs-identifier">genConstMod</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#checkConstClass"><span class="hs-identifier">checkConstClass</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genConstClass"><span class="hs-identifier">genConstClass</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genCalcMod"><span class="hs-identifier">genCalcMod</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-8"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genCalcModProc"><span class="hs-identifier">genCalcModProc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genCalcFunc"><span class="hs-identifier">genCalcFunc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genCalcFuncProc"><span class="hs-identifier">genCalcFuncProc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genOutputMod"><span class="hs-identifier">genOutputMod</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genOutputModProc"><span class="hs-identifier">genOutputModProc</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-9"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genOutputFormat"><span class="hs-identifier">genOutputFormat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genOutputFormatProc"><span class="hs-identifier">genOutputFormatProc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genSampleInput"><span class="hs-identifier">genSampleInput</span></a></span><span>
</span><span id="line-10"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Database.Drasil</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ChunkDB</span></span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Drasil.Code.CodeExpr.Development</span></span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Language.Drasil</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Constraint</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">RealInterval</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>  </span><span class="annot"><span class="hs-identifier">HasUID</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">uid</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Stage</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Comments.html"><span class="hs-identifier">Language.Drasil.Code.Imperative.Comments</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Code.Imperative.Comments.html#getCommentBrief"><span class="hs-identifier">getCommentBrief</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Descriptions.html"><span class="hs-identifier">Language.Drasil.Code.Imperative.Descriptions</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Code.Imperative.Descriptions.html#constClassDesc"><span class="hs-identifier">constClassDesc</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Descriptions.html#constModDesc"><span class="hs-identifier">constModDesc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Descriptions.html#dvFuncDesc"><span class="hs-identifier">dvFuncDesc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Descriptions.html#inConsFuncDesc"><span class="hs-identifier">inConsFuncDesc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Descriptions.html#inFmtFuncDesc"><span class="hs-identifier">inFmtFuncDesc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Descriptions.html#inputClassDesc"><span class="hs-identifier">inputClassDesc</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Descriptions.html#inputConstructorDesc"><span class="hs-identifier">inputConstructorDesc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Descriptions.html#inputParametersDesc"><span class="hs-identifier">inputParametersDesc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Descriptions.html#modDesc"><span class="hs-identifier">modDesc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Descriptions.html#outputFormatDesc"><span class="hs-identifier">outputFormatDesc</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Descriptions.html#woFuncDesc"><span class="hs-identifier">woFuncDesc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Descriptions.html#calcModDesc"><span class="hs-identifier">calcModDesc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.FunctionCalls.html"><span class="hs-identifier">Language.Drasil.Code.Imperative.FunctionCalls</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Code.Imperative.FunctionCalls.html#genCalcCall"><span class="hs-identifier">genCalcCall</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.FunctionCalls.html#genCalcCallProc"><span class="hs-identifier">genCalcCallProc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.FunctionCalls.html#genAllInputCalls"><span class="hs-identifier">genAllInputCalls</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.FunctionCalls.html#genAllInputCallsProc"><span class="hs-identifier">genAllInputCallsProc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.FunctionCalls.html#genOutputCall"><span class="hs-identifier">genOutputCall</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.FunctionCalls.html#genOutputCallProc"><span class="hs-identifier">genOutputCallProc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html"><span class="hs-identifier">Language.Drasil.Code.Imperative.GenerateGOOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html#ClassType"><span class="hs-identifier">ClassType</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html#genModule"><span class="hs-identifier">genModule</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html#genModuleProc"><span class="hs-identifier">genModuleProc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html#genModuleWithImports"><span class="hs-identifier">genModuleWithImports</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html#genModuleWithImportsProc"><span class="hs-identifier">genModuleWithImportsProc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html#primaryClass"><span class="hs-identifier">primaryClass</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html#auxClass"><span class="hs-identifier">auxClass</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Helpers.html"><span class="hs-identifier">Language.Drasil.Code.Imperative.Helpers</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Code.Imperative.Helpers.html#liftS"><span class="hs-identifier">liftS</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Helpers.html#convScope"><span class="hs-identifier">convScope</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html"><span class="hs-identifier">Language.Drasil.Code.Imperative.Import</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#codeType"><span class="hs-identifier">codeType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier">convExpr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier">convExprProc</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier">convStmt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmtProc"><span class="hs-identifier">convStmtProc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#genConstructor"><span class="hs-identifier">genConstructor</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#mkVal"><span class="hs-identifier">mkVal</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#mkValProc"><span class="hs-identifier">mkValProc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier">mkVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#mkVarProc"><span class="hs-identifier">mkVarProc</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#privateInOutMethod"><span class="hs-identifier">privateInOutMethod</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#privateMethod"><span class="hs-identifier">privateMethod</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#privateFuncProc"><span class="hs-identifier">privateFuncProc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#publicFunc"><span class="hs-identifier">publicFunc</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#publicFuncProc"><span class="hs-identifier">publicFuncProc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#publicInOutFunc"><span class="hs-identifier">publicInOutFunc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#publicInOutFuncProc"><span class="hs-identifier">publicInOutFuncProc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#privateInOutFuncProc"><span class="hs-identifier">privateInOutFuncProc</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#readData"><span class="hs-identifier">readData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#readDataProc"><span class="hs-identifier">readDataProc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#renderC"><span class="hs-identifier">renderC</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Logging.html"><span class="hs-identifier">Language.Drasil.Code.Imperative.Logging</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Code.Imperative.Logging.html#maybeLog"><span class="hs-identifier">maybeLog</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Logging.html#varLogFile"><span class="hs-identifier">varLogFile</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Parameters.html"><span class="hs-identifier">Language.Drasil.Code.Imperative.Parameters</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Code.Imperative.Parameters.html#getConstraintParams"><span class="hs-identifier">getConstraintParams</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Parameters.html#getDerivedIns"><span class="hs-identifier">getDerivedIns</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Parameters.html#getDerivedOuts"><span class="hs-identifier">getDerivedOuts</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Parameters.html#getInConstructorParams"><span class="hs-identifier">getInConstructorParams</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Parameters.html#getInputFormatIns"><span class="hs-identifier">getInputFormatIns</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Parameters.html#getInputFormatOuts"><span class="hs-identifier">getInputFormatOuts</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Parameters.html#getCalcParams"><span class="hs-identifier">getCalcParams</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Parameters.html#getOutputParams"><span class="hs-identifier">getOutputParams</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html"><span class="hs-identifier">Language.Drasil.Code.Imperative.DrasilState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier">GenState</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#DrasilState"><span class="hs-identifier">DrasilState</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#ScopeType"><span class="hs-identifier">ScopeType</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#genICName"><span class="hs-identifier">genICName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.GOOL.ClassInterface.html"><span class="hs-identifier">Language.Drasil.Code.Imperative.GOOL.ClassInterface</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Code.Imperative.GOOL.ClassInterface.html#AuxiliarySym"><span class="hs-identifier">AuxiliarySym</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.Chunk.Code.html"><span class="hs-identifier">Language.Drasil.Chunk.Code</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">CodeIdea</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">codeName</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">CodeVarChunk</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Chunk.CodeBase.html#quantvar"><span class="hs-identifier">quantvar</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-42"></span><span>  </span><span class="annot"><span class="hs-identifier">DefiningCodeExpr</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.Chunk.CodeDefinition.html"><span class="hs-identifier">Language.Drasil.Chunk.CodeDefinition</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Chunk.CodeDefinition.html#CodeDefinition"><span class="hs-identifier">CodeDefinition</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Chunk.CodeDefinition.html#DefinitionType"><span class="hs-identifier">DefinitionType</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>  </span><span class="annot"><a href="Language.Drasil.Chunk.CodeDefinition.html#defType"><span class="hs-identifier">defType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.Chunk.ConstraintMap.html"><span class="hs-identifier">Language.Drasil.Chunk.ConstraintMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Chunk.ConstraintMap.html#physLookup"><span class="hs-identifier">physLookup</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Chunk.ConstraintMap.html#sfwrLookup"><span class="hs-identifier">sfwrLookup</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.Chunk.Parameter.html"><span class="hs-identifier">Language.Drasil.Chunk.Parameter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Chunk.Parameter.html#pcAuto"><span class="hs-identifier">pcAuto</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.Code.CodeQuantityDicts.html"><span class="hs-identifier">Language.Drasil.Code.CodeQuantityDicts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Code.CodeQuantityDicts.html#inFileName"><span class="hs-identifier">inFileName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.CodeQuantityDicts.html#inParams"><span class="hs-identifier">inParams</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.CodeQuantityDicts.html#consts"><span class="hs-identifier">consts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html"><span class="hs-identifier">Language.Drasil.Code.DataDesc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#DataDesc"><span class="hs-identifier">DataDesc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#junkLine"><span class="hs-identifier">junkLine</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#singleton"><span class="hs-identifier">singleton</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.Code.ExtLibImport.html"><span class="hs-identifier">Language.Drasil.Code.ExtLibImport</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Code.ExtLibImport.html#defs"><span class="hs-identifier">defs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.ExtLibImport.html#imports"><span class="hs-identifier">imports</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.ExtLibImport.html#steps"><span class="hs-identifier">steps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html"><span class="hs-identifier">Language.Drasil.Choices</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Choices.html#Comments"><span class="hs-identifier">Comments</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#ConstantStructure"><span class="hs-identifier">ConstantStructure</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-51"></span><span>  </span><span class="annot"><a href="Language.Drasil.Choices.html#ConstantRepr"><span class="hs-identifier">ConstantRepr</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#ConstraintBehaviour"><span class="hs-identifier">ConstraintBehaviour</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#ImplementationType"><span class="hs-identifier">ImplementationType</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-52"></span><span>  </span><span class="annot"><a href="Language.Drasil.Choices.html#Logging"><span class="hs-identifier">Logging</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#Structure"><span class="hs-identifier">Structure</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#hasSampleInput"><span class="hs-identifier">hasSampleInput</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#InternalConcept"><span class="hs-identifier">InternalConcept</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.CodeSpec.html"><span class="hs-identifier">Language.Drasil.CodeSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.CodeSpec.html#HasOldCodeSpec"><span class="hs-identifier">HasOldCodeSpec</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Language.Drasil.Expr.Development</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Completeness</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Language.Drasil.Printers</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">SingleLine</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">OneLine</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">codeExprDoc</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">showHasSymbImpl</span></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Drasil.GOOL</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MSBody</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">MSBlock</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">SVariable</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">SValue</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">MSStatement</span></span><span class="hs-special">,</span><span>
</span><span id="line-58"></span><span>  </span><span class="annot"><span class="hs-identifier">SMethod</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">CSStateVar</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">SClass</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">SharedProg</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">OOProg</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">BodySym</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">bodyStatements</span></span><span class="hs-special">,</span><span>
</span><span id="line-59"></span><span>  </span><span class="annot"><span class="hs-identifier">oneLiner</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">BlockSym</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">PermanenceSym</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">TypeSym</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">VariableSym</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-60"></span><span>  </span><span class="annot"><span class="hs-identifier">ScopeSym</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Literal</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">VariableValue</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">CommandLineArgs</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-61"></span><span>  </span><span class="annot"><span class="hs-identifier">BooleanExpression</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">StatementSym</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">AssignStatement</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-62"></span><span>  </span><span class="annot"><span class="hs-identifier">DeclStatement</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">OODeclStatement</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">objDecNewNoParams</span></span><span class="hs-special">,</span><span>
</span><span id="line-63"></span><span>  </span><span class="annot"><span class="hs-identifier">extObjDecNewNoParams</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">IOStatement</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ControlStatement</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ifNoElse</span></span><span class="hs-special">,</span><span>
</span><span id="line-64"></span><span>  </span><span class="annot"><span class="hs-identifier">VisibilitySym</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">MethodSym</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">StateVarSym</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">pubDVar</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">convType</span></span><span class="hs-special">,</span><span>
</span><span id="line-65"></span><span>    </span><span class="annot"><span class="hs-identifier">convTypeOO</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">VisibilityTag</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Drasil.GOOL</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">OO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">SFile</span></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Drasil.GProc</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ProcProg</span></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Drasil.GProc</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Proc</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">SFile</span></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">print</span></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">intersperse</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">partition</span></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(!)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">elems</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">member</span></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">lookup</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">filter</span></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">maybeToList</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">catMaybes</span></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">liftM2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">zipWithM</span></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.State</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">get</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">gets</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">modify</span></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(^.)</span></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.PrettyPrint.HughesPJ</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">render</span></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Deriving.Internal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">interleave</span></span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span class="hs-keyword">type</span><span> </span><span id="ConstraintCE"><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#ConstraintCE"><span class="hs-identifier hs-var">ConstraintCE</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Constraint</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CodeExpr</span></span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="hs-comment">---- MAIN ---</span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="annot"><span class="hs-comment">-- | Generates a controller module.</span></span><span>
</span><span id="line-87"></span><span id="local-6989586621679363078"><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genMain"><span class="hs-identifier hs-type">genMain</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679363078"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OO.SFile</span></span><span> </span><span class="annot"><a href="#local-6989586621679363078"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-88"></span><span id="genMain"><span class="annot"><span class="annottext">genMain :: forall (r :: * -&gt; *). OOProg r =&gt; GenState (SFile r)
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genMain"><span class="hs-identifier hs-var hs-var">genMain</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; String
-&gt; [GenState (Maybe (SMethod r))]
-&gt; [GenState (Maybe (SClass r))]
-&gt; StateT
     DrasilState Identity (StateT FileState Identity (r (File r)))
forall (r :: * -&gt; *).
OOProg r =&gt;
String
-&gt; String
-&gt; [GenState (Maybe (SMethod r))]
-&gt; [GenState (Maybe (SClass r))]
-&gt; GenState (SFile r)
</span><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html#genModule"><span class="hs-identifier hs-var">genModule</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Control&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Controls the flow of the program&quot;</span></span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="annottext">GenState (Maybe (SMethod r))
forall (r :: * -&gt; *). OOProg r =&gt; GenState (Maybe (SMethod r))
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genMainFunc"><span class="hs-identifier hs-var">genMainFunc</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-comment">-- | Generates a main function, to act as the controller for an SCS program.</span><span>
</span><span id="line-92"></span><span class="hs-comment">-- The controller declares input and constant variables, then calls the</span><span>
</span><span id="line-93"></span><span class="hs-comment">-- functions for reading input values, calculating derived inputs, checking</span><span>
</span><span id="line-94"></span><span class="hs-comment">-- constraints, calculating outputs, and printing outputs.</span><span>
</span><span id="line-95"></span><span class="hs-comment">-- Returns Nothing if the user chose to generate a library.</span><span>
</span><span id="line-96"></span><span id="local-6989586621679363088"><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genMainFunc"><span class="hs-identifier hs-type">genMainFunc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679363088"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679363088"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-97"></span><span id="genMainFunc"><span class="annot"><span class="annottext">genMainFunc :: forall (r :: * -&gt; *). OOProg r =&gt; GenState (Maybe (SMethod r))
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genMainFunc"><span class="hs-identifier hs-var hs-var">genMainFunc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-98"></span><span>    </span><span id="local-6989586621679363702"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679363702"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-99"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679364240"><span class="annot"><span class="annottext">mainFunc :: ImplementationType
-&gt; StateT DrasilState Identity (Maybe (MS (r (Method r))))
</span><a href="#local-6989586621679364240"><span class="hs-identifier hs-var hs-var">mainFunc</span></a></span></span><span> </span><span class="annot"><span class="annottext">ImplementationType
</span><a href="Language.Drasil.Choices.html#Library"><span class="hs-identifier hs-var">Library</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (MS (r (Method r)))
-&gt; StateT DrasilState Identity (Maybe (MS (r (Method r))))
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe (MS (r (Method r)))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-100"></span><span>        </span><span class="annot"><a href="#local-6989586621679364240"><span class="hs-identifier hs-var">mainFunc</span></a></span><span> </span><span class="annot"><span class="annottext">ImplementationType
</span><a href="Language.Drasil.Choices.html#Program"><span class="hs-identifier hs-var">Program</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-101"></span><span>          </span><span class="annot"><span class="annottext">(DrasilState -&gt; DrasilState) -&gt; StateT DrasilState Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679364243"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679364243"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679364243"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#currentScope"><span class="hs-identifier hs-var">currentScope</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#MainFn"><span class="hs-identifier hs-type">MainFn</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>          </span><span id="local-6989586621679364246"><span class="annot"><span class="annottext">VS (r (Variable r))
</span><a href="#local-6989586621679364246"><span class="hs-identifier hs-var">v_filename</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeVarChunk -&gt; StateT DrasilState Identity (VS (r (Variable r)))
forall (r :: * -&gt; *).
OOProg r =&gt;
CodeVarChunk -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DefinedQuantityDict -&gt; CodeVarChunk
forall c.
(Quantity c, MayHaveUnit c, Concept c) =&gt;
c -&gt; CodeVarChunk
</span><a href="Language.Drasil.Chunk.CodeBase.html#quantvar"><span class="hs-identifier hs-var">quantvar</span></a></span><span> </span><span class="annot"><span class="annottext">DefinedQuantityDict
</span><a href="Language.Drasil.Code.CodeQuantityDicts.html#inFileName"><span class="hs-identifier hs-var">inFileName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>          </span><span id="local-6989586621679364247"><span class="annot"><span class="annottext">[MS (r (Statement r))]
</span><a href="#local-6989586621679364247"><span class="hs-identifier hs-var">logInFile</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
-&gt; StateT DrasilState Identity [MS (r (Statement r))]
forall (r :: * -&gt; *).
SharedProg r =&gt;
SVariable r -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Logging.html#maybeLog"><span class="hs-identifier hs-var">maybeLog</span></a></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
</span><a href="#local-6989586621679364246"><span class="hs-identifier hs-var">v_filename</span></a></span><span>
</span><span id="line-104"></span><span>          </span><span id="local-6989586621679364248"><span class="annot"><span class="annottext">Maybe (MS (r (Statement r)))
</span><a href="#local-6989586621679364248"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenState (Maybe (MS (r (Statement r))))
forall (r :: * -&gt; *). OOProg r =&gt; GenState (Maybe (MSStatement r))
</span><a href="Language.Drasil.Code.Imperative.Modules.html#initConsts"><span class="hs-identifier hs-var">initConsts</span></a></span><span>
</span><span id="line-105"></span><span>          </span><span id="local-6989586621679364250"><span class="annot"><span class="annottext">Maybe (MS (r (Statement r)))
</span><a href="#local-6989586621679364250"><span class="hs-identifier hs-var">ip</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenState (Maybe (MS (r (Statement r))))
forall (r :: * -&gt; *). OOProg r =&gt; GenState (Maybe (MSStatement r))
</span><a href="Language.Drasil.Code.Imperative.Modules.html#getInputDecl"><span class="hs-identifier hs-var">getInputDecl</span></a></span><span>
</span><span id="line-106"></span><span>          </span><span id="local-6989586621679364252"><span class="annot"><span class="annottext">[MS (r (Statement r))]
</span><a href="#local-6989586621679364252"><span class="hs-identifier hs-var">ics</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity [MS (r (Statement r))]
forall (r :: * -&gt; *). OOProg r =&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.FunctionCalls.html#genAllInputCalls"><span class="hs-identifier hs-var">genAllInputCalls</span></a></span><span>
</span><span id="line-107"></span><span>          </span><span id="local-6989586621679364253"><span class="annot"><span class="annottext">[Maybe (MS (r (Statement r)))]
</span><a href="#local-6989586621679364253"><span class="hs-identifier hs-var">varDef</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(CodeDefinition -&gt; GenState (Maybe (MS (r (Statement r)))))
-&gt; [CodeDefinition]
-&gt; StateT DrasilState Identity [Maybe (MS (r (Statement r)))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">CodeDefinition -&gt; GenState (Maybe (MS (r (Statement r))))
forall (r :: * -&gt; *).
OOProg r =&gt;
CodeDefinition -&gt; GenState (Maybe (MSStatement r))
</span><a href="Language.Drasil.Code.Imperative.FunctionCalls.html#genCalcCall"><span class="hs-identifier hs-var">genCalcCall</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; CodeSpec
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#codeSpec"><span class="hs-identifier hs-var">codeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679363702"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">CodeSpec
-&gt; Getting [CodeDefinition] CodeSpec [CodeDefinition]
-&gt; [CodeDefinition]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting [CodeDefinition] CodeSpec [CodeDefinition]
forall c. HasOldCodeSpec c =&gt; Lens' c [CodeDefinition]
Lens' CodeSpec [CodeDefinition]
</span><a href="Language.Drasil.CodeSpec.html#execOrderO"><span class="hs-identifier hs-var">execOrderO</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span>          </span><span id="local-6989586621679364257"><span class="annot"><span class="annottext">Maybe (MS (r (Statement r)))
</span><a href="#local-6989586621679364257"><span class="hs-identifier hs-var">wo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenState (Maybe (MS (r (Statement r))))
forall (r :: * -&gt; *). OOProg r =&gt; GenState (Maybe (MSStatement r))
</span><a href="Language.Drasil.Code.Imperative.FunctionCalls.html#genOutputCall"><span class="hs-identifier hs-var">genOutputCall</span></a></span><span>
</span><span id="line-109"></span><span>          </span><span class="annot"><span class="annottext">Maybe (MS (r (Method r)))
-&gt; StateT DrasilState Identity (Maybe (MS (r (Method r))))
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (MS (r (Method r)))
 -&gt; StateT DrasilState Identity (Maybe (MS (r (Method r)))))
-&gt; Maybe (MS (r (Method r)))
-&gt; StateT DrasilState Identity (Maybe (MS (r (Method r))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MS (r (Method r)) -&gt; Maybe (MS (r (Method r)))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(MS (r (Method r)) -&gt; Maybe (MS (r (Method r))))
-&gt; MS (r (Method r)) -&gt; Maybe (MS (r (Method r)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Comments
</span><a href="Language.Drasil.Choices.html#CommentFunc"><span class="hs-identifier hs-var">CommentFunc</span></a></span><span> </span><span class="annot"><span class="annottext">Comments -&gt; [Comments] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; [Comments]
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#commented"><span class="hs-identifier hs-var">commented</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679363702"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">MS (r (Body r)) -&gt; MS (r (Method r))
forall (r :: * -&gt; *). MethodSym r =&gt; MSBody r -&gt; SMethod r
</span><span class="hs-identifier hs-var">docMain</span></span><span> </span><span class="hs-keyword">else</span><span>
</span><span id="line-110"></span><span>            </span><span class="annot"><span class="annottext">MS (r (Body r)) -&gt; MS (r (Method r))
forall (r :: * -&gt; *). MethodSym r =&gt; MSBody r -&gt; SMethod r
</span><span class="hs-identifier hs-var">mainFunction</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(MS (r (Body r)) -&gt; MS (r (Method r)))
-&gt; MS (r (Body r)) -&gt; MS (r (Method r))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[MS (r (Statement r))] -&gt; MS (r (Body r))
forall (r :: * -&gt; *). BodySym r =&gt; [MSStatement r] -&gt; MSBody r
</span><span class="hs-identifier hs-var">bodyStatements</span></span><span> </span><span class="annot"><span class="annottext">([MS (r (Statement r))] -&gt; MS (r (Body r)))
-&gt; [MS (r (Statement r))] -&gt; MS (r (Body r))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Logging] -&gt; r (Scope r) -&gt; [MS (r (Statement r))]
forall (r :: * -&gt; *).
SharedProg r =&gt;
[Logging] -&gt; r (Scope r) -&gt; [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Modules.html#initLogFileVar"><span class="hs-identifier hs-var">initLogFileVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; [Logging]
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#logKind"><span class="hs-identifier hs-var">logKind</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679363702"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">r (Scope r)
forall (r :: * -&gt; *). ScopeSym r =&gt; r (Scope r)
</span><span class="hs-identifier hs-var">mainFn</span></span><span>
</span><span id="line-111"></span><span>            </span><span class="annot"><span class="annottext">[MS (r (Statement r))]
-&gt; [MS (r (Statement r))] -&gt; [MS (r (Statement r))]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
-&gt; r (Scope r) -&gt; SValue r -&gt; MS (r (Statement r))
forall (r :: * -&gt; *).
DeclStatement r =&gt;
SVariable r -&gt; r (Scope r) -&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">varDecDef</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
</span><a href="#local-6989586621679364246"><span class="hs-identifier hs-var">v_filename</span></a></span><span> </span><span class="annot"><span class="annottext">r (Scope r)
forall (r :: * -&gt; *). ScopeSym r =&gt; r (Scope r)
</span><span class="hs-identifier hs-var">mainFn</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; SValue r
forall (r :: * -&gt; *). CommandLineArgs r =&gt; Integer -&gt; SValue r
</span><span class="hs-identifier hs-var">arg</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>            </span><span class="annot"><span class="annottext">MS (r (Statement r))
-&gt; [MS (r (Statement r))] -&gt; [MS (r (Statement r))]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[MS (r (Statement r))]
</span><a href="#local-6989586621679364247"><span class="hs-identifier hs-var">logInFile</span></a></span><span>
</span><span id="line-113"></span><span>            </span><span class="hs-comment">-- Constants must be declared before inputs because some derived</span><span>
</span><span id="line-114"></span><span>            </span><span class="hs-comment">-- input definitions or input constraints may use the constants</span><span>
</span><span id="line-115"></span><span>            </span><span class="annot"><span class="annottext">[MS (r (Statement r))]
-&gt; [MS (r (Statement r))] -&gt; [MS (r (Statement r))]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Maybe (MS (r (Statement r)))] -&gt; [MS (r (Statement r))]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Maybe (MS (r (Statement r)))
</span><a href="#local-6989586621679364248"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe (MS (r (Statement r)))
</span><a href="#local-6989586621679364250"><span class="hs-identifier hs-var">ip</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[MS (r (Statement r))]
-&gt; [MS (r (Statement r))] -&gt; [MS (r (Statement r))]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[MS (r (Statement r))]
</span><a href="#local-6989586621679364252"><span class="hs-identifier hs-var">ics</span></a></span><span> </span><span class="annot"><span class="annottext">[MS (r (Statement r))]
-&gt; [MS (r (Statement r))] -&gt; [MS (r (Statement r))]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Maybe (MS (r (Statement r)))] -&gt; [MS (r (Statement r))]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Maybe (MS (r (Statement r)))]
</span><a href="#local-6989586621679364253"><span class="hs-identifier hs-var">varDef</span></a></span><span> </span><span class="annot"><span class="annottext">[Maybe (MS (r (Statement r)))]
-&gt; [Maybe (MS (r (Statement r)))] -&gt; [Maybe (MS (r (Statement r)))]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Maybe (MS (r (Statement r)))
</span><a href="#local-6989586621679364257"><span class="hs-identifier hs-var">wo</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>    </span><span class="annot"><span class="annottext">ImplementationType -&gt; GenState (Maybe (SMethod r))
forall {r :: * -&gt; *}.
OOProg r =&gt;
ImplementationType
-&gt; StateT DrasilState Identity (Maybe (MS (r (Method r))))
</span><a href="#local-6989586621679364240"><span class="hs-identifier hs-var">mainFunc</span></a></span><span> </span><span class="annot"><span class="annottext">(ImplementationType -&gt; GenState (Maybe (SMethod r)))
-&gt; ImplementationType -&gt; GenState (Maybe (SMethod r))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; ImplementationType
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#implType"><span class="hs-identifier hs-var">implType</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679363702"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span class="hs-comment">-- | If there are no inputs, the 'inParams' object still needs to be declared</span><span>
</span><span id="line-119"></span><span class="hs-comment">-- if inputs are 'Bundled', constants are stored 'WithInputs', and constant</span><span>
</span><span id="line-120"></span><span class="hs-comment">-- representation is 'Var'.</span><span>
</span><span id="line-121"></span><span class="hs-comment">-- If there are inputs and they are not exported by any module, then they are</span><span>
</span><span id="line-122"></span><span class="hs-comment">-- 'Unbundled' and are declared individually using 'varDec'.</span><span>
</span><span id="line-123"></span><span class="hs-comment">-- If there are inputs and they are exported by a module, they are 'Bundled' in</span><span>
</span><span id="line-124"></span><span class="hs-comment">-- the InputParameters class, so 'inParams' should be declared and constructed,</span><span>
</span><span id="line-125"></span><span class="hs-comment">-- using 'objDecNew' if the inputs are exported by the current module, and</span><span>
</span><span id="line-126"></span><span class="hs-comment">-- 'extObjDecNew' if they are exported by a different module.</span><span>
</span><span id="line-127"></span><span id="local-6989586621679364276"><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#getInputDecl"><span class="hs-identifier hs-type">getInputDecl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679364276"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MSStatement</span></span><span> </span><span class="annot"><a href="#local-6989586621679364276"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-128"></span><span id="getInputDecl"><span class="annot"><span class="annottext">getInputDecl :: forall (r :: * -&gt; *). OOProg r =&gt; GenState (Maybe (MSStatement r))
</span><a href="Language.Drasil.Code.Imperative.Modules.html#getInputDecl"><span class="hs-identifier hs-var hs-var">getInputDecl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-129"></span><span>  </span><span id="local-6989586621679364356"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679364356"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-130"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679364485"><span class="annot"><span class="annottext">scp :: r (Scope r)
</span><a href="#local-6989586621679364485"><span class="hs-identifier hs-var hs-var">scp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScopeType -&gt; r (Scope r)
forall (r :: * -&gt; *). SharedProg r =&gt; ScopeType -&gt; r (Scope r)
</span><a href="Language.Drasil.Code.Imperative.Helpers.html#convScope"><span class="hs-identifier hs-var">convScope</span></a></span><span> </span><span class="annot"><span class="annottext">(ScopeType -&gt; r (Scope r)) -&gt; ScopeType -&gt; r (Scope r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; ScopeType
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#currentScope"><span class="hs-identifier hs-var">currentScope</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679364356"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-131"></span><span>  </span><span id="local-6989586621679364486"><span class="annot"><span class="annottext">VS (r (Variable r))
</span><a href="#local-6989586621679364486"><span class="hs-identifier hs-var">v_params</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeVarChunk -&gt; StateT DrasilState Identity (VS (r (Variable r)))
forall (r :: * -&gt; *).
OOProg r =&gt;
CodeVarChunk -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DefinedQuantityDict -&gt; CodeVarChunk
forall c.
(Quantity c, MayHaveUnit c, Concept c) =&gt;
c -&gt; CodeVarChunk
</span><a href="Language.Drasil.Chunk.CodeBase.html#quantvar"><span class="hs-identifier hs-var">quantvar</span></a></span><span> </span><span class="annot"><span class="annottext">DefinedQuantityDict
</span><a href="Language.Drasil.Code.CodeQuantityDicts.html#inParams"><span class="hs-identifier hs-var">inParams</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>  </span><span id="local-6989586621679364487"><span class="annot"><span class="annottext">[CodeVarChunk]
</span><a href="#local-6989586621679364487"><span class="hs-identifier hs-var">constrParams</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenState [CodeVarChunk]
</span><a href="Language.Drasil.Code.Imperative.Parameters.html#getInConstructorParams"><span class="hs-identifier hs-var">getInConstructorParams</span></a></span><span>
</span><span id="line-133"></span><span>  </span><span id="local-6989586621679364488"><span class="annot"><span class="annottext">[VS (r (Value r))]
</span><a href="#local-6989586621679364488"><span class="hs-identifier hs-var">cps</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(CodeVarChunk -&gt; StateT DrasilState Identity (VS (r (Value r))))
-&gt; [CodeVarChunk] -&gt; StateT DrasilState Identity [VS (r (Value r))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">CodeVarChunk -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *).
OOProg r =&gt;
CodeVarChunk -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVal"><span class="hs-identifier hs-var">mkVal</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeVarChunk]
</span><a href="#local-6989586621679364487"><span class="hs-identifier hs-var">constrParams</span></a></span><span>
</span><span id="line-134"></span><span>  </span><span id="local-6989586621679364489"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679364489"><span class="hs-identifier hs-var">cname</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">InternalConcept -&gt; GenState String
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#genICName"><span class="hs-identifier hs-var">genICName</span></a></span><span> </span><span class="annot"><span class="annottext">InternalConcept
</span><a href="Language.Drasil.Choices.html#InputParameters"><span class="hs-identifier hs-var">InputParameters</span></a></span><span>
</span><span id="line-135"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679364771"><span class="annot"><span class="annottext">getDecl :: ([CodeVarChunk], [CodeVarChunk])
-&gt; GenState (Maybe (MSStatement r))
</span><a href="#local-6989586621679364771"><span class="hs-identifier hs-var hs-var">getDecl</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([CodeVarChunk], [CodeVarChunk])
-&gt; ConstantRepr
-&gt; ConstantStructure
-&gt; GenState (Maybe (MSStatement r))
</span><a href="#local-6989586621679364772"><span class="hs-identifier hs-var">constIns</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CodeVarChunk -&gt; Bool)
-&gt; [CodeVarChunk] -&gt; ([CodeVarChunk], [CodeVarChunk])
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">partition</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(String -&gt; Map String String -&gt; Bool)
-&gt; Map String String -&gt; String -&gt; Bool
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Map String String -&gt; Bool
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Bool
</span><span class="hs-identifier hs-var">member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; Map String String
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#eMap"><span class="hs-identifier hs-var">eMap</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679364356"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(String -&gt; Bool)
-&gt; (CodeVarChunk -&gt; String) -&gt; CodeVarChunk -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-136"></span><span>        </span><span class="annot"><span class="annottext">CodeVarChunk -&gt; String
forall c. CodeIdea c =&gt; c -&gt; String
</span><span class="hs-identifier hs-var">codeName</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CodeDefinition -&gt; CodeVarChunk)
-&gt; [CodeDefinition] -&gt; [CodeVarChunk]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">CodeDefinition -&gt; CodeVarChunk
forall c.
(Quantity c, MayHaveUnit c, Concept c) =&gt;
c -&gt; CodeVarChunk
</span><a href="Language.Drasil.Chunk.CodeBase.html#quantvar"><span class="hs-identifier hs-var">quantvar</span></a></span><span> </span><span class="annot"><span class="annottext">([CodeDefinition] -&gt; [CodeVarChunk])
-&gt; [CodeDefinition] -&gt; [CodeVarChunk]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; CodeSpec
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#codeSpec"><span class="hs-identifier hs-var">codeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679364356"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">CodeSpec
-&gt; Getting [CodeDefinition] CodeSpec [CodeDefinition]
-&gt; [CodeDefinition]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting [CodeDefinition] CodeSpec [CodeDefinition]
forall c. HasOldCodeSpec c =&gt; Lens' c [CodeDefinition]
Lens' CodeSpec [CodeDefinition]
</span><a href="Language.Drasil.CodeSpec.html#constantsO"><span class="hs-identifier hs-var">constantsO</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; ConstantRepr
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#conRepr"><span class="hs-identifier hs-var">conRepr</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679364356"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; ConstantStructure
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#conStruct"><span class="hs-identifier hs-var">conStruct</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679364356"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>      </span><span class="annot"><a href="#local-6989586621679364771"><span class="hs-identifier hs-var">getDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span id="local-6989586621679364779"><span class="annot"><span class="annottext">[CodeVarChunk]
</span><a href="#local-6989586621679364779"><span class="hs-identifier hs-var">ins</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-139"></span><span>        </span><span id="local-6989586621679364780"><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679364780"><span class="hs-identifier hs-var">vars</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(CodeVarChunk -&gt; StateT DrasilState Identity (VS (r (Variable r))))
-&gt; [CodeVarChunk]
-&gt; StateT DrasilState Identity [VS (r (Variable r))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">CodeVarChunk -&gt; StateT DrasilState Identity (VS (r (Variable r)))
forall (r :: * -&gt; *).
OOProg r =&gt;
CodeVarChunk -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeVarChunk]
</span><a href="#local-6989586621679364779"><span class="hs-identifier hs-var">ins</span></a></span><span>
</span><span id="line-140"></span><span>        </span><span class="annot"><span class="annottext">Maybe (MSStatement r) -&gt; GenState (Maybe (MSStatement r))
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (MSStatement r) -&gt; GenState (Maybe (MSStatement r)))
-&gt; Maybe (MSStatement r) -&gt; GenState (Maybe (MSStatement r))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MSStatement r -&gt; Maybe (MSStatement r)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; Maybe (MSStatement r))
-&gt; MSStatement r -&gt; Maybe (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSStatement r
forall (r :: * -&gt; *).
StatementSym r =&gt;
[MSStatement r] -&gt; MSStatement r
</span><span class="hs-identifier hs-var">multi</span></span><span> </span><span class="annot"><span class="annottext">([MSStatement r] -&gt; MSStatement r)
-&gt; [MSStatement r] -&gt; MSStatement r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(VS (r (Variable r)) -&gt; MSStatement r)
-&gt; [VS (r (Variable r))] -&gt; [MSStatement r]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VS (r (Variable r)) -&gt; r (Scope r) -&gt; MSStatement r
forall (r :: * -&gt; *).
DeclStatement r =&gt;
SVariable r -&gt; r (Scope r) -&gt; MSStatement r
</span><span class="hs-operator hs-var">`varDec`</span></span><span> </span><span class="annot"><span class="annottext">r (Scope r)
</span><a href="#local-6989586621679364485"><span class="hs-identifier hs-var">scp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679364780"><span class="hs-identifier hs-var">vars</span></a></span><span>
</span><span id="line-141"></span><span>      </span><span class="annot"><a href="#local-6989586621679364771"><span class="hs-identifier hs-var">getDecl</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679364782"><span class="annot"><span class="annottext">CodeVarChunk
</span><a href="#local-6989586621679364782"><span class="hs-identifier hs-var">i</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[CodeVarChunk]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (MSStatement r) -&gt; GenState (Maybe (MSStatement r))
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (MSStatement r) -&gt; GenState (Maybe (MSStatement r)))
-&gt; Maybe (MSStatement r) -&gt; GenState (Maybe (MSStatement r))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MSStatement r -&gt; Maybe (MSStatement r)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; Maybe (MSStatement r))
-&gt; MSStatement r -&gt; Maybe (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; String
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#currentModule"><span class="hs-identifier hs-var">currentModule</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679364356"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span>
</span><span id="line-142"></span><span>        </span><span class="annot"><span class="annottext">DrasilState -&gt; Map String String
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#eMap"><span class="hs-identifier hs-var">eMap</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679364356"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Map String String -&gt; String -&gt; String
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="annot"><span class="annottext">CodeVarChunk -&gt; String
forall c. CodeIdea c =&gt; c -&gt; String
</span><span class="hs-identifier hs-var">codeName</span></span><span> </span><span class="annot"><span class="annottext">CodeVarChunk
</span><a href="#local-6989586621679364782"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
-&gt; r (Scope r) -&gt; [VS (r (Value r))] -&gt; MSStatement r
forall (r :: * -&gt; *).
OODeclStatement r =&gt;
SVariable r -&gt; r (Scope r) -&gt; [SValue r] -&gt; MSStatement r
</span><span class="hs-identifier hs-var">objDecNew</span></span><span>
</span><span id="line-143"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String
-&gt; VS (r (Variable r))
-&gt; r (Scope r)
-&gt; [VS (r (Value r))]
-&gt; MSStatement r
forall (r :: * -&gt; *).
OODeclStatement r =&gt;
String -&gt; SVariable r -&gt; r (Scope r) -&gt; [SValue r] -&gt; MSStatement r
</span><span class="hs-identifier hs-var">extObjDecNew</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679364489"><span class="hs-identifier hs-var">cname</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
</span><a href="#local-6989586621679364486"><span class="hs-identifier hs-var">v_params</span></a></span><span> </span><span class="annot"><span class="annottext">r (Scope r)
</span><a href="#local-6989586621679364485"><span class="hs-identifier hs-var">scp</span></a></span><span> </span><span class="annot"><span class="annottext">[VS (r (Value r))]
</span><a href="#local-6989586621679364488"><span class="hs-identifier hs-var">cps</span></a></span><span>
</span><span id="line-144"></span><span>      </span><span class="annot"><a href="#local-6989586621679364771"><span class="hs-identifier hs-var">getDecl</span></a></span><span> </span><span class="annot"><span class="annottext">([CodeVarChunk], [CodeVarChunk])
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; GenState (Maybe (MSStatement r))
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Inputs or constants are only partially contained in &quot;</span></span><span>
</span><span id="line-145"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;a class&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-146"></span><span>      </span><span id="local-6989586621679364772"><span class="annot"><span class="annottext">constIns :: ([CodeVarChunk], [CodeVarChunk])
-&gt; ConstantRepr
-&gt; ConstantStructure
-&gt; GenState (Maybe (MSStatement r))
</span><a href="#local-6989586621679364772"><span class="hs-identifier hs-var hs-var">constIns</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ConstantRepr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ConstantStructure
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (MSStatement r) -&gt; GenState (Maybe (MSStatement r))
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe (MSStatement r)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-147"></span><span>      </span><span class="hs-comment">-- If Const is chosen, don't declare an object because constants are static and accessed through class</span><span>
</span><span id="line-148"></span><span>      </span><span class="annot"><a href="#local-6989586621679364772"><span class="hs-identifier hs-var">constIns</span></a></span><span> </span><span id="local-6989586621679364785"><span class="annot"><span class="annottext">([CodeVarChunk], [CodeVarChunk])
</span><a href="#local-6989586621679364785"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="annot"><span class="annottext">ConstantRepr
</span><a href="Language.Drasil.Choices.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">ConstantStructure
</span><a href="Language.Drasil.Choices.html#WithInputs"><span class="hs-identifier hs-var">WithInputs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([CodeVarChunk], [CodeVarChunk])
-&gt; GenState (Maybe (MSStatement r))
</span><a href="#local-6989586621679364771"><span class="hs-identifier hs-var">getDecl</span></a></span><span> </span><span class="annot"><span class="annottext">([CodeVarChunk], [CodeVarChunk])
</span><a href="#local-6989586621679364785"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-149"></span><span>      </span><span class="annot"><a href="#local-6989586621679364772"><span class="hs-identifier hs-var">constIns</span></a></span><span> </span><span class="annot"><span class="annottext">([CodeVarChunk], [CodeVarChunk])
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ConstantRepr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ConstantStructure
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (MSStatement r) -&gt; GenState (Maybe (MSStatement r))
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe (MSStatement r)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-150"></span><span>  </span><span class="annot"><span class="annottext">([CodeVarChunk], [CodeVarChunk])
-&gt; GenState (Maybe (MSStatement r))
</span><a href="#local-6989586621679364771"><span class="hs-identifier hs-var">getDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CodeVarChunk -&gt; Bool)
-&gt; [CodeVarChunk] -&gt; ([CodeVarChunk], [CodeVarChunk])
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">partition</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(String -&gt; Map String String -&gt; Bool)
-&gt; Map String String -&gt; String -&gt; Bool
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Map String String -&gt; Bool
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Bool
</span><span class="hs-identifier hs-var">member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; Map String String
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#eMap"><span class="hs-identifier hs-var">eMap</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679364356"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(String -&gt; Bool)
-&gt; (CodeVarChunk -&gt; String) -&gt; CodeVarChunk -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CodeVarChunk -&gt; String
forall c. CodeIdea c =&gt; c -&gt; String
</span><span class="hs-identifier hs-var">codeName</span></span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; CodeSpec
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#codeSpec"><span class="hs-identifier hs-var">codeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679364356"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">CodeSpec
-&gt; Getting [CodeVarChunk] CodeSpec [CodeVarChunk] -&gt; [CodeVarChunk]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting [CodeVarChunk] CodeSpec [CodeVarChunk]
forall c. HasOldCodeSpec c =&gt; Lens' c [CodeVarChunk]
Lens' CodeSpec [CodeVarChunk]
</span><a href="Language.Drasil.CodeSpec.html#inputsO"><span class="hs-identifier hs-var">inputsO</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span class="hs-comment">-- | If constants are 'Unbundled', declare them individually using 'varDecDef' if</span><span>
</span><span id="line-154"></span><span class="hs-comment">-- representation is 'Var' and 'constDecDef' if representation is 'Const'.</span><span>
</span><span id="line-155"></span><span class="hs-comment">-- If constants are 'Bundled' independently and representation is 'Var', declare</span><span>
</span><span id="line-156"></span><span class="hs-comment">-- the consts object. If representation is 'Const', no object needs to be</span><span>
</span><span id="line-157"></span><span class="hs-comment">-- declared because the constants will be accessed directly through the</span><span>
</span><span id="line-158"></span><span class="hs-comment">-- Constants class.</span><span>
</span><span id="line-159"></span><span class="hs-comment">-- If constants are 'Bundled' 'WithInputs', do 'Nothing'; declaration of the 'inParams'</span><span>
</span><span id="line-160"></span><span class="hs-comment">-- object is handled by 'getInputDecl'.</span><span>
</span><span id="line-161"></span><span class="hs-comment">-- If constants are 'Inlined', nothing needs to be declared.</span><span>
</span><span id="line-162"></span><span id="local-6989586621679363196"><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#initConsts"><span class="hs-identifier hs-type">initConsts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679363196"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MSStatement</span></span><span> </span><span class="annot"><a href="#local-6989586621679363196"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-163"></span><span id="initConsts"><span class="annot"><span class="annottext">initConsts :: forall (r :: * -&gt; *). OOProg r =&gt; GenState (Maybe (MSStatement r))
</span><a href="Language.Drasil.Code.Imperative.Modules.html#initConsts"><span class="hs-identifier hs-var hs-var">initConsts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-164"></span><span>  </span><span id="local-6989586621679364859"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679364859"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-165"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679364988"><span class="annot"><span class="annottext">scp :: r (Scope r)
</span><a href="#local-6989586621679364988"><span class="hs-identifier hs-var hs-var">scp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScopeType -&gt; r (Scope r)
forall (r :: * -&gt; *). SharedProg r =&gt; ScopeType -&gt; r (Scope r)
</span><a href="Language.Drasil.Code.Imperative.Helpers.html#convScope"><span class="hs-identifier hs-var">convScope</span></a></span><span> </span><span class="annot"><span class="annottext">(ScopeType -&gt; r (Scope r)) -&gt; ScopeType -&gt; r (Scope r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; ScopeType
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#currentScope"><span class="hs-identifier hs-var">currentScope</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679364859"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-166"></span><span>  </span><span id="local-6989586621679364989"><span class="annot"><span class="annottext">VS (r (Variable r))
</span><a href="#local-6989586621679364989"><span class="hs-identifier hs-var">v_consts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeVarChunk -&gt; StateT DrasilState Identity (VS (r (Variable r)))
forall (r :: * -&gt; *).
OOProg r =&gt;
CodeVarChunk -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DefinedQuantityDict -&gt; CodeVarChunk
forall c.
(Quantity c, MayHaveUnit c, Concept c) =&gt;
c -&gt; CodeVarChunk
</span><a href="Language.Drasil.Chunk.CodeBase.html#quantvar"><span class="hs-identifier hs-var">quantvar</span></a></span><span> </span><span class="annot"><span class="annottext">DefinedQuantityDict
</span><a href="Language.Drasil.Code.CodeQuantityDicts.html#consts"><span class="hs-identifier hs-var">consts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>  </span><span id="local-6989586621679364990"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679364990"><span class="hs-identifier hs-var">cname</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">InternalConcept -&gt; GenState String
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#genICName"><span class="hs-identifier hs-var">genICName</span></a></span><span> </span><span class="annot"><span class="annottext">InternalConcept
</span><a href="Language.Drasil.Choices.html#Constants"><span class="hs-identifier hs-var">Constants</span></a></span><span>
</span><span id="line-168"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679364994"><span class="annot"><span class="annottext">cs :: [CodeDefinition]
</span><a href="#local-6989586621679364994"><span class="hs-identifier hs-var hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; CodeSpec
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#codeSpec"><span class="hs-identifier hs-var">codeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679364859"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">CodeSpec
-&gt; Getting [CodeDefinition] CodeSpec [CodeDefinition]
-&gt; [CodeDefinition]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting [CodeDefinition] CodeSpec [CodeDefinition]
forall c. HasOldCodeSpec c =&gt; Lens' c [CodeDefinition]
Lens' CodeSpec [CodeDefinition]
</span><a href="Language.Drasil.CodeSpec.html#constantsO"><span class="hs-identifier hs-var">constantsO</span></a></span><span>
</span><span id="line-169"></span><span>      </span><span id="local-6989586621679365000"><span class="annot"><span class="annottext">getDecl :: ConstantStructure -&gt; Structure -&gt; GenState (Maybe (MSStatement r))
</span><a href="#local-6989586621679365000"><span class="hs-identifier hs-var hs-var">getDecl</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Choices.html#Store"><span class="hs-identifier hs-type">Store</span></a></span><span> </span><span class="annot"><span class="annottext">Structure
</span><a href="Language.Drasil.Choices.html#Unbundled"><span class="hs-identifier hs-var">Unbundled</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Structure
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenState (Maybe (MSStatement r))
</span><a href="#local-6989586621679365002"><span class="hs-identifier hs-var">declVars</span></a></span><span>
</span><span id="line-170"></span><span>      </span><span class="annot"><a href="#local-6989586621679365000"><span class="hs-identifier hs-var">getDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Choices.html#Store"><span class="hs-identifier hs-type">Store</span></a></span><span> </span><span class="annot"><span class="annottext">Structure
</span><a href="Language.Drasil.Choices.html#Bundled"><span class="hs-identifier hs-var">Bundled</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Structure
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DrasilState -&gt; Maybe (MSStatement r))
-&gt; GenState (Maybe (MSStatement r))
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[CodeDefinition] -&gt; ConstantRepr -&gt; Maybe (MSStatement r)
forall {c}.
CodeIdea c =&gt;
[c] -&gt; ConstantRepr -&gt; Maybe (MSStatement r)
</span><a href="#local-6989586621679365003"><span class="hs-identifier hs-var">declObj</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeDefinition]
</span><a href="#local-6989586621679364994"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">(ConstantRepr -&gt; Maybe (MSStatement r))
-&gt; (DrasilState -&gt; ConstantRepr)
-&gt; DrasilState
-&gt; Maybe (MSStatement r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; ConstantRepr
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#conRepr"><span class="hs-identifier hs-var">conRepr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>      </span><span class="annot"><a href="#local-6989586621679365000"><span class="hs-identifier hs-var">getDecl</span></a></span><span> </span><span class="annot"><span class="annottext">ConstantStructure
</span><a href="Language.Drasil.Choices.html#WithInputs"><span class="hs-identifier hs-var">WithInputs</span></a></span><span> </span><span class="annot"><span class="annottext">Structure
</span><a href="Language.Drasil.Choices.html#Unbundled"><span class="hs-identifier hs-var">Unbundled</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenState (Maybe (MSStatement r))
</span><a href="#local-6989586621679365002"><span class="hs-identifier hs-var">declVars</span></a></span><span>
</span><span id="line-172"></span><span>      </span><span class="annot"><a href="#local-6989586621679365000"><span class="hs-identifier hs-var">getDecl</span></a></span><span> </span><span class="annot"><span class="annottext">ConstantStructure
</span><a href="Language.Drasil.Choices.html#WithInputs"><span class="hs-identifier hs-var">WithInputs</span></a></span><span> </span><span class="annot"><span class="annottext">Structure
</span><a href="Language.Drasil.Choices.html#Bundled"><span class="hs-identifier hs-var">Bundled</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (MSStatement r) -&gt; GenState (Maybe (MSStatement r))
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe (MSStatement r)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-173"></span><span>      </span><span class="annot"><a href="#local-6989586621679365000"><span class="hs-identifier hs-var">getDecl</span></a></span><span> </span><span class="annot"><span class="annottext">ConstantStructure
</span><a href="Language.Drasil.Choices.html#Inline"><span class="hs-identifier hs-var">Inline</span></a></span><span> </span><span class="annot"><span class="annottext">Structure
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (MSStatement r) -&gt; GenState (Maybe (MSStatement r))
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe (MSStatement r)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-174"></span><span>      </span><span id="local-6989586621679365002"><span class="annot"><span class="annottext">declVars :: GenState (Maybe (MSStatement r))
</span><a href="#local-6989586621679365002"><span class="hs-identifier hs-var hs-var">declVars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-175"></span><span>        </span><span id="local-6989586621679365391"><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679365391"><span class="hs-identifier hs-var">vars</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(CodeDefinition
 -&gt; StateT DrasilState Identity (VS (r (Variable r))))
-&gt; [CodeDefinition]
-&gt; StateT DrasilState Identity [VS (r (Variable r))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeVarChunk -&gt; StateT DrasilState Identity (VS (r (Variable r)))
forall (r :: * -&gt; *).
OOProg r =&gt;
CodeVarChunk -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="annot"><span class="annottext">(CodeVarChunk -&gt; StateT DrasilState Identity (VS (r (Variable r))))
-&gt; (CodeDefinition -&gt; CodeVarChunk)
-&gt; CodeDefinition
-&gt; StateT DrasilState Identity (VS (r (Variable r)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CodeDefinition -&gt; CodeVarChunk
forall c.
(Quantity c, MayHaveUnit c, Concept c) =&gt;
c -&gt; CodeVarChunk
</span><a href="Language.Drasil.Chunk.CodeBase.html#quantvar"><span class="hs-identifier hs-var">quantvar</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CodeDefinition]
</span><a href="#local-6989586621679364994"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-176"></span><span>        </span><span id="local-6989586621679365392"><span class="annot"><span class="annottext">[VS (r (Value r))]
</span><a href="#local-6989586621679365392"><span class="hs-identifier hs-var">vals</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(CodeDefinition -&gt; StateT DrasilState Identity (VS (r (Value r))))
-&gt; [CodeDefinition]
-&gt; StateT DrasilState Identity [VS (r (Value r))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">(CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r))))
-&gt; (CodeDefinition -&gt; CodeExpr)
-&gt; CodeDefinition
-&gt; StateT DrasilState Identity (VS (r (Value r)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeDefinition
-&gt; Getting CodeExpr CodeDefinition CodeExpr -&gt; CodeExpr
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting CodeExpr CodeDefinition CodeExpr
forall c. DefiningCodeExpr c =&gt; Lens' c CodeExpr
Lens' CodeDefinition CodeExpr
</span><span class="hs-identifier hs-var">codeExpr</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CodeDefinition]
</span><a href="#local-6989586621679364994"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-177"></span><span>        </span><span id="local-6989586621679365394"><span class="annot"><span class="annottext">[[MSStatement r]]
</span><a href="#local-6989586621679365394"><span class="hs-identifier hs-var">logs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(VS (r (Variable r))
 -&gt; StateT DrasilState Identity [MSStatement r])
-&gt; [VS (r (Variable r))]
-&gt; StateT DrasilState Identity [[MSStatement r]]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r)) -&gt; StateT DrasilState Identity [MSStatement r]
forall (r :: * -&gt; *).
SharedProg r =&gt;
SVariable r -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Logging.html#maybeLog"><span class="hs-identifier hs-var">maybeLog</span></a></span><span> </span><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679365391"><span class="hs-identifier hs-var">vars</span></a></span><span>
</span><span id="line-178"></span><span>        </span><span class="annot"><span class="annottext">Maybe (MSStatement r) -&gt; GenState (Maybe (MSStatement r))
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (MSStatement r) -&gt; GenState (Maybe (MSStatement r)))
-&gt; Maybe (MSStatement r) -&gt; GenState (Maybe (MSStatement r))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MSStatement r -&gt; Maybe (MSStatement r)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; Maybe (MSStatement r))
-&gt; MSStatement r -&gt; Maybe (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSStatement r
forall (r :: * -&gt; *).
StatementSym r =&gt;
[MSStatement r] -&gt; MSStatement r
</span><span class="hs-identifier hs-var">multi</span></span><span> </span><span class="annot"><span class="annottext">([MSStatement r] -&gt; MSStatement r)
-&gt; [MSStatement r] -&gt; MSStatement r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-179"></span><span>          </span><span class="annot"><span class="annottext">(VS (r (Variable r)) -&gt; VS (r (Value r)) -&gt; MSStatement r)
-&gt; [VS (r (Variable r))] -&gt; [VS (r (Value r))] -&gt; [MSStatement r]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679365396"><span class="annot"><span class="annottext">VS (r (Variable r))
</span><a href="#local-6989586621679365396"><span class="hs-identifier hs-var">vr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ConstantRepr
-&gt; VS (r (Variable r))
-&gt; r (Scope r)
-&gt; VS (r (Value r))
-&gt; MSStatement r
forall {r :: * -&gt; *}.
DeclStatement r =&gt;
ConstantRepr
-&gt; VS (r (Variable r))
-&gt; r (Scope r)
-&gt; VS (r (Value r))
-&gt; MS (r (Statement r))
</span><a href="#local-6989586621679365397"><span class="hs-identifier hs-var">defFunc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; ConstantRepr
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#conRepr"><span class="hs-identifier hs-var">conRepr</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679364859"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
</span><a href="#local-6989586621679365396"><span class="hs-identifier hs-var">vr</span></a></span><span> </span><span class="annot"><span class="annottext">r (Scope r)
</span><a href="#local-6989586621679364988"><span class="hs-identifier hs-var">scp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679365391"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="annot"><span class="annottext">[VS (r (Value r))]
</span><a href="#local-6989586621679365392"><span class="hs-identifier hs-var">vals</span></a></span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; [MSStatement r] -&gt; [MSStatement r]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[[MSStatement r]] -&gt; [MSStatement r]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">[[MSStatement r]]
</span><a href="#local-6989586621679365394"><span class="hs-identifier hs-var">logs</span></a></span><span>
</span><span id="line-180"></span><span>      </span><span id="local-6989586621679365397"><span class="annot"><span class="annottext">defFunc :: ConstantRepr
-&gt; VS (r (Variable r))
-&gt; r (Scope r)
-&gt; VS (r (Value r))
-&gt; MS (r (Statement r))
</span><a href="#local-6989586621679365397"><span class="hs-identifier hs-var hs-var">defFunc</span></a></span></span><span> </span><span class="annot"><span class="annottext">ConstantRepr
</span><a href="Language.Drasil.Choices.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
-&gt; r (Scope r) -&gt; VS (r (Value r)) -&gt; MS (r (Statement r))
forall (r :: * -&gt; *).
DeclStatement r =&gt;
SVariable r -&gt; r (Scope r) -&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">varDecDef</span></span><span>
</span><span id="line-181"></span><span>      </span><span class="annot"><a href="#local-6989586621679365397"><span class="hs-identifier hs-var">defFunc</span></a></span><span> </span><span class="annot"><span class="annottext">ConstantRepr
</span><a href="Language.Drasil.Choices.html#Const"><span class="hs-identifier hs-var">Const</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
-&gt; r (Scope r) -&gt; VS (r (Value r)) -&gt; MS (r (Statement r))
forall (r :: * -&gt; *).
DeclStatement r =&gt;
SVariable r -&gt; r (Scope r) -&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">constDecDef</span></span><span>
</span><span id="line-182"></span><span>      </span><span id="local-6989586621679365003"><span class="annot"><span class="annottext">declObj :: [c] -&gt; ConstantRepr -&gt; Maybe (MSStatement r)
</span><a href="#local-6989586621679365003"><span class="hs-identifier hs-var hs-var">declObj</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">ConstantRepr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (MSStatement r)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-183"></span><span>      </span><span class="annot"><a href="#local-6989586621679365003"><span class="hs-identifier hs-var">declObj</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679365438"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679365438"><span class="hs-identifier hs-var">c</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[c]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ConstantRepr
</span><a href="Language.Drasil.Choices.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MSStatement r -&gt; Maybe (MSStatement r)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; Maybe (MSStatement r))
-&gt; MSStatement r -&gt; Maybe (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; String
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#currentModule"><span class="hs-identifier hs-var">currentModule</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679364859"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; Map String String
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#eMap"><span class="hs-identifier hs-var">eMap</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679364859"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Map String String -&gt; String -&gt; String
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="annot"><span class="annottext">c -&gt; String
forall c. CodeIdea c =&gt; c -&gt; String
</span><span class="hs-identifier hs-var">codeName</span></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679365438"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-184"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r)) -&gt; r (Scope r) -&gt; MSStatement r
forall (r :: * -&gt; *).
OODeclStatement r =&gt;
SVariable r -&gt; r (Scope r) -&gt; MSStatement r
</span><span class="hs-identifier hs-var">objDecNewNoParams</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String -&gt; VS (r (Variable r)) -&gt; r (Scope r) -&gt; MSStatement r
forall (r :: * -&gt; *).
OODeclStatement r =&gt;
String -&gt; SVariable r -&gt; r (Scope r) -&gt; MSStatement r
</span><span class="hs-identifier hs-var">extObjDecNewNoParams</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679364990"><span class="hs-identifier hs-var">cname</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
</span><a href="#local-6989586621679364989"><span class="hs-identifier hs-var">v_consts</span></a></span><span> </span><span class="annot"><span class="annottext">r (Scope r)
</span><a href="#local-6989586621679364988"><span class="hs-identifier hs-var">scp</span></a></span><span>
</span><span id="line-185"></span><span>      </span><span class="annot"><a href="#local-6989586621679365003"><span class="hs-identifier hs-var">declObj</span></a></span><span> </span><span class="annot"><span class="annottext">[c]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ConstantRepr
</span><a href="Language.Drasil.Choices.html#Const"><span class="hs-identifier hs-var">Const</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (MSStatement r)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-186"></span><span>  </span><span class="annot"><span class="annottext">ConstantStructure -&gt; Structure -&gt; GenState (Maybe (MSStatement r))
</span><a href="#local-6989586621679365000"><span class="hs-identifier hs-var">getDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; ConstantStructure
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#conStruct"><span class="hs-identifier hs-var">conStruct</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679364859"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; Structure
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#inStruct"><span class="hs-identifier hs-var">inStruct</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679364859"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span class="hs-comment">-- | Generates a statement to declare the variable representing the log file,</span><span>
</span><span id="line-189"></span><span class="hs-comment">-- if the user chose to turn on logs for variable assignments.</span><span>
</span><span id="line-190"></span><span id="local-6989586621679363218"><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#initLogFileVar"><span class="hs-identifier hs-type">initLogFileVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679363218"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Choices.html#Logging"><span class="hs-identifier hs-type">Logging</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679363218"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Scope</span></span><span> </span><span class="annot"><a href="#local-6989586621679363218"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSStatement</span></span><span> </span><span class="annot"><a href="#local-6989586621679363218"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-191"></span><span id="initLogFileVar"><span class="annot"><span class="annottext">initLogFileVar :: forall (r :: * -&gt; *).
SharedProg r =&gt;
[Logging] -&gt; r (Scope r) -&gt; [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Modules.html#initLogFileVar"><span class="hs-identifier hs-var hs-var">initLogFileVar</span></a></span></span><span> </span><span id="local-6989586621679365447"><span class="annot"><span class="annottext">[Logging]
</span><a href="#local-6989586621679365447"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679365448"><span class="annot"><span class="annottext">r (Scope r)
</span><a href="#local-6989586621679365448"><span class="hs-identifier hs-var">scp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SVariable r -&gt; r (Scope r) -&gt; MSStatement r
forall (r :: * -&gt; *).
DeclStatement r =&gt;
SVariable r -&gt; r (Scope r) -&gt; MSStatement r
</span><span class="hs-identifier hs-var">varDec</span></span><span> </span><span class="annot"><span class="annottext">SVariable r
forall (r :: * -&gt; *). SharedProg r =&gt; SVariable r
</span><a href="Language.Drasil.Code.Imperative.Logging.html#varLogFile"><span class="hs-identifier hs-var">varLogFile</span></a></span><span> </span><span class="annot"><span class="annottext">r (Scope r)
</span><a href="#local-6989586621679365448"><span class="hs-identifier hs-var">scp</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Logging
</span><a href="Language.Drasil.Choices.html#LogVar"><span class="hs-identifier hs-var">LogVar</span></a></span><span> </span><span class="annot"><span class="annottext">Logging -&gt; [Logging] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[Logging]
</span><a href="#local-6989586621679365447"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span class="hs-comment">------- INPUT ----------</span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span class="annot"><span class="hs-comment">-- | Generates a single module containing all input-related components.</span></span><span>
</span><span id="line-196"></span><span id="local-6989586621679363274"><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genInputMod"><span class="hs-identifier hs-type">genInputMod</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679363274"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">OO.SFile</span></span><span> </span><span class="annot"><a href="#local-6989586621679363274"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-197"></span><span id="genInputMod"><span class="annot"><span class="annottext">genInputMod :: forall (r :: * -&gt; *). OOProg r =&gt; GenState [SFile r]
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genInputMod"><span class="hs-identifier hs-var hs-var">genInputMod</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-198"></span><span>  </span><span id="local-6989586621679365456"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679365456"><span class="hs-identifier hs-var">ipDesc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenState [String] -&gt; GenState String
</span><a href="Language.Drasil.Code.Imperative.Descriptions.html#modDesc"><span class="hs-identifier hs-var">modDesc</span></a></span><span> </span><span class="annot"><span class="annottext">GenState [String]
</span><a href="Language.Drasil.Code.Imperative.Descriptions.html#inputParametersDesc"><span class="hs-identifier hs-var">inputParametersDesc</span></a></span><span>
</span><span id="line-199"></span><span>  </span><span id="local-6989586621679365457"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679365457"><span class="hs-identifier hs-var">cname</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">InternalConcept -&gt; GenState String
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#genICName"><span class="hs-identifier hs-var">genICName</span></a></span><span> </span><span class="annot"><span class="annottext">InternalConcept
</span><a href="Language.Drasil.Choices.html#InputParameters"><span class="hs-identifier hs-var">InputParameters</span></a></span><span>
</span><span id="line-200"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679363276"><span class="annot"><a href="#local-6989586621679365458"><span class="hs-identifier hs-type">genMod</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679363276"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SClass</span></span><span> </span><span class="annot"><a href="#local-6989586621679363276"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-201"></span><span>        </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OO.SFile</span></span><span> </span><span class="annot"><a href="#local-6989586621679363276"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-202"></span><span>      </span><span id="local-6989586621679365458"><span class="annot"><span class="annottext">genMod :: forall (r :: * -&gt; *).
OOProg r =&gt;
Maybe (SClass r) -&gt; GenState (SFile r)
</span><a href="#local-6989586621679365458"><span class="hs-identifier hs-var hs-var">genMod</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (SClass r)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; String
-&gt; [GenState (Maybe (SMethod r))]
-&gt; [GenState (Maybe (SClass r))]
-&gt; StateT
     DrasilState Identity (StateT FileState Identity (r (File r)))
forall (r :: * -&gt; *).
OOProg r =&gt;
String
-&gt; String
-&gt; [GenState (Maybe (SMethod r))]
-&gt; [GenState (Maybe (SClass r))]
-&gt; GenState (SFile r)
</span><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html#genModule"><span class="hs-identifier hs-var">genModule</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679365457"><span class="hs-identifier hs-var">cname</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679365456"><span class="hs-identifier hs-var">ipDesc</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">VisibilityTag -&gt; GenState (Maybe (SMethod r))
forall (r :: * -&gt; *).
OOProg r =&gt;
VisibilityTag -&gt; GenState (Maybe (SMethod r))
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genInputFormat"><span class="hs-identifier hs-var">genInputFormat</span></a></span><span> </span><span class="annot"><span class="annottext">VisibilityTag
</span><span class="hs-identifier hs-var">Pub</span></span><span class="hs-special">,</span><span>
</span><span id="line-203"></span><span>        </span><span class="annot"><span class="annottext">VisibilityTag -&gt; GenState (Maybe (SMethod r))
forall (r :: * -&gt; *).
OOProg r =&gt;
VisibilityTag -&gt; GenState (Maybe (SMethod r))
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genInputDerived"><span class="hs-identifier hs-var">genInputDerived</span></a></span><span> </span><span class="annot"><span class="annottext">VisibilityTag
</span><span class="hs-identifier hs-var">Pub</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VisibilityTag -&gt; GenState (Maybe (SMethod r))
forall (r :: * -&gt; *).
OOProg r =&gt;
VisibilityTag -&gt; GenState (Maybe (SMethod r))
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genInputConstraints"><span class="hs-identifier hs-var">genInputConstraints</span></a></span><span> </span><span class="annot"><span class="annottext">VisibilityTag
</span><span class="hs-identifier hs-var">Pub</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-204"></span><span>      </span><span class="annot"><a href="#local-6989586621679365458"><span class="hs-identifier hs-var">genMod</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (SClass r)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; String
-&gt; [GenState (Maybe (SMethod r))]
-&gt; [GenState (Maybe (SClass r))]
-&gt; StateT
     DrasilState Identity (StateT FileState Identity (r (File r)))
forall (r :: * -&gt; *).
OOProg r =&gt;
String
-&gt; String
-&gt; [GenState (Maybe (SMethod r))]
-&gt; [GenState (Maybe (SClass r))]
-&gt; GenState (SFile r)
</span><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html#genModule"><span class="hs-identifier hs-var">genModule</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679365457"><span class="hs-identifier hs-var">cname</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679365456"><span class="hs-identifier hs-var">ipDesc</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ClassType -&gt; GenState (Maybe (SClass r))
forall (r :: * -&gt; *).
OOProg r =&gt;
ClassType -&gt; GenState (Maybe (SClass r))
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genInputClass"><span class="hs-identifier hs-var">genInputClass</span></a></span><span> </span><span class="annot"><span class="annottext">ClassType
</span><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html#Primary"><span class="hs-identifier hs-var">Primary</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-205"></span><span>  </span><span id="local-6989586621679365468"><span class="annot"><span class="annottext">Maybe (CS (r (Class r)))
</span><a href="#local-6989586621679365468"><span class="hs-identifier hs-var">ic</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ClassType -&gt; StateT DrasilState Identity (Maybe (CS (r (Class r))))
forall (r :: * -&gt; *).
OOProg r =&gt;
ClassType -&gt; GenState (Maybe (SClass r))
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genInputClass"><span class="hs-identifier hs-var">genInputClass</span></a></span><span> </span><span class="annot"><span class="annottext">ClassType
</span><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html#Primary"><span class="hs-identifier hs-var">Primary</span></a></span><span>
</span><span id="line-206"></span><span>  </span><span class="annot"><span class="annottext">State DrasilState (SFile r) -&gt; GenState [SFile r]
forall a b. State a b -&gt; State a [b]
</span><a href="Language.Drasil.Code.Imperative.Helpers.html#liftS"><span class="hs-identifier hs-var">liftS</span></a></span><span> </span><span class="annot"><span class="annottext">(State DrasilState (SFile r) -&gt; GenState [SFile r])
-&gt; State DrasilState (SFile r) -&gt; GenState [SFile r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe (CS (r (Class r))) -&gt; State DrasilState (SFile r)
forall (r :: * -&gt; *).
OOProg r =&gt;
Maybe (SClass r) -&gt; GenState (SFile r)
</span><a href="#local-6989586621679365458"><span class="hs-identifier hs-var">genMod</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (CS (r (Class r)))
</span><a href="#local-6989586621679365468"><span class="hs-identifier hs-var">ic</span></a></span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span class="hs-comment">-- | Returns a function for generating a state variable for a constant.</span><span>
</span><span id="line-209"></span><span class="hs-comment">-- Either generates a declare-define statement for a regular state variable</span><span>
</span><span id="line-210"></span><span class="hs-comment">-- (if user chose 'Var'),</span><span>
</span><span id="line-211"></span><span class="hs-comment">-- or a declare-define statement for a constant variable (if user chose 'Const').</span><span>
</span><span id="line-212"></span><span id="local-6989586621679363287"><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#constVarFunc"><span class="hs-identifier hs-type">constVarFunc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679363287"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#ConstantRepr"><span class="hs-identifier hs-type">ConstantRepr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-213"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SVariable</span></span><span> </span><span class="annot"><a href="#local-6989586621679363287"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679363287"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CSStateVar</span></span><span> </span><span class="annot"><a href="#local-6989586621679363287"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-214"></span><span id="constVarFunc"><span class="annot"><span class="annottext">constVarFunc :: forall (r :: * -&gt; *).
OOProg r =&gt;
ConstantRepr -&gt; SVariable r -&gt; SValue r -&gt; CSStateVar r
</span><a href="Language.Drasil.Code.Imperative.Modules.html#constVarFunc"><span class="hs-identifier hs-var hs-var">constVarFunc</span></a></span></span><span> </span><span class="annot"><span class="annottext">ConstantRepr
</span><a href="Language.Drasil.Choices.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r (Visibility r)
-&gt; r (Permanence r)
-&gt; StateT ValueState Identity (r (Variable r))
-&gt; StateT ValueState Identity (r (Value r))
-&gt; StateT ClassState Identity (r (StateVar r))
forall (r :: * -&gt; *).
StateVarSym r =&gt;
r (Visibility r)
-&gt; r (Permanence r) -&gt; SVariable r -&gt; SValue r -&gt; CSStateVar r
</span><span class="hs-identifier hs-var">stateVarDef</span></span><span> </span><span class="annot"><span class="annottext">r (Visibility r)
forall (r :: * -&gt; *). VisibilitySym r =&gt; r (Visibility r)
</span><span class="hs-identifier hs-var">public</span></span><span> </span><span class="annot"><span class="annottext">r (Permanence r)
forall (r :: * -&gt; *). PermanenceSym r =&gt; r (Permanence r)
</span><span class="hs-keyword hs-var">dynamic</span></span><span>
</span><span id="line-215"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#constVarFunc"><span class="hs-identifier hs-var">constVarFunc</span></a></span><span> </span><span class="annot"><span class="annottext">ConstantRepr
</span><a href="Language.Drasil.Choices.html#Const"><span class="hs-identifier hs-var">Const</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r (Visibility r)
-&gt; StateT ValueState Identity (r (Variable r))
-&gt; StateT ValueState Identity (r (Value r))
-&gt; StateT ClassState Identity (r (StateVar r))
forall (r :: * -&gt; *).
StateVarSym r =&gt;
r (Visibility r) -&gt; SVariable r -&gt; SValue r -&gt; CSStateVar r
</span><span class="hs-identifier hs-var">constVar</span></span><span> </span><span class="annot"><span class="annottext">r (Visibility r)
forall (r :: * -&gt; *). VisibilitySym r =&gt; r (Visibility r)
</span><span class="hs-identifier hs-var">public</span></span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span class="hs-comment">-- | Returns 'Nothing' if no inputs or constants are mapped to InputParameters in</span><span>
</span><span id="line-218"></span><span class="hs-comment">-- the class definition map.</span><span>
</span><span id="line-219"></span><span class="hs-comment">-- If any inputs or constants are defined in InputParameters, this generates</span><span>
</span><span id="line-220"></span><span class="hs-comment">-- the InputParameters class containing the inputs and constants as state</span><span>
</span><span id="line-221"></span><span class="hs-comment">-- variables. If the InputParameters constructor is also exported, then the</span><span>
</span><span id="line-222"></span><span class="hs-comment">-- generated class also contains the input-related functions as private methods.</span><span>
</span><span id="line-223"></span><span id="local-6989586621679363281"><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genInputClass"><span class="hs-identifier hs-type">genInputClass</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679363281"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html#ClassType"><span class="hs-identifier hs-type">ClassType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-224"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SClass</span></span><span> </span><span class="annot"><a href="#local-6989586621679363281"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-225"></span><span id="genInputClass"><span class="annot"><span class="annottext">genInputClass :: forall (r :: * -&gt; *).
OOProg r =&gt;
ClassType -&gt; GenState (Maybe (SClass r))
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genInputClass"><span class="hs-identifier hs-var hs-var">genInputClass</span></a></span></span><span> </span><span id="local-6989586621679365499"><span class="annot"><span class="annottext">ClassType
</span><a href="#local-6989586621679365499"><span class="hs-identifier hs-var">scp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-226"></span><span>  </span><span id="local-6989586621679365500"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679365500"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-227"></span><span>  </span><span class="annot"><span class="annottext">(DrasilState -&gt; DrasilState) -&gt; StateT DrasilState Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679365501"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679365501"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679365501"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#currentScope"><span class="hs-identifier hs-var">currentScope</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#Local"><span class="hs-identifier hs-type">Local</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span>  </span><span id="local-6989586621679365503"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679365503"><span class="hs-identifier hs-var">cname</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">InternalConcept -&gt; GenState String
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#genICName"><span class="hs-identifier hs-var">genICName</span></a></span><span> </span><span class="annot"><span class="annottext">InternalConcept
</span><a href="Language.Drasil.Choices.html#InputParameters"><span class="hs-identifier hs-var">InputParameters</span></a></span><span>
</span><span id="line-229"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679365506"><span class="annot"><span class="annottext">ins :: [CodeVarChunk]
</span><a href="#local-6989586621679365506"><span class="hs-identifier hs-var hs-var">ins</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; CodeSpec
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#codeSpec"><span class="hs-identifier hs-var">codeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679365500"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">CodeSpec
-&gt; Getting [CodeVarChunk] CodeSpec [CodeVarChunk] -&gt; [CodeVarChunk]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting [CodeVarChunk] CodeSpec [CodeVarChunk]
forall c. HasOldCodeSpec c =&gt; Lens' c [CodeVarChunk]
Lens' CodeSpec [CodeVarChunk]
</span><a href="Language.Drasil.CodeSpec.html#inputsO"><span class="hs-identifier hs-var">inputsO</span></a></span><span>
</span><span id="line-230"></span><span>      </span><span id="local-6989586621679365509"><span class="annot"><span class="annottext">cs :: [CodeDefinition]
</span><a href="#local-6989586621679365509"><span class="hs-identifier hs-var hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; CodeSpec
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#codeSpec"><span class="hs-identifier hs-var">codeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679365500"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">CodeSpec
-&gt; Getting [CodeDefinition] CodeSpec [CodeDefinition]
-&gt; [CodeDefinition]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting [CodeDefinition] CodeSpec [CodeDefinition]
forall c. HasOldCodeSpec c =&gt; Lens' c [CodeDefinition]
Lens' CodeSpec [CodeDefinition]
</span><a href="Language.Drasil.CodeSpec.html#constantsO"><span class="hs-identifier hs-var">constantsO</span></a></span><span>
</span><span id="line-231"></span><span>      </span><span id="local-6989586621679363299"><span class="annot"><a href="#local-6989586621679365510"><span class="hs-identifier hs-type">filt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CodeIdea</span></span><span> </span><span class="annot"><a href="#local-6989586621679363299"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679363299"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679363299"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-232"></span><span>      </span><span id="local-6989586621679365510"><span class="annot"><span class="annottext">filt :: forall c. CodeIdea c =&gt; [c] -&gt; [c]
</span><a href="#local-6989586621679365510"><span class="hs-identifier hs-var hs-var">filt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(c -&gt; Bool) -&gt; [c] -&gt; [c]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Maybe String
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679365503"><span class="hs-identifier hs-var">cname</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe String -&gt; Maybe String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe String -&gt; Bool) -&gt; (c -&gt; Maybe String) -&gt; c -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Map String String -&gt; Maybe String)
-&gt; Map String String -&gt; String -&gt; Maybe String
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Map String String -&gt; Maybe String
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; Map String String
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#clsMap"><span class="hs-identifier hs-var">clsMap</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679365500"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(String -&gt; Maybe String) -&gt; (c -&gt; String) -&gt; c -&gt; Maybe String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">c -&gt; String
forall c. CodeIdea c =&gt; c -&gt; String
</span><span class="hs-identifier hs-var">codeName</span></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>      </span><span id="local-6989586621679363305"><span class="annot"><a href="#local-6989586621679365517"><span class="hs-identifier hs-type">constructors</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679363305"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679363305"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-234"></span><span>      </span><span id="local-6989586621679365517"><span class="annot"><span class="annottext">constructors :: forall (r :: * -&gt; *). OOProg r =&gt; GenState [SMethod r]
</span><a href="#local-6989586621679365517"><span class="hs-identifier hs-var hs-var">constructors</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679365503"><span class="hs-identifier hs-var">cname</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Set String -&gt; Bool
forall a. Eq a =&gt; a -&gt; Set a -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; Set String
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#defSet"><span class="hs-identifier hs-var">defSet</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679365500"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-235"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[[MS (r (Method r))]] -&gt; [MS (r (Method r))]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">([[MS (r (Method r))]] -&gt; [MS (r (Method r))])
-&gt; StateT DrasilState Identity [[MS (r (Method r))]]
-&gt; StateT DrasilState Identity [MS (r (Method r))]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(StateT DrasilState Identity (Maybe (MS (r (Method r))))
 -&gt; StateT DrasilState Identity [MS (r (Method r))])
-&gt; [StateT DrasilState Identity (Maybe (MS (r (Method r))))]
-&gt; StateT DrasilState Identity [[MS (r (Method r))]]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Maybe (MS (r (Method r))) -&gt; [MS (r (Method r))])
-&gt; StateT DrasilState Identity (Maybe (MS (r (Method r))))
-&gt; StateT DrasilState Identity [MS (r (Method r))]
forall a b.
(a -&gt; b)
-&gt; StateT DrasilState Identity a -&gt; StateT DrasilState Identity b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Maybe (MS (r (Method r))) -&gt; [MS (r (Method r))]
forall a. Maybe a -&gt; [a]
</span><span class="hs-identifier hs-var">maybeToList</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">StateT DrasilState Identity (Maybe (MS (r (Method r))))
forall (r :: * -&gt; *). OOProg r =&gt; GenState (Maybe (SMethod r))
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genInputConstructor"><span class="hs-identifier hs-var">genInputConstructor</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-236"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[MS (r (Method r))]
-&gt; StateT DrasilState Identity [MS (r (Method r))]
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-237"></span><span>      </span><span id="local-6989586621679365535"><span class="annot"><a href="#local-6989586621679365536"><span class="hs-identifier hs-type">methods</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679365535"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679365535"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-238"></span><span>      </span><span id="local-6989586621679365536"><span class="annot"><span class="annottext">methods :: forall (r :: * -&gt; *). OOProg r =&gt; GenState [SMethod r]
</span><a href="#local-6989586621679365536"><span class="hs-identifier hs-var hs-var">methods</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679365503"><span class="hs-identifier hs-var">cname</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Set String -&gt; Bool
forall a. Eq a =&gt; a -&gt; Set a -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; Set String
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#defSet"><span class="hs-identifier hs-var">defSet</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679365500"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-239"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[[MS (r (Method r))]] -&gt; [MS (r (Method r))]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">([[MS (r (Method r))]] -&gt; [MS (r (Method r))])
-&gt; StateT DrasilState Identity [[MS (r (Method r))]]
-&gt; StateT DrasilState Identity [MS (r (Method r))]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(StateT DrasilState Identity (Maybe (MS (r (Method r))))
 -&gt; StateT DrasilState Identity [MS (r (Method r))])
-&gt; [StateT DrasilState Identity (Maybe (MS (r (Method r))))]
-&gt; StateT DrasilState Identity [[MS (r (Method r))]]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Maybe (MS (r (Method r))) -&gt; [MS (r (Method r))])
-&gt; StateT DrasilState Identity (Maybe (MS (r (Method r))))
-&gt; StateT DrasilState Identity [MS (r (Method r))]
forall a b.
(a -&gt; b)
-&gt; StateT DrasilState Identity a -&gt; StateT DrasilState Identity b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Maybe (MS (r (Method r))) -&gt; [MS (r (Method r))]
forall a. Maybe a -&gt; [a]
</span><span class="hs-identifier hs-var">maybeToList</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">VisibilityTag
-&gt; StateT DrasilState Identity (Maybe (MS (r (Method r))))
forall (r :: * -&gt; *).
OOProg r =&gt;
VisibilityTag -&gt; GenState (Maybe (SMethod r))
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genInputFormat"><span class="hs-identifier hs-var">genInputFormat</span></a></span><span> </span><span class="annot"><span class="annottext">VisibilityTag
</span><span class="hs-identifier hs-var">Priv</span></span><span class="hs-special">,</span><span>
</span><span id="line-240"></span><span>        </span><span class="annot"><span class="annottext">VisibilityTag
-&gt; StateT DrasilState Identity (Maybe (MS (r (Method r))))
forall (r :: * -&gt; *).
OOProg r =&gt;
VisibilityTag -&gt; GenState (Maybe (SMethod r))
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genInputDerived"><span class="hs-identifier hs-var">genInputDerived</span></a></span><span> </span><span class="annot"><span class="annottext">VisibilityTag
</span><span class="hs-identifier hs-var">Priv</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VisibilityTag
-&gt; StateT DrasilState Identity (Maybe (MS (r (Method r))))
forall (r :: * -&gt; *).
OOProg r =&gt;
VisibilityTag -&gt; GenState (Maybe (SMethod r))
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genInputConstraints"><span class="hs-identifier hs-var">genInputConstraints</span></a></span><span> </span><span class="annot"><span class="annottext">VisibilityTag
</span><span class="hs-identifier hs-var">Priv</span></span><span class="hs-special">]</span><span>
</span><span id="line-241"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[MS (r (Method r))]
-&gt; StateT DrasilState Identity [MS (r (Method r))]
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-242"></span><span>      </span><span id="local-6989586621679363318"><span class="annot"><a href="#local-6989586621679365551"><span class="hs-identifier hs-type">genClass</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679363318"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">CodeVarChunk</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Chunk.CodeDefinition.html#CodeDefinition"><span class="hs-identifier hs-type">CodeDefinition</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-243"></span><span>        </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SClass</span></span><span> </span><span class="annot"><a href="#local-6989586621679363318"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-244"></span><span>      </span><span id="local-6989586621679365551"><span class="annot"><span class="annottext">genClass :: forall (r :: * -&gt; *).
OOProg r =&gt;
[CodeVarChunk] -&gt; [CodeDefinition] -&gt; GenState (Maybe (SClass r))
</span><a href="#local-6989586621679365551"><span class="hs-identifier hs-var hs-var">genClass</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (CS (r (Class r)))
-&gt; StateT DrasilState Identity (Maybe (CS (r (Class r))))
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe (CS (r (Class r)))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-245"></span><span>      </span><span class="annot"><a href="#local-6989586621679365551"><span class="hs-identifier hs-var">genClass</span></a></span><span> </span><span id="local-6989586621679365644"><span class="annot"><span class="annottext">[CodeVarChunk]
</span><a href="#local-6989586621679365644"><span class="hs-identifier hs-var">inps</span></a></span></span><span> </span><span id="local-6989586621679365645"><span class="annot"><span class="annottext">[CodeDefinition]
</span><a href="#local-6989586621679365645"><span class="hs-identifier hs-var">csts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-246"></span><span>        </span><span id="local-6989586621679365646"><span class="annot"><span class="annottext">[VS (r (Value r))]
</span><a href="#local-6989586621679365646"><span class="hs-identifier hs-var">vals</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(CodeDefinition -&gt; StateT DrasilState Identity (VS (r (Value r))))
-&gt; [CodeDefinition]
-&gt; StateT DrasilState Identity [VS (r (Value r))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">(CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r))))
-&gt; (CodeDefinition -&gt; CodeExpr)
-&gt; CodeDefinition
-&gt; StateT DrasilState Identity (VS (r (Value r)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeDefinition
-&gt; Getting CodeExpr CodeDefinition CodeExpr -&gt; CodeExpr
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting CodeExpr CodeDefinition CodeExpr
forall c. DefiningCodeExpr c =&gt; Lens' c CodeExpr
Lens' CodeDefinition CodeExpr
</span><span class="hs-identifier hs-var">codeExpr</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CodeDefinition]
</span><a href="#local-6989586621679365645"><span class="hs-identifier hs-var">csts</span></a></span><span>
</span><span id="line-247"></span><span>        </span><span id="local-6989586621679365647"><span class="annot"><span class="annottext">[CS (r (StateVar r))]
</span><a href="#local-6989586621679365647"><span class="hs-identifier hs-var">inputVars</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(CodeVarChunk -&gt; StateT DrasilState Identity (CS (r (StateVar r))))
-&gt; [CodeVarChunk]
-&gt; StateT DrasilState Identity [CS (r (StateVar r))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679365648"><span class="annot"><span class="annottext">CodeVarChunk
</span><a href="#local-6989586621679365648"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(CodeType -&gt; CS (r (StateVar r)))
-&gt; StateT DrasilState Identity CodeType
-&gt; StateT DrasilState Identity (CS (r (StateVar r)))
forall a b.
(a -&gt; b)
-&gt; StateT DrasilState Identity a -&gt; StateT DrasilState Identity b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SVariable r -&gt; CS (r (StateVar r))
forall (r :: * -&gt; *). StateVarSym r =&gt; SVariable r -&gt; CSStateVar r
</span><span class="hs-identifier hs-var">pubDVar</span></span><span> </span><span class="annot"><span class="annottext">(SVariable r -&gt; CS (r (StateVar r)))
-&gt; (CodeType -&gt; SVariable r) -&gt; CodeType -&gt; CS (r (StateVar r))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-248"></span><span>          </span><span class="annot"><span class="annottext">String -&gt; VS (r (Type r)) -&gt; SVariable r
forall (r :: * -&gt; *).
VariableSym r =&gt;
String -&gt; VSType r -&gt; SVariable r
</span><span class="hs-identifier hs-var">var</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeVarChunk -&gt; String
forall c. CodeIdea c =&gt; c -&gt; String
</span><span class="hs-identifier hs-var">codeName</span></span><span> </span><span class="annot"><span class="annottext">CodeVarChunk
</span><a href="#local-6989586621679365648"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(VS (r (Type r)) -&gt; SVariable r)
-&gt; (CodeType -&gt; VS (r (Type r))) -&gt; CodeType -&gt; SVariable r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CodeType -&gt; VS (r (Type r))
forall (r :: * -&gt; *). OOTypeSym r =&gt; CodeType -&gt; VSType r
</span><span class="hs-identifier hs-var">convTypeOO</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeVarChunk -&gt; StateT DrasilState Identity CodeType
forall c. HasSpace c =&gt; c -&gt; StateT DrasilState Identity CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#codeType"><span class="hs-identifier hs-var">codeType</span></a></span><span> </span><span class="annot"><span class="annottext">CodeVarChunk
</span><a href="#local-6989586621679365648"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CodeVarChunk]
</span><a href="#local-6989586621679365644"><span class="hs-identifier hs-var">inps</span></a></span><span>
</span><span id="line-249"></span><span>        </span><span id="local-6989586621679365650"><span class="annot"><span class="annottext">[CS (r (StateVar r))]
</span><a href="#local-6989586621679365650"><span class="hs-identifier hs-var">constVars</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(CodeDefinition
 -&gt; VS (r (Value r))
 -&gt; StateT DrasilState Identity (CS (r (StateVar r))))
-&gt; [CodeDefinition]
-&gt; [VS (r (Value r))]
-&gt; StateT DrasilState Identity [CS (r (StateVar r))]
forall (m :: * -&gt; *) a b c.
Applicative m =&gt;
(a -&gt; b -&gt; m c) -&gt; [a] -&gt; [b] -&gt; m [c]
</span><span class="hs-identifier hs-var">zipWithM</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679365651"><span class="annot"><span class="annottext">CodeDefinition
</span><a href="#local-6989586621679365651"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679365652"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679365652"><span class="hs-identifier hs-var">vl</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(CodeType -&gt; CS (r (StateVar r)))
-&gt; StateT DrasilState Identity CodeType
-&gt; StateT DrasilState Identity (CS (r (StateVar r)))
forall a b.
(a -&gt; b)
-&gt; StateT DrasilState Identity a -&gt; StateT DrasilState Identity b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679365653"><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679365653"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ConstantRepr
-&gt; SVariable r -&gt; VS (r (Value r)) -&gt; CS (r (StateVar r))
forall (r :: * -&gt; *).
OOProg r =&gt;
ConstantRepr -&gt; SVariable r -&gt; SValue r -&gt; CSStateVar r
</span><a href="Language.Drasil.Code.Imperative.Modules.html#constVarFunc"><span class="hs-identifier hs-var">constVarFunc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; ConstantRepr
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#conRepr"><span class="hs-identifier hs-var">conRepr</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679365500"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-250"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; VS (r (Type r)) -&gt; SVariable r
forall (r :: * -&gt; *).
VariableSym r =&gt;
String -&gt; VSType r -&gt; SVariable r
</span><span class="hs-identifier hs-var">var</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeDefinition -&gt; String
forall c. CodeIdea c =&gt; c -&gt; String
</span><span class="hs-identifier hs-var">codeName</span></span><span> </span><span class="annot"><span class="annottext">CodeDefinition
</span><a href="#local-6989586621679365651"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeType -&gt; VS (r (Type r))
forall (r :: * -&gt; *). OOTypeSym r =&gt; CodeType -&gt; VSType r
</span><span class="hs-identifier hs-var">convTypeOO</span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679365653"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679365652"><span class="hs-identifier hs-var">vl</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeDefinition -&gt; StateT DrasilState Identity CodeType
forall c. HasSpace c =&gt; c -&gt; StateT DrasilState Identity CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#codeType"><span class="hs-identifier hs-var">codeType</span></a></span><span> </span><span class="annot"><span class="annottext">CodeDefinition
</span><a href="#local-6989586621679365651"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-251"></span><span>          </span><span class="annot"><span class="annottext">[CodeDefinition]
</span><a href="#local-6989586621679365645"><span class="hs-identifier hs-var">csts</span></a></span><span> </span><span class="annot"><span class="annottext">[VS (r (Value r))]
</span><a href="#local-6989586621679365646"><span class="hs-identifier hs-var">vals</span></a></span><span>
</span><span id="line-252"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679365940"><span class="annot"><span class="annottext">getFunc :: ClassType
-&gt; String
-&gt; Maybe String
-&gt; String
-&gt; [CSStateVar r]
-&gt; GenState [SMethod r]
-&gt; GenState [SMethod r]
-&gt; GenState (SClass r)
</span><a href="#local-6989586621679365940"><span class="hs-identifier hs-var hs-var">getFunc</span></a></span></span><span> </span><span class="annot"><span class="annottext">ClassType
</span><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html#Primary"><span class="hs-identifier hs-var">Primary</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; Maybe String
-&gt; String
-&gt; [CSStateVar r]
-&gt; GenState [SMethod r]
-&gt; GenState [SMethod r]
-&gt; GenState (SClass r)
forall (r :: * -&gt; *).
OOProg r =&gt;
String
-&gt; Maybe String
-&gt; String
-&gt; [CSStateVar r]
-&gt; GenState [SMethod r]
-&gt; GenState [SMethod r]
-&gt; GenState (SClass r)
</span><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html#primaryClass"><span class="hs-identifier hs-var">primaryClass</span></a></span><span>
</span><span id="line-253"></span><span>            </span><span class="annot"><a href="#local-6989586621679365940"><span class="hs-identifier hs-var">getFunc</span></a></span><span> </span><span class="annot"><span class="annottext">ClassType
</span><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html#Auxiliary"><span class="hs-identifier hs-var">Auxiliary</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; Maybe String
-&gt; String
-&gt; [CSStateVar r]
-&gt; GenState [SMethod r]
-&gt; GenState [SMethod r]
-&gt; GenState (SClass r)
forall (r :: * -&gt; *).
OOProg r =&gt;
String
-&gt; Maybe String
-&gt; String
-&gt; [CSStateVar r]
-&gt; GenState [SMethod r]
-&gt; GenState [SMethod r]
-&gt; GenState (SClass r)
</span><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html#auxClass"><span class="hs-identifier hs-var">auxClass</span></a></span><span>
</span><span id="line-254"></span><span>            </span><span id="local-6989586621679366168"><span class="annot"><span class="annottext">f :: String
-&gt; Maybe String
-&gt; String
-&gt; [CS (r (StateVar r))]
-&gt; GenState [MS (r (Method r))]
-&gt; GenState [MS (r (Method r))]
-&gt; GenState (CS (r (Class r)))
</span><a href="#local-6989586621679366168"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ClassType
-&gt; String
-&gt; Maybe String
-&gt; String
-&gt; [CS (r (StateVar r))]
-&gt; GenState [MS (r (Method r))]
-&gt; GenState [MS (r (Method r))]
-&gt; GenState (CS (r (Class r)))
forall {r :: * -&gt; *}.
OOProg r =&gt;
ClassType
-&gt; String
-&gt; Maybe String
-&gt; String
-&gt; [CSStateVar r]
-&gt; GenState [SMethod r]
-&gt; GenState [SMethod r]
-&gt; GenState (SClass r)
</span><a href="#local-6989586621679365940"><span class="hs-identifier hs-var">getFunc</span></a></span><span> </span><span class="annot"><span class="annottext">ClassType
</span><a href="#local-6989586621679365499"><span class="hs-identifier hs-var">scp</span></a></span><span>
</span><span id="line-255"></span><span>        </span><span id="local-6989586621679366169"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679366169"><span class="hs-identifier hs-var">icDesc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenState String
</span><a href="Language.Drasil.Code.Imperative.Descriptions.html#inputClassDesc"><span class="hs-identifier hs-var">inputClassDesc</span></a></span><span>
</span><span id="line-256"></span><span>        </span><span id="local-6989586621679366170"><span class="annot"><span class="annottext">CS (r (Class r))
</span><a href="#local-6989586621679366170"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; Maybe String
-&gt; String
-&gt; [CS (r (StateVar r))]
-&gt; GenState [MS (r (Method r))]
-&gt; GenState [MS (r (Method r))]
-&gt; GenState (CS (r (Class r)))
</span><a href="#local-6989586621679366168"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679365503"><span class="hs-identifier hs-var">cname</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe String
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679366169"><span class="hs-identifier hs-var">icDesc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[CS (r (StateVar r))]
</span><a href="#local-6989586621679365647"><span class="hs-identifier hs-var">inputVars</span></a></span><span> </span><span class="annot"><span class="annottext">[CS (r (StateVar r))]
-&gt; [CS (r (StateVar r))] -&gt; [CS (r (StateVar r))]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[CS (r (StateVar r))]
</span><a href="#local-6989586621679365650"><span class="hs-identifier hs-var">constVars</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">GenState [MS (r (Method r))]
forall (r :: * -&gt; *). OOProg r =&gt; GenState [SMethod r]
</span><a href="#local-6989586621679365517"><span class="hs-identifier hs-var">constructors</span></a></span><span> </span><span class="annot"><span class="annottext">GenState [MS (r (Method r))]
forall (r :: * -&gt; *). OOProg r =&gt; GenState [SMethod r]
</span><a href="#local-6989586621679365536"><span class="hs-identifier hs-var">methods</span></a></span><span>
</span><span id="line-257"></span><span>        </span><span class="annot"><span class="annottext">Maybe (CS (r (Class r)))
-&gt; StateT DrasilState Identity (Maybe (CS (r (Class r))))
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (CS (r (Class r)))
 -&gt; StateT DrasilState Identity (Maybe (CS (r (Class r)))))
-&gt; Maybe (CS (r (Class r)))
-&gt; StateT DrasilState Identity (Maybe (CS (r (Class r))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CS (r (Class r)) -&gt; Maybe (CS (r (Class r)))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">CS (r (Class r))
</span><a href="#local-6989586621679366170"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-258"></span><span>  </span><span class="annot"><span class="annottext">[CodeVarChunk] -&gt; [CodeDefinition] -&gt; GenState (Maybe (SClass r))
forall (r :: * -&gt; *).
OOProg r =&gt;
[CodeVarChunk] -&gt; [CodeDefinition] -&gt; GenState (Maybe (SClass r))
</span><a href="#local-6989586621679365551"><span class="hs-identifier hs-var">genClass</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[CodeVarChunk] -&gt; [CodeVarChunk]
forall c. CodeIdea c =&gt; [c] -&gt; [c]
</span><a href="#local-6989586621679365510"><span class="hs-identifier hs-var">filt</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeVarChunk]
</span><a href="#local-6989586621679365506"><span class="hs-identifier hs-var">ins</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[CodeDefinition] -&gt; [CodeDefinition]
forall c. CodeIdea c =&gt; [c] -&gt; [c]
</span><a href="#local-6989586621679365510"><span class="hs-identifier hs-var">filt</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeDefinition]
</span><a href="#local-6989586621679365509"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span class="hs-comment">-- | Generates a constructor for the input class, where the constructor calls the</span><span>
</span><span id="line-261"></span><span class="hs-comment">-- input-related functions. Returns 'Nothing' if no input-related functions are</span><span>
</span><span id="line-262"></span><span class="hs-comment">-- generated.</span><span>
</span><span id="line-263"></span><span id="local-6989586621679366171"><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genInputConstructor"><span class="hs-identifier hs-type">genInputConstructor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679366171"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679366171"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-264"></span><span id="genInputConstructor"><span class="annot"><span class="annottext">genInputConstructor :: forall (r :: * -&gt; *). OOProg r =&gt; GenState (Maybe (SMethod r))
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genInputConstructor"><span class="hs-identifier hs-var hs-var">genInputConstructor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-265"></span><span>  </span><span id="local-6989586621679366183"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679366183"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-266"></span><span>  </span><span id="local-6989586621679366184"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679366184"><span class="hs-identifier hs-var">ipName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">InternalConcept -&gt; GenState String
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#genICName"><span class="hs-identifier hs-var">genICName</span></a></span><span> </span><span class="annot"><span class="annottext">InternalConcept
</span><a href="Language.Drasil.Choices.html#InputParameters"><span class="hs-identifier hs-var">InputParameters</span></a></span><span>
</span><span id="line-267"></span><span>  </span><span id="local-6989586621679366185"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679366185"><span class="hs-identifier hs-var">giName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">InternalConcept -&gt; GenState String
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#genICName"><span class="hs-identifier hs-var">genICName</span></a></span><span> </span><span class="annot"><span class="annottext">InternalConcept
</span><a href="Language.Drasil.Choices.html#GetInput"><span class="hs-identifier hs-var">GetInput</span></a></span><span>
</span><span id="line-268"></span><span>  </span><span id="local-6989586621679366187"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679366187"><span class="hs-identifier hs-var">dvName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">InternalConcept -&gt; GenState String
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#genICName"><span class="hs-identifier hs-var">genICName</span></a></span><span> </span><span class="annot"><span class="annottext">InternalConcept
</span><a href="Language.Drasil.Choices.html#DerivedValuesFn"><span class="hs-identifier hs-var">DerivedValuesFn</span></a></span><span>
</span><span id="line-269"></span><span>  </span><span id="local-6989586621679366189"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679366189"><span class="hs-identifier hs-var">icName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">InternalConcept -&gt; GenState String
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#genICName"><span class="hs-identifier hs-var">genICName</span></a></span><span> </span><span class="annot"><span class="annottext">InternalConcept
</span><a href="Language.Drasil.Choices.html#InputConstraintsFn"><span class="hs-identifier hs-var">InputConstraintsFn</span></a></span><span>
</span><span id="line-270"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679366191"><span class="annot"><span class="annottext">ds :: Set String
</span><a href="#local-6989586621679366191"><span class="hs-identifier hs-var hs-var">ds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; Set String
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#defSet"><span class="hs-identifier hs-var">defSet</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679366183"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-271"></span><span>      </span><span id="local-6989586621679366490"><span class="annot"><span class="annottext">genCtor :: Bool -&gt; StateT DrasilState Identity (Maybe (MS (r (Method r))))
</span><a href="#local-6989586621679366490"><span class="hs-identifier hs-var hs-var">genCtor</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (MS (r (Method r)))
-&gt; StateT DrasilState Identity (Maybe (MS (r (Method r))))
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe (MS (r (Method r)))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-272"></span><span>      </span><span class="annot"><a href="#local-6989586621679366490"><span class="hs-identifier hs-var">genCtor</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-273"></span><span>        </span><span id="local-6989586621679366491"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679366491"><span class="hs-identifier hs-var">cdesc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenState String
</span><a href="Language.Drasil.Code.Imperative.Descriptions.html#inputConstructorDesc"><span class="hs-identifier hs-var">inputConstructorDesc</span></a></span><span>
</span><span id="line-274"></span><span>        </span><span id="local-6989586621679366492"><span class="annot"><span class="annottext">[CodeVarChunk]
</span><a href="#local-6989586621679366492"><span class="hs-identifier hs-var">cparams</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenState [CodeVarChunk]
</span><a href="Language.Drasil.Code.Imperative.Parameters.html#getInConstructorParams"><span class="hs-identifier hs-var">getInConstructorParams</span></a></span><span>
</span><span id="line-275"></span><span>        </span><span id="local-6989586621679366493"><span class="annot"><span class="annottext">[MS (r (Statement r))]
</span><a href="#local-6989586621679366493"><span class="hs-identifier hs-var">ics</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenState [MS (r (Statement r))]
forall (r :: * -&gt; *). OOProg r =&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.FunctionCalls.html#genAllInputCalls"><span class="hs-identifier hs-var">genAllInputCalls</span></a></span><span>
</span><span id="line-276"></span><span>        </span><span id="local-6989586621679366494"><span class="annot"><span class="annottext">MS (r (Method r))
</span><a href="#local-6989586621679366494"><span class="hs-identifier hs-var">ctor</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; String
-&gt; [ParameterChunk]
-&gt; [MSBlock r]
-&gt; StateT DrasilState Identity (MS (r (Method r)))
forall (r :: * -&gt; *).
OOProg r =&gt;
String
-&gt; String
-&gt; [ParameterChunk]
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genConstructor"><span class="hs-identifier hs-var">genConstructor</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679366184"><span class="hs-identifier hs-var">ipName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679366491"><span class="hs-identifier hs-var">cdesc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CodeVarChunk -&gt; ParameterChunk)
-&gt; [CodeVarChunk] -&gt; [ParameterChunk]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">CodeVarChunk -&gt; ParameterChunk
forall c. CodeIdea c =&gt; c -&gt; ParameterChunk
</span><a href="Language.Drasil.Chunk.Parameter.html#pcAuto"><span class="hs-identifier hs-var">pcAuto</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeVarChunk]
</span><a href="#local-6989586621679366492"><span class="hs-identifier hs-var">cparams</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-277"></span><span>          </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[MS (r (Statement r))] -&gt; MSBlock r
forall (r :: * -&gt; *). BlockSym r =&gt; [MSStatement r] -&gt; MSBlock r
</span><span class="hs-identifier hs-var">block</span></span><span> </span><span class="annot"><span class="annottext">[MS (r (Statement r))]
</span><a href="#local-6989586621679366493"><span class="hs-identifier hs-var">ics</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-278"></span><span>        </span><span class="annot"><span class="annottext">Maybe (MS (r (Method r)))
-&gt; StateT DrasilState Identity (Maybe (MS (r (Method r))))
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (MS (r (Method r)))
 -&gt; StateT DrasilState Identity (Maybe (MS (r (Method r)))))
-&gt; Maybe (MS (r (Method r)))
-&gt; StateT DrasilState Identity (Maybe (MS (r (Method r))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MS (r (Method r)) -&gt; Maybe (MS (r (Method r)))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">MS (r (Method r))
</span><a href="#local-6989586621679366494"><span class="hs-identifier hs-var">ctor</span></a></span><span>
</span><span id="line-279"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; GenState (Maybe (SMethod r))
forall {r :: * -&gt; *}.
OOProg r =&gt;
Bool -&gt; StateT DrasilState Identity (Maybe (MS (r (Method r))))
</span><a href="#local-6989586621679366490"><span class="hs-identifier hs-var">genCtor</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; GenState (Maybe (SMethod r)))
-&gt; Bool -&gt; GenState (Maybe (SMethod r))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Bool) -&gt; [String] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Set String -&gt; Bool
forall a. Eq a =&gt; a -&gt; Set a -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">Set String
</span><a href="#local-6989586621679366191"><span class="hs-identifier hs-var">ds</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679366185"><span class="hs-identifier hs-var">giName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-280"></span><span>    </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679366187"><span class="hs-identifier hs-var">dvName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679366189"><span class="hs-identifier hs-var">icName</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-281"></span><span>
</span><span id="line-282"></span><span class="annot"><span class="hs-comment">-- | Generates a function for calculating derived inputs.</span></span><span>
</span><span id="line-283"></span><span id="local-6989586621679366497"><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genInputDerived"><span class="hs-identifier hs-type">genInputDerived</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679366497"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VisibilityTag</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-284"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679366497"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-285"></span><span id="genInputDerived"><span class="annot"><span class="annottext">genInputDerived :: forall (r :: * -&gt; *).
OOProg r =&gt;
VisibilityTag -&gt; GenState (Maybe (SMethod r))
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genInputDerived"><span class="hs-identifier hs-var hs-var">genInputDerived</span></a></span></span><span> </span><span id="local-6989586621679366507"><span class="annot"><span class="annottext">VisibilityTag
</span><a href="#local-6989586621679366507"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-286"></span><span>  </span><span id="local-6989586621679366508"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679366508"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-287"></span><span>  </span><span class="annot"><span class="annottext">(DrasilState -&gt; DrasilState) -&gt; StateT DrasilState Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679366509"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679366509"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679366509"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#currentScope"><span class="hs-identifier hs-var">currentScope</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#Local"><span class="hs-identifier hs-type">Local</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-288"></span><span>  </span><span id="local-6989586621679366510"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679366510"><span class="hs-identifier hs-var">dvName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">InternalConcept -&gt; GenState String
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#genICName"><span class="hs-identifier hs-var">genICName</span></a></span><span> </span><span class="annot"><span class="annottext">InternalConcept
</span><a href="Language.Drasil.Choices.html#DerivedValuesFn"><span class="hs-identifier hs-var">DerivedValuesFn</span></a></span><span>
</span><span id="line-289"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679366513"><span class="annot"><span class="annottext">dvals :: [CodeDefinition]
</span><a href="#local-6989586621679366513"><span class="hs-identifier hs-var hs-var">dvals</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; CodeSpec
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#codeSpec"><span class="hs-identifier hs-var">codeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679366508"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">CodeSpec
-&gt; Getting [CodeDefinition] CodeSpec [CodeDefinition]
-&gt; [CodeDefinition]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting [CodeDefinition] CodeSpec [CodeDefinition]
forall c. HasOldCodeSpec c =&gt; Lens' c [CodeDefinition]
Lens' CodeSpec [CodeDefinition]
</span><a href="Language.Drasil.CodeSpec.html#derivedInputsO"><span class="hs-identifier hs-var">derivedInputsO</span></a></span><span>
</span><span id="line-290"></span><span>      </span><span id="local-6989586621679366801"><span class="annot"><span class="annottext">getFunc :: VisibilityTag
-&gt; String
-&gt; String
-&gt; [CodeVarChunk]
-&gt; [CodeVarChunk]
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="#local-6989586621679366801"><span class="hs-identifier hs-var hs-var">getFunc</span></a></span></span><span> </span><span class="annot"><span class="annottext">VisibilityTag
</span><span class="hs-identifier hs-var">Pub</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; String
-&gt; [CodeVarChunk]
-&gt; [CodeVarChunk]
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
forall (r :: * -&gt; *).
OOProg r =&gt;
String
-&gt; String
-&gt; [CodeVarChunk]
-&gt; [CodeVarChunk]
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#publicInOutFunc"><span class="hs-identifier hs-var">publicInOutFunc</span></a></span><span>
</span><span id="line-291"></span><span>      </span><span class="annot"><a href="#local-6989586621679366801"><span class="hs-identifier hs-var">getFunc</span></a></span><span> </span><span class="annot"><span class="annottext">VisibilityTag
</span><span class="hs-identifier hs-var">Priv</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; String
-&gt; [CodeVarChunk]
-&gt; [CodeVarChunk]
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
forall (r :: * -&gt; *).
OOProg r =&gt;
String
-&gt; String
-&gt; [CodeVarChunk]
-&gt; [CodeVarChunk]
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#privateInOutMethod"><span class="hs-identifier hs-var">privateInOutMethod</span></a></span><span>
</span><span id="line-292"></span><span>      </span><span id="local-6989586621679366802"><span class="annot"><a href="#local-6989586621679366803"><span class="hs-identifier hs-type">genDerived</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679366802"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span>
</span><span id="line-293"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679366802"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-294"></span><span>      </span><span id="local-6989586621679366803"><span class="annot"><span class="annottext">genDerived :: forall {r :: * -&gt; *}.
OOProg r =&gt;
Bool -&gt; StateT DrasilState Identity (Maybe (MS (r (Method r))))
</span><a href="#local-6989586621679366803"><span class="hs-identifier hs-var hs-var">genDerived</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (MS (r (Method r)))
-&gt; StateT DrasilState Identity (Maybe (MS (r (Method r))))
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe (MS (r (Method r)))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-295"></span><span>      </span><span class="annot"><a href="#local-6989586621679366803"><span class="hs-identifier hs-var">genDerived</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-296"></span><span>        </span><span id="local-6989586621679366818"><span class="annot"><span class="annottext">[CodeVarChunk]
</span><a href="#local-6989586621679366818"><span class="hs-identifier hs-var">ins</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenState [CodeVarChunk]
</span><a href="Language.Drasil.Code.Imperative.Parameters.html#getDerivedIns"><span class="hs-identifier hs-var">getDerivedIns</span></a></span><span>
</span><span id="line-297"></span><span>        </span><span id="local-6989586621679366819"><span class="annot"><span class="annottext">[CodeVarChunk]
</span><a href="#local-6989586621679366819"><span class="hs-identifier hs-var">outs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenState [CodeVarChunk]
</span><a href="Language.Drasil.Code.Imperative.Parameters.html#getDerivedOuts"><span class="hs-identifier hs-var">getDerivedOuts</span></a></span><span>
</span><span id="line-298"></span><span>        </span><span id="local-6989586621679366820"><span class="annot"><span class="annottext">[MS (r (Block r))]
</span><a href="#local-6989586621679366820"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(CodeDefinition -&gt; StateT DrasilState Identity (MS (r (Block r))))
-&gt; [CodeDefinition]
-&gt; StateT DrasilState Identity [MS (r (Block r))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679366821"><span class="annot"><span class="annottext">CodeDefinition
</span><a href="#local-6989586621679366821"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CalcType
-&gt; CodeDefinition
-&gt; CodeExpr
-&gt; StateT DrasilState Identity (MS (r (Block r)))
forall (r :: * -&gt; *).
OOProg r =&gt;
CalcType -&gt; CodeDefinition -&gt; CodeExpr -&gt; GenState (MSBlock r)
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genCalcBlock"><span class="hs-identifier hs-var">genCalcBlock</span></a></span><span> </span><span class="annot"><span class="annottext">CalcType
</span><a href="Language.Drasil.Code.Imperative.Modules.html#CalcAssign"><span class="hs-identifier hs-var">CalcAssign</span></a></span><span> </span><span class="annot"><span class="annottext">CodeDefinition
</span><a href="#local-6989586621679366821"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeDefinition
</span><a href="#local-6989586621679366821"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CodeDefinition
-&gt; Getting CodeExpr CodeDefinition CodeExpr -&gt; CodeExpr
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting CodeExpr CodeDefinition CodeExpr
forall c. DefiningCodeExpr c =&gt; Lens' c CodeExpr
Lens' CodeDefinition CodeExpr
</span><span class="hs-identifier hs-var">codeExpr</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CodeDefinition]
</span><a href="#local-6989586621679366513"><span class="hs-identifier hs-var">dvals</span></a></span><span>
</span><span id="line-299"></span><span>        </span><span id="local-6989586621679366824"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679366824"><span class="hs-identifier hs-var">desc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenState String
</span><a href="Language.Drasil.Code.Imperative.Descriptions.html#dvFuncDesc"><span class="hs-identifier hs-var">dvFuncDesc</span></a></span><span>
</span><span id="line-300"></span><span>        </span><span id="local-6989586621679366825"><span class="annot"><span class="annottext">MS (r (Method r))
</span><a href="#local-6989586621679366825"><span class="hs-identifier hs-var">mthd</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VisibilityTag
-&gt; String
-&gt; String
-&gt; [CodeVarChunk]
-&gt; [CodeVarChunk]
-&gt; [MS (r (Block r))]
-&gt; StateT DrasilState Identity (MS (r (Method r)))
forall {r :: * -&gt; *}.
OOProg r =&gt;
VisibilityTag
-&gt; String
-&gt; String
-&gt; [CodeVarChunk]
-&gt; [CodeVarChunk]
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="#local-6989586621679366801"><span class="hs-identifier hs-var">getFunc</span></a></span><span> </span><span class="annot"><span class="annottext">VisibilityTag
</span><a href="#local-6989586621679366507"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679366510"><span class="hs-identifier hs-var">dvName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679366824"><span class="hs-identifier hs-var">desc</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeVarChunk]
</span><a href="#local-6989586621679366818"><span class="hs-identifier hs-var">ins</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeVarChunk]
</span><a href="#local-6989586621679366819"><span class="hs-identifier hs-var">outs</span></a></span><span> </span><span class="annot"><span class="annottext">[MS (r (Block r))]
</span><a href="#local-6989586621679366820"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-301"></span><span>        </span><span class="annot"><span class="annottext">Maybe (MS (r (Method r)))
-&gt; StateT DrasilState Identity (Maybe (MS (r (Method r))))
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (MS (r (Method r)))
 -&gt; StateT DrasilState Identity (Maybe (MS (r (Method r)))))
-&gt; Maybe (MS (r (Method r)))
-&gt; StateT DrasilState Identity (Maybe (MS (r (Method r))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MS (r (Method r)) -&gt; Maybe (MS (r (Method r)))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">MS (r (Method r))
</span><a href="#local-6989586621679366825"><span class="hs-identifier hs-var">mthd</span></a></span><span>
</span><span id="line-302"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; GenState (Maybe (SMethod r))
forall {r :: * -&gt; *}.
OOProg r =&gt;
Bool -&gt; StateT DrasilState Identity (Maybe (MS (r (Method r))))
</span><a href="#local-6989586621679366803"><span class="hs-identifier hs-var">genDerived</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; GenState (Maybe (SMethod r)))
-&gt; Bool -&gt; GenState (Maybe (SMethod r))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679366510"><span class="hs-identifier hs-var">dvName</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Set String -&gt; Bool
forall a. Eq a =&gt; a -&gt; Set a -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; Set String
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#defSet"><span class="hs-identifier hs-var">defSet</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679366508"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-303"></span><span>
</span><span id="line-304"></span><span class="annot"><span class="hs-comment">-- | Generates function that checks constraints on the input.</span></span><span>
</span><span id="line-305"></span><span id="local-6989586621679366826"><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genInputConstraints"><span class="hs-identifier hs-type">genInputConstraints</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679366826"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VisibilityTag</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-306"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679366826"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-307"></span><span id="genInputConstraints"><span class="annot"><span class="annottext">genInputConstraints :: forall (r :: * -&gt; *).
OOProg r =&gt;
VisibilityTag -&gt; GenState (Maybe (SMethod r))
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genInputConstraints"><span class="hs-identifier hs-var hs-var">genInputConstraints</span></a></span></span><span> </span><span id="local-6989586621679366836"><span class="annot"><span class="annottext">VisibilityTag
</span><a href="#local-6989586621679366836"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-308"></span><span>  </span><span id="local-6989586621679366837"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679366837"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-309"></span><span>  </span><span class="annot"><span class="annottext">(DrasilState -&gt; DrasilState) -&gt; StateT DrasilState Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679366838"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679366838"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679366838"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#currentScope"><span class="hs-identifier hs-var">currentScope</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#Local"><span class="hs-identifier hs-type">Local</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span>  </span><span id="local-6989586621679366839"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679366839"><span class="hs-identifier hs-var">icName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">InternalConcept -&gt; GenState String
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#genICName"><span class="hs-identifier hs-var">genICName</span></a></span><span> </span><span class="annot"><span class="annottext">InternalConcept
</span><a href="Language.Drasil.Choices.html#InputConstraintsFn"><span class="hs-identifier hs-var">InputConstraintsFn</span></a></span><span>
</span><span id="line-311"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679366842"><span class="annot"><span class="annottext">cm :: ConstraintCEMap
</span><a href="#local-6989586621679366842"><span class="hs-identifier hs-var hs-var">cm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; CodeSpec
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#codeSpec"><span class="hs-identifier hs-var">codeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679366837"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">CodeSpec
-&gt; Getting ConstraintCEMap CodeSpec ConstraintCEMap
-&gt; ConstraintCEMap
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting ConstraintCEMap CodeSpec ConstraintCEMap
forall c. HasOldCodeSpec c =&gt; Lens' c ConstraintCEMap
Lens' CodeSpec ConstraintCEMap
</span><a href="Language.Drasil.CodeSpec.html#cMapO"><span class="hs-identifier hs-var">cMapO</span></a></span><span>
</span><span id="line-312"></span><span>      </span><span id="local-6989586621679367130"><span class="annot"><span class="annottext">getFunc :: VisibilityTag
-&gt; String
-&gt; VSType r
-&gt; String
-&gt; [ParameterChunk]
-&gt; Maybe String
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="#local-6989586621679367130"><span class="hs-identifier hs-var hs-var">getFunc</span></a></span></span><span> </span><span class="annot"><span class="annottext">VisibilityTag
</span><span class="hs-identifier hs-var">Pub</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; VSType r
-&gt; String
-&gt; [ParameterChunk]
-&gt; Maybe String
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
forall (r :: * -&gt; *).
OOProg r =&gt;
String
-&gt; VSType r
-&gt; String
-&gt; [ParameterChunk]
-&gt; Maybe String
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#publicFunc"><span class="hs-identifier hs-var">publicFunc</span></a></span><span>
</span><span id="line-313"></span><span>      </span><span class="annot"><a href="#local-6989586621679367130"><span class="hs-identifier hs-var">getFunc</span></a></span><span> </span><span class="annot"><span class="annottext">VisibilityTag
</span><span class="hs-identifier hs-var">Priv</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; VSType r
-&gt; String
-&gt; [ParameterChunk]
-&gt; Maybe String
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
forall (r :: * -&gt; *).
OOProg r =&gt;
String
-&gt; VSType r
-&gt; String
-&gt; [ParameterChunk]
-&gt; Maybe String
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#privateMethod"><span class="hs-identifier hs-var">privateMethod</span></a></span><span>
</span><span id="line-314"></span><span>      </span><span id="local-6989586621679367131"><span class="annot"><a href="#local-6989586621679367132"><span class="hs-identifier hs-type">genConstraints</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679367131"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span>
</span><span id="line-315"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679367131"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-316"></span><span>      </span><span id="local-6989586621679367132"><span class="annot"><span class="annottext">genConstraints :: forall {r :: * -&gt; *}.
OOProg r =&gt;
Bool -&gt; StateT DrasilState Identity (Maybe (MS (r (Method r))))
</span><a href="#local-6989586621679367132"><span class="hs-identifier hs-var hs-var">genConstraints</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (MS (r (Method r)))
-&gt; StateT DrasilState Identity (Maybe (MS (r (Method r))))
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe (MS (r (Method r)))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-317"></span><span>      </span><span class="annot"><a href="#local-6989586621679367132"><span class="hs-identifier hs-var">genConstraints</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-318"></span><span>        </span><span id="local-6989586621679367154"><span class="annot"><span class="annottext">[CodeVarChunk]
</span><a href="#local-6989586621679367154"><span class="hs-identifier hs-var">parms</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenState [CodeVarChunk]
</span><a href="Language.Drasil.Code.Imperative.Parameters.html#getConstraintParams"><span class="hs-identifier hs-var">getConstraintParams</span></a></span><span>
</span><span id="line-319"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679367164"><span class="annot"><span class="annottext">varsList :: [CodeVarChunk]
</span><a href="#local-6989586621679367164"><span class="hs-identifier hs-var hs-var">varsList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CodeVarChunk -&gt; Bool) -&gt; [CodeVarChunk] -&gt; [CodeVarChunk]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679367165"><span class="annot"><span class="annottext">CodeVarChunk
</span><a href="#local-6989586621679367165"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UID -&gt; ConstraintCEMap -&gt; Bool
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Bool
</span><span class="hs-identifier hs-var">member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeVarChunk
</span><a href="#local-6989586621679367165"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">CodeVarChunk -&gt; Getting UID CodeVarChunk UID -&gt; UID
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting UID CodeVarChunk UID
forall c. HasUID c =&gt; Getter c UID
Getter CodeVarChunk UID
</span><span class="hs-identifier hs-var">uid</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ConstraintCEMap
</span><a href="#local-6989586621679366842"><span class="hs-identifier hs-var">cm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; CodeSpec
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#codeSpec"><span class="hs-identifier hs-var">codeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679366837"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">CodeSpec
-&gt; Getting [CodeVarChunk] CodeSpec [CodeVarChunk] -&gt; [CodeVarChunk]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting [CodeVarChunk] CodeSpec [CodeVarChunk]
forall c. HasOldCodeSpec c =&gt; Lens' c [CodeVarChunk]
Lens' CodeSpec [CodeVarChunk]
</span><a href="Language.Drasil.CodeSpec.html#inputsO"><span class="hs-identifier hs-var">inputsO</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-320"></span><span>            </span><span id="local-6989586621679367167"><span class="annot"><span class="annottext">sfwrCs :: [(CodeVarChunk, [ConstraintCE])]
</span><a href="#local-6989586621679367167"><span class="hs-identifier hs-var hs-var">sfwrCs</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CodeVarChunk -&gt; (CodeVarChunk, [ConstraintCE]))
-&gt; [CodeVarChunk] -&gt; [(CodeVarChunk, [ConstraintCE])]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConstraintCEMap -&gt; CodeVarChunk -&gt; (CodeVarChunk, [ConstraintCE])
forall q. HasUID q =&gt; ConstraintCEMap -&gt; q -&gt; (q, [ConstraintCE])
</span><a href="Language.Drasil.Chunk.ConstraintMap.html#sfwrLookup"><span class="hs-identifier hs-var">sfwrLookup</span></a></span><span> </span><span class="annot"><span class="annottext">ConstraintCEMap
</span><a href="#local-6989586621679366842"><span class="hs-identifier hs-var">cm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CodeVarChunk]
</span><a href="#local-6989586621679367164"><span class="hs-identifier hs-var">varsList</span></a></span><span>
</span><span id="line-321"></span><span>            </span><span id="local-6989586621679367169"><span class="annot"><span class="annottext">physCs :: [(CodeVarChunk, [ConstraintCE])]
</span><a href="#local-6989586621679367169"><span class="hs-identifier hs-var hs-var">physCs</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CodeVarChunk -&gt; (CodeVarChunk, [ConstraintCE]))
-&gt; [CodeVarChunk] -&gt; [(CodeVarChunk, [ConstraintCE])]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConstraintCEMap -&gt; CodeVarChunk -&gt; (CodeVarChunk, [ConstraintCE])
forall q. HasUID q =&gt; ConstraintCEMap -&gt; q -&gt; (q, [ConstraintCE])
</span><a href="Language.Drasil.Chunk.ConstraintMap.html#physLookup"><span class="hs-identifier hs-var">physLookup</span></a></span><span> </span><span class="annot"><span class="annottext">ConstraintCEMap
</span><a href="#local-6989586621679366842"><span class="hs-identifier hs-var">cm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CodeVarChunk]
</span><a href="#local-6989586621679367164"><span class="hs-identifier hs-var">varsList</span></a></span><span>
</span><span id="line-322"></span><span>        </span><span id="local-6989586621679367170"><span class="annot"><span class="annottext">[MS (r (Statement r))]
</span><a href="#local-6989586621679367170"><span class="hs-identifier hs-var">sf</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(CodeVarChunk, [ConstraintCE])]
-&gt; StateT DrasilState Identity [MS (r (Statement r))]
forall (r :: * -&gt; *).
OOProg r =&gt;
[(CodeVarChunk, [ConstraintCE])] -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Modules.html#sfwrCBody"><span class="hs-identifier hs-var">sfwrCBody</span></a></span><span> </span><span class="annot"><span class="annottext">[(CodeVarChunk, [ConstraintCE])]
</span><a href="#local-6989586621679367167"><span class="hs-identifier hs-var">sfwrCs</span></a></span><span>
</span><span id="line-323"></span><span>        </span><span id="local-6989586621679367172"><span class="annot"><span class="annottext">[MS (r (Statement r))]
</span><a href="#local-6989586621679367172"><span class="hs-identifier hs-var">ph</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(CodeVarChunk, [ConstraintCE])]
-&gt; StateT DrasilState Identity [MS (r (Statement r))]
forall (r :: * -&gt; *).
OOProg r =&gt;
[(CodeVarChunk, [ConstraintCE])] -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Modules.html#physCBody"><span class="hs-identifier hs-var">physCBody</span></a></span><span> </span><span class="annot"><span class="annottext">[(CodeVarChunk, [ConstraintCE])]
</span><a href="#local-6989586621679367169"><span class="hs-identifier hs-var">physCs</span></a></span><span>
</span><span id="line-324"></span><span>        </span><span id="local-6989586621679367174"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679367174"><span class="hs-identifier hs-var">desc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenState String
</span><a href="Language.Drasil.Code.Imperative.Descriptions.html#inConsFuncDesc"><span class="hs-identifier hs-var">inConsFuncDesc</span></a></span><span>
</span><span id="line-325"></span><span>        </span><span id="local-6989586621679367175"><span class="annot"><span class="annottext">MS (r (Method r))
</span><a href="#local-6989586621679367175"><span class="hs-identifier hs-var">mthd</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VisibilityTag
-&gt; String
-&gt; VS (r (Type r))
-&gt; String
-&gt; [ParameterChunk]
-&gt; Maybe String
-&gt; [MS (r (Block r))]
-&gt; StateT DrasilState Identity (MS (r (Method r)))
forall {r :: * -&gt; *}.
OOProg r =&gt;
VisibilityTag
-&gt; String
-&gt; VSType r
-&gt; String
-&gt; [ParameterChunk]
-&gt; Maybe String
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="#local-6989586621679367130"><span class="hs-identifier hs-var">getFunc</span></a></span><span> </span><span class="annot"><span class="annottext">VisibilityTag
</span><a href="#local-6989586621679366836"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679366839"><span class="hs-identifier hs-var">icName</span></a></span><span> </span><span class="annot"><span class="annottext">VS (r (Type r))
forall (r :: * -&gt; *). TypeSym r =&gt; VSType r
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679367174"><span class="hs-identifier hs-var">desc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CodeVarChunk -&gt; ParameterChunk)
-&gt; [CodeVarChunk] -&gt; [ParameterChunk]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">CodeVarChunk -&gt; ParameterChunk
forall c. CodeIdea c =&gt; c -&gt; ParameterChunk
</span><a href="Language.Drasil.Chunk.Parameter.html#pcAuto"><span class="hs-identifier hs-var">pcAuto</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeVarChunk]
</span><a href="#local-6989586621679367154"><span class="hs-identifier hs-var">parms</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-326"></span><span>          </span><span class="annot"><span class="annottext">Maybe String
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[MS (r (Statement r))] -&gt; MS (r (Block r))
forall (r :: * -&gt; *). BlockSym r =&gt; [MSStatement r] -&gt; MSBlock r
</span><span class="hs-identifier hs-var">block</span></span><span> </span><span class="annot"><span class="annottext">[MS (r (Statement r))]
</span><a href="#local-6989586621679367170"><span class="hs-identifier hs-var">sf</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[MS (r (Statement r))] -&gt; MS (r (Block r))
forall (r :: * -&gt; *). BlockSym r =&gt; [MSStatement r] -&gt; MSBlock r
</span><span class="hs-identifier hs-var">block</span></span><span> </span><span class="annot"><span class="annottext">[MS (r (Statement r))]
</span><a href="#local-6989586621679367172"><span class="hs-identifier hs-var">ph</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-327"></span><span>        </span><span class="annot"><span class="annottext">Maybe (MS (r (Method r)))
-&gt; StateT DrasilState Identity (Maybe (MS (r (Method r))))
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (MS (r (Method r)))
 -&gt; StateT DrasilState Identity (Maybe (MS (r (Method r)))))
-&gt; Maybe (MS (r (Method r)))
-&gt; StateT DrasilState Identity (Maybe (MS (r (Method r))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MS (r (Method r)) -&gt; Maybe (MS (r (Method r)))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">MS (r (Method r))
</span><a href="#local-6989586621679367175"><span class="hs-identifier hs-var">mthd</span></a></span><span>
</span><span id="line-328"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; GenState (Maybe (SMethod r))
forall {r :: * -&gt; *}.
OOProg r =&gt;
Bool -&gt; StateT DrasilState Identity (Maybe (MS (r (Method r))))
</span><a href="#local-6989586621679367132"><span class="hs-identifier hs-var">genConstraints</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; GenState (Maybe (SMethod r)))
-&gt; Bool -&gt; GenState (Maybe (SMethod r))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679366839"><span class="hs-identifier hs-var">icName</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Set String -&gt; Bool
forall a. Eq a =&gt; a -&gt; Set a -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; Set String
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#defSet"><span class="hs-identifier hs-var">defSet</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679366837"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-329"></span><span>
</span><span id="line-330"></span><span class="annot"><span class="hs-comment">-- | Generates input constraints code block for checking software constraints.</span></span><span>
</span><span id="line-331"></span><span id="local-6989586621679363364"><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#sfwrCBody"><span class="hs-identifier hs-type">sfwrCBody</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679363364"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CodeVarChunk</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#ConstraintCE"><span class="hs-identifier hs-type">ConstraintCE</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-332"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSStatement</span></span><span> </span><span class="annot"><a href="#local-6989586621679363364"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-333"></span><span id="sfwrCBody"><span class="annot"><span class="annottext">sfwrCBody :: forall (r :: * -&gt; *).
OOProg r =&gt;
[(CodeVarChunk, [ConstraintCE])] -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Modules.html#sfwrCBody"><span class="hs-identifier hs-var hs-var">sfwrCBody</span></a></span></span><span> </span><span id="local-6989586621679367181"><span class="annot"><span class="annottext">[(CodeVarChunk, [ConstraintCE])]
</span><a href="#local-6989586621679367181"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-334"></span><span>  </span><span id="local-6989586621679367182"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679367182"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-335"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679367183"><span class="annot"><span class="annottext">cb :: ConstraintBehaviour
</span><a href="#local-6989586621679367183"><span class="hs-identifier hs-var hs-var">cb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; ConstraintBehaviour
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#onSfwrC"><span class="hs-identifier hs-var">onSfwrC</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679367182"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-336"></span><span>  </span><span class="annot"><span class="annottext">ConstraintBehaviour
-&gt; [(CodeVarChunk, [ConstraintCE])] -&gt; GenState [MSStatement r]
forall (r :: * -&gt; *).
OOProg r =&gt;
ConstraintBehaviour
-&gt; [(CodeVarChunk, [ConstraintCE])] -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Modules.html#chooseConstr"><span class="hs-identifier hs-var">chooseConstr</span></a></span><span> </span><span class="annot"><span class="annottext">ConstraintBehaviour
</span><a href="#local-6989586621679367183"><span class="hs-identifier hs-var">cb</span></a></span><span> </span><span class="annot"><span class="annottext">[(CodeVarChunk, [ConstraintCE])]
</span><a href="#local-6989586621679367181"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-337"></span><span>
</span><span id="line-338"></span><span class="annot"><span class="hs-comment">-- | Generates input constraints code block for checking physical constraints.</span></span><span>
</span><span id="line-339"></span><span id="local-6989586621679367186"><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#physCBody"><span class="hs-identifier hs-type">physCBody</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679367186"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CodeVarChunk</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#ConstraintCE"><span class="hs-identifier hs-type">ConstraintCE</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-340"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSStatement</span></span><span> </span><span class="annot"><a href="#local-6989586621679367186"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-341"></span><span id="physCBody"><span class="annot"><span class="annottext">physCBody :: forall (r :: * -&gt; *).
OOProg r =&gt;
[(CodeVarChunk, [ConstraintCE])] -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Modules.html#physCBody"><span class="hs-identifier hs-var hs-var">physCBody</span></a></span></span><span> </span><span id="local-6989586621679367191"><span class="annot"><span class="annottext">[(CodeVarChunk, [ConstraintCE])]
</span><a href="#local-6989586621679367191"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-342"></span><span>  </span><span id="local-6989586621679367192"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679367192"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-343"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679367193"><span class="annot"><span class="annottext">cb :: ConstraintBehaviour
</span><a href="#local-6989586621679367193"><span class="hs-identifier hs-var hs-var">cb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; ConstraintBehaviour
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#onPhysC"><span class="hs-identifier hs-var">onPhysC</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679367192"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-344"></span><span>  </span><span class="annot"><span class="annottext">ConstraintBehaviour
-&gt; [(CodeVarChunk, [ConstraintCE])] -&gt; GenState [MSStatement r]
forall (r :: * -&gt; *).
OOProg r =&gt;
ConstraintBehaviour
-&gt; [(CodeVarChunk, [ConstraintCE])] -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Modules.html#chooseConstr"><span class="hs-identifier hs-var">chooseConstr</span></a></span><span> </span><span class="annot"><span class="annottext">ConstraintBehaviour
</span><a href="#local-6989586621679367193"><span class="hs-identifier hs-var">cb</span></a></span><span> </span><span class="annot"><span class="annottext">[(CodeVarChunk, [ConstraintCE])]
</span><a href="#local-6989586621679367191"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-345"></span><span>
</span><span id="line-346"></span><span class="hs-comment">-- | Generates conditional statements for checking constraints, where the</span><span>
</span><span id="line-347"></span><span class="hs-comment">-- bodies depend on user's choice of constraint violation behaviour.</span><span>
</span><span id="line-348"></span><span id="local-6989586621679363368"><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#chooseConstr"><span class="hs-identifier hs-type">chooseConstr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679363368"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#ConstraintBehaviour"><span class="hs-identifier hs-type">ConstraintBehaviour</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-349"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CodeVarChunk</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#ConstraintCE"><span class="hs-identifier hs-type">ConstraintCE</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSStatement</span></span><span> </span><span class="annot"><a href="#local-6989586621679363368"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-350"></span><span id="chooseConstr"><span class="annot"><span class="annottext">chooseConstr :: forall (r :: * -&gt; *).
OOProg r =&gt;
ConstraintBehaviour
-&gt; [(CodeVarChunk, [ConstraintCE])] -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Modules.html#chooseConstr"><span class="hs-identifier hs-var hs-var">chooseConstr</span></a></span></span><span> </span><span id="local-6989586621679367230"><span class="annot"><span class="annottext">ConstraintBehaviour
</span><a href="#local-6989586621679367230"><span class="hs-identifier hs-var">cb</span></a></span></span><span> </span><span id="local-6989586621679367231"><span class="annot"><span class="annottext">[(CodeVarChunk, [ConstraintCE])]
</span><a href="#local-6989586621679367231"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-351"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679367233"><span class="annot"><span class="annottext">ch :: [(CodeVarChunk, ConstraintCE)]
</span><a href="#local-6989586621679367233"><span class="hs-identifier hs-var hs-var">ch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((CodeVarChunk, [ConstraintCE]) -&gt; [(CodeVarChunk, ConstraintCE)])
-&gt; [(CodeVarChunk, [ConstraintCE])]
-&gt; [(CodeVarChunk, ConstraintCE)]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679367235"><span class="annot"><span class="annottext">CodeVarChunk
</span><a href="#local-6989586621679367235"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679367236"><span class="annot"><span class="annottext">[ConstraintCE]
</span><a href="#local-6989586621679367236"><span class="hs-identifier hs-var">ns</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeVarChunk
</span><a href="#local-6989586621679367235"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ConstraintCE
</span><a href="#local-6989586621679367237"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679367237"><span class="annot"><span class="annottext">ConstraintCE
</span><a href="#local-6989586621679367237"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ConstraintCE]
</span><a href="#local-6989586621679367236"><span class="hs-identifier hs-var">ns</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(CodeVarChunk, [ConstraintCE])]
</span><a href="#local-6989586621679367231"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-352"></span><span>  </span><span class="hs-comment">-- Generate variable declarations based on constraints</span><span>
</span><span id="line-353"></span><span>  </span><span id="local-6989586621679367238"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679367238"><span class="hs-identifier hs-var">varDecs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((CodeVarChunk, ConstraintCE)
 -&gt; StateT DrasilState Identity (MSStatement r))
-&gt; [(CodeVarChunk, ConstraintCE)] -&gt; GenState [MSStatement r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-354"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679367239"><span class="annot"><span class="annottext">CodeVarChunk
</span><a href="#local-6989586621679367239"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Elem</span></span><span> </span><span class="annot"><span class="annottext">ConstraintReason
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679367241"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679367241"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CodeVarChunk
-&gt; CodeExpr -&gt; StateT DrasilState Identity (MSStatement r)
forall (r :: * -&gt; *).
OOProg r =&gt;
CodeVarChunk -&gt; CodeExpr -&gt; GenState (MSStatement r)
</span><a href="Language.Drasil.Code.Imperative.Modules.html#constrVarDec"><span class="hs-identifier hs-var">constrVarDec</span></a></span><span> </span><span class="annot"><span class="annottext">CodeVarChunk
</span><a href="#local-6989586621679367239"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679367241"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-355"></span><span>    </span><span class="annot"><span class="annottext">(CodeVarChunk, ConstraintCE)
</span><span class="hs-identifier">_</span></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MSStatement r -&gt; StateT DrasilState Identity (MSStatement r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">MSStatement r
forall (r :: * -&gt; *). StatementSym r =&gt; MSStatement r
</span><span class="hs-identifier hs-var">emptyStmt</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(CodeVarChunk, ConstraintCE)]
</span><a href="#local-6989586621679367233"><span class="hs-identifier hs-var">ch</span></a></span><span>
</span><span id="line-356"></span><span>  </span><span class="hs-comment">-- Generate conditions for constraints</span><span>
</span><span id="line-357"></span><span>  </span><span id="local-6989586621679367244"><span class="annot"><span class="annottext">[[VS (r (Value r))]]
</span><a href="#local-6989586621679367244"><span class="hs-identifier hs-var">conds</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((CodeVarChunk, [ConstraintCE])
 -&gt; StateT DrasilState Identity [VS (r (Value r))])
-&gt; [(CodeVarChunk, [ConstraintCE])]
-&gt; StateT DrasilState Identity [[VS (r (Value r))]]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679367245"><span class="annot"><span class="annottext">CodeVarChunk
</span><a href="#local-6989586621679367245"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679367246"><span class="annot"><span class="annottext">[ConstraintCE]
</span><a href="#local-6989586621679367246"><span class="hs-identifier hs-var">cns</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(ConstraintCE -&gt; StateT DrasilState Identity (VS (r (Value r))))
-&gt; [ConstraintCE] -&gt; StateT DrasilState Identity [VS (r (Value r))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">(CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r))))
-&gt; (ConstraintCE -&gt; CodeExpr)
-&gt; ConstraintCE
-&gt; StateT DrasilState Identity (VS (r (Value r)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CodeVarChunk -&gt; ConstraintCE -&gt; CodeExpr
forall c. (HasUID c, HasSymbol c) =&gt; c -&gt; ConstraintCE -&gt; CodeExpr
</span><a href="Language.Drasil.Code.Imperative.Import.html#renderC"><span class="hs-identifier hs-var">renderC</span></a></span><span> </span><span class="annot"><span class="annottext">CodeVarChunk
</span><a href="#local-6989586621679367245"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ConstraintCE]
</span><a href="#local-6989586621679367246"><span class="hs-identifier hs-var">cns</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(CodeVarChunk, [ConstraintCE])]
</span><a href="#local-6989586621679367231"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-358"></span><span>  </span><span class="hs-comment">-- Generate bodies based on constraint behavior</span><span>
</span><span id="line-359"></span><span>  </span><span id="local-6989586621679367247"><span class="annot"><span class="annottext">[[MS (r (Body r))]]
</span><a href="#local-6989586621679367247"><span class="hs-identifier hs-var">bods</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((CodeVarChunk, [ConstraintCE])
 -&gt; StateT DrasilState Identity [MS (r (Body r))])
-&gt; [(CodeVarChunk, [ConstraintCE])]
-&gt; StateT DrasilState Identity [[MS (r (Body r))]]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConstraintBehaviour
-&gt; (CodeVarChunk, [ConstraintCE])
-&gt; StateT DrasilState Identity [MS (r (Body r))]
forall {r :: * -&gt; *}.
OOProg r =&gt;
ConstraintBehaviour
-&gt; (CodeVarChunk, [ConstraintCE]) -&gt; GenState [MS (r (Body r))]
</span><a href="#local-6989586621679367248"><span class="hs-identifier hs-var">chooseCB</span></a></span><span> </span><span class="annot"><span class="annottext">ConstraintBehaviour
</span><a href="#local-6989586621679367230"><span class="hs-identifier hs-var">cb</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(CodeVarChunk, [ConstraintCE])]
</span><a href="#local-6989586621679367231"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-360"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679367261"><span class="annot"><span class="annottext">bodies :: [MSStatement r]
</span><a href="#local-6989586621679367261"><span class="hs-identifier hs-var hs-var">bodies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[MSStatement r]] -&gt; [MSStatement r]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">([[MSStatement r]] -&gt; [MSStatement r])
-&gt; [[MSStatement r]] -&gt; [MSStatement r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">([VS (r (Value r))] -&gt; [MS (r (Body r))] -&gt; [MSStatement r])
-&gt; [[VS (r (Value r))]] -&gt; [[MS (r (Body r))]] -&gt; [[MSStatement r]]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(VS (r (Value r)) -&gt; MS (r (Body r)) -&gt; MSStatement r)
-&gt; [VS (r (Value r))] -&gt; [MS (r (Body r))] -&gt; [MSStatement r]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679367262"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679367262"><span class="hs-identifier hs-var">cond</span></a></span></span><span> </span><span id="local-6989586621679367263"><span class="annot"><span class="annottext">MS (r (Body r))
</span><a href="#local-6989586621679367263"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[(VS (r (Value r)), MS (r (Body r)))] -&gt; MSStatement r
forall (r :: * -&gt; *).
ControlStatement r =&gt;
[(SValue r, MSBody r)] -&gt; MSStatement r
</span><span class="hs-identifier hs-var">ifNoElse</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">VS (r (Value r)) -&gt; VS (r (Value r))
forall (r :: * -&gt; *). BooleanExpression r =&gt; SValue r -&gt; SValue r
</span><span class="hs-operator hs-var">(?!)</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679367262"><span class="hs-identifier hs-var">cond</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MS (r (Body r))
</span><a href="#local-6989586621679367263"><span class="hs-identifier hs-var">bod</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[[VS (r (Value r))]]
</span><a href="#local-6989586621679367244"><span class="hs-identifier hs-var">conds</span></a></span><span> </span><span class="annot"><span class="annottext">[[MS (r (Body r))]]
</span><a href="#local-6989586621679367247"><span class="hs-identifier hs-var">bods</span></a></span><span>
</span><span id="line-361"></span><span>  </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; GenState [MSStatement r]
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([MSStatement r] -&gt; GenState [MSStatement r])
-&gt; [MSStatement r] -&gt; GenState [MSStatement r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; [MSStatement r] -&gt; [MSStatement r]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">interleave</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679367238"><span class="hs-identifier hs-var">varDecs</span></a></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679367261"><span class="hs-identifier hs-var">bodies</span></a></span><span>
</span><span id="line-362"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679367248"><span class="annot"><span class="annottext">chooseCB :: ConstraintBehaviour
-&gt; (CodeVarChunk, [ConstraintCE]) -&gt; GenState [MS (r (Body r))]
</span><a href="#local-6989586621679367248"><span class="hs-identifier hs-var hs-var">chooseCB</span></a></span></span><span> </span><span class="annot"><span class="annottext">ConstraintBehaviour
</span><a href="Language.Drasil.Choices.html#Warning"><span class="hs-identifier hs-var">Warning</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CodeVarChunk, [ConstraintCE]) -&gt; GenState [MS (r (Body r))]
forall (r :: * -&gt; *).
OOProg r =&gt;
(CodeVarChunk, [ConstraintCE]) -&gt; GenState [MSBody r]
</span><a href="Language.Drasil.Code.Imperative.Modules.html#constrWarn"><span class="hs-identifier hs-var">constrWarn</span></a></span><span>
</span><span id="line-363"></span><span>        </span><span class="annot"><a href="#local-6989586621679367248"><span class="hs-identifier hs-var">chooseCB</span></a></span><span> </span><span class="annot"><span class="annottext">ConstraintBehaviour
</span><a href="Language.Drasil.Choices.html#Exception"><span class="hs-identifier hs-var">Exception</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CodeVarChunk, [ConstraintCE]) -&gt; GenState [MS (r (Body r))]
forall (r :: * -&gt; *).
OOProg r =&gt;
(CodeVarChunk, [ConstraintCE]) -&gt; GenState [MSBody r]
</span><a href="Language.Drasil.Code.Imperative.Modules.html#constrExc"><span class="hs-identifier hs-var">constrExc</span></a></span><span>
</span><span id="line-364"></span><span>
</span><span id="line-365"></span><span>
</span><span id="line-366"></span><span class="hs-comment">-- | Generates body defining constraint violation behaviour if Warning chosen from 'chooseConstr'.</span><span>
</span><span id="line-367"></span><span class="hs-comment">-- Prints a \&quot;Warning\&quot; message followed by a message that says</span><span>
</span><span id="line-368"></span><span class="hs-comment">-- what value was \&quot;suggested\&quot;.</span><span>
</span><span id="line-369"></span><span id="local-6989586621679363381"><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#constrWarn"><span class="hs-identifier hs-type">constrWarn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679363381"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CodeVarChunk</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#ConstraintCE"><span class="hs-identifier hs-type">ConstraintCE</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-370"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSBody</span></span><span> </span><span class="annot"><a href="#local-6989586621679363381"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-371"></span><span id="constrWarn"><span class="annot"><span class="annottext">constrWarn :: forall (r :: * -&gt; *).
OOProg r =&gt;
(CodeVarChunk, [ConstraintCE]) -&gt; GenState [MSBody r]
</span><a href="Language.Drasil.Code.Imperative.Modules.html#constrWarn"><span class="hs-identifier hs-var hs-var">constrWarn</span></a></span></span><span> </span><span id="local-6989586621679367567"><span class="annot"><span class="annottext">(CodeVarChunk, [ConstraintCE])
</span><a href="#local-6989586621679367567"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-372"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679367568"><span class="annot"><span class="annottext">q :: CodeVarChunk
</span><a href="#local-6989586621679367568"><span class="hs-identifier hs-var hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CodeVarChunk, [ConstraintCE]) -&gt; CodeVarChunk
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(CodeVarChunk, [ConstraintCE])
</span><a href="#local-6989586621679367567"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-373"></span><span>      </span><span id="local-6989586621679367570"><span class="annot"><span class="annottext">cs :: [ConstraintCE]
</span><a href="#local-6989586621679367570"><span class="hs-identifier hs-var hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CodeVarChunk, [ConstraintCE]) -&gt; [ConstraintCE]
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(CodeVarChunk, [ConstraintCE])
</span><a href="#local-6989586621679367567"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-374"></span><span>  </span><span id="local-6989586621679367572"><span class="annot"><span class="annottext">[[MS (r (Statement r))]]
</span><a href="#local-6989586621679367572"><span class="hs-identifier hs-var">msgs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ConstraintCE
 -&gt; StateT DrasilState Identity [MS (r (Statement r))])
-&gt; [ConstraintCE]
-&gt; StateT DrasilState Identity [[MS (r (Statement r))]]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeVarChunk
-&gt; String
-&gt; ConstraintCE
-&gt; StateT DrasilState Identity [MS (r (Statement r))]
forall (r :: * -&gt; *).
OOProg r =&gt;
CodeVarChunk -&gt; String -&gt; ConstraintCE -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Modules.html#constraintViolatedMsg"><span class="hs-identifier hs-var">constraintViolatedMsg</span></a></span><span> </span><span class="annot"><span class="annottext">CodeVarChunk
</span><a href="#local-6989586621679367568"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;suggested&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ConstraintCE]
</span><a href="#local-6989586621679367570"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-375"></span><span>  </span><span class="annot"><span class="annottext">[MSBody r] -&gt; GenState [MSBody r]
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([MSBody r] -&gt; GenState [MSBody r])
-&gt; [MSBody r] -&gt; GenState [MSBody r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">([MS (r (Statement r))] -&gt; MSBody r)
-&gt; [[MS (r (Statement r))]] -&gt; [MSBody r]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MS (r (Statement r))] -&gt; MSBody r
forall (r :: * -&gt; *). BodySym r =&gt; [MSStatement r] -&gt; MSBody r
</span><span class="hs-identifier hs-var">bodyStatements</span></span><span> </span><span class="annot"><span class="annottext">([MS (r (Statement r))] -&gt; MSBody r)
-&gt; ([MS (r (Statement r))] -&gt; [MS (r (Statement r))])
-&gt; [MS (r (Statement r))]
-&gt; MSBody r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; MS (r (Statement r))
forall (r :: * -&gt; *). IOStatement r =&gt; String -&gt; MSStatement r
</span><span class="hs-identifier hs-var">printStr</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Warning: &quot;</span></span><span> </span><span class="annot"><span class="annottext">MS (r (Statement r))
-&gt; [MS (r (Statement r))] -&gt; [MS (r (Statement r))]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[[MS (r (Statement r))]]
</span><a href="#local-6989586621679367572"><span class="hs-identifier hs-var">msgs</span></a></span><span>
</span><span id="line-376"></span><span>
</span><span id="line-377"></span><span>
</span><span id="line-378"></span><span class="hs-comment">-- | Generates body defining constraint violation behaviour if Exception chosen from 'chooseConstr'.</span><span>
</span><span id="line-379"></span><span class="hs-comment">-- Prints a message that says what value was \&quot;expected\&quot;,</span><span>
</span><span id="line-380"></span><span class="hs-comment">-- followed by throwing an exception.</span><span>
</span><span id="line-381"></span><span id="local-6989586621679367575"><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#constrExc"><span class="hs-identifier hs-type">constrExc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679367575"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CodeVarChunk</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#ConstraintCE"><span class="hs-identifier hs-type">ConstraintCE</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-382"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSBody</span></span><span> </span><span class="annot"><a href="#local-6989586621679367575"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-383"></span><span id="constrExc"><span class="annot"><span class="annottext">constrExc :: forall (r :: * -&gt; *).
OOProg r =&gt;
(CodeVarChunk, [ConstraintCE]) -&gt; GenState [MSBody r]
</span><a href="Language.Drasil.Code.Imperative.Modules.html#constrExc"><span class="hs-identifier hs-var hs-var">constrExc</span></a></span></span><span> </span><span id="local-6989586621679367588"><span class="annot"><span class="annottext">(CodeVarChunk, [ConstraintCE])
</span><a href="#local-6989586621679367588"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-384"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679367589"><span class="annot"><span class="annottext">q :: CodeVarChunk
</span><a href="#local-6989586621679367589"><span class="hs-identifier hs-var hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CodeVarChunk, [ConstraintCE]) -&gt; CodeVarChunk
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(CodeVarChunk, [ConstraintCE])
</span><a href="#local-6989586621679367588"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-385"></span><span>      </span><span id="local-6989586621679367590"><span class="annot"><span class="annottext">cs :: [ConstraintCE]
</span><a href="#local-6989586621679367590"><span class="hs-identifier hs-var hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CodeVarChunk, [ConstraintCE]) -&gt; [ConstraintCE]
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(CodeVarChunk, [ConstraintCE])
</span><a href="#local-6989586621679367588"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-386"></span><span>  </span><span id="local-6989586621679367591"><span class="annot"><span class="annottext">[[MS (r (Statement r))]]
</span><a href="#local-6989586621679367591"><span class="hs-identifier hs-var">msgs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ConstraintCE
 -&gt; StateT DrasilState Identity [MS (r (Statement r))])
-&gt; [ConstraintCE]
-&gt; StateT DrasilState Identity [[MS (r (Statement r))]]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeVarChunk
-&gt; String
-&gt; ConstraintCE
-&gt; StateT DrasilState Identity [MS (r (Statement r))]
forall (r :: * -&gt; *).
OOProg r =&gt;
CodeVarChunk -&gt; String -&gt; ConstraintCE -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Modules.html#constraintViolatedMsg"><span class="hs-identifier hs-var">constraintViolatedMsg</span></a></span><span> </span><span class="annot"><span class="annottext">CodeVarChunk
</span><a href="#local-6989586621679367589"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;expected&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ConstraintCE]
</span><a href="#local-6989586621679367590"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-387"></span><span>  </span><span class="annot"><span class="annottext">[MSBody r] -&gt; GenState [MSBody r]
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([MSBody r] -&gt; GenState [MSBody r])
-&gt; [MSBody r] -&gt; GenState [MSBody r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">([MS (r (Statement r))] -&gt; MSBody r)
-&gt; [[MS (r (Statement r))]] -&gt; [MSBody r]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MS (r (Statement r))] -&gt; MSBody r
forall (r :: * -&gt; *). BodySym r =&gt; [MSStatement r] -&gt; MSBody r
</span><span class="hs-identifier hs-var">bodyStatements</span></span><span> </span><span class="annot"><span class="annottext">([MS (r (Statement r))] -&gt; MSBody r)
-&gt; ([MS (r (Statement r))] -&gt; [MS (r (Statement r))])
-&gt; [MS (r (Statement r))]
-&gt; MSBody r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MS (r (Statement r))]
-&gt; [MS (r (Statement r))] -&gt; [MS (r (Statement r))]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; MS (r (Statement r))
forall (r :: * -&gt; *). ControlStatement r =&gt; String -&gt; MSStatement r
</span><span class="hs-identifier hs-var">throw</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;InputError&quot;</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[[MS (r (Statement r))]]
</span><a href="#local-6989586621679367591"><span class="hs-identifier hs-var">msgs</span></a></span><span>
</span><span id="line-388"></span><span>
</span><span id="line-389"></span><span class="annot"><span class="hs-comment">-- | Generates set variable dec</span></span><span>
</span><span id="line-390"></span><span id="local-6989586621679363376"><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#constrVarDec"><span class="hs-identifier hs-type">constrVarDec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679363376"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CodeVarChunk</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CodeExpr</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-391"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MSStatement</span></span><span> </span><span class="annot"><a href="#local-6989586621679363376"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-392"></span><span id="constrVarDec"><span class="annot"><span class="annottext">constrVarDec :: forall (r :: * -&gt; *).
OOProg r =&gt;
CodeVarChunk -&gt; CodeExpr -&gt; GenState (MSStatement r)
</span><a href="Language.Drasil.Code.Imperative.Modules.html#constrVarDec"><span class="hs-identifier hs-var hs-var">constrVarDec</span></a></span></span><span> </span><span id="local-6989586621679367608"><span class="annot"><span class="annottext">CodeVarChunk
</span><a href="#local-6989586621679367608"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679367609"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679367609"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-393"></span><span>  </span><span id="local-6989586621679367610"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679367610"><span class="hs-identifier hs-var">lb</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679367609"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-394"></span><span>  </span><span id="local-6989586621679367611"><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679367611"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeVarChunk -&gt; StateT DrasilState Identity CodeType
forall c. HasSpace c =&gt; c -&gt; StateT DrasilState Identity CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#codeType"><span class="hs-identifier hs-var">codeType</span></a></span><span> </span><span class="annot"><span class="annottext">CodeVarChunk
</span><a href="#local-6989586621679367608"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-395"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679367617"><span class="annot"><span class="annottext">mkValue :: SVariable r
</span><a href="#local-6989586621679367617"><span class="hs-identifier hs-var hs-var">mkValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; VSType r -&gt; SVariable r
forall (r :: * -&gt; *).
VariableSym r =&gt;
String -&gt; VSType r -&gt; SVariable r
</span><span class="hs-identifier hs-var">var</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;set_&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">CodeVarChunk -&gt; String
forall x. HasSymbol x =&gt; x -&gt; String
</span><span class="hs-identifier hs-var">showHasSymbImpl</span></span><span> </span><span class="annot"><span class="annottext">CodeVarChunk
</span><a href="#local-6989586621679367608"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VSType r -&gt; VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; VSType r -&gt; VSType r
</span><span class="hs-identifier hs-var">setType</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeType -&gt; VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; CodeType -&gt; VSType r
</span><span class="hs-identifier hs-var">convType</span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679367611"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-396"></span><span>  </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SVariable r -&gt; r (Scope r) -&gt; VS (r (Value r)) -&gt; MSStatement r
forall (r :: * -&gt; *).
DeclStatement r =&gt;
SVariable r -&gt; r (Scope r) -&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">setDecDef</span></span><span> </span><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679367617"><span class="hs-identifier hs-var">mkValue</span></a></span><span> </span><span class="annot"><span class="annottext">r (Scope r)
forall (r :: * -&gt; *). ScopeSym r =&gt; r (Scope r)
</span><span class="hs-identifier hs-var">local</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679367610"><span class="hs-identifier hs-var">lb</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-397"></span><span>
</span><span id="line-398"></span><span class="hs-comment">-- | Generates statements that print a message for when a constraint is violated.</span><span>
</span><span id="line-399"></span><span class="hs-comment">-- Message includes the name of the cosntraint quantity, its value, and a</span><span>
</span><span id="line-400"></span><span class="hs-comment">-- description of the constraint that is violated.</span><span>
</span><span id="line-401"></span><span id="local-6989586621679363387"><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#constraintViolatedMsg"><span class="hs-identifier hs-type">constraintViolatedMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679363387"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CodeVarChunk</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-402"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#ConstraintCE"><span class="hs-identifier hs-type">ConstraintCE</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSStatement</span></span><span> </span><span class="annot"><a href="#local-6989586621679363387"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-403"></span><span id="constraintViolatedMsg"><span class="annot"><span class="annottext">constraintViolatedMsg :: forall (r :: * -&gt; *).
OOProg r =&gt;
CodeVarChunk -&gt; String -&gt; ConstraintCE -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Modules.html#constraintViolatedMsg"><span class="hs-identifier hs-var hs-var">constraintViolatedMsg</span></a></span></span><span> </span><span id="local-6989586621679367645"><span class="annot"><span class="annottext">CodeVarChunk
</span><a href="#local-6989586621679367645"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621679367646"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679367646"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679367647"><span class="annot"><span class="annottext">ConstraintCE
</span><a href="#local-6989586621679367647"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-404"></span><span>  </span><span id="local-6989586621679367648"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679367648"><span class="hs-identifier hs-var">pc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; ConstraintCE -&gt; GenState [MSStatement r]
forall (r :: * -&gt; *).
OOProg r =&gt;
String -&gt; ConstraintCE -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Modules.html#printConstraint"><span class="hs-identifier hs-var">printConstraint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeVarChunk -&gt; String
forall x. HasSymbol x =&gt; x -&gt; String
</span><span class="hs-identifier hs-var">showHasSymbImpl</span></span><span> </span><span class="annot"><span class="annottext">CodeVarChunk
</span><a href="#local-6989586621679367645"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ConstraintCE
</span><a href="#local-6989586621679367647"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-405"></span><span>  </span><span id="local-6989586621679367650"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679367650"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeVarChunk -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *).
OOProg r =&gt;
CodeVarChunk -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVal"><span class="hs-identifier hs-var">mkVal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeVarChunk -&gt; CodeVarChunk
forall c.
(Quantity c, MayHaveUnit c, Concept c) =&gt;
c -&gt; CodeVarChunk
</span><a href="Language.Drasil.Chunk.CodeBase.html#quantvar"><span class="hs-identifier hs-var">quantvar</span></a></span><span> </span><span class="annot"><span class="annottext">CodeVarChunk
</span><a href="#local-6989586621679367645"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-406"></span><span>  </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; GenState [MSStatement r]
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([MSStatement r] -&gt; GenState [MSStatement r])
-&gt; [MSStatement r] -&gt; GenState [MSStatement r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; MSStatement r
forall (r :: * -&gt; *). IOStatement r =&gt; String -&gt; MSStatement r
</span><span class="hs-identifier hs-var">printStr</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; MSStatement r) -&gt; String -&gt; MSStatement r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CodeVarChunk -&gt; String
forall c. CodeIdea c =&gt; c -&gt; String
</span><span class="hs-identifier hs-var">codeName</span></span><span> </span><span class="annot"><span class="annottext">CodeVarChunk
</span><a href="#local-6989586621679367645"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; has value &quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-407"></span><span>    </span><span class="annot"><span class="annottext">VS (r (Value r)) -&gt; MSStatement r
forall (r :: * -&gt; *). IOStatement r =&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679367650"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-408"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; MSStatement r
forall (r :: * -&gt; *). IOStatement r =&gt; String -&gt; MSStatement r
</span><span class="hs-identifier hs-var">printStr</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; MSStatement r) -&gt; String -&gt; MSStatement r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;, but is &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679367646"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; to be &quot;</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; [MSStatement r] -&gt; [MSStatement r]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679367648"><span class="hs-identifier hs-var">pc</span></a></span><span>
</span><span id="line-409"></span><span>
</span><span id="line-410"></span><span class="hs-comment">-- | Generates statements to print descriptions of constraints, using words and</span><span>
</span><span id="line-411"></span><span class="hs-comment">-- the constrained values. Constrained values are followed by printing the</span><span>
</span><span id="line-412"></span><span class="hs-comment">-- expression they originated from, using printExpr.</span><span>
</span><span id="line-413"></span><span id="local-6989586621679363395"><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#printConstraint"><span class="hs-identifier hs-type">printConstraint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679363395"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#ConstraintCE"><span class="hs-identifier hs-type">ConstraintCE</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-414"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSStatement</span></span><span> </span><span class="annot"><a href="#local-6989586621679363395"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-415"></span><span id="printConstraint"><span class="annot"><span class="annottext">printConstraint :: forall (r :: * -&gt; *).
OOProg r =&gt;
String -&gt; ConstraintCE -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Modules.html#printConstraint"><span class="hs-identifier hs-var hs-var">printConstraint</span></a></span></span><span> </span><span id="local-6989586621679367656"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679367656"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679367657"><span class="annot"><span class="annottext">ConstraintCE
</span><a href="#local-6989586621679367657"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-416"></span><span>  </span><span id="local-6989586621679367658"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679367658"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-417"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679367661"><span class="annot"><span class="annottext">db :: ChunkDB
</span><a href="#local-6989586621679367661"><span class="hs-identifier hs-var hs-var">db</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; CodeSpec
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#codeSpec"><span class="hs-identifier hs-var">codeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679367658"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">CodeSpec -&gt; Getting ChunkDB CodeSpec ChunkDB -&gt; ChunkDB
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting ChunkDB CodeSpec ChunkDB
forall c. HasOldCodeSpec c =&gt; Lens' c ChunkDB
Lens' CodeSpec ChunkDB
</span><a href="Language.Drasil.CodeSpec.html#systemdbO"><span class="hs-identifier hs-var">systemdbO</span></a></span><span>
</span><span id="line-418"></span><span>      </span><span id="local-6989586621679367663"><span class="annot"><a href="#local-6989586621679367664"><span class="hs-identifier hs-type">printConstraint'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679367663"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#ConstraintCE"><span class="hs-identifier hs-type">ConstraintCE</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span>
</span><span id="line-419"></span><span>        </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSStatement</span></span><span> </span><span class="annot"><a href="#local-6989586621679367663"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-420"></span><span>      </span><span id="local-6989586621679367664"><span class="annot"><span class="annottext">printConstraint' :: forall (r :: * -&gt; *).
OOProg r =&gt;
String -&gt; ConstraintCE -&gt; GenState [MSStatement r]
</span><a href="#local-6989586621679367664"><span class="hs-identifier hs-var hs-var">printConstraint'</span></a></span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Range</span></span><span> </span><span class="annot"><span class="annottext">ConstraintReason
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bounded</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Inclusive
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679367702"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679367702"><span class="hs-identifier hs-var">e1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Inclusive
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679367703"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679367703"><span class="hs-identifier hs-var">e2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-421"></span><span>        </span><span id="local-6989586621679367704"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679367704"><span class="hs-identifier hs-var">lb</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679367702"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-422"></span><span>        </span><span id="local-6989586621679367705"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679367705"><span class="hs-identifier hs-var">ub</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679367703"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-423"></span><span>        </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; GenState [MSStatement r]
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([MSStatement r] -&gt; GenState [MSStatement r])
-&gt; [MSStatement r] -&gt; GenState [MSStatement r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; MSStatement r
forall (r :: * -&gt; *). IOStatement r =&gt; String -&gt; MSStatement r
</span><span class="hs-identifier hs-var">printStr</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;between &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VS (r (Value r)) -&gt; MSStatement r
forall (r :: * -&gt; *). IOStatement r =&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679367704"><span class="hs-identifier hs-var">lb</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; [MSStatement r] -&gt; [MSStatement r]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; ChunkDB -&gt; [MSStatement r]
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; ChunkDB -&gt; [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Modules.html#printExpr"><span class="hs-identifier hs-var">printExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679367702"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679367661"><span class="hs-identifier hs-var">db</span></a></span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; [MSStatement r] -&gt; [MSStatement r]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-424"></span><span>          </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; MSStatement r
forall (r :: * -&gt; *). IOStatement r =&gt; String -&gt; MSStatement r
</span><span class="hs-identifier hs-var">printStr</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; and &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VS (r (Value r)) -&gt; MSStatement r
forall (r :: * -&gt; *). IOStatement r =&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679367705"><span class="hs-identifier hs-var">ub</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; [MSStatement r] -&gt; [MSStatement r]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; ChunkDB -&gt; [MSStatement r]
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; ChunkDB -&gt; [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Modules.html#printExpr"><span class="hs-identifier hs-var">printExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679367703"><span class="hs-identifier hs-var">e2</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679367661"><span class="hs-identifier hs-var">db</span></a></span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; [MSStatement r] -&gt; [MSStatement r]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; MSStatement r
forall (r :: * -&gt; *). IOStatement r =&gt; String -&gt; MSStatement r
</span><span class="hs-identifier hs-var">printStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-425"></span><span>      </span><span class="annot"><a href="#local-6989586621679367664"><span class="hs-identifier hs-var">printConstraint'</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Range</span></span><span> </span><span class="annot"><span class="annottext">ConstraintReason
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UpTo</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Inclusive
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679367709"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679367709"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-426"></span><span>        </span><span id="local-6989586621679367710"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679367710"><span class="hs-identifier hs-var">ub</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679367709"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-427"></span><span>        </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; GenState [MSStatement r]
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([MSStatement r] -&gt; GenState [MSStatement r])
-&gt; [MSStatement r] -&gt; GenState [MSStatement r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; MSStatement r
forall (r :: * -&gt; *). IOStatement r =&gt; String -&gt; MSStatement r
</span><span class="hs-identifier hs-var">printStr</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;below &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VS (r (Value r)) -&gt; MSStatement r
forall (r :: * -&gt; *). IOStatement r =&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679367710"><span class="hs-identifier hs-var">ub</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; [MSStatement r] -&gt; [MSStatement r]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; ChunkDB -&gt; [MSStatement r]
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; ChunkDB -&gt; [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Modules.html#printExpr"><span class="hs-identifier hs-var">printExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679367709"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679367661"><span class="hs-identifier hs-var">db</span></a></span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; [MSStatement r] -&gt; [MSStatement r]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-428"></span><span>          </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; MSStatement r
forall (r :: * -&gt; *). IOStatement r =&gt; String -&gt; MSStatement r
</span><span class="hs-identifier hs-var">printStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-429"></span><span>      </span><span class="annot"><a href="#local-6989586621679367664"><span class="hs-identifier hs-var">printConstraint'</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Range</span></span><span> </span><span class="annot"><span class="annottext">ConstraintReason
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UpFrom</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Inclusive
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679367712"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679367712"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-430"></span><span>        </span><span id="local-6989586621679367713"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679367713"><span class="hs-identifier hs-var">lb</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679367712"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-431"></span><span>        </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; GenState [MSStatement r]
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([MSStatement r] -&gt; GenState [MSStatement r])
-&gt; [MSStatement r] -&gt; GenState [MSStatement r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; MSStatement r
forall (r :: * -&gt; *). IOStatement r =&gt; String -&gt; MSStatement r
</span><span class="hs-identifier hs-var">printStr</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;above &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VS (r (Value r)) -&gt; MSStatement r
forall (r :: * -&gt; *). IOStatement r =&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679367713"><span class="hs-identifier hs-var">lb</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; [MSStatement r] -&gt; [MSStatement r]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; ChunkDB -&gt; [MSStatement r]
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; ChunkDB -&gt; [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Modules.html#printExpr"><span class="hs-identifier hs-var">printExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679367712"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679367661"><span class="hs-identifier hs-var">db</span></a></span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; [MSStatement r] -&gt; [MSStatement r]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; MSStatement r
forall (r :: * -&gt; *). IOStatement r =&gt; String -&gt; MSStatement r
</span><span class="hs-identifier hs-var">printStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-432"></span><span>      </span><span class="annot"><a href="#local-6989586621679367664"><span class="hs-identifier hs-var">printConstraint'</span></a></span><span> </span><span id="local-6989586621679367714"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679367714"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Elem</span></span><span> </span><span class="annot"><span class="annottext">ConstraintReason
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679367715"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679367715"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-433"></span><span>        </span><span id="local-6989586621679367716"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679367716"><span class="hs-identifier hs-var">lb</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; CodeExpr -&gt; CodeExpr
</span><span class="hs-identifier hs-var">Variable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;set_&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679367714"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679367715"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-434"></span><span>        </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; GenState [MSStatement r]
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([MSStatement r] -&gt; GenState [MSStatement r])
-&gt; [MSStatement r] -&gt; GenState [MSStatement r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; MSStatement r
forall (r :: * -&gt; *). IOStatement r =&gt; String -&gt; MSStatement r
</span><span class="hs-identifier hs-var">printStr</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;an element of the set &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VS (r (Value r)) -&gt; MSStatement r
forall (r :: * -&gt; *). IOStatement r =&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679367716"><span class="hs-identifier hs-var">lb</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; [MSStatement r] -&gt; [MSStatement r]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; MSStatement r
forall (r :: * -&gt; *). IOStatement r =&gt; String -&gt; MSStatement r
</span><span class="hs-identifier hs-var">printStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-435"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; ConstraintCE -&gt; GenState [MSStatement r]
forall (r :: * -&gt; *).
OOProg r =&gt;
String -&gt; ConstraintCE -&gt; GenState [MSStatement r]
</span><a href="#local-6989586621679367664"><span class="hs-identifier hs-var">printConstraint'</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679367656"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">ConstraintCE
</span><a href="#local-6989586621679367657"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-436"></span><span>
</span><span id="line-437"></span><span>
</span><span id="line-438"></span><span class="hs-comment">-- | Don't print expressions that are just literals, because that would be</span><span>
</span><span id="line-439"></span><span class="hs-comment">-- redundant (the values are already printed by printConstraint).</span><span>
</span><span id="line-440"></span><span class="hs-comment">-- If expression is more than just a literal, print it in parentheses.</span><span>
</span><span id="line-441"></span><span id="local-6989586621679363401"><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#printExpr"><span class="hs-identifier hs-type">printExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679363401"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CodeExpr</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ChunkDB</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSStatement</span></span><span> </span><span class="annot"><a href="#local-6989586621679363401"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-442"></span><span id="printExpr"><span class="annot"><span class="annottext">printExpr :: forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; ChunkDB -&gt; [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Modules.html#printExpr"><span class="hs-identifier hs-var hs-var">printExpr</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lit</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-443"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#printExpr"><span class="hs-identifier hs-var">printExpr</span></a></span><span> </span><span id="local-6989586621679367722"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679367722"><span class="hs-identifier hs-var">e</span></a></span></span><span>     </span><span id="local-6989586621679367723"><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679367723"><span class="hs-identifier hs-var">db</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; MS (r (Statement r))
forall (r :: * -&gt; *). IOStatement r =&gt; String -&gt; MSStatement r
</span><span class="hs-identifier hs-var">printStr</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; MS (r (Statement r))) -&gt; String -&gt; MS (r (Statement r))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; (&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; String
</span><span class="hs-identifier hs-var">render</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB -&gt; Stage -&gt; SingleLine -&gt; CodeExpr -&gt; Doc
</span><span class="hs-identifier hs-var">codeExprDoc</span></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679367723"><span class="hs-identifier hs-var">db</span></a></span><span> </span><span class="annot"><span class="annottext">Stage
</span><span class="hs-identifier hs-var">Implementation</span></span><span> </span><span class="annot"><span class="annottext">SingleLine
</span><span class="hs-identifier hs-var">OneLine</span></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679367722"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-444"></span><span>
</span><span id="line-445"></span><span class="annot"><span class="hs-comment">-- | | Generates a function for reading inputs from a file.</span></span><span>
</span><span id="line-446"></span><span id="local-6989586621679363279"><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genInputFormat"><span class="hs-identifier hs-type">genInputFormat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679363279"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VisibilityTag</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-447"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679363279"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-448"></span><span id="genInputFormat"><span class="annot"><span class="annottext">genInputFormat :: forall (r :: * -&gt; *).
OOProg r =&gt;
VisibilityTag -&gt; GenState (Maybe (SMethod r))
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genInputFormat"><span class="hs-identifier hs-var hs-var">genInputFormat</span></a></span></span><span> </span><span id="local-6989586621679367735"><span class="annot"><span class="annottext">VisibilityTag
</span><a href="#local-6989586621679367735"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-449"></span><span>  </span><span id="local-6989586621679367736"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679367736"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-450"></span><span>  </span><span class="annot"><span class="annottext">(DrasilState -&gt; DrasilState) -&gt; StateT DrasilState Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679367737"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679367737"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679367737"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#currentScope"><span class="hs-identifier hs-var">currentScope</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#Local"><span class="hs-identifier hs-type">Local</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-451"></span><span>  </span><span id="local-6989586621679367738"><span class="annot"><span class="annottext">DataDesc
</span><a href="#local-6989586621679367738"><span class="hs-identifier hs-var">dd</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenState DataDesc
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genDataDesc"><span class="hs-identifier hs-var">genDataDesc</span></a></span><span>
</span><span id="line-452"></span><span>  </span><span id="local-6989586621679367740"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679367740"><span class="hs-identifier hs-var">giName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">InternalConcept -&gt; GenState String
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#genICName"><span class="hs-identifier hs-var">genICName</span></a></span><span> </span><span class="annot"><span class="annottext">InternalConcept
</span><a href="Language.Drasil.Choices.html#GetInput"><span class="hs-identifier hs-var">GetInput</span></a></span><span>
</span><span id="line-453"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679368027"><span class="annot"><span class="annottext">getFunc :: VisibilityTag
-&gt; String
-&gt; String
-&gt; [CodeVarChunk]
-&gt; [CodeVarChunk]
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="#local-6989586621679368027"><span class="hs-identifier hs-var hs-var">getFunc</span></a></span></span><span> </span><span class="annot"><span class="annottext">VisibilityTag
</span><span class="hs-identifier hs-var">Pub</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; String
-&gt; [CodeVarChunk]
-&gt; [CodeVarChunk]
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
forall (r :: * -&gt; *).
OOProg r =&gt;
String
-&gt; String
-&gt; [CodeVarChunk]
-&gt; [CodeVarChunk]
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#publicInOutFunc"><span class="hs-identifier hs-var">publicInOutFunc</span></a></span><span>
</span><span id="line-454"></span><span>      </span><span class="annot"><a href="#local-6989586621679368027"><span class="hs-identifier hs-var">getFunc</span></a></span><span> </span><span class="annot"><span class="annottext">VisibilityTag
</span><span class="hs-identifier hs-var">Priv</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; String
-&gt; [CodeVarChunk]
-&gt; [CodeVarChunk]
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
forall (r :: * -&gt; *).
OOProg r =&gt;
String
-&gt; String
-&gt; [CodeVarChunk]
-&gt; [CodeVarChunk]
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#privateInOutMethod"><span class="hs-identifier hs-var">privateInOutMethod</span></a></span><span>
</span><span id="line-455"></span><span>      </span><span id="local-6989586621679368028"><span class="annot"><a href="#local-6989586621679368029"><span class="hs-identifier hs-type">genInFormat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679368028"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span>
</span><span id="line-456"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679368028"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-457"></span><span>      </span><span id="local-6989586621679368029"><span class="annot"><span class="annottext">genInFormat :: forall {r :: * -&gt; *}.
OOProg r =&gt;
Bool -&gt; StateT DrasilState Identity (Maybe (MS (r (Method r))))
</span><a href="#local-6989586621679368029"><span class="hs-identifier hs-var hs-var">genInFormat</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (MS (r (Method r)))
-&gt; StateT DrasilState Identity (Maybe (MS (r (Method r))))
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe (MS (r (Method r)))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-458"></span><span>      </span><span class="annot"><a href="#local-6989586621679368029"><span class="hs-identifier hs-var">genInFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-459"></span><span>        </span><span id="local-6989586621679368040"><span class="annot"><span class="annottext">[CodeVarChunk]
</span><a href="#local-6989586621679368040"><span class="hs-identifier hs-var">ins</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenState [CodeVarChunk]
</span><a href="Language.Drasil.Code.Imperative.Parameters.html#getInputFormatIns"><span class="hs-identifier hs-var">getInputFormatIns</span></a></span><span>
</span><span id="line-460"></span><span>        </span><span id="local-6989586621679368041"><span class="annot"><span class="annottext">[CodeVarChunk]
</span><a href="#local-6989586621679368041"><span class="hs-identifier hs-var">outs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenState [CodeVarChunk]
</span><a href="Language.Drasil.Code.Imperative.Parameters.html#getInputFormatOuts"><span class="hs-identifier hs-var">getInputFormatOuts</span></a></span><span>
</span><span id="line-461"></span><span>        </span><span id="local-6989586621679368042"><span class="annot"><span class="annottext">[MS (r (Block r))]
</span><a href="#local-6989586621679368042"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DataDesc -&gt; StateT DrasilState Identity [MS (r (Block r))]
forall (r :: * -&gt; *). OOProg r =&gt; DataDesc -&gt; GenState [MSBlock r]
</span><a href="Language.Drasil.Code.Imperative.Import.html#readData"><span class="hs-identifier hs-var">readData</span></a></span><span> </span><span class="annot"><span class="annottext">DataDesc
</span><a href="#local-6989586621679367738"><span class="hs-identifier hs-var">dd</span></a></span><span>
</span><span id="line-462"></span><span>        </span><span id="local-6989586621679368043"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679368043"><span class="hs-identifier hs-var">desc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenState String
</span><a href="Language.Drasil.Code.Imperative.Descriptions.html#inFmtFuncDesc"><span class="hs-identifier hs-var">inFmtFuncDesc</span></a></span><span>
</span><span id="line-463"></span><span>        </span><span id="local-6989586621679368044"><span class="annot"><span class="annottext">MS (r (Method r))
</span><a href="#local-6989586621679368044"><span class="hs-identifier hs-var">mthd</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VisibilityTag
-&gt; String
-&gt; String
-&gt; [CodeVarChunk]
-&gt; [CodeVarChunk]
-&gt; [MS (r (Block r))]
-&gt; StateT DrasilState Identity (MS (r (Method r)))
forall {r :: * -&gt; *}.
OOProg r =&gt;
VisibilityTag
-&gt; String
-&gt; String
-&gt; [CodeVarChunk]
-&gt; [CodeVarChunk]
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="#local-6989586621679368027"><span class="hs-identifier hs-var">getFunc</span></a></span><span> </span><span class="annot"><span class="annottext">VisibilityTag
</span><a href="#local-6989586621679367735"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679367740"><span class="hs-identifier hs-var">giName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679368043"><span class="hs-identifier hs-var">desc</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeVarChunk]
</span><a href="#local-6989586621679368040"><span class="hs-identifier hs-var">ins</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeVarChunk]
</span><a href="#local-6989586621679368041"><span class="hs-identifier hs-var">outs</span></a></span><span> </span><span class="annot"><span class="annottext">[MS (r (Block r))]
</span><a href="#local-6989586621679368042"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-464"></span><span>        </span><span class="annot"><span class="annottext">Maybe (MS (r (Method r)))
-&gt; StateT DrasilState Identity (Maybe (MS (r (Method r))))
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (MS (r (Method r)))
 -&gt; StateT DrasilState Identity (Maybe (MS (r (Method r)))))
-&gt; Maybe (MS (r (Method r)))
-&gt; StateT DrasilState Identity (Maybe (MS (r (Method r))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MS (r (Method r)) -&gt; Maybe (MS (r (Method r)))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">MS (r (Method r))
</span><a href="#local-6989586621679368044"><span class="hs-identifier hs-var">mthd</span></a></span><span>
</span><span id="line-465"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; GenState (Maybe (SMethod r))
forall {r :: * -&gt; *}.
OOProg r =&gt;
Bool -&gt; StateT DrasilState Identity (Maybe (MS (r (Method r))))
</span><a href="#local-6989586621679368029"><span class="hs-identifier hs-var">genInFormat</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; GenState (Maybe (SMethod r)))
-&gt; Bool -&gt; GenState (Maybe (SMethod r))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679367740"><span class="hs-identifier hs-var">giName</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Set String -&gt; Bool
forall a. Eq a =&gt; a -&gt; Set a -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; Set String
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#defSet"><span class="hs-identifier hs-var">defSet</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679367736"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-466"></span><span>
</span><span id="line-467"></span><span class="hs-comment">-- | Defines the 'DataDesc' for the format we require for input files. When we make</span><span>
</span><span id="line-468"></span><span class="hs-comment">-- input format a design variability, this will read the user's design choices</span><span>
</span><span id="line-469"></span><span class="hs-comment">-- instead of returning a fixed 'DataDesc'.</span><span>
</span><span id="line-470"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genDataDesc"><span class="hs-identifier hs-type">genDataDesc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#DataDesc"><span class="hs-identifier hs-type">DataDesc</span></a></span><span>
</span><span id="line-471"></span><span id="genDataDesc"><span class="annot"><span class="annottext">genDataDesc :: GenState DataDesc
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genDataDesc"><span class="hs-identifier hs-var hs-var">genDataDesc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-472"></span><span>  </span><span id="local-6989586621679368045"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679368045"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-473"></span><span>  </span><span class="annot"><span class="annottext">DataDesc -&gt; GenState DataDesc
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DataDesc -&gt; GenState DataDesc) -&gt; DataDesc -&gt; GenState DataDesc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Data
</span><a href="Language.Drasil.Code.DataDesc.html#junkLine"><span class="hs-identifier hs-var">junkLine</span></a></span><span> </span><span class="annot"><span class="annottext">Data -&gt; DataDesc -&gt; DataDesc
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span>
</span><span id="line-474"></span><span>    </span><span class="annot"><span class="annottext">Data -&gt; DataDesc -&gt; DataDesc
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">intersperse</span></span><span> </span><span class="annot"><span class="annottext">Data
</span><a href="Language.Drasil.Code.DataDesc.html#junkLine"><span class="hs-identifier hs-var">junkLine</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CodeVarChunk -&gt; Data) -&gt; [CodeVarChunk] -&gt; DataDesc
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">CodeVarChunk -&gt; Data
</span><a href="Language.Drasil.Code.DataDesc.html#singleton"><span class="hs-identifier hs-var">singleton</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; CodeSpec
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#codeSpec"><span class="hs-identifier hs-var">codeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679368045"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">CodeSpec
-&gt; Getting [CodeVarChunk] CodeSpec [CodeVarChunk] -&gt; [CodeVarChunk]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting [CodeVarChunk] CodeSpec [CodeVarChunk]
forall c. HasOldCodeSpec c =&gt; Lens' c [CodeVarChunk]
Lens' CodeSpec [CodeVarChunk]
</span><a href="Language.Drasil.CodeSpec.html#extInputsO"><span class="hs-identifier hs-var">extInputsO</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-475"></span><span>
</span><span id="line-476"></span><span class="hs-comment">-- | Generates a sample input file compatible with the generated program,</span><span>
</span><span id="line-477"></span><span class="hs-comment">-- if the user chose to.</span><span>
</span><span id="line-478"></span><span id="local-6989586621679363412"><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genSampleInput"><span class="hs-identifier hs-type">genSampleInput</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Code.Imperative.GOOL.ClassInterface.html#AuxiliarySym"><span class="hs-identifier hs-type">AuxiliarySym</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679363412"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679363412"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Code.Imperative.GOOL.ClassInterface.html#Auxiliary"><span class="hs-identifier hs-type">Auxiliary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679363412"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-479"></span><span id="genSampleInput"><span class="annot"><span class="annottext">genSampleInput :: forall (r :: * -&gt; *).
AuxiliarySym r =&gt;
GenState (Maybe (r (Auxiliary r)))
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genSampleInput"><span class="hs-identifier hs-var hs-var">genSampleInput</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-480"></span><span>  </span><span id="local-6989586621679368056"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679368056"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-481"></span><span>  </span><span id="local-6989586621679368057"><span class="annot"><span class="annottext">DataDesc
</span><a href="#local-6989586621679368057"><span class="hs-identifier hs-var">dd</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenState DataDesc
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genDataDesc"><span class="hs-identifier hs-var">genDataDesc</span></a></span><span>
</span><span id="line-482"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[AuxFile] -&gt; Bool
</span><a href="Language.Drasil.Choices.html#hasSampleInput"><span class="hs-identifier hs-var">hasSampleInput</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; [AuxFile]
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#auxiliaries"><span class="hs-identifier hs-var">auxiliaries</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679368056"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Maybe (r (Auxiliary r)) -&gt; GenState (Maybe (r (Auxiliary r)))
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (r (Auxiliary r)) -&gt; GenState (Maybe (r (Auxiliary r))))
-&gt; (r (Auxiliary r) -&gt; Maybe (r (Auxiliary r)))
-&gt; r (Auxiliary r)
-&gt; GenState (Maybe (r (Auxiliary r)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">r (Auxiliary r) -&gt; Maybe (r (Auxiliary r))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(r (Auxiliary r) -&gt; GenState (Maybe (r (Auxiliary r))))
-&gt; r (Auxiliary r) -&gt; GenState (Maybe (r (Auxiliary r)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ChunkDB -&gt; DataDesc -&gt; [Expr] -&gt; r (Auxiliary r)
forall (r :: * -&gt; *).
AuxiliarySym r =&gt;
ChunkDB -&gt; DataDesc -&gt; [Expr] -&gt; r (Auxiliary r)
</span><a href="Language.Drasil.Code.Imperative.GOOL.ClassInterface.html#sampleInput"><span class="hs-identifier hs-var">sampleInput</span></a></span><span>
</span><span id="line-483"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; CodeSpec
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#codeSpec"><span class="hs-identifier hs-var">codeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679368056"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">CodeSpec -&gt; Getting ChunkDB CodeSpec ChunkDB -&gt; ChunkDB
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting ChunkDB CodeSpec ChunkDB
forall c. HasOldCodeSpec c =&gt; Lens' c ChunkDB
Lens' CodeSpec ChunkDB
</span><a href="Language.Drasil.CodeSpec.html#systemdbO"><span class="hs-identifier hs-var">systemdbO</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DataDesc
</span><a href="#local-6989586621679368057"><span class="hs-identifier hs-var">dd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; [Expr]
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#sampleData"><span class="hs-identifier hs-var">sampleData</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679368056"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe (r (Auxiliary r)) -&gt; GenState (Maybe (r (Auxiliary r)))
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe (r (Auxiliary r))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-484"></span><span>
</span><span id="line-485"></span><span class="hs-comment">----- CONSTANTS -----</span><span>
</span><span id="line-486"></span><span>
</span><span id="line-487"></span><span class="annot"><span class="hs-comment">-- | Generates a module containing the class where constants are stored.</span></span><span>
</span><span id="line-488"></span><span id="local-6989586621679368061"><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genConstMod"><span class="hs-identifier hs-type">genConstMod</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679368061"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">OO.SFile</span></span><span> </span><span class="annot"><a href="#local-6989586621679368061"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-489"></span><span id="genConstMod"><span class="annot"><span class="annottext">genConstMod :: forall (r :: * -&gt; *). OOProg r =&gt; GenState [SFile r]
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genConstMod"><span class="hs-identifier hs-var hs-var">genConstMod</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-490"></span><span>  </span><span id="local-6989586621679368067"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679368067"><span class="hs-identifier hs-var">cDesc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenState [String] -&gt; GenState String
</span><a href="Language.Drasil.Code.Imperative.Descriptions.html#modDesc"><span class="hs-identifier hs-var">modDesc</span></a></span><span> </span><span class="annot"><span class="annottext">(GenState [String] -&gt; GenState String)
-&gt; GenState [String] -&gt; GenState String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GenState String -&gt; GenState [String]
forall a b. State a b -&gt; State a [b]
</span><a href="Language.Drasil.Code.Imperative.Helpers.html#liftS"><span class="hs-identifier hs-var">liftS</span></a></span><span> </span><span class="annot"><span class="annottext">GenState String
</span><a href="Language.Drasil.Code.Imperative.Descriptions.html#constModDesc"><span class="hs-identifier hs-var">constModDesc</span></a></span><span>
</span><span id="line-491"></span><span>  </span><span id="local-6989586621679368068"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679368068"><span class="hs-identifier hs-var">cName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">InternalConcept -&gt; GenState String
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#genICName"><span class="hs-identifier hs-var">genICName</span></a></span><span> </span><span class="annot"><span class="annottext">InternalConcept
</span><a href="Language.Drasil.Choices.html#Constants"><span class="hs-identifier hs-var">Constants</span></a></span><span>
</span><span id="line-492"></span><span>  </span><span class="annot"><span class="annottext">State DrasilState (SFile r) -&gt; GenState [SFile r]
forall a b. State a b -&gt; State a [b]
</span><a href="Language.Drasil.Code.Imperative.Helpers.html#liftS"><span class="hs-identifier hs-var">liftS</span></a></span><span> </span><span class="annot"><span class="annottext">(State DrasilState (SFile r) -&gt; GenState [SFile r])
-&gt; State DrasilState (SFile r) -&gt; GenState [SFile r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
-&gt; String
-&gt; [GenState (Maybe (SMethod r))]
-&gt; [GenState (Maybe (SClass r))]
-&gt; State DrasilState (SFile r)
forall (r :: * -&gt; *).
OOProg r =&gt;
String
-&gt; String
-&gt; [GenState (Maybe (SMethod r))]
-&gt; [GenState (Maybe (SClass r))]
-&gt; GenState (SFile r)
</span><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html#genModule"><span class="hs-identifier hs-var">genModule</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679368068"><span class="hs-identifier hs-var">cName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679368067"><span class="hs-identifier hs-var">cDesc</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ClassType -&gt; GenState (Maybe (SClass r))
forall (r :: * -&gt; *).
OOProg r =&gt;
ClassType -&gt; GenState (Maybe (SClass r))
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genConstClass"><span class="hs-identifier hs-var">genConstClass</span></a></span><span> </span><span class="annot"><span class="annottext">ClassType
</span><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html#Primary"><span class="hs-identifier hs-var">Primary</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-493"></span><span>
</span><span id="line-494"></span><span class="hs-comment">-- | Generates a class to store constants, if constants are mapped to the</span><span>
</span><span id="line-495"></span><span class="hs-comment">-- Constants class in the class definition map, otherwise returns Nothing.</span><span>
</span><span id="line-496"></span><span id="local-6989586621679368069"><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genConstClass"><span class="hs-identifier hs-type">genConstClass</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679368069"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html#ClassType"><span class="hs-identifier hs-type">ClassType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-497"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SClass</span></span><span> </span><span class="annot"><a href="#local-6989586621679368069"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-498"></span><span id="genConstClass"><span class="annot"><span class="annottext">genConstClass :: forall (r :: * -&gt; *).
OOProg r =&gt;
ClassType -&gt; GenState (Maybe (SClass r))
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genConstClass"><span class="hs-identifier hs-var hs-var">genConstClass</span></a></span></span><span> </span><span id="local-6989586621679368080"><span class="annot"><span class="annottext">ClassType
</span><a href="#local-6989586621679368080"><span class="hs-identifier hs-var">scp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-499"></span><span>  </span><span id="local-6989586621679368081"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679368081"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-500"></span><span>  </span><span class="annot"><span class="annottext">(DrasilState -&gt; DrasilState) -&gt; StateT DrasilState Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679368082"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679368082"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679368082"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#currentScope"><span class="hs-identifier hs-var">currentScope</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#Local"><span class="hs-identifier hs-type">Local</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-501"></span><span>  </span><span id="local-6989586621679368083"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679368083"><span class="hs-identifier hs-var">cname</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">InternalConcept -&gt; GenState String
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#genICName"><span class="hs-identifier hs-var">genICName</span></a></span><span> </span><span class="annot"><span class="annottext">InternalConcept
</span><a href="Language.Drasil.Choices.html#Constants"><span class="hs-identifier hs-var">Constants</span></a></span><span>
</span><span id="line-502"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679368086"><span class="annot"><span class="annottext">cs :: [CodeDefinition]
</span><a href="#local-6989586621679368086"><span class="hs-identifier hs-var hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; CodeSpec
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#codeSpec"><span class="hs-identifier hs-var">codeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679368081"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">CodeSpec
-&gt; Getting [CodeDefinition] CodeSpec [CodeDefinition]
-&gt; [CodeDefinition]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting [CodeDefinition] CodeSpec [CodeDefinition]
forall c. HasOldCodeSpec c =&gt; Lens' c [CodeDefinition]
Lens' CodeSpec [CodeDefinition]
</span><a href="Language.Drasil.CodeSpec.html#constantsO"><span class="hs-identifier hs-var">constantsO</span></a></span><span>
</span><span id="line-503"></span><span>      </span><span id="local-6989586621679363421"><span class="annot"><a href="#local-6989586621679368087"><span class="hs-identifier hs-type">genClass</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679363421"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Chunk.CodeDefinition.html#CodeDefinition"><span class="hs-identifier hs-type">CodeDefinition</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span>
</span><span id="line-504"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SClass</span></span><span> </span><span class="annot"><a href="#local-6989586621679363421"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-505"></span><span>      </span><span id="local-6989586621679368087"><span class="annot"><span class="annottext">genClass :: forall (r :: * -&gt; *).
OOProg r =&gt;
[CodeDefinition] -&gt; GenState (Maybe (SClass r))
</span><a href="#local-6989586621679368087"><span class="hs-identifier hs-var hs-var">genClass</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (CS (r (Class r)))
-&gt; StateT DrasilState Identity (Maybe (CS (r (Class r))))
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe (CS (r (Class r)))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-506"></span><span>      </span><span class="annot"><a href="#local-6989586621679368087"><span class="hs-identifier hs-var">genClass</span></a></span><span> </span><span id="local-6989586621679368168"><span class="annot"><span class="annottext">[CodeDefinition]
</span><a href="#local-6989586621679368168"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-507"></span><span>        </span><span id="local-6989586621679368169"><span class="annot"><span class="annottext">[VS (r (Value r))]
</span><a href="#local-6989586621679368169"><span class="hs-identifier hs-var">vals</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(CodeDefinition -&gt; StateT DrasilState Identity (VS (r (Value r))))
-&gt; [CodeDefinition]
-&gt; StateT DrasilState Identity [VS (r (Value r))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">(CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r))))
-&gt; (CodeDefinition -&gt; CodeExpr)
-&gt; CodeDefinition
-&gt; StateT DrasilState Identity (VS (r (Value r)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeDefinition
-&gt; Getting CodeExpr CodeDefinition CodeExpr -&gt; CodeExpr
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting CodeExpr CodeDefinition CodeExpr
forall c. DefiningCodeExpr c =&gt; Lens' c CodeExpr
Lens' CodeDefinition CodeExpr
</span><span class="hs-identifier hs-var">codeExpr</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CodeDefinition]
</span><a href="#local-6989586621679368168"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-508"></span><span>        </span><span id="local-6989586621679368170"><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679368170"><span class="hs-identifier hs-var">vars</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(CodeDefinition
 -&gt; StateT DrasilState Identity (VS (r (Variable r))))
-&gt; [CodeDefinition]
-&gt; StateT DrasilState Identity [VS (r (Variable r))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679368171"><span class="annot"><span class="annottext">CodeDefinition
</span><a href="#local-6989586621679368171"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(CodeType -&gt; VS (r (Variable r)))
-&gt; StateT DrasilState Identity CodeType
-&gt; StateT DrasilState Identity (VS (r (Variable r)))
forall a b.
(a -&gt; b)
-&gt; StateT DrasilState Identity a -&gt; StateT DrasilState Identity b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; VS (r (Type r)) -&gt; VS (r (Variable r))
forall (r :: * -&gt; *).
VariableSym r =&gt;
String -&gt; VSType r -&gt; SVariable r
</span><span class="hs-identifier hs-var">var</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeDefinition -&gt; String
forall c. CodeIdea c =&gt; c -&gt; String
</span><span class="hs-identifier hs-var">codeName</span></span><span> </span><span class="annot"><span class="annottext">CodeDefinition
</span><a href="#local-6989586621679368171"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(VS (r (Type r)) -&gt; VS (r (Variable r)))
-&gt; (CodeType -&gt; VS (r (Type r))) -&gt; CodeType -&gt; VS (r (Variable r))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CodeType -&gt; VS (r (Type r))
forall (r :: * -&gt; *). OOTypeSym r =&gt; CodeType -&gt; VSType r
</span><span class="hs-identifier hs-var">convTypeOO</span></span><span class="hs-special">)</span><span>
</span><span id="line-509"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeDefinition -&gt; StateT DrasilState Identity CodeType
forall c. HasSpace c =&gt; c -&gt; StateT DrasilState Identity CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#codeType"><span class="hs-identifier hs-var">codeType</span></a></span><span> </span><span class="annot"><span class="annottext">CodeDefinition
</span><a href="#local-6989586621679368171"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CodeDefinition]
</span><a href="#local-6989586621679368168"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-510"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679368398"><span class="annot"><span class="annottext">constVars :: [CS (r (StateVar r))]
</span><a href="#local-6989586621679368398"><span class="hs-identifier hs-var hs-var">constVars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(VS (r (Variable r)) -&gt; VS (r (Value r)) -&gt; CS (r (StateVar r)))
-&gt; [VS (r (Variable r))]
-&gt; [VS (r (Value r))]
-&gt; [CS (r (StateVar r))]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConstantRepr
-&gt; VS (r (Variable r)) -&gt; VS (r (Value r)) -&gt; CS (r (StateVar r))
forall (r :: * -&gt; *).
OOProg r =&gt;
ConstantRepr -&gt; SVariable r -&gt; SValue r -&gt; CSStateVar r
</span><a href="Language.Drasil.Code.Imperative.Modules.html#constVarFunc"><span class="hs-identifier hs-var">constVarFunc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; ConstantRepr
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#conRepr"><span class="hs-identifier hs-var">conRepr</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679368081"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679368170"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="annot"><span class="annottext">[VS (r (Value r))]
</span><a href="#local-6989586621679368169"><span class="hs-identifier hs-var">vals</span></a></span><span>
</span><span id="line-511"></span><span>            </span><span id="local-6989586621679368685"><span class="annot"><span class="annottext">getFunc :: ClassType
-&gt; String
-&gt; Maybe String
-&gt; String
-&gt; [CSStateVar r]
-&gt; GenState [SMethod r]
-&gt; GenState [SMethod r]
-&gt; GenState (SClass r)
</span><a href="#local-6989586621679368685"><span class="hs-identifier hs-var hs-var">getFunc</span></a></span></span><span> </span><span class="annot"><span class="annottext">ClassType
</span><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html#Primary"><span class="hs-identifier hs-var">Primary</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; Maybe String
-&gt; String
-&gt; [CSStateVar r]
-&gt; GenState [SMethod r]
-&gt; GenState [SMethod r]
-&gt; GenState (SClass r)
forall (r :: * -&gt; *).
OOProg r =&gt;
String
-&gt; Maybe String
-&gt; String
-&gt; [CSStateVar r]
-&gt; GenState [SMethod r]
-&gt; GenState [SMethod r]
-&gt; GenState (SClass r)
</span><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html#primaryClass"><span class="hs-identifier hs-var">primaryClass</span></a></span><span>
</span><span id="line-512"></span><span>            </span><span class="annot"><a href="#local-6989586621679368685"><span class="hs-identifier hs-var">getFunc</span></a></span><span> </span><span class="annot"><span class="annottext">ClassType
</span><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html#Auxiliary"><span class="hs-identifier hs-var">Auxiliary</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; Maybe String
-&gt; String
-&gt; [CSStateVar r]
-&gt; GenState [SMethod r]
-&gt; GenState [SMethod r]
-&gt; GenState (SClass r)
forall (r :: * -&gt; *).
OOProg r =&gt;
String
-&gt; Maybe String
-&gt; String
-&gt; [CSStateVar r]
-&gt; GenState [SMethod r]
-&gt; GenState [SMethod r]
-&gt; GenState (SClass r)
</span><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html#auxClass"><span class="hs-identifier hs-var">auxClass</span></a></span><span>
</span><span id="line-513"></span><span>            </span><span id="local-6989586621679368912"><span class="annot"><span class="annottext">f :: String
-&gt; Maybe String
-&gt; String
-&gt; [CS (r (StateVar r))]
-&gt; GenState [MS (r (Method r))]
-&gt; GenState [MS (r (Method r))]
-&gt; GenState (CS (r (Class r)))
</span><a href="#local-6989586621679368912"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ClassType
-&gt; String
-&gt; Maybe String
-&gt; String
-&gt; [CS (r (StateVar r))]
-&gt; GenState [MS (r (Method r))]
-&gt; GenState [MS (r (Method r))]
-&gt; GenState (CS (r (Class r)))
forall {r :: * -&gt; *}.
OOProg r =&gt;
ClassType
-&gt; String
-&gt; Maybe String
-&gt; String
-&gt; [CSStateVar r]
-&gt; GenState [SMethod r]
-&gt; GenState [SMethod r]
-&gt; GenState (SClass r)
</span><a href="#local-6989586621679368685"><span class="hs-identifier hs-var">getFunc</span></a></span><span> </span><span class="annot"><span class="annottext">ClassType
</span><a href="#local-6989586621679368080"><span class="hs-identifier hs-var">scp</span></a></span><span>
</span><span id="line-514"></span><span>        </span><span id="local-6989586621679368913"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679368913"><span class="hs-identifier hs-var">cDesc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenState String
</span><a href="Language.Drasil.Code.Imperative.Descriptions.html#constClassDesc"><span class="hs-identifier hs-var">constClassDesc</span></a></span><span>
</span><span id="line-515"></span><span>        </span><span id="local-6989586621679368914"><span class="annot"><span class="annottext">CS (r (Class r))
</span><a href="#local-6989586621679368914"><span class="hs-identifier hs-var">cls</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; Maybe String
-&gt; String
-&gt; [CS (r (StateVar r))]
-&gt; GenState [MS (r (Method r))]
-&gt; GenState [MS (r (Method r))]
-&gt; GenState (CS (r (Class r)))
</span><a href="#local-6989586621679368912"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679368083"><span class="hs-identifier hs-var">cname</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe String
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679368913"><span class="hs-identifier hs-var">cDesc</span></a></span><span> </span><span class="annot"><span class="annottext">[CS (r (StateVar r))]
</span><a href="#local-6989586621679368398"><span class="hs-identifier hs-var">constVars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MS (r (Method r))] -&gt; GenState [MS (r (Method r))]
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MS (r (Method r))] -&gt; GenState [MS (r (Method r))]
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-516"></span><span>        </span><span class="annot"><span class="annottext">Maybe (CS (r (Class r)))
-&gt; StateT DrasilState Identity (Maybe (CS (r (Class r))))
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (CS (r (Class r)))
 -&gt; StateT DrasilState Identity (Maybe (CS (r (Class r)))))
-&gt; Maybe (CS (r (Class r)))
-&gt; StateT DrasilState Identity (Maybe (CS (r (Class r))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CS (r (Class r)) -&gt; Maybe (CS (r (Class r)))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">CS (r (Class r))
</span><a href="#local-6989586621679368914"><span class="hs-identifier hs-var">cls</span></a></span><span>
</span><span id="line-517"></span><span>  </span><span class="annot"><span class="annottext">[CodeDefinition] -&gt; GenState (Maybe (SClass r))
forall (r :: * -&gt; *).
OOProg r =&gt;
[CodeDefinition] -&gt; GenState (Maybe (SClass r))
</span><a href="#local-6989586621679368087"><span class="hs-identifier hs-var">genClass</span></a></span><span> </span><span class="annot"><span class="annottext">([CodeDefinition] -&gt; GenState (Maybe (SClass r)))
-&gt; [CodeDefinition] -&gt; GenState (Maybe (SClass r))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(CodeDefinition -&gt; Bool) -&gt; [CodeDefinition] -&gt; [CodeDefinition]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(String -&gt; Map String String -&gt; Bool)
-&gt; Map String String -&gt; String -&gt; Bool
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Map String String -&gt; Bool
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Bool
</span><span class="hs-identifier hs-var">member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(String -&gt; Bool) -&gt; Map String String -&gt; Map String String
forall a k. (a -&gt; Bool) -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679368083"><span class="hs-identifier hs-var">cname</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; Map String String
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#clsMap"><span class="hs-identifier hs-var">clsMap</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679368081"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-518"></span><span>    </span><span class="annot"><span class="annottext">(String -&gt; Bool)
-&gt; (CodeDefinition -&gt; String) -&gt; CodeDefinition -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CodeDefinition -&gt; String
forall c. CodeIdea c =&gt; c -&gt; String
</span><span class="hs-identifier hs-var">codeName</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CodeDefinition]
</span><a href="#local-6989586621679368086"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-519"></span><span>
</span><span id="line-520"></span><span class="hs-comment">------- CALC ----------</span><span>
</span><span id="line-521"></span><span>
</span><span id="line-522"></span><span class="annot"><span class="hs-comment">-- | Generates a module containing calculation functions.</span></span><span>
</span><span id="line-523"></span><span id="local-6989586621679368915"><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genCalcMod"><span class="hs-identifier hs-type">genCalcMod</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679368915"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OO.SFile</span></span><span> </span><span class="annot"><a href="#local-6989586621679368915"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-524"></span><span id="genCalcMod"><span class="annot"><span class="annottext">genCalcMod :: forall (r :: * -&gt; *). OOProg r =&gt; GenState (SFile r)
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genCalcMod"><span class="hs-identifier hs-var hs-var">genCalcMod</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-525"></span><span>  </span><span id="local-6989586621679368928"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679368928"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-526"></span><span>  </span><span id="local-6989586621679368929"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679368929"><span class="hs-identifier hs-var">cName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">InternalConcept -&gt; GenState String
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#genICName"><span class="hs-identifier hs-var">genICName</span></a></span><span> </span><span class="annot"><span class="annottext">InternalConcept
</span><a href="Language.Drasil.Choices.html#Calculations"><span class="hs-identifier hs-var">Calculations</span></a></span><span>
</span><span id="line-527"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679368931"><span class="annot"><span class="annottext">elmap :: ExtLibMap
</span><a href="#local-6989586621679368931"><span class="hs-identifier hs-var hs-var">elmap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; ExtLibMap
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#extLibMap"><span class="hs-identifier hs-var">extLibMap</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679368928"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-528"></span><span>  </span><span class="annot"><span class="annottext">String
-&gt; String
-&gt; [String]
-&gt; [GenState (Maybe (SMethod r))]
-&gt; [GenState (Maybe (SClass r))]
-&gt; GenState (SFile r)
forall (r :: * -&gt; *).
OOProg r =&gt;
String
-&gt; String
-&gt; [String]
-&gt; [GenState (Maybe (SMethod r))]
-&gt; [GenState (Maybe (SClass r))]
-&gt; GenState (SFile r)
</span><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html#genModuleWithImports"><span class="hs-identifier hs-var">genModuleWithImports</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679368929"><span class="hs-identifier hs-var">cName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Language.Drasil.Code.Imperative.Descriptions.html#calcModDesc"><span class="hs-identifier hs-var">calcModDesc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ExtLibState -&gt; [String]) -&gt; [ExtLibState] -&gt; [String]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExtLibState -&gt; Getting [String] ExtLibState [String] -&gt; [String]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting [String] ExtLibState [String]
Lens' ExtLibState [String]
</span><a href="Language.Drasil.Code.ExtLibImport.html#imports"><span class="hs-identifier hs-var">imports</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([ExtLibState] -&gt; [String]) -&gt; [ExtLibState] -&gt; [String]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-529"></span><span>    </span><span class="annot"><span class="annottext">ExtLibMap -&gt; [ExtLibState]
forall k a. Map k a -&gt; [a]
</span><span class="hs-identifier hs-var">elems</span></span><span> </span><span class="annot"><span class="annottext">ExtLibMap
</span><a href="#local-6989586621679368931"><span class="hs-identifier hs-var">elmap</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CodeDefinition -&gt; GenState (Maybe (SMethod r)))
-&gt; [CodeDefinition] -&gt; [GenState (Maybe (SMethod r))]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(SMethod r -&gt; Maybe (SMethod r))
-&gt; StateT DrasilState Identity (SMethod r)
-&gt; GenState (Maybe (SMethod r))
forall a b.
(a -&gt; b)
-&gt; StateT DrasilState Identity a -&gt; StateT DrasilState Identity b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">SMethod r -&gt; Maybe (SMethod r)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(StateT DrasilState Identity (SMethod r)
 -&gt; GenState (Maybe (SMethod r)))
-&gt; (CodeDefinition -&gt; StateT DrasilState Identity (SMethod r))
-&gt; CodeDefinition
-&gt; GenState (Maybe (SMethod r))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CodeDefinition -&gt; StateT DrasilState Identity (SMethod r)
forall (r :: * -&gt; *).
OOProg r =&gt;
CodeDefinition -&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genCalcFunc"><span class="hs-identifier hs-var">genCalcFunc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; CodeSpec
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#codeSpec"><span class="hs-identifier hs-var">codeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679368928"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">CodeSpec
-&gt; Getting [CodeDefinition] CodeSpec [CodeDefinition]
-&gt; [CodeDefinition]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting [CodeDefinition] CodeSpec [CodeDefinition]
forall c. HasOldCodeSpec c =&gt; Lens' c [CodeDefinition]
Lens' CodeSpec [CodeDefinition]
</span><a href="Language.Drasil.CodeSpec.html#execOrderO"><span class="hs-identifier hs-var">execOrderO</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-530"></span><span>
</span><span id="line-531"></span><span class="hs-comment">-- | Generates a calculation function corresponding to the 'CodeDefinition'.</span><span>
</span><span id="line-532"></span><span class="hs-comment">-- For solving ODEs, the 'ExtLibState' containing the information needed to</span><span>
</span><span id="line-533"></span><span class="hs-comment">-- generate code is found by looking it up in the external library map.</span><span>
</span><span id="line-534"></span><span id="local-6989586621679363432"><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genCalcFunc"><span class="hs-identifier hs-type">genCalcFunc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679363432"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Chunk.CodeDefinition.html#CodeDefinition"><span class="hs-identifier hs-type">CodeDefinition</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-535"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679363432"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-536"></span><span id="genCalcFunc"><span class="annot"><span class="annottext">genCalcFunc :: forall (r :: * -&gt; *).
OOProg r =&gt;
CodeDefinition -&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genCalcFunc"><span class="hs-identifier hs-var hs-var">genCalcFunc</span></a></span></span><span> </span><span id="local-6989586621679368993"><span class="annot"><span class="annottext">CodeDefinition
</span><a href="#local-6989586621679368993"><span class="hs-identifier hs-var">cdef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-537"></span><span>  </span><span id="local-6989586621679368994"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679368994"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-538"></span><span>  </span><span class="annot"><span class="annottext">(DrasilState -&gt; DrasilState) -&gt; StateT DrasilState Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679368995"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679368995"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679368995"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#currentScope"><span class="hs-identifier hs-var">currentScope</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#Local"><span class="hs-identifier hs-type">Local</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-539"></span><span>  </span><span id="local-6989586621679368996"><span class="annot"><span class="annottext">[CodeVarChunk]
</span><a href="#local-6989586621679368996"><span class="hs-identifier hs-var">parms</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeDefinition -&gt; GenState [CodeVarChunk]
</span><a href="Language.Drasil.Code.Imperative.Parameters.html#getCalcParams"><span class="hs-identifier hs-var">getCalcParams</span></a></span><span> </span><span class="annot"><span class="annottext">CodeDefinition
</span><a href="#local-6989586621679368993"><span class="hs-identifier hs-var">cdef</span></a></span><span>
</span><span id="line-540"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679368998"><span class="annot"><span class="annottext">nm :: String
</span><a href="#local-6989586621679368998"><span class="hs-identifier hs-var hs-var">nm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CodeDefinition -&gt; String
forall c. CodeIdea c =&gt; c -&gt; String
</span><span class="hs-identifier hs-var">codeName</span></span><span> </span><span class="annot"><span class="annottext">CodeDefinition
</span><a href="#local-6989586621679368993"><span class="hs-identifier hs-var">cdef</span></a></span><span>
</span><span id="line-541"></span><span>  </span><span id="local-6989586621679368999"><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679368999"><span class="hs-identifier hs-var">tp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeDefinition -&gt; StateT DrasilState Identity CodeType
forall c. HasSpace c =&gt; c -&gt; StateT DrasilState Identity CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#codeType"><span class="hs-identifier hs-var">codeType</span></a></span><span> </span><span class="annot"><span class="annottext">CodeDefinition
</span><a href="#local-6989586621679368993"><span class="hs-identifier hs-var">cdef</span></a></span><span>
</span><span id="line-542"></span><span>  </span><span id="local-6989586621679369000"><span class="annot"><span class="annottext">VS (r (Variable r))
</span><a href="#local-6989586621679369000"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeVarChunk -&gt; StateT DrasilState Identity (VS (r (Variable r)))
forall (r :: * -&gt; *).
OOProg r =&gt;
CodeVarChunk -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeDefinition -&gt; CodeVarChunk
forall c.
(Quantity c, MayHaveUnit c, Concept c) =&gt;
c -&gt; CodeVarChunk
</span><a href="Language.Drasil.Chunk.CodeBase.html#quantvar"><span class="hs-identifier hs-var">quantvar</span></a></span><span> </span><span class="annot"><span class="annottext">CodeDefinition
</span><a href="#local-6989586621679368993"><span class="hs-identifier hs-var">cdef</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-543"></span><span>  </span><span id="local-6989586621679369001"><span class="annot"><span class="annottext">[MS (r (Block r))]
</span><a href="#local-6989586621679369001"><span class="hs-identifier hs-var">blcks</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CodeDefinition
</span><a href="#local-6989586621679368993"><span class="hs-identifier hs-var">cdef</span></a></span><span> </span><span class="annot"><span class="annottext">CodeDefinition
-&gt; Getting DefinitionType CodeDefinition DefinitionType
-&gt; DefinitionType
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting DefinitionType CodeDefinition DefinitionType
Lens' CodeDefinition DefinitionType
</span><a href="Language.Drasil.Chunk.CodeDefinition.html#defType"><span class="hs-identifier hs-var">defType</span></a></span><span>
</span><span id="line-544"></span><span>            </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="annottext">DefinitionType
</span><a href="Language.Drasil.Chunk.CodeDefinition.html#Definition"><span class="hs-identifier hs-var">Definition</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">State DrasilState (MS (r (Block r)))
-&gt; StateT DrasilState Identity [MS (r (Block r))]
forall a b. State a b -&gt; State a [b]
</span><a href="Language.Drasil.Code.Imperative.Helpers.html#liftS"><span class="hs-identifier hs-var">liftS</span></a></span><span> </span><span class="annot"><span class="annottext">(State DrasilState (MS (r (Block r)))
 -&gt; StateT DrasilState Identity [MS (r (Block r))])
-&gt; State DrasilState (MS (r (Block r)))
-&gt; StateT DrasilState Identity [MS (r (Block r))]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CalcType
-&gt; CodeDefinition
-&gt; CodeExpr
-&gt; State DrasilState (MS (r (Block r)))
forall (r :: * -&gt; *).
OOProg r =&gt;
CalcType -&gt; CodeDefinition -&gt; CodeExpr -&gt; GenState (MSBlock r)
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genCalcBlock"><span class="hs-identifier hs-var">genCalcBlock</span></a></span><span> </span><span class="annot"><span class="annottext">CalcType
</span><a href="Language.Drasil.Code.Imperative.Modules.html#CalcReturn"><span class="hs-identifier hs-var">CalcReturn</span></a></span><span> </span><span class="annot"><span class="annottext">CodeDefinition
</span><a href="#local-6989586621679368993"><span class="hs-identifier hs-var">cdef</span></a></span><span>
</span><span id="line-545"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeDefinition
</span><a href="#local-6989586621679368993"><span class="hs-identifier hs-var">cdef</span></a></span><span> </span><span class="annot"><span class="annottext">CodeDefinition
-&gt; Getting CodeExpr CodeDefinition CodeExpr -&gt; CodeExpr
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting CodeExpr CodeDefinition CodeExpr
forall c. DefiningCodeExpr c =&gt; Lens' c CodeExpr
Lens' CodeDefinition CodeExpr
</span><span class="hs-identifier hs-var">codeExpr</span></span><span class="hs-special">)</span><span>
</span><span id="line-546"></span><span>               </span><span class="annot"><span class="annottext">DefinitionType
</span><a href="Language.Drasil.Chunk.CodeDefinition.html#ODE"><span class="hs-identifier hs-var">ODE</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity [MS (r (Block r))]
-&gt; (ExtLibState -&gt; StateT DrasilState Identity [MS (r (Block r))])
-&gt; Maybe ExtLibState
-&gt; StateT DrasilState Identity [MS (r (Block r))]
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; StateT DrasilState Identity [MS (r (Block r))]
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; StateT DrasilState Identity [MS (r (Block r))])
-&gt; String -&gt; StateT DrasilState Identity [MS (r (Block r))]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679368998"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; missing from ExtLibMap&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-547"></span><span>                 </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679369006"><span class="annot"><span class="annottext">ExtLibState
</span><a href="#local-6989586621679369006"><span class="hs-identifier hs-var">el</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-548"></span><span>                   </span><span id="local-6989586621679369007"><span class="annot"><span class="annottext">[MS (r (Statement r))]
</span><a href="#local-6989586621679369007"><span class="hs-identifier hs-var">defStmts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FuncStmt -&gt; StateT DrasilState Identity (MS (r (Statement r))))
-&gt; [FuncStmt] -&gt; StateT DrasilState Identity [MS (r (Statement r))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">FuncStmt -&gt; StateT DrasilState Identity (MS (r (Statement r)))
forall (r :: * -&gt; *).
OOProg r =&gt;
FuncStmt -&gt; GenState (MSStatement r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExtLibState
</span><a href="#local-6989586621679369006"><span class="hs-identifier hs-var">el</span></a></span><span> </span><span class="annot"><span class="annottext">ExtLibState
-&gt; Getting [FuncStmt] ExtLibState [FuncStmt] -&gt; [FuncStmt]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting [FuncStmt] ExtLibState [FuncStmt]
Lens' ExtLibState [FuncStmt]
</span><a href="Language.Drasil.Code.ExtLibImport.html#defs"><span class="hs-identifier hs-var">defs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-549"></span><span>                   </span><span id="local-6989586621679369008"><span class="annot"><span class="annottext">[MS (r (Statement r))]
</span><a href="#local-6989586621679369008"><span class="hs-identifier hs-var">stepStmts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FuncStmt -&gt; StateT DrasilState Identity (MS (r (Statement r))))
-&gt; [FuncStmt] -&gt; StateT DrasilState Identity [MS (r (Statement r))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">FuncStmt -&gt; StateT DrasilState Identity (MS (r (Statement r)))
forall (r :: * -&gt; *).
OOProg r =&gt;
FuncStmt -&gt; GenState (MSStatement r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExtLibState
</span><a href="#local-6989586621679369006"><span class="hs-identifier hs-var">el</span></a></span><span> </span><span class="annot"><span class="annottext">ExtLibState
-&gt; Getting [FuncStmt] ExtLibState [FuncStmt] -&gt; [FuncStmt]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting [FuncStmt] ExtLibState [FuncStmt]
Lens' ExtLibState [FuncStmt]
</span><a href="Language.Drasil.Code.ExtLibImport.html#steps"><span class="hs-identifier hs-var">steps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-550"></span><span>                   </span><span class="annot"><span class="annottext">[MS (r (Block r))]
-&gt; StateT DrasilState Identity [MS (r (Block r))]
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[MS (r (Statement r))] -&gt; MS (r (Block r))
forall (r :: * -&gt; *). BlockSym r =&gt; [MSStatement r] -&gt; MSBlock r
</span><span class="hs-identifier hs-var">block</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VS (r (Variable r)) -&gt; r (Scope r) -&gt; MS (r (Statement r))
forall (r :: * -&gt; *).
DeclStatement r =&gt;
SVariable r -&gt; r (Scope r) -&gt; MSStatement r
</span><span class="hs-identifier hs-var">varDec</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
</span><a href="#local-6989586621679369000"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">r (Scope r)
forall (r :: * -&gt; *). ScopeSym r =&gt; r (Scope r)
</span><span class="hs-identifier hs-var">local</span></span><span> </span><span class="annot"><span class="annottext">MS (r (Statement r))
-&gt; [MS (r (Statement r))] -&gt; [MS (r (Statement r))]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[MS (r (Statement r))]
</span><a href="#local-6989586621679369007"><span class="hs-identifier hs-var">defStmts</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-551"></span><span>                     </span><span class="annot"><span class="annottext">[MS (r (Statement r))] -&gt; MS (r (Block r))
forall (r :: * -&gt; *). BlockSym r =&gt; [MSStatement r] -&gt; MSBlock r
</span><span class="hs-identifier hs-var">block</span></span><span> </span><span class="annot"><span class="annottext">[MS (r (Statement r))]
</span><a href="#local-6989586621679369008"><span class="hs-identifier hs-var">stepStmts</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-552"></span><span>                     </span><span class="annot"><span class="annottext">[MS (r (Statement r))] -&gt; MS (r (Block r))
forall (r :: * -&gt; *). BlockSym r =&gt; [MSStatement r] -&gt; MSBlock r
</span><span class="hs-identifier hs-var">block</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SValue r -&gt; MS (r (Statement r))
forall (r :: * -&gt; *).
ControlStatement r =&gt;
SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">returnStmt</span></span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; MS (r (Statement r)))
-&gt; SValue r -&gt; MS (r (Statement r))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r)) -&gt; SValue r
forall (r :: * -&gt; *). VariableValue r =&gt; SVariable r -&gt; SValue r
</span><span class="hs-identifier hs-var">valueOf</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
</span><a href="#local-6989586621679369000"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-553"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ExtLibMap -&gt; Maybe ExtLibState
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679368998"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; ExtLibMap
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#extLibMap"><span class="hs-identifier hs-var">extLibMap</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679368994"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-554"></span><span>  </span><span id="local-6989586621679369011"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679369011"><span class="hs-identifier hs-var">calcDesc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeDefinition -&gt; GenState String
forall c. CodeIdea c =&gt; c -&gt; GenState String
</span><a href="Language.Drasil.Code.Imperative.Comments.html#getCommentBrief"><span class="hs-identifier hs-var">getCommentBrief</span></a></span><span> </span><span class="annot"><span class="annottext">CodeDefinition
</span><a href="#local-6989586621679368993"><span class="hs-identifier hs-var">cdef</span></a></span><span>
</span><span id="line-555"></span><span>  </span><span id="local-6989586621679369012"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679369012"><span class="hs-identifier hs-var">desc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeDefinition -&gt; GenState String
forall c. CodeIdea c =&gt; c -&gt; GenState String
</span><a href="Language.Drasil.Code.Imperative.Comments.html#getCommentBrief"><span class="hs-identifier hs-var">getCommentBrief</span></a></span><span> </span><span class="annot"><span class="annottext">CodeDefinition
</span><a href="#local-6989586621679368993"><span class="hs-identifier hs-var">cdef</span></a></span><span>
</span><span id="line-556"></span><span>  </span><span class="annot"><span class="annottext">String
-&gt; VSType r
-&gt; String
-&gt; [ParameterChunk]
-&gt; Maybe String
-&gt; [MS (r (Block r))]
-&gt; GenState (SMethod r)
forall (r :: * -&gt; *).
OOProg r =&gt;
String
-&gt; VSType r
-&gt; String
-&gt; [ParameterChunk]
-&gt; Maybe String
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#publicFunc"><span class="hs-identifier hs-var">publicFunc</span></a></span><span>
</span><span id="line-557"></span><span>    </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679368998"><span class="hs-identifier hs-var">nm</span></a></span><span>
</span><span id="line-558"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeType -&gt; VSType r
forall (r :: * -&gt; *). OOTypeSym r =&gt; CodeType -&gt; VSType r
</span><span class="hs-identifier hs-var">convTypeOO</span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679368999"><span class="hs-identifier hs-var">tp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-559"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Calculates &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679369011"><span class="hs-identifier hs-var">calcDesc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-560"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CodeVarChunk -&gt; ParameterChunk)
-&gt; [CodeVarChunk] -&gt; [ParameterChunk]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">CodeVarChunk -&gt; ParameterChunk
forall c. CodeIdea c =&gt; c -&gt; ParameterChunk
</span><a href="Language.Drasil.Chunk.Parameter.html#pcAuto"><span class="hs-identifier hs-var">pcAuto</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeVarChunk]
</span><a href="#local-6989586621679368996"><span class="hs-identifier hs-var">parms</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-561"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Maybe String
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679369012"><span class="hs-identifier hs-var">desc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-562"></span><span>    </span><span class="annot"><span class="annottext">[MS (r (Block r))]
</span><a href="#local-6989586621679369001"><span class="hs-identifier hs-var">blcks</span></a></span><span>
</span><span id="line-563"></span><span>
</span><span id="line-564"></span><span class="annot"><span class="hs-comment">-- | Calculations may be assigned to a variable or asked for a result.</span></span><span>
</span><span id="line-565"></span><span class="hs-keyword">data</span><span> </span><span id="CalcType"><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#CalcType"><span class="hs-identifier hs-var">CalcType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="CalcAssign"><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#CalcAssign"><span class="hs-identifier hs-var">CalcAssign</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="CalcReturn"><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#CalcReturn"><span class="hs-identifier hs-var">CalcReturn</span></a></span></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679369014"><span id="local-6989586621679369016"><span class="annot"><span class="annottext">CalcType -&gt; CalcType -&gt; Bool
(CalcType -&gt; CalcType -&gt; Bool)
-&gt; (CalcType -&gt; CalcType -&gt; Bool) -&gt; Eq CalcType
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: CalcType -&gt; CalcType -&gt; Bool
== :: CalcType -&gt; CalcType -&gt; Bool
$c/= :: CalcType -&gt; CalcType -&gt; Bool
/= :: CalcType -&gt; CalcType -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span>
</span><span id="line-566"></span><span>
</span><span id="line-567"></span><span class="hs-comment">-- | Generates a calculation block for the given 'CodeDefinition', and assigns the</span><span>
</span><span id="line-568"></span><span class="hs-comment">-- result to a variable (if 'CalcAssign') or returns the result (if 'CalcReturn').</span><span>
</span><span id="line-569"></span><span id="local-6989586621679363350"><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genCalcBlock"><span class="hs-identifier hs-type">genCalcBlock</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679363350"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#CalcType"><span class="hs-identifier hs-type">CalcType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Chunk.CodeDefinition.html#CodeDefinition"><span class="hs-identifier hs-type">CodeDefinition</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CodeExpr</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-570"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MSBlock</span></span><span> </span><span class="annot"><a href="#local-6989586621679363350"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-571"></span><span id="genCalcBlock"><span class="annot"><span class="annottext">genCalcBlock :: forall (r :: * -&gt; *).
OOProg r =&gt;
CalcType -&gt; CodeDefinition -&gt; CodeExpr -&gt; GenState (MSBlock r)
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genCalcBlock"><span class="hs-identifier hs-var hs-var">genCalcBlock</span></a></span></span><span> </span><span id="local-6989586621679369049"><span class="annot"><span class="annottext">CalcType
</span><a href="#local-6989586621679369049"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679369050"><span class="annot"><span class="annottext">CodeDefinition
</span><a href="#local-6989586621679369050"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Case</span></span><span> </span><span id="local-6989586621679369052"><span class="annot"><span class="annottext">Completeness
</span><a href="#local-6989586621679369052"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679369053"><span class="annot"><span class="annottext">[(CodeExpr, CodeExpr)]
</span><a href="#local-6989586621679369053"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CalcType
-&gt; CodeDefinition
-&gt; Completeness
-&gt; [(CodeExpr, CodeExpr)]
-&gt; StateT
     DrasilState Identity (StateT MethodState Identity (r (Block r)))
forall (r :: * -&gt; *).
OOProg r =&gt;
CalcType
-&gt; CodeDefinition
-&gt; Completeness
-&gt; [(CodeExpr, CodeExpr)]
-&gt; GenState (MSBlock r)
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genCaseBlock"><span class="hs-identifier hs-var">genCaseBlock</span></a></span><span> </span><span class="annot"><span class="annottext">CalcType
</span><a href="#local-6989586621679369049"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">CodeDefinition
</span><a href="#local-6989586621679369050"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Completeness
</span><a href="#local-6989586621679369052"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">[(CodeExpr, CodeExpr)]
</span><a href="#local-6989586621679369053"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-572"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genCalcBlock"><span class="hs-identifier hs-var">genCalcBlock</span></a></span><span> </span><span class="annot"><span class="annottext">CalcType
</span><a href="Language.Drasil.Code.Imperative.Modules.html#CalcAssign"><span class="hs-identifier hs-var">CalcAssign</span></a></span><span> </span><span id="local-6989586621679369055"><span class="annot"><span class="annottext">CodeDefinition
</span><a href="#local-6989586621679369055"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679369056"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679369056"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-573"></span><span>  </span><span id="local-6989586621679369057"><span class="annot"><span class="annottext">VS (r (Variable r))
</span><a href="#local-6989586621679369057"><span class="hs-identifier hs-var">vv</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeVarChunk -&gt; StateT DrasilState Identity (VS (r (Variable r)))
forall (r :: * -&gt; *).
OOProg r =&gt;
CodeVarChunk -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeDefinition -&gt; CodeVarChunk
forall c.
(Quantity c, MayHaveUnit c, Concept c) =&gt;
c -&gt; CodeVarChunk
</span><a href="Language.Drasil.Chunk.CodeBase.html#quantvar"><span class="hs-identifier hs-var">quantvar</span></a></span><span> </span><span class="annot"><span class="annottext">CodeDefinition
</span><a href="#local-6989586621679369055"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-574"></span><span>  </span><span id="local-6989586621679369058"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679369058"><span class="hs-identifier hs-var">ee</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679369056"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-575"></span><span>  </span><span id="local-6989586621679369059"><span class="annot"><span class="annottext">[MS (r (Statement r))]
</span><a href="#local-6989586621679369059"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
-&gt; StateT DrasilState Identity [MS (r (Statement r))]
forall (r :: * -&gt; *).
SharedProg r =&gt;
SVariable r -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Logging.html#maybeLog"><span class="hs-identifier hs-var">maybeLog</span></a></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
</span><a href="#local-6989586621679369057"><span class="hs-identifier hs-var">vv</span></a></span><span>
</span><span id="line-576"></span><span>  </span><span class="annot"><span class="annottext">StateT MethodState Identity (r (Block r))
-&gt; StateT
     DrasilState Identity (StateT MethodState Identity (r (Block r)))
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(StateT MethodState Identity (r (Block r))
 -&gt; StateT
      DrasilState Identity (StateT MethodState Identity (r (Block r))))
-&gt; StateT MethodState Identity (r (Block r))
-&gt; StateT
     DrasilState Identity (StateT MethodState Identity (r (Block r)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[MS (r (Statement r))] -&gt; StateT MethodState Identity (r (Block r))
forall (r :: * -&gt; *). BlockSym r =&gt; [MSStatement r] -&gt; MSBlock r
</span><span class="hs-identifier hs-var">block</span></span><span> </span><span class="annot"><span class="annottext">([MS (r (Statement r))]
 -&gt; StateT MethodState Identity (r (Block r)))
-&gt; [MS (r (Statement r))]
-&gt; StateT MethodState Identity (r (Block r))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r)) -&gt; VS (r (Value r)) -&gt; MS (r (Statement r))
forall (r :: * -&gt; *).
AssignStatement r =&gt;
SVariable r -&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">assign</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
</span><a href="#local-6989586621679369057"><span class="hs-identifier hs-var">vv</span></a></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679369058"><span class="hs-identifier hs-var">ee</span></a></span><span> </span><span class="annot"><span class="annottext">MS (r (Statement r))
-&gt; [MS (r (Statement r))] -&gt; [MS (r (Statement r))]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[MS (r (Statement r))]
</span><a href="#local-6989586621679369059"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-577"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genCalcBlock"><span class="hs-identifier hs-var">genCalcBlock</span></a></span><span> </span><span class="annot"><span class="annottext">CalcType
</span><a href="Language.Drasil.Code.Imperative.Modules.html#CalcReturn"><span class="hs-identifier hs-var">CalcReturn</span></a></span><span> </span><span class="annot"><span class="annottext">CodeDefinition
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679369061"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679369061"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[MS (r (Statement r))] -&gt; StateT MethodState Identity (r (Block r))
forall (r :: * -&gt; *). BlockSym r =&gt; [MSStatement r] -&gt; MSBlock r
</span><span class="hs-identifier hs-var">block</span></span><span> </span><span class="annot"><span class="annottext">([MS (r (Statement r))]
 -&gt; StateT MethodState Identity (r (Block r)))
-&gt; StateT DrasilState Identity [MS (r (Statement r))]
-&gt; StateT
     DrasilState Identity (StateT MethodState Identity (r (Block r)))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">State DrasilState (MS (r (Statement r)))
-&gt; StateT DrasilState Identity [MS (r (Statement r))]
forall a b. State a b -&gt; State a [b]
</span><a href="Language.Drasil.Code.Imperative.Helpers.html#liftS"><span class="hs-identifier hs-var">liftS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VS (r (Value r)) -&gt; MS (r (Statement r))
forall (r :: * -&gt; *).
ControlStatement r =&gt;
SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">returnStmt</span></span><span> </span><span class="annot"><span class="annottext">(VS (r (Value r)) -&gt; MS (r (Statement r)))
-&gt; StateT DrasilState Identity (VS (r (Value r)))
-&gt; State DrasilState (MS (r (Statement r)))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679369061"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-578"></span><span>
</span><span id="line-579"></span><span class="hs-comment">-- | Generates a calculation block for a value defined by cases.</span><span>
</span><span id="line-580"></span><span class="hs-comment">-- If the function is defined for every case, the final case is captured by an</span><span>
</span><span id="line-581"></span><span class="hs-comment">-- else clause, otherwise an error-throwing else-clause is generated.</span><span>
</span><span id="line-582"></span><span id="local-6989586621679363444"><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genCaseBlock"><span class="hs-identifier hs-type">genCaseBlock</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679363444"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#CalcType"><span class="hs-identifier hs-type">CalcType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Chunk.CodeDefinition.html#CodeDefinition"><span class="hs-identifier hs-type">CodeDefinition</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Completeness</span></span><span>
</span><span id="line-583"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CodeExpr</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CodeExpr</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MSBlock</span></span><span> </span><span class="annot"><a href="#local-6989586621679363444"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-584"></span><span id="genCaseBlock"><span class="annot"><span class="annottext">genCaseBlock :: forall (r :: * -&gt; *).
OOProg r =&gt;
CalcType
-&gt; CodeDefinition
-&gt; Completeness
-&gt; [(CodeExpr, CodeExpr)]
-&gt; GenState (MSBlock r)
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genCaseBlock"><span class="hs-identifier hs-var hs-var">genCaseBlock</span></a></span></span><span> </span><span class="annot"><span class="annottext">CalcType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">CodeDefinition
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Completeness
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; GenState (MSBlock r)
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; GenState (MSBlock r)) -&gt; String -&gt; GenState (MSBlock r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Case expression with no cases encountered&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-585"></span><span>  </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; in code generator&quot;</span></span><span>
</span><span id="line-586"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genCaseBlock"><span class="hs-identifier hs-var">genCaseBlock</span></a></span><span> </span><span id="local-6989586621679369081"><span class="annot"><span class="annottext">CalcType
</span><a href="#local-6989586621679369081"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679369082"><span class="annot"><span class="annottext">CodeDefinition
</span><a href="#local-6989586621679369082"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679369083"><span class="annot"><span class="annottext">Completeness
</span><a href="#local-6989586621679369083"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679369084"><span class="annot"><span class="annottext">[(CodeExpr, CodeExpr)]
</span><a href="#local-6989586621679369084"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-587"></span><span>  </span><span id="local-6989586621679369085"><span class="annot"><span class="annottext">[(VS (r (Value r)), MS (r (Body r)))]
</span><a href="#local-6989586621679369085"><span class="hs-identifier hs-var">ifs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((CodeExpr, CodeExpr)
 -&gt; StateT DrasilState Identity (VS (r (Value r)), MS (r (Body r))))
-&gt; [(CodeExpr, CodeExpr)]
-&gt; StateT
     DrasilState Identity [(VS (r (Value r)), MS (r (Body r)))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679369086"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679369086"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679369087"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679369087"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(VS (r (Value r))
 -&gt; MS (r (Body r)) -&gt; (VS (r (Value r)), MS (r (Body r))))
-&gt; StateT DrasilState Identity (VS (r (Value r)))
-&gt; StateT DrasilState Identity (MS (r (Body r)))
-&gt; StateT DrasilState Identity (VS (r (Value r)), MS (r (Body r)))
forall (m :: * -&gt; *) a1 a2 r.
Monad m =&gt;
(a1 -&gt; a2 -&gt; r) -&gt; m a1 -&gt; m a2 -&gt; m r
</span><span class="hs-identifier hs-var">liftM2</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679369087"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (MS (r (Body r)))
forall {r :: * -&gt; *}.
OOProg r =&gt;
CodeExpr -&gt; StateT DrasilState Identity (MS (r (Body r)))
</span><a href="#local-6989586621679369088"><span class="hs-identifier hs-var">calcBody</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679369086"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Completeness -&gt; [(CodeExpr, CodeExpr)]
</span><a href="#local-6989586621679369089"><span class="hs-identifier hs-var">ifEs</span></a></span><span> </span><span class="annot"><span class="annottext">Completeness
</span><a href="#local-6989586621679369083"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-588"></span><span>  </span><span id="local-6989586621679369090"><span class="annot"><span class="annottext">MS (r (Body r))
</span><a href="#local-6989586621679369090"><span class="hs-identifier hs-var">els</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Completeness -&gt; StateT DrasilState Identity (MS (r (Body r)))
forall {r :: * -&gt; *}.
OOProg r =&gt;
Completeness -&gt; StateT DrasilState Identity (MS (r (Body r)))
</span><a href="#local-6989586621679369091"><span class="hs-identifier hs-var">elseE</span></a></span><span> </span><span class="annot"><span class="annottext">Completeness
</span><a href="#local-6989586621679369083"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-589"></span><span>  </span><span class="annot"><span class="annottext">MSBlock r -&gt; GenState (MSBlock r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSBlock r -&gt; GenState (MSBlock r))
-&gt; MSBlock r -&gt; GenState (MSBlock r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSBlock r
forall (r :: * -&gt; *). BlockSym r =&gt; [MSStatement r] -&gt; MSBlock r
</span><span class="hs-identifier hs-var">block</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[(VS (r (Value r)), MS (r (Body r)))]
-&gt; MS (r (Body r)) -&gt; MSStatement r
forall (r :: * -&gt; *).
ControlStatement r =&gt;
[(SValue r, MSBody r)] -&gt; MSBody r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">ifCond</span></span><span> </span><span class="annot"><span class="annottext">[(VS (r (Value r)), MS (r (Body r)))]
</span><a href="#local-6989586621679369085"><span class="hs-identifier hs-var">ifs</span></a></span><span> </span><span class="annot"><span class="annottext">MS (r (Body r))
</span><a href="#local-6989586621679369090"><span class="hs-identifier hs-var">els</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-590"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679369088"><span class="annot"><span class="annottext">calcBody :: CodeExpr -&gt; StateT DrasilState Identity (MS (r (Body r)))
</span><a href="#local-6989586621679369088"><span class="hs-identifier hs-var hs-var">calcBody</span></a></span></span><span> </span><span id="local-6989586621679369385"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679369385"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([MS (r (Block r))] -&gt; MS (r (Body r)))
-&gt; StateT DrasilState Identity [MS (r (Block r))]
-&gt; StateT DrasilState Identity (MS (r (Body r)))
forall a b.
(a -&gt; b)
-&gt; StateT DrasilState Identity a -&gt; StateT DrasilState Identity b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">[MS (r (Block r))] -&gt; MS (r (Body r))
forall (r :: * -&gt; *). BodySym r =&gt; [MSBlock r] -&gt; MSBody r
</span><span class="hs-identifier hs-var">body</span></span><span> </span><span class="annot"><span class="annottext">(StateT DrasilState Identity [MS (r (Block r))]
 -&gt; StateT DrasilState Identity (MS (r (Body r))))
-&gt; StateT DrasilState Identity [MS (r (Block r))]
-&gt; StateT DrasilState Identity (MS (r (Body r)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">State DrasilState (MS (r (Block r)))
-&gt; StateT DrasilState Identity [MS (r (Block r))]
forall a b. State a b -&gt; State a [b]
</span><a href="Language.Drasil.Code.Imperative.Helpers.html#liftS"><span class="hs-identifier hs-var">liftS</span></a></span><span> </span><span class="annot"><span class="annottext">(State DrasilState (MS (r (Block r)))
 -&gt; StateT DrasilState Identity [MS (r (Block r))])
-&gt; State DrasilState (MS (r (Block r)))
-&gt; StateT DrasilState Identity [MS (r (Block r))]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CalcType
-&gt; CodeDefinition
-&gt; CodeExpr
-&gt; State DrasilState (MS (r (Block r)))
forall (r :: * -&gt; *).
OOProg r =&gt;
CalcType -&gt; CodeDefinition -&gt; CodeExpr -&gt; GenState (MSBlock r)
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genCalcBlock"><span class="hs-identifier hs-var">genCalcBlock</span></a></span><span> </span><span class="annot"><span class="annottext">CalcType
</span><a href="#local-6989586621679369081"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">CodeDefinition
</span><a href="#local-6989586621679369082"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679369385"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-591"></span><span>        </span><span id="local-6989586621679369089"><span class="annot"><span class="annottext">ifEs :: Completeness -&gt; [(CodeExpr, CodeExpr)]
</span><a href="#local-6989586621679369089"><span class="hs-identifier hs-var hs-var">ifEs</span></a></span></span><span> </span><span class="annot"><span class="annottext">Completeness
</span><span class="hs-identifier hs-var">Complete</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(CodeExpr, CodeExpr)] -&gt; [(CodeExpr, CodeExpr)]
forall a. HasCallStack =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">init</span></span><span> </span><span class="annot"><span class="annottext">[(CodeExpr, CodeExpr)]
</span><a href="#local-6989586621679369084"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-592"></span><span>        </span><span class="annot"><a href="#local-6989586621679369089"><span class="hs-identifier hs-var">ifEs</span></a></span><span> </span><span class="annot"><span class="annottext">Completeness
</span><span class="hs-identifier hs-var">Incomplete</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(CodeExpr, CodeExpr)]
</span><a href="#local-6989586621679369084"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-593"></span><span>        </span><span id="local-6989586621679369091"><span class="annot"><span class="annottext">elseE :: Completeness -&gt; StateT DrasilState Identity (MS (r (Body r)))
</span><a href="#local-6989586621679369091"><span class="hs-identifier hs-var hs-var">elseE</span></a></span></span><span> </span><span class="annot"><span class="annottext">Completeness
</span><span class="hs-identifier hs-var">Complete</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (MS (r (Body r)))
forall {r :: * -&gt; *}.
OOProg r =&gt;
CodeExpr -&gt; StateT DrasilState Identity (MS (r (Body r)))
</span><a href="#local-6989586621679369088"><span class="hs-identifier hs-var">calcBody</span></a></span><span> </span><span class="annot"><span class="annottext">(CodeExpr -&gt; StateT DrasilState Identity (MS (r (Body r))))
-&gt; CodeExpr -&gt; StateT DrasilState Identity (MS (r (Body r)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(CodeExpr, CodeExpr) -&gt; CodeExpr
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((CodeExpr, CodeExpr) -&gt; CodeExpr)
-&gt; (CodeExpr, CodeExpr) -&gt; CodeExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(CodeExpr, CodeExpr)] -&gt; (CodeExpr, CodeExpr)
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">last</span></span><span> </span><span class="annot"><span class="annottext">[(CodeExpr, CodeExpr)]
</span><a href="#local-6989586621679369084"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-594"></span><span>        </span><span class="annot"><a href="#local-6989586621679369091"><span class="hs-identifier hs-var">elseE</span></a></span><span> </span><span class="annot"><span class="annottext">Completeness
</span><span class="hs-identifier hs-var">Incomplete</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MS (r (Body r)) -&gt; StateT DrasilState Identity (MS (r (Body r)))
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MS (r (Body r)) -&gt; StateT DrasilState Identity (MS (r (Body r))))
-&gt; MS (r (Body r)) -&gt; StateT DrasilState Identity (MS (r (Body r)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MSStatement r -&gt; MS (r (Body r))
forall (r :: * -&gt; *). BodySym r =&gt; MSStatement r -&gt; MSBody r
</span><span class="hs-identifier hs-var">oneLiner</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; MS (r (Body r)))
-&gt; MSStatement r -&gt; MS (r (Body r))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; MSStatement r
forall (r :: * -&gt; *). ControlStatement r =&gt; String -&gt; MSStatement r
</span><span class="hs-identifier hs-var">throw</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; MSStatement r) -&gt; String -&gt; MSStatement r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-595"></span><span>          </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Undefined case encountered in function &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">CodeDefinition -&gt; String
forall c. CodeIdea c =&gt; c -&gt; String
</span><span class="hs-identifier hs-var">codeName</span></span><span> </span><span class="annot"><span class="annottext">CodeDefinition
</span><a href="#local-6989586621679369082"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-596"></span><span>
</span><span id="line-597"></span><span class="hs-comment">----- OUTPUT -------</span><span>
</span><span id="line-598"></span><span>
</span><span id="line-599"></span><span class="annot"><span class="hs-comment">-- | Generates a module containing the function for printing outputs.</span></span><span>
</span><span id="line-600"></span><span id="local-6989586621679369696"><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genOutputMod"><span class="hs-identifier hs-type">genOutputMod</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679369696"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">OO.SFile</span></span><span> </span><span class="annot"><a href="#local-6989586621679369696"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-601"></span><span id="genOutputMod"><span class="annot"><span class="annottext">genOutputMod :: forall (r :: * -&gt; *). OOProg r =&gt; GenState [SFile r]
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genOutputMod"><span class="hs-identifier hs-var hs-var">genOutputMod</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-602"></span><span>  </span><span id="local-6989586621679369702"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679369702"><span class="hs-identifier hs-var">ofName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">InternalConcept -&gt; GenState String
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#genICName"><span class="hs-identifier hs-var">genICName</span></a></span><span> </span><span class="annot"><span class="annottext">InternalConcept
</span><a href="Language.Drasil.Choices.html#OutputFormat"><span class="hs-identifier hs-var">OutputFormat</span></a></span><span>
</span><span id="line-603"></span><span>  </span><span id="local-6989586621679369704"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679369704"><span class="hs-identifier hs-var">ofDesc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenState [String] -&gt; GenState String
</span><a href="Language.Drasil.Code.Imperative.Descriptions.html#modDesc"><span class="hs-identifier hs-var">modDesc</span></a></span><span> </span><span class="annot"><span class="annottext">(GenState [String] -&gt; GenState String)
-&gt; GenState [String] -&gt; GenState String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GenState String -&gt; GenState [String]
forall a b. State a b -&gt; State a [b]
</span><a href="Language.Drasil.Code.Imperative.Helpers.html#liftS"><span class="hs-identifier hs-var">liftS</span></a></span><span> </span><span class="annot"><span class="annottext">GenState String
</span><a href="Language.Drasil.Code.Imperative.Descriptions.html#outputFormatDesc"><span class="hs-identifier hs-var">outputFormatDesc</span></a></span><span>
</span><span id="line-604"></span><span>  </span><span class="annot"><span class="annottext">State DrasilState (SFile r) -&gt; GenState [SFile r]
forall a b. State a b -&gt; State a [b]
</span><a href="Language.Drasil.Code.Imperative.Helpers.html#liftS"><span class="hs-identifier hs-var">liftS</span></a></span><span> </span><span class="annot"><span class="annottext">(State DrasilState (SFile r) -&gt; GenState [SFile r])
-&gt; State DrasilState (SFile r) -&gt; GenState [SFile r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
-&gt; String
-&gt; [GenState (Maybe (SMethod r))]
-&gt; [GenState (Maybe (SClass r))]
-&gt; State DrasilState (SFile r)
forall (r :: * -&gt; *).
OOProg r =&gt;
String
-&gt; String
-&gt; [GenState (Maybe (SMethod r))]
-&gt; [GenState (Maybe (SClass r))]
-&gt; GenState (SFile r)
</span><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html#genModule"><span class="hs-identifier hs-var">genModule</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679369702"><span class="hs-identifier hs-var">ofName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679369704"><span class="hs-identifier hs-var">ofDesc</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">GenState (Maybe (SMethod r))
forall (r :: * -&gt; *). OOProg r =&gt; GenState (Maybe (SMethod r))
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genOutputFormat"><span class="hs-identifier hs-var">genOutputFormat</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-605"></span><span>
</span><span id="line-606"></span><span class="annot"><span class="hs-comment">-- | Generates a function for printing output values.</span></span><span>
</span><span id="line-607"></span><span id="local-6989586621679369705"><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genOutputFormat"><span class="hs-identifier hs-type">genOutputFormat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679369705"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679369705"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-608"></span><span id="genOutputFormat"><span class="annot"><span class="annottext">genOutputFormat :: forall (r :: * -&gt; *). OOProg r =&gt; GenState (Maybe (SMethod r))
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genOutputFormat"><span class="hs-identifier hs-var hs-var">genOutputFormat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-609"></span><span>  </span><span id="local-6989586621679369714"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679369714"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-610"></span><span>  </span><span class="annot"><span class="annottext">(DrasilState -&gt; DrasilState) -&gt; StateT DrasilState Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679369715"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679369715"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679369715"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#currentScope"><span class="hs-identifier hs-var">currentScope</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#Local"><span class="hs-identifier hs-type">Local</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-611"></span><span>  </span><span id="local-6989586621679369716"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679369716"><span class="hs-identifier hs-var">woName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">InternalConcept -&gt; GenState String
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#genICName"><span class="hs-identifier hs-var">genICName</span></a></span><span> </span><span class="annot"><span class="annottext">InternalConcept
</span><a href="Language.Drasil.Choices.html#WriteOutput"><span class="hs-identifier hs-var">WriteOutput</span></a></span><span>
</span><span id="line-612"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679363458"><span class="annot"><a href="#local-6989586621679369718"><span class="hs-identifier hs-type">genOutput</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679363458"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679363458"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-613"></span><span>      </span><span id="local-6989586621679369718"><span class="annot"><span class="annottext">genOutput :: forall (r :: * -&gt; *).
OOProg r =&gt;
Maybe String -&gt; GenState (Maybe (SMethod r))
</span><a href="#local-6989586621679369718"><span class="hs-identifier hs-var hs-var">genOutput</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (MS (r (Method r)))
-&gt; StateT DrasilState Identity (Maybe (MS (r (Method r))))
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe (MS (r (Method r)))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-614"></span><span>      </span><span class="annot"><a href="#local-6989586621679369718"><span class="hs-identifier hs-var">genOutput</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-615"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679369761"><span class="annot"><span class="annottext">l_outfile :: String
</span><a href="#local-6989586621679369761"><span class="hs-identifier hs-var hs-var">l_outfile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;outputfile&quot;</span></span><span>
</span><span id="line-616"></span><span>            </span><span id="local-6989586621679369765"><span class="annot"><span class="annottext">var_outfile :: SVariable r
</span><a href="#local-6989586621679369765"><span class="hs-identifier hs-var hs-var">var_outfile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; VSType r -&gt; SVariable r
forall (r :: * -&gt; *).
VariableSym r =&gt;
String -&gt; VSType r -&gt; SVariable r
</span><span class="hs-identifier hs-var">var</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679369761"><span class="hs-identifier hs-var">l_outfile</span></a></span><span> </span><span class="annot"><span class="annottext">VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; VSType r
</span><span class="hs-identifier hs-var">outfile</span></span><span>
</span><span id="line-617"></span><span>            </span><span id="local-6989586621679369772"><span class="annot"><span class="annottext">v_outfile :: SValue r
</span><a href="#local-6989586621679369772"><span class="hs-identifier hs-var hs-var">v_outfile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SVariable r -&gt; SValue r
forall (r :: * -&gt; *). VariableValue r =&gt; SVariable r -&gt; SValue r
</span><span class="hs-identifier hs-var">valueOf</span></span><span> </span><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679369765"><span class="hs-identifier hs-var">var_outfile</span></a></span><span>
</span><span id="line-618"></span><span>        </span><span id="local-6989586621679369773"><span class="annot"><span class="annottext">[CodeVarChunk]
</span><a href="#local-6989586621679369773"><span class="hs-identifier hs-var">parms</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenState [CodeVarChunk]
</span><a href="Language.Drasil.Code.Imperative.Parameters.html#getOutputParams"><span class="hs-identifier hs-var">getOutputParams</span></a></span><span>
</span><span id="line-619"></span><span>        </span><span id="local-6989586621679369774"><span class="annot"><span class="annottext">[[MS (r (Statement r))]]
</span><a href="#local-6989586621679369774"><span class="hs-identifier hs-var">outp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(CodeVarChunk
 -&gt; StateT DrasilState Identity [MS (r (Statement r))])
-&gt; [CodeVarChunk]
-&gt; StateT DrasilState Identity [[MS (r (Statement r))]]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679369775"><span class="annot"><span class="annottext">CodeVarChunk
</span><a href="#local-6989586621679369775"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-620"></span><span>          </span><span id="local-6989586621679369776"><span class="annot"><span class="annottext">SValue r
</span><a href="#local-6989586621679369776"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeVarChunk -&gt; StateT DrasilState Identity (SValue r)
forall (r :: * -&gt; *).
OOProg r =&gt;
CodeVarChunk -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVal"><span class="hs-identifier hs-var">mkVal</span></a></span><span> </span><span class="annot"><span class="annottext">CodeVarChunk
</span><a href="#local-6989586621679369775"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-621"></span><span>          </span><span class="annot"><span class="annottext">[MS (r (Statement r))]
-&gt; StateT DrasilState Identity [MS (r (Statement r))]
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; String -&gt; MS (r (Statement r))
forall (r :: * -&gt; *).
IOStatement r =&gt;
SValue r -&gt; String -&gt; MSStatement r
</span><span class="hs-identifier hs-var">printFileStr</span></span><span> </span><span class="annot"><span class="annottext">SValue r
</span><a href="#local-6989586621679369772"><span class="hs-identifier hs-var">v_outfile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeVarChunk -&gt; String
forall c. CodeIdea c =&gt; c -&gt; String
</span><span class="hs-identifier hs-var">codeName</span></span><span> </span><span class="annot"><span class="annottext">CodeVarChunk
</span><a href="#local-6989586621679369775"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; = &quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-622"></span><span>                   </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r -&gt; MS (r (Statement r))
forall (r :: * -&gt; *).
IOStatement r =&gt;
SValue r -&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">printFileLn</span></span><span> </span><span class="annot"><span class="annottext">SValue r
</span><a href="#local-6989586621679369772"><span class="hs-identifier hs-var">v_outfile</span></a></span><span> </span><span class="annot"><span class="annottext">SValue r
</span><a href="#local-6989586621679369776"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-623"></span><span>                 </span><span class="hs-special">]</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; CodeSpec
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#codeSpec"><span class="hs-identifier hs-var">codeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679369714"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">CodeSpec
-&gt; Getting [CodeVarChunk] CodeSpec [CodeVarChunk] -&gt; [CodeVarChunk]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting [CodeVarChunk] CodeSpec [CodeVarChunk]
forall c. HasOldCodeSpec c =&gt; Lens' c [CodeVarChunk]
Lens' CodeSpec [CodeVarChunk]
</span><a href="Language.Drasil.CodeSpec.html#outputsO"><span class="hs-identifier hs-var">outputsO</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-624"></span><span>        </span><span id="local-6989586621679369780"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679369780"><span class="hs-identifier hs-var">desc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenState String
</span><a href="Language.Drasil.Code.Imperative.Descriptions.html#woFuncDesc"><span class="hs-identifier hs-var">woFuncDesc</span></a></span><span>
</span><span id="line-625"></span><span>        </span><span id="local-6989586621679369781"><span class="annot"><span class="annottext">MS (r (Method r))
</span><a href="#local-6989586621679369781"><span class="hs-identifier hs-var">mthd</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; VSType r
-&gt; String
-&gt; [ParameterChunk]
-&gt; Maybe String
-&gt; [MSBlock r]
-&gt; StateT DrasilState Identity (MS (r (Method r)))
forall (r :: * -&gt; *).
OOProg r =&gt;
String
-&gt; VSType r
-&gt; String
-&gt; [ParameterChunk]
-&gt; Maybe String
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#publicFunc"><span class="hs-identifier hs-var">publicFunc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679369716"><span class="hs-identifier hs-var">woName</span></a></span><span> </span><span class="annot"><span class="annottext">VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; VSType r
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679369780"><span class="hs-identifier hs-var">desc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CodeVarChunk -&gt; ParameterChunk)
-&gt; [CodeVarChunk] -&gt; [ParameterChunk]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">CodeVarChunk -&gt; ParameterChunk
forall c. CodeIdea c =&gt; c -&gt; ParameterChunk
</span><a href="Language.Drasil.Chunk.Parameter.html#pcAuto"><span class="hs-identifier hs-var">pcAuto</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeVarChunk]
</span><a href="#local-6989586621679369773"><span class="hs-identifier hs-var">parms</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe String
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-626"></span><span>          </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[MS (r (Statement r))] -&gt; MSBlock r
forall (r :: * -&gt; *). BlockSym r =&gt; [MSStatement r] -&gt; MSBlock r
</span><span class="hs-identifier hs-var">block</span></span><span> </span><span class="annot"><span class="annottext">([MS (r (Statement r))] -&gt; MSBlock r)
-&gt; [MS (r (Statement r))] -&gt; MSBlock r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-627"></span><span>          </span><span class="annot"><span class="annottext">SVariable r -&gt; r (Scope r) -&gt; MS (r (Statement r))
forall (r :: * -&gt; *).
DeclStatement r =&gt;
SVariable r -&gt; r (Scope r) -&gt; MSStatement r
</span><span class="hs-identifier hs-var">varDec</span></span><span> </span><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679369765"><span class="hs-identifier hs-var">var_outfile</span></a></span><span> </span><span class="annot"><span class="annottext">r (Scope r)
forall (r :: * -&gt; *). ScopeSym r =&gt; r (Scope r)
</span><span class="hs-identifier hs-var">local</span></span><span class="hs-special">,</span><span>
</span><span id="line-628"></span><span>          </span><span class="annot"><span class="annottext">SVariable r -&gt; SValue r -&gt; MS (r (Statement r))
forall (r :: * -&gt; *).
IOStatement r =&gt;
SVariable r -&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">openFileW</span></span><span> </span><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679369765"><span class="hs-identifier hs-var">var_outfile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SValue r
forall (r :: * -&gt; *). Literal r =&gt; String -&gt; SValue r
</span><span class="hs-identifier hs-var">litString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;output.txt&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[MS (r (Statement r))]
-&gt; [MS (r (Statement r))] -&gt; [MS (r (Statement r))]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-629"></span><span>          </span><span class="annot"><span class="annottext">[[MS (r (Statement r))]] -&gt; [MS (r (Statement r))]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">[[MS (r (Statement r))]]
</span><a href="#local-6989586621679369774"><span class="hs-identifier hs-var">outp</span></a></span><span> </span><span class="annot"><span class="annottext">[MS (r (Statement r))]
-&gt; [MS (r (Statement r))] -&gt; [MS (r (Statement r))]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; MS (r (Statement r))
forall (r :: * -&gt; *). IOStatement r =&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">closeFile</span></span><span> </span><span class="annot"><span class="annottext">SValue r
</span><a href="#local-6989586621679369772"><span class="hs-identifier hs-var">v_outfile</span></a></span><span> </span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-630"></span><span>        </span><span class="annot"><span class="annottext">Maybe (MS (r (Method r)))
-&gt; StateT DrasilState Identity (Maybe (MS (r (Method r))))
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (MS (r (Method r)))
 -&gt; StateT DrasilState Identity (Maybe (MS (r (Method r)))))
-&gt; Maybe (MS (r (Method r)))
-&gt; StateT DrasilState Identity (Maybe (MS (r (Method r))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MS (r (Method r)) -&gt; Maybe (MS (r (Method r)))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">MS (r (Method r))
</span><a href="#local-6989586621679369781"><span class="hs-identifier hs-var">mthd</span></a></span><span>
</span><span id="line-631"></span><span>  </span><span class="annot"><span class="annottext">Maybe String -&gt; GenState (Maybe (SMethod r))
forall (r :: * -&gt; *).
OOProg r =&gt;
Maybe String -&gt; GenState (Maybe (SMethod r))
</span><a href="#local-6989586621679369718"><span class="hs-identifier hs-var">genOutput</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe String -&gt; GenState (Maybe (SMethod r)))
-&gt; Maybe String -&gt; GenState (Maybe (SMethod r))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Map String String -&gt; Maybe String
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679369716"><span class="hs-identifier hs-var">woName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; Map String String
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#eMap"><span class="hs-identifier hs-var">eMap</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679369714"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-632"></span><span>
</span><span id="line-633"></span><span class="hs-comment">-- Procedural Versions --</span><span>
</span><span id="line-634"></span><span>
</span><span id="line-635"></span><span class="annot"><span class="hs-comment">-- | Generates a controller module.</span></span><span>
</span><span id="line-636"></span><span id="local-6989586621679363461"><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genMainProc"><span class="hs-identifier hs-type">genMainProc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ProcProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679363461"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Proc.SFile</span></span><span> </span><span class="annot"><a href="#local-6989586621679363461"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-637"></span><span id="genMainProc"><span class="annot"><span class="annottext">genMainProc :: forall (r :: * -&gt; *). ProcProg r =&gt; GenState (SFile r)
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genMainProc"><span class="hs-identifier hs-var hs-var">genMainProc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; String
-&gt; [GenState (Maybe (SMethod r))]
-&gt; StateT
     DrasilState Identity (StateT FileState Identity (r (File r)))
forall (r :: * -&gt; *).
ProcProg r =&gt;
String
-&gt; String -&gt; [GenState (Maybe (SMethod r))] -&gt; GenState (SFile r)
</span><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html#genModuleProc"><span class="hs-identifier hs-var">genModuleProc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Control&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Controls the flow of the program&quot;</span></span><span>
</span><span id="line-638"></span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="annottext">GenState (Maybe (SMethod r))
forall (r :: * -&gt; *). SharedProg r =&gt; GenState (Maybe (SMethod r))
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genMainFuncProc"><span class="hs-identifier hs-var">genMainFuncProc</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-639"></span><span>
</span><span id="line-640"></span><span class="hs-comment">-- | Generates a main function, to act as the controller for an SCS program.</span><span>
</span><span id="line-641"></span><span class="hs-comment">-- The controller declares input and constant variables, then calls the</span><span>
</span><span id="line-642"></span><span class="hs-comment">-- functions for reading input values, calculating derived inputs, checking</span><span>
</span><span id="line-643"></span><span class="hs-comment">-- constraints, calculating outputs, and printing outputs.</span><span>
</span><span id="line-644"></span><span class="hs-comment">-- Returns Nothing if the user chose to generate a library.</span><span>
</span><span id="line-645"></span><span id="local-6989586621679363468"><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genMainFuncProc"><span class="hs-identifier hs-type">genMainFuncProc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679363468"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679363468"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-646"></span><span id="genMainFuncProc"><span class="annot"><span class="annottext">genMainFuncProc :: forall (r :: * -&gt; *). SharedProg r =&gt; GenState (Maybe (SMethod r))
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genMainFuncProc"><span class="hs-identifier hs-var hs-var">genMainFuncProc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-647"></span><span>    </span><span id="local-6989586621679369794"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679369794"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-648"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679370025"><span class="annot"><span class="annottext">mainFunc :: ImplementationType
-&gt; StateT DrasilState Identity (Maybe (MS (r (Method r))))
</span><a href="#local-6989586621679370025"><span class="hs-identifier hs-var hs-var">mainFunc</span></a></span></span><span> </span><span class="annot"><span class="annottext">ImplementationType
</span><a href="Language.Drasil.Choices.html#Library"><span class="hs-identifier hs-var">Library</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (MS (r (Method r)))
-&gt; StateT DrasilState Identity (Maybe (MS (r (Method r))))
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe (MS (r (Method r)))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-649"></span><span>        </span><span class="annot"><a href="#local-6989586621679370025"><span class="hs-identifier hs-var">mainFunc</span></a></span><span> </span><span class="annot"><span class="annottext">ImplementationType
</span><a href="Language.Drasil.Choices.html#Program"><span class="hs-identifier hs-var">Program</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-650"></span><span>          </span><span class="annot"><span class="annottext">(DrasilState -&gt; DrasilState) -&gt; StateT DrasilState Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679370026"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679370026"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679370026"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#currentScope"><span class="hs-identifier hs-var">currentScope</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#MainFn"><span class="hs-identifier hs-type">MainFn</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-651"></span><span>          </span><span id="local-6989586621679370027"><span class="annot"><span class="annottext">VS (r (Variable r))
</span><a href="#local-6989586621679370027"><span class="hs-identifier hs-var">v_filename</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeVarChunk -&gt; StateT DrasilState Identity (VS (r (Variable r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeVarChunk -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVarProc"><span class="hs-identifier hs-var">mkVarProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DefinedQuantityDict -&gt; CodeVarChunk
forall c.
(Quantity c, MayHaveUnit c, Concept c) =&gt;
c -&gt; CodeVarChunk
</span><a href="Language.Drasil.Chunk.CodeBase.html#quantvar"><span class="hs-identifier hs-var">quantvar</span></a></span><span> </span><span class="annot"><span class="annottext">DefinedQuantityDict
</span><a href="Language.Drasil.Code.CodeQuantityDicts.html#inFileName"><span class="hs-identifier hs-var">inFileName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-652"></span><span>          </span><span id="local-6989586621679370028"><span class="annot"><span class="annottext">[MS (r (Statement r))]
</span><a href="#local-6989586621679370028"><span class="hs-identifier hs-var">logInFile</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
-&gt; StateT DrasilState Identity [MS (r (Statement r))]
forall (r :: * -&gt; *).
SharedProg r =&gt;
SVariable r -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Logging.html#maybeLog"><span class="hs-identifier hs-var">maybeLog</span></a></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
</span><a href="#local-6989586621679370027"><span class="hs-identifier hs-var">v_filename</span></a></span><span>
</span><span id="line-653"></span><span>          </span><span id="local-6989586621679370029"><span class="annot"><span class="annottext">Maybe (MS (r (Statement r)))
</span><a href="#local-6989586621679370029"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenState (Maybe (MS (r (Statement r))))
forall (r :: * -&gt; *).
SharedProg r =&gt;
GenState (Maybe (MSStatement r))
</span><a href="Language.Drasil.Code.Imperative.Modules.html#initConstsProc"><span class="hs-identifier hs-var">initConstsProc</span></a></span><span>
</span><span id="line-654"></span><span>          </span><span id="local-6989586621679370031"><span class="annot"><span class="annottext">Maybe (MS (r (Statement r)))
</span><a href="#local-6989586621679370031"><span class="hs-identifier hs-var">ip</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenState (Maybe (MS (r (Statement r))))
forall (r :: * -&gt; *).
SharedProg r =&gt;
GenState (Maybe (MSStatement r))
</span><a href="Language.Drasil.Code.Imperative.Modules.html#getInputDeclProc"><span class="hs-identifier hs-var">getInputDeclProc</span></a></span><span>
</span><span id="line-655"></span><span>          </span><span id="local-6989586621679370033"><span class="annot"><span class="annottext">[MS (r (Statement r))]
</span><a href="#local-6989586621679370033"><span class="hs-identifier hs-var">ics</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity [MS (r (Statement r))]
forall (r :: * -&gt; *). SharedProg r =&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.FunctionCalls.html#genAllInputCallsProc"><span class="hs-identifier hs-var">genAllInputCallsProc</span></a></span><span>
</span><span id="line-656"></span><span>          </span><span id="local-6989586621679370034"><span class="annot"><span class="annottext">[Maybe (MS (r (Statement r)))]
</span><a href="#local-6989586621679370034"><span class="hs-identifier hs-var">varDef</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(CodeDefinition -&gt; GenState (Maybe (MS (r (Statement r)))))
-&gt; [CodeDefinition]
-&gt; StateT DrasilState Identity [Maybe (MS (r (Statement r)))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">CodeDefinition -&gt; GenState (Maybe (MS (r (Statement r))))
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeDefinition -&gt; GenState (Maybe (MSStatement r))
</span><a href="Language.Drasil.Code.Imperative.FunctionCalls.html#genCalcCallProc"><span class="hs-identifier hs-var">genCalcCallProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; CodeSpec
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#codeSpec"><span class="hs-identifier hs-var">codeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679369794"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">CodeSpec
-&gt; Getting [CodeDefinition] CodeSpec [CodeDefinition]
-&gt; [CodeDefinition]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting [CodeDefinition] CodeSpec [CodeDefinition]
forall c. HasOldCodeSpec c =&gt; Lens' c [CodeDefinition]
Lens' CodeSpec [CodeDefinition]
</span><a href="Language.Drasil.CodeSpec.html#execOrderO"><span class="hs-identifier hs-var">execOrderO</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-657"></span><span>          </span><span id="local-6989586621679370035"><span class="annot"><span class="annottext">Maybe (MS (r (Statement r)))
</span><a href="#local-6989586621679370035"><span class="hs-identifier hs-var">wo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenState (Maybe (MS (r (Statement r))))
forall (r :: * -&gt; *).
SharedProg r =&gt;
GenState (Maybe (MSStatement r))
</span><a href="Language.Drasil.Code.Imperative.FunctionCalls.html#genOutputCallProc"><span class="hs-identifier hs-var">genOutputCallProc</span></a></span><span>
</span><span id="line-658"></span><span>          </span><span class="annot"><span class="annottext">Maybe (MS (r (Method r)))
-&gt; StateT DrasilState Identity (Maybe (MS (r (Method r))))
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (MS (r (Method r)))
 -&gt; StateT DrasilState Identity (Maybe (MS (r (Method r)))))
-&gt; Maybe (MS (r (Method r)))
-&gt; StateT DrasilState Identity (Maybe (MS (r (Method r))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MS (r (Method r)) -&gt; Maybe (MS (r (Method r)))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(MS (r (Method r)) -&gt; Maybe (MS (r (Method r))))
-&gt; MS (r (Method r)) -&gt; Maybe (MS (r (Method r)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Comments
</span><a href="Language.Drasil.Choices.html#CommentFunc"><span class="hs-identifier hs-var">CommentFunc</span></a></span><span> </span><span class="annot"><span class="annottext">Comments -&gt; [Comments] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; [Comments]
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#commented"><span class="hs-identifier hs-var">commented</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679369794"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">MS (r (Body r)) -&gt; MS (r (Method r))
forall (r :: * -&gt; *). MethodSym r =&gt; MSBody r -&gt; SMethod r
</span><span class="hs-identifier hs-var">docMain</span></span><span> </span><span class="hs-keyword">else</span><span>
</span><span id="line-659"></span><span>            </span><span class="annot"><span class="annottext">MS (r (Body r)) -&gt; MS (r (Method r))
forall (r :: * -&gt; *). MethodSym r =&gt; MSBody r -&gt; SMethod r
</span><span class="hs-identifier hs-var">mainFunction</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(MS (r (Body r)) -&gt; MS (r (Method r)))
-&gt; MS (r (Body r)) -&gt; MS (r (Method r))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[MS (r (Statement r))] -&gt; MS (r (Body r))
forall (r :: * -&gt; *). BodySym r =&gt; [MSStatement r] -&gt; MSBody r
</span><span class="hs-identifier hs-var">bodyStatements</span></span><span> </span><span class="annot"><span class="annottext">([MS (r (Statement r))] -&gt; MS (r (Body r)))
-&gt; [MS (r (Statement r))] -&gt; MS (r (Body r))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Logging] -&gt; r (Scope r) -&gt; [MS (r (Statement r))]
forall (r :: * -&gt; *).
SharedProg r =&gt;
[Logging] -&gt; r (Scope r) -&gt; [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Modules.html#initLogFileVar"><span class="hs-identifier hs-var">initLogFileVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; [Logging]
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#logKind"><span class="hs-identifier hs-var">logKind</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679369794"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">r (Scope r)
forall (r :: * -&gt; *). ScopeSym r =&gt; r (Scope r)
</span><span class="hs-identifier hs-var">mainFn</span></span><span>
</span><span id="line-660"></span><span>            </span><span class="annot"><span class="annottext">[MS (r (Statement r))]
-&gt; [MS (r (Statement r))] -&gt; [MS (r (Statement r))]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
-&gt; r (Scope r) -&gt; SValue r -&gt; MS (r (Statement r))
forall (r :: * -&gt; *).
DeclStatement r =&gt;
SVariable r -&gt; r (Scope r) -&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">varDecDef</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
</span><a href="#local-6989586621679370027"><span class="hs-identifier hs-var">v_filename</span></a></span><span> </span><span class="annot"><span class="annottext">r (Scope r)
forall (r :: * -&gt; *). ScopeSym r =&gt; r (Scope r)
</span><span class="hs-identifier hs-var">mainFn</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; SValue r
forall (r :: * -&gt; *). CommandLineArgs r =&gt; Integer -&gt; SValue r
</span><span class="hs-identifier hs-var">arg</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-661"></span><span>            </span><span class="annot"><span class="annottext">MS (r (Statement r))
-&gt; [MS (r (Statement r))] -&gt; [MS (r (Statement r))]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[MS (r (Statement r))]
</span><a href="#local-6989586621679370028"><span class="hs-identifier hs-var">logInFile</span></a></span><span>
</span><span id="line-662"></span><span>            </span><span class="hs-comment">-- Constants must be declared before inputs because some derived</span><span>
</span><span id="line-663"></span><span>            </span><span class="hs-comment">-- input definitions or input constraints may use the constants</span><span>
</span><span id="line-664"></span><span>            </span><span class="annot"><span class="annottext">[MS (r (Statement r))]
-&gt; [MS (r (Statement r))] -&gt; [MS (r (Statement r))]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Maybe (MS (r (Statement r)))] -&gt; [MS (r (Statement r))]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Maybe (MS (r (Statement r)))
</span><a href="#local-6989586621679370029"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe (MS (r (Statement r)))
</span><a href="#local-6989586621679370031"><span class="hs-identifier hs-var">ip</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[MS (r (Statement r))]
-&gt; [MS (r (Statement r))] -&gt; [MS (r (Statement r))]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[MS (r (Statement r))]
</span><a href="#local-6989586621679370033"><span class="hs-identifier hs-var">ics</span></a></span><span> </span><span class="annot"><span class="annottext">[MS (r (Statement r))]
-&gt; [MS (r (Statement r))] -&gt; [MS (r (Statement r))]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Maybe (MS (r (Statement r)))] -&gt; [MS (r (Statement r))]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Maybe (MS (r (Statement r)))]
</span><a href="#local-6989586621679370034"><span class="hs-identifier hs-var">varDef</span></a></span><span> </span><span class="annot"><span class="annottext">[Maybe (MS (r (Statement r)))]
-&gt; [Maybe (MS (r (Statement r)))] -&gt; [Maybe (MS (r (Statement r)))]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Maybe (MS (r (Statement r)))
</span><a href="#local-6989586621679370035"><span class="hs-identifier hs-var">wo</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-665"></span><span>    </span><span class="annot"><span class="annottext">ImplementationType -&gt; GenState (Maybe (SMethod r))
forall {r :: * -&gt; *}.
SharedProg r =&gt;
ImplementationType
-&gt; StateT DrasilState Identity (Maybe (MS (r (Method r))))
</span><a href="#local-6989586621679370025"><span class="hs-identifier hs-var">mainFunc</span></a></span><span> </span><span class="annot"><span class="annottext">(ImplementationType -&gt; GenState (Maybe (SMethod r)))
-&gt; ImplementationType -&gt; GenState (Maybe (SMethod r))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; ImplementationType
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#implType"><span class="hs-identifier hs-var">implType</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679369794"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-666"></span><span>
</span><span id="line-667"></span><span class="hs-comment">-- | If constants are 'Unbundled', declare them individually using 'varDecDef' if</span><span>
</span><span id="line-668"></span><span class="hs-comment">-- representation is 'Var' and 'constDecDef' if representation is 'Const'.</span><span>
</span><span id="line-669"></span><span class="hs-comment">-- If constants are 'Bundled' independently and representation is 'Var', throw</span><span>
</span><span id="line-670"></span><span class="hs-comment">-- an error. If representation is 'Const', no object needs to be</span><span>
</span><span id="line-671"></span><span class="hs-comment">-- declared because the constants will be accessed directly through the</span><span>
</span><span id="line-672"></span><span class="hs-comment">-- Constants class.</span><span>
</span><span id="line-673"></span><span class="hs-comment">-- If constants are 'Bundled' 'WithInputs', do 'Nothing'; declaration of the 'inParams'</span><span>
</span><span id="line-674"></span><span class="hs-comment">-- object is handled by 'getInputDecl'.</span><span>
</span><span id="line-675"></span><span class="hs-comment">-- If constants are 'Inlined', nothing needs to be declared.</span><span>
</span><span id="line-676"></span><span id="local-6989586621679363474"><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#initConstsProc"><span class="hs-identifier hs-type">initConstsProc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679363474"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MSStatement</span></span><span> </span><span class="annot"><a href="#local-6989586621679363474"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-677"></span><span id="initConstsProc"><span class="annot"><span class="annottext">initConstsProc :: forall (r :: * -&gt; *).
SharedProg r =&gt;
GenState (Maybe (MSStatement r))
</span><a href="Language.Drasil.Code.Imperative.Modules.html#initConstsProc"><span class="hs-identifier hs-var hs-var">initConstsProc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-678"></span><span>  </span><span id="local-6989586621679370077"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679370077"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-679"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679370206"><span class="annot"><span class="annottext">scp :: r (Scope r)
</span><a href="#local-6989586621679370206"><span class="hs-identifier hs-var hs-var">scp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScopeType -&gt; r (Scope r)
forall (r :: * -&gt; *). SharedProg r =&gt; ScopeType -&gt; r (Scope r)
</span><a href="Language.Drasil.Code.Imperative.Helpers.html#convScope"><span class="hs-identifier hs-var">convScope</span></a></span><span> </span><span class="annot"><span class="annottext">(ScopeType -&gt; r (Scope r)) -&gt; ScopeType -&gt; r (Scope r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; ScopeType
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#currentScope"><span class="hs-identifier hs-var">currentScope</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679370077"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-680"></span><span>      </span><span id="local-6989586621679370209"><span class="annot"><span class="annottext">cs :: [CodeDefinition]
</span><a href="#local-6989586621679370209"><span class="hs-identifier hs-var hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; CodeSpec
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#codeSpec"><span class="hs-identifier hs-var">codeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679370077"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">CodeSpec
-&gt; Getting [CodeDefinition] CodeSpec [CodeDefinition]
-&gt; [CodeDefinition]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting [CodeDefinition] CodeSpec [CodeDefinition]
forall c. HasOldCodeSpec c =&gt; Lens' c [CodeDefinition]
Lens' CodeSpec [CodeDefinition]
</span><a href="Language.Drasil.CodeSpec.html#constantsO"><span class="hs-identifier hs-var">constantsO</span></a></span><span>
</span><span id="line-681"></span><span>      </span><span id="local-6989586621679370215"><span class="annot"><span class="annottext">getDecl :: ConstantStructure -&gt; Structure -&gt; GenState (Maybe (MSStatement r))
</span><a href="#local-6989586621679370215"><span class="hs-identifier hs-var hs-var">getDecl</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Choices.html#Store"><span class="hs-identifier hs-type">Store</span></a></span><span> </span><span class="annot"><span class="annottext">Structure
</span><a href="Language.Drasil.Choices.html#Unbundled"><span class="hs-identifier hs-var">Unbundled</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Structure
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenState (Maybe (MSStatement r))
</span><a href="#local-6989586621679370216"><span class="hs-identifier hs-var">declVars</span></a></span><span>
</span><span id="line-682"></span><span>      </span><span class="annot"><a href="#local-6989586621679370215"><span class="hs-identifier hs-var">getDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Choices.html#Store"><span class="hs-identifier hs-type">Store</span></a></span><span> </span><span class="annot"><span class="annottext">Structure
</span><a href="Language.Drasil.Choices.html#Bundled"><span class="hs-identifier hs-var">Bundled</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Structure
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; GenState (Maybe (MSStatement r))
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;initConstsProc: Procedural renderers do not support bundled constants.&quot;</span></span><span>
</span><span id="line-683"></span><span>      </span><span class="annot"><a href="#local-6989586621679370215"><span class="hs-identifier hs-var">getDecl</span></a></span><span> </span><span class="annot"><span class="annottext">ConstantStructure
</span><a href="Language.Drasil.Choices.html#WithInputs"><span class="hs-identifier hs-var">WithInputs</span></a></span><span> </span><span class="annot"><span class="annottext">Structure
</span><a href="Language.Drasil.Choices.html#Unbundled"><span class="hs-identifier hs-var">Unbundled</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenState (Maybe (MSStatement r))
</span><a href="#local-6989586621679370216"><span class="hs-identifier hs-var">declVars</span></a></span><span>
</span><span id="line-684"></span><span>      </span><span class="annot"><a href="#local-6989586621679370215"><span class="hs-identifier hs-var">getDecl</span></a></span><span> </span><span class="annot"><span class="annottext">ConstantStructure
</span><a href="Language.Drasil.Choices.html#WithInputs"><span class="hs-identifier hs-var">WithInputs</span></a></span><span> </span><span class="annot"><span class="annottext">Structure
</span><a href="Language.Drasil.Choices.html#Bundled"><span class="hs-identifier hs-var">Bundled</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (MSStatement r) -&gt; GenState (Maybe (MSStatement r))
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe (MSStatement r)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-685"></span><span>      </span><span class="annot"><a href="#local-6989586621679370215"><span class="hs-identifier hs-var">getDecl</span></a></span><span> </span><span class="annot"><span class="annottext">ConstantStructure
</span><a href="Language.Drasil.Choices.html#Inline"><span class="hs-identifier hs-var">Inline</span></a></span><span> </span><span class="annot"><span class="annottext">Structure
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (MSStatement r) -&gt; GenState (Maybe (MSStatement r))
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe (MSStatement r)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-686"></span><span>      </span><span id="local-6989586621679370216"><span class="annot"><span class="annottext">declVars :: GenState (Maybe (MSStatement r))
</span><a href="#local-6989586621679370216"><span class="hs-identifier hs-var hs-var">declVars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-687"></span><span>        </span><span id="local-6989586621679370377"><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679370377"><span class="hs-identifier hs-var">vars</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(CodeDefinition
 -&gt; StateT DrasilState Identity (VS (r (Variable r))))
-&gt; [CodeDefinition]
-&gt; StateT DrasilState Identity [VS (r (Variable r))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeVarChunk -&gt; StateT DrasilState Identity (VS (r (Variable r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeVarChunk -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVarProc"><span class="hs-identifier hs-var">mkVarProc</span></a></span><span> </span><span class="annot"><span class="annottext">(CodeVarChunk -&gt; StateT DrasilState Identity (VS (r (Variable r))))
-&gt; (CodeDefinition -&gt; CodeVarChunk)
-&gt; CodeDefinition
-&gt; StateT DrasilState Identity (VS (r (Variable r)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CodeDefinition -&gt; CodeVarChunk
forall c.
(Quantity c, MayHaveUnit c, Concept c) =&gt;
c -&gt; CodeVarChunk
</span><a href="Language.Drasil.Chunk.CodeBase.html#quantvar"><span class="hs-identifier hs-var">quantvar</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CodeDefinition]
</span><a href="#local-6989586621679370209"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-688"></span><span>        </span><span id="local-6989586621679370378"><span class="annot"><span class="annottext">[VS (r (Value r))]
</span><a href="#local-6989586621679370378"><span class="hs-identifier hs-var">vals</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(CodeDefinition -&gt; StateT DrasilState Identity (VS (r (Value r))))
-&gt; [CodeDefinition]
-&gt; StateT DrasilState Identity [VS (r (Value r))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">(CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r))))
-&gt; (CodeDefinition -&gt; CodeExpr)
-&gt; CodeDefinition
-&gt; StateT DrasilState Identity (VS (r (Value r)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeDefinition
-&gt; Getting CodeExpr CodeDefinition CodeExpr -&gt; CodeExpr
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting CodeExpr CodeDefinition CodeExpr
forall c. DefiningCodeExpr c =&gt; Lens' c CodeExpr
Lens' CodeDefinition CodeExpr
</span><span class="hs-identifier hs-var">codeExpr</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CodeDefinition]
</span><a href="#local-6989586621679370209"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-689"></span><span>        </span><span id="local-6989586621679370379"><span class="annot"><span class="annottext">[[MSStatement r]]
</span><a href="#local-6989586621679370379"><span class="hs-identifier hs-var">logs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(VS (r (Variable r))
 -&gt; StateT DrasilState Identity [MSStatement r])
-&gt; [VS (r (Variable r))]
-&gt; StateT DrasilState Identity [[MSStatement r]]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r)) -&gt; StateT DrasilState Identity [MSStatement r]
forall (r :: * -&gt; *).
SharedProg r =&gt;
SVariable r -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Logging.html#maybeLog"><span class="hs-identifier hs-var">maybeLog</span></a></span><span> </span><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679370377"><span class="hs-identifier hs-var">vars</span></a></span><span>
</span><span id="line-690"></span><span>        </span><span class="annot"><span class="annottext">Maybe (MSStatement r) -&gt; GenState (Maybe (MSStatement r))
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (MSStatement r) -&gt; GenState (Maybe (MSStatement r)))
-&gt; Maybe (MSStatement r) -&gt; GenState (Maybe (MSStatement r))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MSStatement r -&gt; Maybe (MSStatement r)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; Maybe (MSStatement r))
-&gt; MSStatement r -&gt; Maybe (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSStatement r
forall (r :: * -&gt; *).
StatementSym r =&gt;
[MSStatement r] -&gt; MSStatement r
</span><span class="hs-identifier hs-var">multi</span></span><span> </span><span class="annot"><span class="annottext">([MSStatement r] -&gt; MSStatement r)
-&gt; [MSStatement r] -&gt; MSStatement r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-691"></span><span>          </span><span class="annot"><span class="annottext">(VS (r (Variable r)) -&gt; VS (r (Value r)) -&gt; MSStatement r)
-&gt; [VS (r (Variable r))] -&gt; [VS (r (Value r))] -&gt; [MSStatement r]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679370380"><span class="annot"><span class="annottext">VS (r (Variable r))
</span><a href="#local-6989586621679370380"><span class="hs-identifier hs-var">vr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ConstantRepr
-&gt; VS (r (Variable r))
-&gt; r (Scope r)
-&gt; VS (r (Value r))
-&gt; MSStatement r
forall {r :: * -&gt; *}.
DeclStatement r =&gt;
ConstantRepr
-&gt; VS (r (Variable r))
-&gt; r (Scope r)
-&gt; VS (r (Value r))
-&gt; MS (r (Statement r))
</span><a href="#local-6989586621679370381"><span class="hs-identifier hs-var">defFunc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; ConstantRepr
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#conRepr"><span class="hs-identifier hs-var">conRepr</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679370077"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
</span><a href="#local-6989586621679370380"><span class="hs-identifier hs-var">vr</span></a></span><span> </span><span class="annot"><span class="annottext">r (Scope r)
</span><a href="#local-6989586621679370206"><span class="hs-identifier hs-var">scp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679370377"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="annot"><span class="annottext">[VS (r (Value r))]
</span><a href="#local-6989586621679370378"><span class="hs-identifier hs-var">vals</span></a></span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; [MSStatement r] -&gt; [MSStatement r]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[[MSStatement r]] -&gt; [MSStatement r]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">[[MSStatement r]]
</span><a href="#local-6989586621679370379"><span class="hs-identifier hs-var">logs</span></a></span><span>
</span><span id="line-692"></span><span>      </span><span id="local-6989586621679370381"><span class="annot"><span class="annottext">defFunc :: ConstantRepr
-&gt; SVariable r -&gt; r (Scope r) -&gt; SValue r -&gt; MSStatement r
</span><a href="#local-6989586621679370381"><span class="hs-identifier hs-var hs-var">defFunc</span></a></span></span><span> </span><span class="annot"><span class="annottext">ConstantRepr
</span><a href="Language.Drasil.Choices.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SVariable r -&gt; r (Scope r) -&gt; SValue r -&gt; MSStatement r
forall (r :: * -&gt; *).
DeclStatement r =&gt;
SVariable r -&gt; r (Scope r) -&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">varDecDef</span></span><span>
</span><span id="line-693"></span><span>      </span><span class="annot"><a href="#local-6989586621679370381"><span class="hs-identifier hs-var">defFunc</span></a></span><span> </span><span class="annot"><span class="annottext">ConstantRepr
</span><a href="Language.Drasil.Choices.html#Const"><span class="hs-identifier hs-var">Const</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SVariable r -&gt; r (Scope r) -&gt; SValue r -&gt; MSStatement r
forall (r :: * -&gt; *).
DeclStatement r =&gt;
SVariable r -&gt; r (Scope r) -&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">constDecDef</span></span><span>
</span><span id="line-694"></span><span>  </span><span class="annot"><span class="annottext">ConstantStructure -&gt; Structure -&gt; GenState (Maybe (MSStatement r))
</span><a href="#local-6989586621679370215"><span class="hs-identifier hs-var">getDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; ConstantStructure
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#conStruct"><span class="hs-identifier hs-var">conStruct</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679370077"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; Structure
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#inStruct"><span class="hs-identifier hs-var">inStruct</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679370077"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-695"></span><span>
</span><span id="line-696"></span><span class="hs-comment">-- | Checks if a class is needed to store constants, i.e. if constants are</span><span>
</span><span id="line-697"></span><span class="hs-comment">-- mapped to the constants class in the class definition map.</span><span>
</span><span id="line-698"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#checkConstClass"><span class="hs-identifier hs-type">checkConstClass</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-699"></span><span id="checkConstClass"><span class="annot"><span class="annottext">checkConstClass :: GenState Bool
</span><a href="Language.Drasil.Code.Imperative.Modules.html#checkConstClass"><span class="hs-identifier hs-var hs-var">checkConstClass</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-700"></span><span>  </span><span id="local-6989586621679370396"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679370396"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-701"></span><span>  </span><span id="local-6989586621679370397"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679370397"><span class="hs-identifier hs-var">cName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">InternalConcept -&gt; GenState String
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#genICName"><span class="hs-identifier hs-var">genICName</span></a></span><span> </span><span class="annot"><span class="annottext">InternalConcept
</span><a href="Language.Drasil.Choices.html#Constants"><span class="hs-identifier hs-var">Constants</span></a></span><span>
</span><span id="line-702"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679370400"><span class="annot"><span class="annottext">cs :: [CodeDefinition]
</span><a href="#local-6989586621679370400"><span class="hs-identifier hs-var hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; CodeSpec
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#codeSpec"><span class="hs-identifier hs-var">codeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679370396"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">CodeSpec
-&gt; Getting [CodeDefinition] CodeSpec [CodeDefinition]
-&gt; [CodeDefinition]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting [CodeDefinition] CodeSpec [CodeDefinition]
forall c. HasOldCodeSpec c =&gt; Lens' c [CodeDefinition]
Lens' CodeSpec [CodeDefinition]
</span><a href="Language.Drasil.CodeSpec.html#constantsO"><span class="hs-identifier hs-var">constantsO</span></a></span><span>
</span><span id="line-703"></span><span>      </span><span class="annot"><a href="#local-6989586621679370401"><span class="hs-identifier hs-type">checkClass</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Chunk.CodeDefinition.html#CodeDefinition"><span class="hs-identifier hs-type">CodeDefinition</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-704"></span><span>      </span><span id="local-6989586621679370401"><span class="annot"><span class="annottext">checkClass :: [CodeDefinition] -&gt; GenState Bool
</span><a href="#local-6989586621679370401"><span class="hs-identifier hs-var hs-var">checkClass</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; GenState Bool
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-705"></span><span>      </span><span class="annot"><a href="#local-6989586621679370401"><span class="hs-identifier hs-var">checkClass</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeDefinition]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; GenState Bool
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-706"></span><span>  </span><span class="annot"><span class="annottext">[CodeDefinition] -&gt; GenState Bool
</span><a href="#local-6989586621679370401"><span class="hs-identifier hs-var">checkClass</span></a></span><span> </span><span class="annot"><span class="annottext">([CodeDefinition] -&gt; GenState Bool)
-&gt; [CodeDefinition] -&gt; GenState Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(CodeDefinition -&gt; Bool) -&gt; [CodeDefinition] -&gt; [CodeDefinition]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(String -&gt; Map String String -&gt; Bool)
-&gt; Map String String -&gt; String -&gt; Bool
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Map String String -&gt; Bool
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Bool
</span><span class="hs-identifier hs-var">member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(String -&gt; Bool) -&gt; Map String String -&gt; Map String String
forall a k. (a -&gt; Bool) -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679370397"><span class="hs-identifier hs-var">cName</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; Map String String
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#clsMap"><span class="hs-identifier hs-var">clsMap</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679370396"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-707"></span><span>    </span><span class="annot"><span class="annottext">(String -&gt; Bool)
-&gt; (CodeDefinition -&gt; String) -&gt; CodeDefinition -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CodeDefinition -&gt; String
forall c. CodeIdea c =&gt; c -&gt; String
</span><span class="hs-identifier hs-var">codeName</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CodeDefinition]
</span><a href="#local-6989586621679370400"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-708"></span><span>
</span><span id="line-709"></span><span class="annot"><span class="hs-comment">-- | Generates a single module containing all input-related components.</span></span><span>
</span><span id="line-710"></span><span id="local-6989586621679363480"><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genInputModProc"><span class="hs-identifier hs-type">genInputModProc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ProcProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679363480"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Proc.SFile</span></span><span> </span><span class="annot"><a href="#local-6989586621679363480"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-711"></span><span id="genInputModProc"><span class="annot"><span class="annottext">genInputModProc :: forall (r :: * -&gt; *). ProcProg r =&gt; GenState [SFile r]
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genInputModProc"><span class="hs-identifier hs-var hs-var">genInputModProc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-712"></span><span>  </span><span id="local-6989586621679370407"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679370407"><span class="hs-identifier hs-var">ipDesc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenState [String] -&gt; GenState String
</span><a href="Language.Drasil.Code.Imperative.Descriptions.html#modDesc"><span class="hs-identifier hs-var">modDesc</span></a></span><span> </span><span class="annot"><span class="annottext">GenState [String]
</span><a href="Language.Drasil.Code.Imperative.Descriptions.html#inputParametersDesc"><span class="hs-identifier hs-var">inputParametersDesc</span></a></span><span>
</span><span id="line-713"></span><span>  </span><span id="local-6989586621679370408"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679370408"><span class="hs-identifier hs-var">cname</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">InternalConcept -&gt; GenState String
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#genICName"><span class="hs-identifier hs-var">genICName</span></a></span><span> </span><span class="annot"><span class="annottext">InternalConcept
</span><a href="Language.Drasil.Choices.html#InputParameters"><span class="hs-identifier hs-var">InputParameters</span></a></span><span>
</span><span id="line-714"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679363482"><span class="annot"><a href="#local-6989586621679370409"><span class="hs-identifier hs-type">genMod</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ProcProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679363482"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-715"></span><span>        </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Proc.SFile</span></span><span> </span><span class="annot"><a href="#local-6989586621679363482"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-716"></span><span>      </span><span id="local-6989586621679370409"><span class="annot"><span class="annottext">genMod :: forall (r :: * -&gt; *). ProcProg r =&gt; Bool -&gt; GenState (SFile r)
</span><a href="#local-6989586621679370409"><span class="hs-identifier hs-var hs-var">genMod</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; String
-&gt; [GenState (Maybe (SMethod r))]
-&gt; StateT
     DrasilState Identity (StateT FileState Identity (r (File r)))
forall (r :: * -&gt; *).
ProcProg r =&gt;
String
-&gt; String -&gt; [GenState (Maybe (SMethod r))] -&gt; GenState (SFile r)
</span><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html#genModuleProc"><span class="hs-identifier hs-var">genModuleProc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679370408"><span class="hs-identifier hs-var">cname</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679370407"><span class="hs-identifier hs-var">ipDesc</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">VisibilityTag -&gt; GenState (Maybe (SMethod r))
forall (r :: * -&gt; *).
SharedProg r =&gt;
VisibilityTag -&gt; GenState (Maybe (SMethod r))
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genInputFormatProc"><span class="hs-identifier hs-var">genInputFormatProc</span></a></span><span> </span><span class="annot"><span class="annottext">VisibilityTag
</span><span class="hs-identifier hs-var">Pub</span></span><span class="hs-special">,</span><span>
</span><span id="line-717"></span><span>        </span><span class="annot"><span class="annottext">VisibilityTag -&gt; GenState (Maybe (SMethod r))
forall (r :: * -&gt; *).
SharedProg r =&gt;
VisibilityTag -&gt; GenState (Maybe (SMethod r))
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genInputDerivedProc"><span class="hs-identifier hs-var">genInputDerivedProc</span></a></span><span> </span><span class="annot"><span class="annottext">VisibilityTag
</span><span class="hs-identifier hs-var">Pub</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VisibilityTag -&gt; GenState (Maybe (SMethod r))
forall (r :: * -&gt; *).
SharedProg r =&gt;
VisibilityTag -&gt; GenState (Maybe (SMethod r))
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genInputConstraintsProc"><span class="hs-identifier hs-var">genInputConstraintsProc</span></a></span><span> </span><span class="annot"><span class="annottext">VisibilityTag
</span><span class="hs-identifier hs-var">Pub</span></span><span class="hs-special">]</span><span>
</span><span id="line-718"></span><span>      </span><span class="annot"><a href="#local-6989586621679370409"><span class="hs-identifier hs-var">genMod</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; StateT
     DrasilState Identity (StateT FileState Identity (r (File r)))
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;genInputModProc: Procedural renderers do not support bundled inputs&quot;</span></span><span>
</span><span id="line-719"></span><span>  </span><span id="local-6989586621679370418"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679370418"><span class="hs-identifier hs-var">ic</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenState Bool
</span><a href="Language.Drasil.Code.Imperative.Modules.html#checkInputClass"><span class="hs-identifier hs-var">checkInputClass</span></a></span><span>
</span><span id="line-720"></span><span>  </span><span class="annot"><span class="annottext">State DrasilState (SFile r) -&gt; GenState [SFile r]
forall a b. State a b -&gt; State a [b]
</span><a href="Language.Drasil.Code.Imperative.Helpers.html#liftS"><span class="hs-identifier hs-var">liftS</span></a></span><span> </span><span class="annot"><span class="annottext">(State DrasilState (SFile r) -&gt; GenState [SFile r])
-&gt; State DrasilState (SFile r) -&gt; GenState [SFile r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; State DrasilState (SFile r)
forall (r :: * -&gt; *). ProcProg r =&gt; Bool -&gt; GenState (SFile r)
</span><a href="#local-6989586621679370409"><span class="hs-identifier hs-var">genMod</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679370418"><span class="hs-identifier hs-var">ic</span></a></span><span>
</span><span id="line-721"></span><span>
</span><span id="line-722"></span><span class="hs-comment">-- | Returns 'False' if no inputs or constants are mapped to InputParameters in</span><span>
</span><span id="line-723"></span><span class="hs-comment">-- the class definition map.</span><span>
</span><span id="line-724"></span><span class="hs-comment">-- Returns 'True' If any inputs or constants are defined in InputParameters</span><span>
</span><span id="line-725"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#checkInputClass"><span class="hs-identifier hs-type">checkInputClass</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-726"></span><span id="checkInputClass"><span class="annot"><span class="annottext">checkInputClass :: GenState Bool
</span><a href="Language.Drasil.Code.Imperative.Modules.html#checkInputClass"><span class="hs-identifier hs-var hs-var">checkInputClass</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-727"></span><span>  </span><span id="local-6989586621679370420"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679370420"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-728"></span><span>  </span><span id="local-6989586621679370421"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679370421"><span class="hs-identifier hs-var">cname</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">InternalConcept -&gt; GenState String
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#genICName"><span class="hs-identifier hs-var">genICName</span></a></span><span> </span><span class="annot"><span class="annottext">InternalConcept
</span><a href="Language.Drasil.Choices.html#InputParameters"><span class="hs-identifier hs-var">InputParameters</span></a></span><span>
</span><span id="line-729"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679370424"><span class="annot"><span class="annottext">ins :: [CodeVarChunk]
</span><a href="#local-6989586621679370424"><span class="hs-identifier hs-var hs-var">ins</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; CodeSpec
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#codeSpec"><span class="hs-identifier hs-var">codeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679370420"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">CodeSpec
-&gt; Getting [CodeVarChunk] CodeSpec [CodeVarChunk] -&gt; [CodeVarChunk]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting [CodeVarChunk] CodeSpec [CodeVarChunk]
forall c. HasOldCodeSpec c =&gt; Lens' c [CodeVarChunk]
Lens' CodeSpec [CodeVarChunk]
</span><a href="Language.Drasil.CodeSpec.html#inputsO"><span class="hs-identifier hs-var">inputsO</span></a></span><span>
</span><span id="line-730"></span><span>      </span><span id="local-6989586621679370427"><span class="annot"><span class="annottext">cs :: [CodeDefinition]
</span><a href="#local-6989586621679370427"><span class="hs-identifier hs-var hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; CodeSpec
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#codeSpec"><span class="hs-identifier hs-var">codeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679370420"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">CodeSpec
-&gt; Getting [CodeDefinition] CodeSpec [CodeDefinition]
-&gt; [CodeDefinition]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting [CodeDefinition] CodeSpec [CodeDefinition]
forall c. HasOldCodeSpec c =&gt; Lens' c [CodeDefinition]
Lens' CodeSpec [CodeDefinition]
</span><a href="Language.Drasil.CodeSpec.html#constantsO"><span class="hs-identifier hs-var">constantsO</span></a></span><span>
</span><span id="line-731"></span><span>      </span><span id="local-6989586621679370428"><span class="annot"><a href="#local-6989586621679370429"><span class="hs-identifier hs-type">filt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CodeIdea</span></span><span> </span><span class="annot"><a href="#local-6989586621679370428"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679370428"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679370428"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-732"></span><span>      </span><span id="local-6989586621679370429"><span class="annot"><span class="annottext">filt :: forall c. CodeIdea c =&gt; [c] -&gt; [c]
</span><a href="#local-6989586621679370429"><span class="hs-identifier hs-var hs-var">filt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(c -&gt; Bool) -&gt; [c] -&gt; [c]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Maybe String
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679370421"><span class="hs-identifier hs-var">cname</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe String -&gt; Maybe String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe String -&gt; Bool) -&gt; (c -&gt; Maybe String) -&gt; c -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Map String String -&gt; Maybe String)
-&gt; Map String String -&gt; String -&gt; Maybe String
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Map String String -&gt; Maybe String
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; Map String String
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#clsMap"><span class="hs-identifier hs-var">clsMap</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679370420"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(String -&gt; Maybe String) -&gt; (c -&gt; String) -&gt; c -&gt; Maybe String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">c -&gt; String
forall c. CodeIdea c =&gt; c -&gt; String
</span><span class="hs-identifier hs-var">codeName</span></span><span class="hs-special">)</span><span>
</span><span id="line-733"></span><span>      </span><span class="annot"><a href="#local-6989586621679370434"><span class="hs-identifier hs-type">checkClass</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">CodeVarChunk</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Chunk.CodeDefinition.html#CodeDefinition"><span class="hs-identifier hs-type">CodeDefinition</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-734"></span><span>      </span><span id="local-6989586621679370434"><span class="annot"><span class="annottext">checkClass :: [CodeVarChunk] -&gt; [CodeDefinition] -&gt; GenState Bool
</span><a href="#local-6989586621679370434"><span class="hs-identifier hs-var hs-var">checkClass</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; GenState Bool
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-735"></span><span>      </span><span class="annot"><a href="#local-6989586621679370434"><span class="hs-identifier hs-var">checkClass</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeVarChunk]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[CodeDefinition]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; GenState Bool
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-736"></span><span>  </span><span class="annot"><span class="annottext">[CodeVarChunk] -&gt; [CodeDefinition] -&gt; GenState Bool
</span><a href="#local-6989586621679370434"><span class="hs-identifier hs-var">checkClass</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[CodeVarChunk] -&gt; [CodeVarChunk]
forall c. CodeIdea c =&gt; [c] -&gt; [c]
</span><a href="#local-6989586621679370429"><span class="hs-identifier hs-var">filt</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeVarChunk]
</span><a href="#local-6989586621679370424"><span class="hs-identifier hs-var">ins</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[CodeDefinition] -&gt; [CodeDefinition]
forall c. CodeIdea c =&gt; [c] -&gt; [c]
</span><a href="#local-6989586621679370429"><span class="hs-identifier hs-var">filt</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeDefinition]
</span><a href="#local-6989586621679370427"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-737"></span><span>
</span><span id="line-738"></span><span class="hs-comment">-- | If there are no inputs, return nothing.</span><span>
</span><span id="line-739"></span><span class="hs-comment">-- If there are inputs and they are not exported by any module, then they are</span><span>
</span><span id="line-740"></span><span class="hs-comment">-- 'Unbundled' and are declared individually using 'varDec'.</span><span>
</span><span id="line-741"></span><span class="hs-comment">-- If there are inputs and they are exported by a module, they are 'Bundled' in</span><span>
</span><span id="line-742"></span><span class="hs-comment">-- the InputParameters class, so 'inParams' should be declared and constructed,</span><span>
</span><span id="line-743"></span><span class="hs-comment">-- using 'objDecNew' if the inputs are exported by the current module, and</span><span>
</span><span id="line-744"></span><span class="hs-comment">-- 'extObjDecNew' if they are exported by a different module.</span><span>
</span><span id="line-745"></span><span id="local-6989586621679370435"><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#getInputDeclProc"><span class="hs-identifier hs-type">getInputDeclProc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679370435"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MSStatement</span></span><span> </span><span class="annot"><a href="#local-6989586621679370435"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-746"></span><span id="getInputDeclProc"><span class="annot"><span class="annottext">getInputDeclProc :: forall (r :: * -&gt; *).
SharedProg r =&gt;
GenState (Maybe (MSStatement r))
</span><a href="Language.Drasil.Code.Imperative.Modules.html#getInputDeclProc"><span class="hs-identifier hs-var hs-var">getInputDeclProc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-747"></span><span>  </span><span id="local-6989586621679370481"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679370481"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-748"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679370610"><span class="annot"><span class="annottext">scp :: r (Scope r)
</span><a href="#local-6989586621679370610"><span class="hs-identifier hs-var hs-var">scp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScopeType -&gt; r (Scope r)
forall (r :: * -&gt; *). SharedProg r =&gt; ScopeType -&gt; r (Scope r)
</span><a href="Language.Drasil.Code.Imperative.Helpers.html#convScope"><span class="hs-identifier hs-var">convScope</span></a></span><span> </span><span class="annot"><span class="annottext">(ScopeType -&gt; r (Scope r)) -&gt; ScopeType -&gt; r (Scope r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; ScopeType
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#currentScope"><span class="hs-identifier hs-var">currentScope</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679370481"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-749"></span><span>      </span><span id="local-6989586621679370757"><span class="annot"><span class="annottext">getDecl :: ([a], [CodeVarChunk]) -&gt; GenState (Maybe (MSStatement r))
</span><a href="#local-6989586621679370757"><span class="hs-identifier hs-var hs-var">getDecl</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (MSStatement r) -&gt; GenState (Maybe (MSStatement r))
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe (MSStatement r)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-750"></span><span>      </span><span class="annot"><a href="#local-6989586621679370757"><span class="hs-identifier hs-var">getDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span id="local-6989586621679370758"><span class="annot"><span class="annottext">[CodeVarChunk]
</span><a href="#local-6989586621679370758"><span class="hs-identifier hs-var">ins</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-751"></span><span>        </span><span id="local-6989586621679370759"><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679370759"><span class="hs-identifier hs-var">vars</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(CodeVarChunk -&gt; StateT DrasilState Identity (VS (r (Variable r))))
-&gt; [CodeVarChunk]
-&gt; StateT DrasilState Identity [VS (r (Variable r))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">CodeVarChunk -&gt; StateT DrasilState Identity (VS (r (Variable r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeVarChunk -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVarProc"><span class="hs-identifier hs-var">mkVarProc</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeVarChunk]
</span><a href="#local-6989586621679370758"><span class="hs-identifier hs-var">ins</span></a></span><span>
</span><span id="line-752"></span><span>        </span><span class="annot"><span class="annottext">Maybe (MSStatement r) -&gt; GenState (Maybe (MSStatement r))
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (MSStatement r) -&gt; GenState (Maybe (MSStatement r)))
-&gt; Maybe (MSStatement r) -&gt; GenState (Maybe (MSStatement r))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MSStatement r -&gt; Maybe (MSStatement r)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; Maybe (MSStatement r))
-&gt; MSStatement r -&gt; Maybe (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSStatement r
forall (r :: * -&gt; *).
StatementSym r =&gt;
[MSStatement r] -&gt; MSStatement r
</span><span class="hs-identifier hs-var">multi</span></span><span> </span><span class="annot"><span class="annottext">([MSStatement r] -&gt; MSStatement r)
-&gt; [MSStatement r] -&gt; MSStatement r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(VS (r (Variable r)) -&gt; MSStatement r)
-&gt; [VS (r (Variable r))] -&gt; [MSStatement r]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VS (r (Variable r)) -&gt; r (Scope r) -&gt; MSStatement r
forall (r :: * -&gt; *).
DeclStatement r =&gt;
SVariable r -&gt; r (Scope r) -&gt; MSStatement r
</span><span class="hs-operator hs-var">`varDec`</span></span><span> </span><span class="annot"><span class="annottext">r (Scope r)
</span><a href="#local-6989586621679370610"><span class="hs-identifier hs-var">scp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679370759"><span class="hs-identifier hs-var">vars</span></a></span><span>
</span><span id="line-753"></span><span>      </span><span class="annot"><a href="#local-6989586621679370757"><span class="hs-identifier hs-var">getDecl</span></a></span><span> </span><span class="annot"><span class="annottext">([a], [CodeVarChunk])
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; GenState (Maybe (MSStatement r))
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;getInputDeclProc: Procedural renderers do not support bundled inputs&quot;</span></span><span>
</span><span id="line-754"></span><span>  </span><span class="annot"><span class="annottext">([CodeVarChunk], [CodeVarChunk])
-&gt; GenState (Maybe (MSStatement r))
forall {a}.
([a], [CodeVarChunk]) -&gt; GenState (Maybe (MSStatement r))
</span><a href="#local-6989586621679370757"><span class="hs-identifier hs-var">getDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CodeVarChunk -&gt; Bool)
-&gt; [CodeVarChunk] -&gt; ([CodeVarChunk], [CodeVarChunk])
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">partition</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(String -&gt; Map String String -&gt; Bool)
-&gt; Map String String -&gt; String -&gt; Bool
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Map String String -&gt; Bool
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Bool
</span><span class="hs-identifier hs-var">member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; Map String String
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#eMap"><span class="hs-identifier hs-var">eMap</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679370481"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(String -&gt; Bool)
-&gt; (CodeVarChunk -&gt; String) -&gt; CodeVarChunk -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CodeVarChunk -&gt; String
forall c. CodeIdea c =&gt; c -&gt; String
</span><span class="hs-identifier hs-var">codeName</span></span><span class="hs-special">)</span><span>
</span><span id="line-755"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; CodeSpec
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#codeSpec"><span class="hs-identifier hs-var">codeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679370481"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">CodeSpec
-&gt; Getting [CodeVarChunk] CodeSpec [CodeVarChunk] -&gt; [CodeVarChunk]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting [CodeVarChunk] CodeSpec [CodeVarChunk]
forall c. HasOldCodeSpec c =&gt; Lens' c [CodeVarChunk]
Lens' CodeSpec [CodeVarChunk]
</span><a href="Language.Drasil.CodeSpec.html#inputsO"><span class="hs-identifier hs-var">inputsO</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-756"></span><span>
</span><span id="line-757"></span><span class="annot"><span class="hs-comment">-- | Generates a module containing calculation functions.</span></span><span>
</span><span id="line-758"></span><span id="local-6989586621679370760"><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genCalcModProc"><span class="hs-identifier hs-type">genCalcModProc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ProcProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679370760"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Proc.SFile</span></span><span> </span><span class="annot"><a href="#local-6989586621679370760"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-759"></span><span id="genCalcModProc"><span class="annot"><span class="annottext">genCalcModProc :: forall (r :: * -&gt; *). ProcProg r =&gt; GenState (SFile r)
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genCalcModProc"><span class="hs-identifier hs-var hs-var">genCalcModProc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-760"></span><span>  </span><span id="local-6989586621679370774"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679370774"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-761"></span><span>  </span><span id="local-6989586621679370775"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679370775"><span class="hs-identifier hs-var">cName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">InternalConcept -&gt; GenState String
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#genICName"><span class="hs-identifier hs-var">genICName</span></a></span><span> </span><span class="annot"><span class="annottext">InternalConcept
</span><a href="Language.Drasil.Choices.html#Calculations"><span class="hs-identifier hs-var">Calculations</span></a></span><span>
</span><span id="line-762"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679370776"><span class="annot"><span class="annottext">elmap :: ExtLibMap
</span><a href="#local-6989586621679370776"><span class="hs-identifier hs-var hs-var">elmap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; ExtLibMap
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#extLibMap"><span class="hs-identifier hs-var">extLibMap</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679370774"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-763"></span><span>  </span><span class="annot"><span class="annottext">String
-&gt; String
-&gt; [String]
-&gt; [GenState (Maybe (SMethod r))]
-&gt; GenState (SFile r)
forall (r :: * -&gt; *).
ProcProg r =&gt;
String
-&gt; String
-&gt; [String]
-&gt; [GenState (Maybe (SMethod r))]
-&gt; GenState (SFile r)
</span><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html#genModuleWithImportsProc"><span class="hs-identifier hs-var">genModuleWithImportsProc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679370775"><span class="hs-identifier hs-var">cName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Language.Drasil.Code.Imperative.Descriptions.html#calcModDesc"><span class="hs-identifier hs-var">calcModDesc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ExtLibState -&gt; [String]) -&gt; [ExtLibState] -&gt; [String]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExtLibState -&gt; Getting [String] ExtLibState [String] -&gt; [String]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting [String] ExtLibState [String]
Lens' ExtLibState [String]
</span><a href="Language.Drasil.Code.ExtLibImport.html#imports"><span class="hs-identifier hs-var">imports</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([ExtLibState] -&gt; [String]) -&gt; [ExtLibState] -&gt; [String]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-764"></span><span>    </span><span class="annot"><span class="annottext">ExtLibMap -&gt; [ExtLibState]
forall k a. Map k a -&gt; [a]
</span><span class="hs-identifier hs-var">elems</span></span><span> </span><span class="annot"><span class="annottext">ExtLibMap
</span><a href="#local-6989586621679370776"><span class="hs-identifier hs-var">elmap</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CodeDefinition -&gt; GenState (Maybe (SMethod r)))
-&gt; [CodeDefinition] -&gt; [GenState (Maybe (SMethod r))]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(SMethod r -&gt; Maybe (SMethod r))
-&gt; StateT DrasilState Identity (SMethod r)
-&gt; GenState (Maybe (SMethod r))
forall a b.
(a -&gt; b)
-&gt; StateT DrasilState Identity a -&gt; StateT DrasilState Identity b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">SMethod r -&gt; Maybe (SMethod r)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(StateT DrasilState Identity (SMethod r)
 -&gt; GenState (Maybe (SMethod r)))
-&gt; (CodeDefinition -&gt; StateT DrasilState Identity (SMethod r))
-&gt; CodeDefinition
-&gt; GenState (Maybe (SMethod r))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CodeDefinition -&gt; StateT DrasilState Identity (SMethod r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeDefinition -&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genCalcFuncProc"><span class="hs-identifier hs-var">genCalcFuncProc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; CodeSpec
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#codeSpec"><span class="hs-identifier hs-var">codeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679370774"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">CodeSpec
-&gt; Getting [CodeDefinition] CodeSpec [CodeDefinition]
-&gt; [CodeDefinition]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting [CodeDefinition] CodeSpec [CodeDefinition]
forall c. HasOldCodeSpec c =&gt; Lens' c [CodeDefinition]
Lens' CodeSpec [CodeDefinition]
</span><a href="Language.Drasil.CodeSpec.html#execOrderO"><span class="hs-identifier hs-var">execOrderO</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-765"></span><span>
</span><span id="line-766"></span><span class="hs-comment">-- | Generates a calculation function corresponding to the 'CodeDefinition'.</span><span>
</span><span id="line-767"></span><span class="hs-comment">-- For solving ODEs, the 'ExtLibState' containing the information needed to</span><span>
</span><span id="line-768"></span><span class="hs-comment">-- generate code is found by looking it up in the external library map.</span><span>
</span><span id="line-769"></span><span id="local-6989586621679363490"><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genCalcFuncProc"><span class="hs-identifier hs-type">genCalcFuncProc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679363490"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Chunk.CodeDefinition.html#CodeDefinition"><span class="hs-identifier hs-type">CodeDefinition</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-770"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679363490"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-771"></span><span id="genCalcFuncProc"><span class="annot"><span class="annottext">genCalcFuncProc :: forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeDefinition -&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genCalcFuncProc"><span class="hs-identifier hs-var hs-var">genCalcFuncProc</span></a></span></span><span> </span><span id="local-6989586621679370834"><span class="annot"><span class="annottext">CodeDefinition
</span><a href="#local-6989586621679370834"><span class="hs-identifier hs-var">cdef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-772"></span><span>  </span><span id="local-6989586621679370835"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679370835"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-773"></span><span>  </span><span class="annot"><span class="annottext">(DrasilState -&gt; DrasilState) -&gt; StateT DrasilState Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679370836"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679370836"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679370836"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#currentScope"><span class="hs-identifier hs-var">currentScope</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#Local"><span class="hs-identifier hs-type">Local</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-774"></span><span>  </span><span id="local-6989586621679370837"><span class="annot"><span class="annottext">[CodeVarChunk]
</span><a href="#local-6989586621679370837"><span class="hs-identifier hs-var">parms</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeDefinition -&gt; GenState [CodeVarChunk]
</span><a href="Language.Drasil.Code.Imperative.Parameters.html#getCalcParams"><span class="hs-identifier hs-var">getCalcParams</span></a></span><span> </span><span class="annot"><span class="annottext">CodeDefinition
</span><a href="#local-6989586621679370834"><span class="hs-identifier hs-var">cdef</span></a></span><span>
</span><span id="line-775"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679370839"><span class="annot"><span class="annottext">nm :: String
</span><a href="#local-6989586621679370839"><span class="hs-identifier hs-var hs-var">nm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CodeDefinition -&gt; String
forall c. CodeIdea c =&gt; c -&gt; String
</span><span class="hs-identifier hs-var">codeName</span></span><span> </span><span class="annot"><span class="annottext">CodeDefinition
</span><a href="#local-6989586621679370834"><span class="hs-identifier hs-var">cdef</span></a></span><span>
</span><span id="line-776"></span><span>  </span><span id="local-6989586621679370840"><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679370840"><span class="hs-identifier hs-var">tp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeDefinition -&gt; StateT DrasilState Identity CodeType
forall c. HasSpace c =&gt; c -&gt; StateT DrasilState Identity CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#codeType"><span class="hs-identifier hs-var">codeType</span></a></span><span> </span><span class="annot"><span class="annottext">CodeDefinition
</span><a href="#local-6989586621679370834"><span class="hs-identifier hs-var">cdef</span></a></span><span>
</span><span id="line-777"></span><span>  </span><span id="local-6989586621679370841"><span class="annot"><span class="annottext">VS (r (Variable r))
</span><a href="#local-6989586621679370841"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeVarChunk -&gt; StateT DrasilState Identity (VS (r (Variable r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeVarChunk -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVarProc"><span class="hs-identifier hs-var">mkVarProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeDefinition -&gt; CodeVarChunk
forall c.
(Quantity c, MayHaveUnit c, Concept c) =&gt;
c -&gt; CodeVarChunk
</span><a href="Language.Drasil.Chunk.CodeBase.html#quantvar"><span class="hs-identifier hs-var">quantvar</span></a></span><span> </span><span class="annot"><span class="annottext">CodeDefinition
</span><a href="#local-6989586621679370834"><span class="hs-identifier hs-var">cdef</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-778"></span><span>  </span><span id="local-6989586621679370842"><span class="annot"><span class="annottext">[MS (r (Block r))]
</span><a href="#local-6989586621679370842"><span class="hs-identifier hs-var">blcks</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CodeDefinition
</span><a href="#local-6989586621679370834"><span class="hs-identifier hs-var">cdef</span></a></span><span> </span><span class="annot"><span class="annottext">CodeDefinition
-&gt; Getting DefinitionType CodeDefinition DefinitionType
-&gt; DefinitionType
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting DefinitionType CodeDefinition DefinitionType
Lens' CodeDefinition DefinitionType
</span><a href="Language.Drasil.Chunk.CodeDefinition.html#defType"><span class="hs-identifier hs-var">defType</span></a></span><span>
</span><span id="line-779"></span><span>            </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="annottext">DefinitionType
</span><a href="Language.Drasil.Chunk.CodeDefinition.html#Definition"><span class="hs-identifier hs-var">Definition</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">State DrasilState (MS (r (Block r)))
-&gt; StateT DrasilState Identity [MS (r (Block r))]
forall a b. State a b -&gt; State a [b]
</span><a href="Language.Drasil.Code.Imperative.Helpers.html#liftS"><span class="hs-identifier hs-var">liftS</span></a></span><span> </span><span class="annot"><span class="annottext">(State DrasilState (MS (r (Block r)))
 -&gt; StateT DrasilState Identity [MS (r (Block r))])
-&gt; State DrasilState (MS (r (Block r)))
-&gt; StateT DrasilState Identity [MS (r (Block r))]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CalcType
-&gt; CodeDefinition
-&gt; CodeExpr
-&gt; State DrasilState (MS (r (Block r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
CalcType -&gt; CodeDefinition -&gt; CodeExpr -&gt; GenState (MSBlock r)
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genCalcBlockProc"><span class="hs-identifier hs-var">genCalcBlockProc</span></a></span><span> </span><span class="annot"><span class="annottext">CalcType
</span><a href="Language.Drasil.Code.Imperative.Modules.html#CalcReturn"><span class="hs-identifier hs-var">CalcReturn</span></a></span><span> </span><span class="annot"><span class="annottext">CodeDefinition
</span><a href="#local-6989586621679370834"><span class="hs-identifier hs-var">cdef</span></a></span><span>
</span><span id="line-780"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeDefinition
</span><a href="#local-6989586621679370834"><span class="hs-identifier hs-var">cdef</span></a></span><span> </span><span class="annot"><span class="annottext">CodeDefinition
-&gt; Getting CodeExpr CodeDefinition CodeExpr -&gt; CodeExpr
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting CodeExpr CodeDefinition CodeExpr
forall c. DefiningCodeExpr c =&gt; Lens' c CodeExpr
Lens' CodeDefinition CodeExpr
</span><span class="hs-identifier hs-var">codeExpr</span></span><span class="hs-special">)</span><span>
</span><span id="line-781"></span><span>               </span><span class="annot"><span class="annottext">DefinitionType
</span><a href="Language.Drasil.Chunk.CodeDefinition.html#ODE"><span class="hs-identifier hs-var">ODE</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity [MS (r (Block r))]
-&gt; (ExtLibState -&gt; StateT DrasilState Identity [MS (r (Block r))])
-&gt; Maybe ExtLibState
-&gt; StateT DrasilState Identity [MS (r (Block r))]
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; StateT DrasilState Identity [MS (r (Block r))]
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; StateT DrasilState Identity [MS (r (Block r))])
-&gt; String -&gt; StateT DrasilState Identity [MS (r (Block r))]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679370839"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; missing from ExtLibMap&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-782"></span><span>                 </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679370844"><span class="annot"><span class="annottext">ExtLibState
</span><a href="#local-6989586621679370844"><span class="hs-identifier hs-var">el</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-783"></span><span>                   </span><span id="local-6989586621679370845"><span class="annot"><span class="annottext">[MS (r (Statement r))]
</span><a href="#local-6989586621679370845"><span class="hs-identifier hs-var">defStmts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FuncStmt -&gt; StateT DrasilState Identity (MS (r (Statement r))))
-&gt; [FuncStmt] -&gt; StateT DrasilState Identity [MS (r (Statement r))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">FuncStmt -&gt; StateT DrasilState Identity (MS (r (Statement r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
FuncStmt -&gt; GenState (MSStatement r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convStmtProc"><span class="hs-identifier hs-var">convStmtProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExtLibState
</span><a href="#local-6989586621679370844"><span class="hs-identifier hs-var">el</span></a></span><span> </span><span class="annot"><span class="annottext">ExtLibState
-&gt; Getting [FuncStmt] ExtLibState [FuncStmt] -&gt; [FuncStmt]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting [FuncStmt] ExtLibState [FuncStmt]
Lens' ExtLibState [FuncStmt]
</span><a href="Language.Drasil.Code.ExtLibImport.html#defs"><span class="hs-identifier hs-var">defs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-784"></span><span>                   </span><span id="local-6989586621679370846"><span class="annot"><span class="annottext">[MS (r (Statement r))]
</span><a href="#local-6989586621679370846"><span class="hs-identifier hs-var">stepStmts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FuncStmt -&gt; StateT DrasilState Identity (MS (r (Statement r))))
-&gt; [FuncStmt] -&gt; StateT DrasilState Identity [MS (r (Statement r))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">FuncStmt -&gt; StateT DrasilState Identity (MS (r (Statement r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
FuncStmt -&gt; GenState (MSStatement r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convStmtProc"><span class="hs-identifier hs-var">convStmtProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExtLibState
</span><a href="#local-6989586621679370844"><span class="hs-identifier hs-var">el</span></a></span><span> </span><span class="annot"><span class="annottext">ExtLibState
-&gt; Getting [FuncStmt] ExtLibState [FuncStmt] -&gt; [FuncStmt]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting [FuncStmt] ExtLibState [FuncStmt]
Lens' ExtLibState [FuncStmt]
</span><a href="Language.Drasil.Code.ExtLibImport.html#steps"><span class="hs-identifier hs-var">steps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-785"></span><span>                   </span><span class="annot"><span class="annottext">[MS (r (Block r))]
-&gt; StateT DrasilState Identity [MS (r (Block r))]
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[MS (r (Statement r))] -&gt; MS (r (Block r))
forall (r :: * -&gt; *). BlockSym r =&gt; [MSStatement r] -&gt; MSBlock r
</span><span class="hs-identifier hs-var">block</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VS (r (Variable r)) -&gt; r (Scope r) -&gt; MS (r (Statement r))
forall (r :: * -&gt; *).
DeclStatement r =&gt;
SVariable r -&gt; r (Scope r) -&gt; MSStatement r
</span><span class="hs-identifier hs-var">varDec</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
</span><a href="#local-6989586621679370841"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">r (Scope r)
forall (r :: * -&gt; *). ScopeSym r =&gt; r (Scope r)
</span><span class="hs-identifier hs-var">local</span></span><span> </span><span class="annot"><span class="annottext">MS (r (Statement r))
-&gt; [MS (r (Statement r))] -&gt; [MS (r (Statement r))]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[MS (r (Statement r))]
</span><a href="#local-6989586621679370845"><span class="hs-identifier hs-var">defStmts</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-786"></span><span>                     </span><span class="annot"><span class="annottext">[MS (r (Statement r))] -&gt; MS (r (Block r))
forall (r :: * -&gt; *). BlockSym r =&gt; [MSStatement r] -&gt; MSBlock r
</span><span class="hs-identifier hs-var">block</span></span><span> </span><span class="annot"><span class="annottext">[MS (r (Statement r))]
</span><a href="#local-6989586621679370846"><span class="hs-identifier hs-var">stepStmts</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-787"></span><span>                     </span><span class="annot"><span class="annottext">[MS (r (Statement r))] -&gt; MS (r (Block r))
forall (r :: * -&gt; *). BlockSym r =&gt; [MSStatement r] -&gt; MSBlock r
</span><span class="hs-identifier hs-var">block</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SValue r -&gt; MS (r (Statement r))
forall (r :: * -&gt; *).
ControlStatement r =&gt;
SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">returnStmt</span></span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; MS (r (Statement r)))
-&gt; SValue r -&gt; MS (r (Statement r))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r)) -&gt; SValue r
forall (r :: * -&gt; *). VariableValue r =&gt; SVariable r -&gt; SValue r
</span><span class="hs-identifier hs-var">valueOf</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
</span><a href="#local-6989586621679370841"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-788"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ExtLibMap -&gt; Maybe ExtLibState
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679370839"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; ExtLibMap
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#extLibMap"><span class="hs-identifier hs-var">extLibMap</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679370835"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-789"></span><span>  </span><span id="local-6989586621679370847"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679370847"><span class="hs-identifier hs-var">calcDesc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeDefinition -&gt; GenState String
forall c. CodeIdea c =&gt; c -&gt; GenState String
</span><a href="Language.Drasil.Code.Imperative.Comments.html#getCommentBrief"><span class="hs-identifier hs-var">getCommentBrief</span></a></span><span> </span><span class="annot"><span class="annottext">CodeDefinition
</span><a href="#local-6989586621679370834"><span class="hs-identifier hs-var">cdef</span></a></span><span>
</span><span id="line-790"></span><span>  </span><span id="local-6989586621679370848"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679370848"><span class="hs-identifier hs-var">desc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeDefinition -&gt; GenState String
forall c. CodeIdea c =&gt; c -&gt; GenState String
</span><a href="Language.Drasil.Code.Imperative.Comments.html#getCommentBrief"><span class="hs-identifier hs-var">getCommentBrief</span></a></span><span> </span><span class="annot"><span class="annottext">CodeDefinition
</span><a href="#local-6989586621679370834"><span class="hs-identifier hs-var">cdef</span></a></span><span>
</span><span id="line-791"></span><span>  </span><span class="annot"><span class="annottext">String
-&gt; VSType r
-&gt; String
-&gt; [ParameterChunk]
-&gt; Maybe String
-&gt; [MS (r (Block r))]
-&gt; GenState (SMethod r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
String
-&gt; VSType r
-&gt; String
-&gt; [ParameterChunk]
-&gt; Maybe String
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#publicFuncProc"><span class="hs-identifier hs-var">publicFuncProc</span></a></span><span>
</span><span id="line-792"></span><span>    </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679370839"><span class="hs-identifier hs-var">nm</span></a></span><span>
</span><span id="line-793"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeType -&gt; VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; CodeType -&gt; VSType r
</span><span class="hs-identifier hs-var">convType</span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679370840"><span class="hs-identifier hs-var">tp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-794"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Calculates &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679370847"><span class="hs-identifier hs-var">calcDesc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-795"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CodeVarChunk -&gt; ParameterChunk)
-&gt; [CodeVarChunk] -&gt; [ParameterChunk]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">CodeVarChunk -&gt; ParameterChunk
forall c. CodeIdea c =&gt; c -&gt; ParameterChunk
</span><a href="Language.Drasil.Chunk.Parameter.html#pcAuto"><span class="hs-identifier hs-var">pcAuto</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeVarChunk]
</span><a href="#local-6989586621679370837"><span class="hs-identifier hs-var">parms</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-796"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Maybe String
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679370848"><span class="hs-identifier hs-var">desc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-797"></span><span>    </span><span class="annot"><span class="annottext">[MS (r (Block r))]
</span><a href="#local-6989586621679370842"><span class="hs-identifier hs-var">blcks</span></a></span><span>
</span><span id="line-798"></span><span>
</span><span id="line-799"></span><span class="hs-comment">-- | Generates a calculation block for the given 'CodeDefinition', and assigns the</span><span>
</span><span id="line-800"></span><span class="hs-comment">-- result to a variable (if 'CalcAssign') or returns the result (if 'CalcReturn').</span><span>
</span><span id="line-801"></span><span id="local-6989586621679363492"><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genCalcBlockProc"><span class="hs-identifier hs-type">genCalcBlockProc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679363492"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#CalcType"><span class="hs-identifier hs-type">CalcType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Chunk.CodeDefinition.html#CodeDefinition"><span class="hs-identifier hs-type">CodeDefinition</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CodeExpr</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-802"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MSBlock</span></span><span> </span><span class="annot"><a href="#local-6989586621679363492"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-803"></span><span id="genCalcBlockProc"><span class="annot"><span class="annottext">genCalcBlockProc :: forall (r :: * -&gt; *).
SharedProg r =&gt;
CalcType -&gt; CodeDefinition -&gt; CodeExpr -&gt; GenState (MSBlock r)
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genCalcBlockProc"><span class="hs-identifier hs-var hs-var">genCalcBlockProc</span></a></span></span><span> </span><span id="local-6989586621679370876"><span class="annot"><span class="annottext">CalcType
</span><a href="#local-6989586621679370876"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679370877"><span class="annot"><span class="annottext">CodeDefinition
</span><a href="#local-6989586621679370877"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Case</span></span><span> </span><span id="local-6989586621679370878"><span class="annot"><span class="annottext">Completeness
</span><a href="#local-6989586621679370878"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679370879"><span class="annot"><span class="annottext">[(CodeExpr, CodeExpr)]
</span><a href="#local-6989586621679370879"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CalcType
-&gt; CodeDefinition
-&gt; Completeness
-&gt; [(CodeExpr, CodeExpr)]
-&gt; StateT
     DrasilState Identity (StateT MethodState Identity (r (Block r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
CalcType
-&gt; CodeDefinition
-&gt; Completeness
-&gt; [(CodeExpr, CodeExpr)]
-&gt; GenState (MSBlock r)
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genCaseBlockProc"><span class="hs-identifier hs-var">genCaseBlockProc</span></a></span><span> </span><span class="annot"><span class="annottext">CalcType
</span><a href="#local-6989586621679370876"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">CodeDefinition
</span><a href="#local-6989586621679370877"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Completeness
</span><a href="#local-6989586621679370878"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">[(CodeExpr, CodeExpr)]
</span><a href="#local-6989586621679370879"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-804"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genCalcBlockProc"><span class="hs-identifier hs-var">genCalcBlockProc</span></a></span><span> </span><span class="annot"><span class="annottext">CalcType
</span><a href="Language.Drasil.Code.Imperative.Modules.html#CalcAssign"><span class="hs-identifier hs-var">CalcAssign</span></a></span><span> </span><span id="local-6989586621679370881"><span class="annot"><span class="annottext">CodeDefinition
</span><a href="#local-6989586621679370881"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679370882"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679370882"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-805"></span><span>  </span><span id="local-6989586621679370883"><span class="annot"><span class="annottext">VS (r (Variable r))
</span><a href="#local-6989586621679370883"><span class="hs-identifier hs-var">vv</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeVarChunk -&gt; StateT DrasilState Identity (VS (r (Variable r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeVarChunk -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVarProc"><span class="hs-identifier hs-var">mkVarProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeDefinition -&gt; CodeVarChunk
forall c.
(Quantity c, MayHaveUnit c, Concept c) =&gt;
c -&gt; CodeVarChunk
</span><a href="Language.Drasil.Chunk.CodeBase.html#quantvar"><span class="hs-identifier hs-var">quantvar</span></a></span><span> </span><span class="annot"><span class="annottext">CodeDefinition
</span><a href="#local-6989586621679370881"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-806"></span><span>  </span><span id="local-6989586621679370884"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679370884"><span class="hs-identifier hs-var">ee</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679370882"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-807"></span><span>  </span><span id="local-6989586621679370885"><span class="annot"><span class="annottext">[MS (r (Statement r))]
</span><a href="#local-6989586621679370885"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
-&gt; StateT DrasilState Identity [MS (r (Statement r))]
forall (r :: * -&gt; *).
SharedProg r =&gt;
SVariable r -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Logging.html#maybeLog"><span class="hs-identifier hs-var">maybeLog</span></a></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
</span><a href="#local-6989586621679370883"><span class="hs-identifier hs-var">vv</span></a></span><span>
</span><span id="line-808"></span><span>  </span><span class="annot"><span class="annottext">StateT MethodState Identity (r (Block r))
-&gt; StateT
     DrasilState Identity (StateT MethodState Identity (r (Block r)))
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(StateT MethodState Identity (r (Block r))
 -&gt; StateT
      DrasilState Identity (StateT MethodState Identity (r (Block r))))
-&gt; StateT MethodState Identity (r (Block r))
-&gt; StateT
     DrasilState Identity (StateT MethodState Identity (r (Block r)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[MS (r (Statement r))] -&gt; StateT MethodState Identity (r (Block r))
forall (r :: * -&gt; *). BlockSym r =&gt; [MSStatement r] -&gt; MSBlock r
</span><span class="hs-identifier hs-var">block</span></span><span> </span><span class="annot"><span class="annottext">([MS (r (Statement r))]
 -&gt; StateT MethodState Identity (r (Block r)))
-&gt; [MS (r (Statement r))]
-&gt; StateT MethodState Identity (r (Block r))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r)) -&gt; VS (r (Value r)) -&gt; MS (r (Statement r))
forall (r :: * -&gt; *).
AssignStatement r =&gt;
SVariable r -&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">assign</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
</span><a href="#local-6989586621679370883"><span class="hs-identifier hs-var">vv</span></a></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679370884"><span class="hs-identifier hs-var">ee</span></a></span><span> </span><span class="annot"><span class="annottext">MS (r (Statement r))
-&gt; [MS (r (Statement r))] -&gt; [MS (r (Statement r))]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[MS (r (Statement r))]
</span><a href="#local-6989586621679370885"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-809"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genCalcBlockProc"><span class="hs-identifier hs-var">genCalcBlockProc</span></a></span><span> </span><span class="annot"><span class="annottext">CalcType
</span><a href="Language.Drasil.Code.Imperative.Modules.html#CalcReturn"><span class="hs-identifier hs-var">CalcReturn</span></a></span><span> </span><span class="annot"><span class="annottext">CodeDefinition
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679370886"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679370886"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[MS (r (Statement r))] -&gt; StateT MethodState Identity (r (Block r))
forall (r :: * -&gt; *). BlockSym r =&gt; [MSStatement r] -&gt; MSBlock r
</span><span class="hs-identifier hs-var">block</span></span><span> </span><span class="annot"><span class="annottext">([MS (r (Statement r))]
 -&gt; StateT MethodState Identity (r (Block r)))
-&gt; StateT DrasilState Identity [MS (r (Statement r))]
-&gt; StateT
     DrasilState Identity (StateT MethodState Identity (r (Block r)))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">State DrasilState (MS (r (Statement r)))
-&gt; StateT DrasilState Identity [MS (r (Statement r))]
forall a b. State a b -&gt; State a [b]
</span><a href="Language.Drasil.Code.Imperative.Helpers.html#liftS"><span class="hs-identifier hs-var">liftS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VS (r (Value r)) -&gt; MS (r (Statement r))
forall (r :: * -&gt; *).
ControlStatement r =&gt;
SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">returnStmt</span></span><span> </span><span class="annot"><span class="annottext">(VS (r (Value r)) -&gt; MS (r (Statement r)))
-&gt; StateT DrasilState Identity (VS (r (Value r)))
-&gt; State DrasilState (MS (r (Statement r)))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679370886"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-810"></span><span>
</span><span id="line-811"></span><span class="hs-comment">-- | Generates a calculation block for a value defined by cases.</span><span>
</span><span id="line-812"></span><span class="hs-comment">-- If the function is defined for every case, the final case is captured by an</span><span>
</span><span id="line-813"></span><span class="hs-comment">-- else clause, otherwise an error-throwing else-clause is generated.</span><span>
</span><span id="line-814"></span><span id="local-6989586621679363496"><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genCaseBlockProc"><span class="hs-identifier hs-type">genCaseBlockProc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679363496"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#CalcType"><span class="hs-identifier hs-type">CalcType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Chunk.CodeDefinition.html#CodeDefinition"><span class="hs-identifier hs-type">CodeDefinition</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Completeness</span></span><span>
</span><span id="line-815"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CodeExpr</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CodeExpr</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MSBlock</span></span><span> </span><span class="annot"><a href="#local-6989586621679363496"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-816"></span><span id="genCaseBlockProc"><span class="annot"><span class="annottext">genCaseBlockProc :: forall (r :: * -&gt; *).
SharedProg r =&gt;
CalcType
-&gt; CodeDefinition
-&gt; Completeness
-&gt; [(CodeExpr, CodeExpr)]
-&gt; GenState (MSBlock r)
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genCaseBlockProc"><span class="hs-identifier hs-var hs-var">genCaseBlockProc</span></a></span></span><span> </span><span class="annot"><span class="annottext">CalcType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">CodeDefinition
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Completeness
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; GenState (MSBlock r)
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; GenState (MSBlock r)) -&gt; String -&gt; GenState (MSBlock r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Case expression with no cases encountered&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-817"></span><span>  </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; in code generator&quot;</span></span><span>
</span><span id="line-818"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genCaseBlockProc"><span class="hs-identifier hs-var">genCaseBlockProc</span></a></span><span> </span><span id="local-6989586621679370904"><span class="annot"><span class="annottext">CalcType
</span><a href="#local-6989586621679370904"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679370905"><span class="annot"><span class="annottext">CodeDefinition
</span><a href="#local-6989586621679370905"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679370906"><span class="annot"><span class="annottext">Completeness
</span><a href="#local-6989586621679370906"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679370907"><span class="annot"><span class="annottext">[(CodeExpr, CodeExpr)]
</span><a href="#local-6989586621679370907"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-819"></span><span>  </span><span id="local-6989586621679370908"><span class="annot"><span class="annottext">[(VS (r (Value r)), MS (r (Body r)))]
</span><a href="#local-6989586621679370908"><span class="hs-identifier hs-var">ifs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((CodeExpr, CodeExpr)
 -&gt; StateT DrasilState Identity (VS (r (Value r)), MS (r (Body r))))
-&gt; [(CodeExpr, CodeExpr)]
-&gt; StateT
     DrasilState Identity [(VS (r (Value r)), MS (r (Body r)))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679370909"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679370909"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679370910"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679370910"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(VS (r (Value r))
 -&gt; MS (r (Body r)) -&gt; (VS (r (Value r)), MS (r (Body r))))
-&gt; StateT DrasilState Identity (VS (r (Value r)))
-&gt; StateT DrasilState Identity (MS (r (Body r)))
-&gt; StateT DrasilState Identity (VS (r (Value r)), MS (r (Body r)))
forall (m :: * -&gt; *) a1 a2 r.
Monad m =&gt;
(a1 -&gt; a2 -&gt; r) -&gt; m a1 -&gt; m a2 -&gt; m r
</span><span class="hs-identifier hs-var">liftM2</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679370910"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (MS (r (Body r)))
forall {r :: * -&gt; *}.
SharedProg r =&gt;
CodeExpr -&gt; StateT DrasilState Identity (MS (r (Body r)))
</span><a href="#local-6989586621679370911"><span class="hs-identifier hs-var">calcBody</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679370909"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Completeness -&gt; [(CodeExpr, CodeExpr)]
</span><a href="#local-6989586621679370912"><span class="hs-identifier hs-var">ifEs</span></a></span><span> </span><span class="annot"><span class="annottext">Completeness
</span><a href="#local-6989586621679370906"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-820"></span><span>  </span><span id="local-6989586621679370913"><span class="annot"><span class="annottext">MS (r (Body r))
</span><a href="#local-6989586621679370913"><span class="hs-identifier hs-var">els</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Completeness -&gt; StateT DrasilState Identity (MS (r (Body r)))
forall {r :: * -&gt; *}.
SharedProg r =&gt;
Completeness -&gt; StateT DrasilState Identity (MS (r (Body r)))
</span><a href="#local-6989586621679370914"><span class="hs-identifier hs-var">elseE</span></a></span><span> </span><span class="annot"><span class="annottext">Completeness
</span><a href="#local-6989586621679370906"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-821"></span><span>  </span><span class="annot"><span class="annottext">MSBlock r -&gt; GenState (MSBlock r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSBlock r -&gt; GenState (MSBlock r))
-&gt; MSBlock r -&gt; GenState (MSBlock r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSBlock r
forall (r :: * -&gt; *). BlockSym r =&gt; [MSStatement r] -&gt; MSBlock r
</span><span class="hs-identifier hs-var">block</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[(VS (r (Value r)), MS (r (Body r)))]
-&gt; MS (r (Body r)) -&gt; MSStatement r
forall (r :: * -&gt; *).
ControlStatement r =&gt;
[(SValue r, MSBody r)] -&gt; MSBody r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">ifCond</span></span><span> </span><span class="annot"><span class="annottext">[(VS (r (Value r)), MS (r (Body r)))]
</span><a href="#local-6989586621679370908"><span class="hs-identifier hs-var">ifs</span></a></span><span> </span><span class="annot"><span class="annottext">MS (r (Body r))
</span><a href="#local-6989586621679370913"><span class="hs-identifier hs-var">els</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-822"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679370911"><span class="annot"><span class="annottext">calcBody :: CodeExpr -&gt; StateT DrasilState Identity (MS (r (Body r)))
</span><a href="#local-6989586621679370911"><span class="hs-identifier hs-var hs-var">calcBody</span></a></span></span><span> </span><span id="local-6989586621679371089"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679371089"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([MS (r (Block r))] -&gt; MS (r (Body r)))
-&gt; StateT DrasilState Identity [MS (r (Block r))]
-&gt; StateT DrasilState Identity (MS (r (Body r)))
forall a b.
(a -&gt; b)
-&gt; StateT DrasilState Identity a -&gt; StateT DrasilState Identity b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">[MS (r (Block r))] -&gt; MS (r (Body r))
forall (r :: * -&gt; *). BodySym r =&gt; [MSBlock r] -&gt; MSBody r
</span><span class="hs-identifier hs-var">body</span></span><span> </span><span class="annot"><span class="annottext">(StateT DrasilState Identity [MS (r (Block r))]
 -&gt; StateT DrasilState Identity (MS (r (Body r))))
-&gt; StateT DrasilState Identity [MS (r (Block r))]
-&gt; StateT DrasilState Identity (MS (r (Body r)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">State DrasilState (MS (r (Block r)))
-&gt; StateT DrasilState Identity [MS (r (Block r))]
forall a b. State a b -&gt; State a [b]
</span><a href="Language.Drasil.Code.Imperative.Helpers.html#liftS"><span class="hs-identifier hs-var">liftS</span></a></span><span> </span><span class="annot"><span class="annottext">(State DrasilState (MS (r (Block r)))
 -&gt; StateT DrasilState Identity [MS (r (Block r))])
-&gt; State DrasilState (MS (r (Block r)))
-&gt; StateT DrasilState Identity [MS (r (Block r))]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CalcType
-&gt; CodeDefinition
-&gt; CodeExpr
-&gt; State DrasilState (MS (r (Block r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
CalcType -&gt; CodeDefinition -&gt; CodeExpr -&gt; GenState (MSBlock r)
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genCalcBlockProc"><span class="hs-identifier hs-var">genCalcBlockProc</span></a></span><span> </span><span class="annot"><span class="annottext">CalcType
</span><a href="#local-6989586621679370904"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">CodeDefinition
</span><a href="#local-6989586621679370905"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679371089"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-823"></span><span>        </span><span id="local-6989586621679370912"><span class="annot"><span class="annottext">ifEs :: Completeness -&gt; [(CodeExpr, CodeExpr)]
</span><a href="#local-6989586621679370912"><span class="hs-identifier hs-var hs-var">ifEs</span></a></span></span><span> </span><span class="annot"><span class="annottext">Completeness
</span><span class="hs-identifier hs-var">Complete</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(CodeExpr, CodeExpr)] -&gt; [(CodeExpr, CodeExpr)]
forall a. HasCallStack =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">init</span></span><span> </span><span class="annot"><span class="annottext">[(CodeExpr, CodeExpr)]
</span><a href="#local-6989586621679370907"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-824"></span><span>        </span><span class="annot"><a href="#local-6989586621679370912"><span class="hs-identifier hs-var">ifEs</span></a></span><span> </span><span class="annot"><span class="annottext">Completeness
</span><span class="hs-identifier hs-var">Incomplete</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(CodeExpr, CodeExpr)]
</span><a href="#local-6989586621679370907"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-825"></span><span>        </span><span id="local-6989586621679370914"><span class="annot"><span class="annottext">elseE :: Completeness -&gt; StateT DrasilState Identity (MS (r (Body r)))
</span><a href="#local-6989586621679370914"><span class="hs-identifier hs-var hs-var">elseE</span></a></span></span><span> </span><span class="annot"><span class="annottext">Completeness
</span><span class="hs-identifier hs-var">Complete</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (MS (r (Body r)))
forall {r :: * -&gt; *}.
SharedProg r =&gt;
CodeExpr -&gt; StateT DrasilState Identity (MS (r (Body r)))
</span><a href="#local-6989586621679370911"><span class="hs-identifier hs-var">calcBody</span></a></span><span> </span><span class="annot"><span class="annottext">(CodeExpr -&gt; StateT DrasilState Identity (MS (r (Body r))))
-&gt; CodeExpr -&gt; StateT DrasilState Identity (MS (r (Body r)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(CodeExpr, CodeExpr) -&gt; CodeExpr
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((CodeExpr, CodeExpr) -&gt; CodeExpr)
-&gt; (CodeExpr, CodeExpr) -&gt; CodeExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(CodeExpr, CodeExpr)] -&gt; (CodeExpr, CodeExpr)
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">last</span></span><span> </span><span class="annot"><span class="annottext">[(CodeExpr, CodeExpr)]
</span><a href="#local-6989586621679370907"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-826"></span><span>        </span><span class="annot"><a href="#local-6989586621679370914"><span class="hs-identifier hs-var">elseE</span></a></span><span> </span><span class="annot"><span class="annottext">Completeness
</span><span class="hs-identifier hs-var">Incomplete</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MS (r (Body r)) -&gt; StateT DrasilState Identity (MS (r (Body r)))
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MS (r (Body r)) -&gt; StateT DrasilState Identity (MS (r (Body r))))
-&gt; MS (r (Body r)) -&gt; StateT DrasilState Identity (MS (r (Body r)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MSStatement r -&gt; MS (r (Body r))
forall (r :: * -&gt; *). BodySym r =&gt; MSStatement r -&gt; MSBody r
</span><span class="hs-identifier hs-var">oneLiner</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; MS (r (Body r)))
-&gt; MSStatement r -&gt; MS (r (Body r))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; MSStatement r
forall (r :: * -&gt; *). ControlStatement r =&gt; String -&gt; MSStatement r
</span><span class="hs-identifier hs-var">throw</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; MSStatement r) -&gt; String -&gt; MSStatement r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-827"></span><span>          </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Undefined case encountered in function &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">CodeDefinition -&gt; String
forall c. CodeIdea c =&gt; c -&gt; String
</span><span class="hs-identifier hs-var">codeName</span></span><span> </span><span class="annot"><span class="annottext">CodeDefinition
</span><a href="#local-6989586621679370905"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-828"></span><span>
</span><span id="line-829"></span><span class="annot"><span class="hs-comment">-- | | Generates a function for reading inputs from a file.</span></span><span>
</span><span id="line-830"></span><span id="local-6989586621679363484"><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genInputFormatProc"><span class="hs-identifier hs-type">genInputFormatProc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679363484"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VisibilityTag</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-831"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679363484"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-832"></span><span id="genInputFormatProc"><span class="annot"><span class="annottext">genInputFormatProc :: forall (r :: * -&gt; *).
SharedProg r =&gt;
VisibilityTag -&gt; GenState (Maybe (SMethod r))
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genInputFormatProc"><span class="hs-identifier hs-var hs-var">genInputFormatProc</span></a></span></span><span> </span><span id="local-6989586621679371287"><span class="annot"><span class="annottext">VisibilityTag
</span><a href="#local-6989586621679371287"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-833"></span><span>  </span><span id="local-6989586621679371288"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679371288"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-834"></span><span>  </span><span class="annot"><span class="annottext">(DrasilState -&gt; DrasilState) -&gt; StateT DrasilState Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679371289"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679371289"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679371289"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#currentScope"><span class="hs-identifier hs-var">currentScope</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#Local"><span class="hs-identifier hs-type">Local</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-835"></span><span>  </span><span id="local-6989586621679371290"><span class="annot"><span class="annottext">DataDesc
</span><a href="#local-6989586621679371290"><span class="hs-identifier hs-var">dd</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenState DataDesc
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genDataDesc"><span class="hs-identifier hs-var">genDataDesc</span></a></span><span>
</span><span id="line-836"></span><span>  </span><span id="local-6989586621679371291"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679371291"><span class="hs-identifier hs-var">giName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">InternalConcept -&gt; GenState String
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#genICName"><span class="hs-identifier hs-var">genICName</span></a></span><span> </span><span class="annot"><span class="annottext">InternalConcept
</span><a href="Language.Drasil.Choices.html#GetInput"><span class="hs-identifier hs-var">GetInput</span></a></span><span>
</span><span id="line-837"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679371460"><span class="annot"><span class="annottext">getFunc :: VisibilityTag
-&gt; String
-&gt; String
-&gt; [CodeVarChunk]
-&gt; [CodeVarChunk]
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="#local-6989586621679371460"><span class="hs-identifier hs-var hs-var">getFunc</span></a></span></span><span> </span><span class="annot"><span class="annottext">VisibilityTag
</span><span class="hs-identifier hs-var">Pub</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; String
-&gt; [CodeVarChunk]
-&gt; [CodeVarChunk]
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
String
-&gt; String
-&gt; [CodeVarChunk]
-&gt; [CodeVarChunk]
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#publicInOutFuncProc"><span class="hs-identifier hs-var">publicInOutFuncProc</span></a></span><span>
</span><span id="line-838"></span><span>      </span><span class="annot"><a href="#local-6989586621679371460"><span class="hs-identifier hs-var">getFunc</span></a></span><span> </span><span class="annot"><span class="annottext">VisibilityTag
</span><span class="hs-identifier hs-var">Priv</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; String
-&gt; [CodeVarChunk]
-&gt; [CodeVarChunk]
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
String
-&gt; String
-&gt; [CodeVarChunk]
-&gt; [CodeVarChunk]
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#privateInOutFuncProc"><span class="hs-identifier hs-var">privateInOutFuncProc</span></a></span><span>
</span><span id="line-839"></span><span>      </span><span id="local-6989586621679363503"><span class="annot"><a href="#local-6989586621679371461"><span class="hs-identifier hs-type">genInFormat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679363503"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span>
</span><span id="line-840"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679363503"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-841"></span><span>      </span><span id="local-6989586621679371461"><span class="annot"><span class="annottext">genInFormat :: forall (r :: * -&gt; *).
SharedProg r =&gt;
Bool -&gt; GenState (Maybe (SMethod r))
</span><a href="#local-6989586621679371461"><span class="hs-identifier hs-var hs-var">genInFormat</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (MS (r (Method r)))
-&gt; StateT DrasilState Identity (Maybe (MS (r (Method r))))
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe (MS (r (Method r)))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-842"></span><span>      </span><span class="annot"><a href="#local-6989586621679371461"><span class="hs-identifier hs-var">genInFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-843"></span><span>        </span><span id="local-6989586621679371472"><span class="annot"><span class="annottext">[CodeVarChunk]
</span><a href="#local-6989586621679371472"><span class="hs-identifier hs-var">ins</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenState [CodeVarChunk]
</span><a href="Language.Drasil.Code.Imperative.Parameters.html#getInputFormatIns"><span class="hs-identifier hs-var">getInputFormatIns</span></a></span><span>
</span><span id="line-844"></span><span>        </span><span id="local-6989586621679371473"><span class="annot"><span class="annottext">[CodeVarChunk]
</span><a href="#local-6989586621679371473"><span class="hs-identifier hs-var">outs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenState [CodeVarChunk]
</span><a href="Language.Drasil.Code.Imperative.Parameters.html#getInputFormatOuts"><span class="hs-identifier hs-var">getInputFormatOuts</span></a></span><span>
</span><span id="line-845"></span><span>        </span><span id="local-6989586621679371474"><span class="annot"><span class="annottext">[MS (r (Block r))]
</span><a href="#local-6989586621679371474"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DataDesc -&gt; StateT DrasilState Identity [MS (r (Block r))]
forall (r :: * -&gt; *).
SharedProg r =&gt;
DataDesc -&gt; GenState [MSBlock r]
</span><a href="Language.Drasil.Code.Imperative.Import.html#readDataProc"><span class="hs-identifier hs-var">readDataProc</span></a></span><span> </span><span class="annot"><span class="annottext">DataDesc
</span><a href="#local-6989586621679371290"><span class="hs-identifier hs-var">dd</span></a></span><span>
</span><span id="line-846"></span><span>        </span><span id="local-6989586621679371475"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679371475"><span class="hs-identifier hs-var">desc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenState String
</span><a href="Language.Drasil.Code.Imperative.Descriptions.html#inFmtFuncDesc"><span class="hs-identifier hs-var">inFmtFuncDesc</span></a></span><span>
</span><span id="line-847"></span><span>        </span><span id="local-6989586621679371476"><span class="annot"><span class="annottext">MS (r (Method r))
</span><a href="#local-6989586621679371476"><span class="hs-identifier hs-var">mthd</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VisibilityTag
-&gt; String
-&gt; String
-&gt; [CodeVarChunk]
-&gt; [CodeVarChunk]
-&gt; [MS (r (Block r))]
-&gt; StateT DrasilState Identity (MS (r (Method r)))
forall {r :: * -&gt; *}.
SharedProg r =&gt;
VisibilityTag
-&gt; String
-&gt; String
-&gt; [CodeVarChunk]
-&gt; [CodeVarChunk]
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="#local-6989586621679371460"><span class="hs-identifier hs-var">getFunc</span></a></span><span> </span><span class="annot"><span class="annottext">VisibilityTag
</span><a href="#local-6989586621679371287"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679371291"><span class="hs-identifier hs-var">giName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679371475"><span class="hs-identifier hs-var">desc</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeVarChunk]
</span><a href="#local-6989586621679371472"><span class="hs-identifier hs-var">ins</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeVarChunk]
</span><a href="#local-6989586621679371473"><span class="hs-identifier hs-var">outs</span></a></span><span> </span><span class="annot"><span class="annottext">[MS (r (Block r))]
</span><a href="#local-6989586621679371474"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-848"></span><span>        </span><span class="annot"><span class="annottext">Maybe (MS (r (Method r)))
-&gt; StateT DrasilState Identity (Maybe (MS (r (Method r))))
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (MS (r (Method r)))
 -&gt; StateT DrasilState Identity (Maybe (MS (r (Method r)))))
-&gt; Maybe (MS (r (Method r)))
-&gt; StateT DrasilState Identity (Maybe (MS (r (Method r))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MS (r (Method r)) -&gt; Maybe (MS (r (Method r)))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">MS (r (Method r))
</span><a href="#local-6989586621679371476"><span class="hs-identifier hs-var">mthd</span></a></span><span>
</span><span id="line-849"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; GenState (Maybe (SMethod r))
forall (r :: * -&gt; *).
SharedProg r =&gt;
Bool -&gt; GenState (Maybe (SMethod r))
</span><a href="#local-6989586621679371461"><span class="hs-identifier hs-var">genInFormat</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; GenState (Maybe (SMethod r)))
-&gt; Bool -&gt; GenState (Maybe (SMethod r))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679371291"><span class="hs-identifier hs-var">giName</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Set String -&gt; Bool
forall a. Eq a =&gt; a -&gt; Set a -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; Set String
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#defSet"><span class="hs-identifier hs-var">defSet</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679371288"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-850"></span><span>
</span><span id="line-851"></span><span class="annot"><span class="hs-comment">-- | Generates a function for calculating derived inputs.</span></span><span>
</span><span id="line-852"></span><span id="local-6989586621679371477"><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genInputDerivedProc"><span class="hs-identifier hs-type">genInputDerivedProc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679371477"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VisibilityTag</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-853"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679371477"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-854"></span><span id="genInputDerivedProc"><span class="annot"><span class="annottext">genInputDerivedProc :: forall (r :: * -&gt; *).
SharedProg r =&gt;
VisibilityTag -&gt; GenState (Maybe (SMethod r))
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genInputDerivedProc"><span class="hs-identifier hs-var hs-var">genInputDerivedProc</span></a></span></span><span> </span><span id="local-6989586621679371487"><span class="annot"><span class="annottext">VisibilityTag
</span><a href="#local-6989586621679371487"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-855"></span><span>  </span><span id="local-6989586621679371488"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679371488"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-856"></span><span>  </span><span class="annot"><span class="annottext">(DrasilState -&gt; DrasilState) -&gt; StateT DrasilState Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679371489"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679371489"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679371489"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#currentScope"><span class="hs-identifier hs-var">currentScope</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#Local"><span class="hs-identifier hs-type">Local</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-857"></span><span>  </span><span id="local-6989586621679371490"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679371490"><span class="hs-identifier hs-var">dvName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">InternalConcept -&gt; GenState String
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#genICName"><span class="hs-identifier hs-var">genICName</span></a></span><span> </span><span class="annot"><span class="annottext">InternalConcept
</span><a href="Language.Drasil.Choices.html#DerivedValuesFn"><span class="hs-identifier hs-var">DerivedValuesFn</span></a></span><span>
</span><span id="line-858"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679371493"><span class="annot"><span class="annottext">dvals :: [CodeDefinition]
</span><a href="#local-6989586621679371493"><span class="hs-identifier hs-var hs-var">dvals</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; CodeSpec
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#codeSpec"><span class="hs-identifier hs-var">codeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679371488"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">CodeSpec
-&gt; Getting [CodeDefinition] CodeSpec [CodeDefinition]
-&gt; [CodeDefinition]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting [CodeDefinition] CodeSpec [CodeDefinition]
forall c. HasOldCodeSpec c =&gt; Lens' c [CodeDefinition]
Lens' CodeSpec [CodeDefinition]
</span><a href="Language.Drasil.CodeSpec.html#derivedInputsO"><span class="hs-identifier hs-var">derivedInputsO</span></a></span><span>
</span><span id="line-859"></span><span>      </span><span id="local-6989586621679371662"><span class="annot"><span class="annottext">getFunc :: VisibilityTag
-&gt; String
-&gt; String
-&gt; [CodeVarChunk]
-&gt; [CodeVarChunk]
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="#local-6989586621679371662"><span class="hs-identifier hs-var hs-var">getFunc</span></a></span></span><span> </span><span class="annot"><span class="annottext">VisibilityTag
</span><span class="hs-identifier hs-var">Pub</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; String
-&gt; [CodeVarChunk]
-&gt; [CodeVarChunk]
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
String
-&gt; String
-&gt; [CodeVarChunk]
-&gt; [CodeVarChunk]
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#publicInOutFuncProc"><span class="hs-identifier hs-var">publicInOutFuncProc</span></a></span><span>
</span><span id="line-860"></span><span>      </span><span class="annot"><a href="#local-6989586621679371662"><span class="hs-identifier hs-var">getFunc</span></a></span><span> </span><span class="annot"><span class="annottext">VisibilityTag
</span><span class="hs-identifier hs-var">Priv</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; String
-&gt; [CodeVarChunk]
-&gt; [CodeVarChunk]
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
String
-&gt; String
-&gt; [CodeVarChunk]
-&gt; [CodeVarChunk]
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#privateInOutFuncProc"><span class="hs-identifier hs-var">privateInOutFuncProc</span></a></span><span>
</span><span id="line-861"></span><span>      </span><span id="local-6989586621679371663"><span class="annot"><a href="#local-6989586621679371664"><span class="hs-identifier hs-type">genDerived</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679371663"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span>
</span><span id="line-862"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679371663"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-863"></span><span>      </span><span id="local-6989586621679371664"><span class="annot"><span class="annottext">genDerived :: forall (r :: * -&gt; *).
SharedProg r =&gt;
Bool -&gt; GenState (Maybe (SMethod r))
</span><a href="#local-6989586621679371664"><span class="hs-identifier hs-var hs-var">genDerived</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (MS (r (Method r)))
-&gt; StateT DrasilState Identity (Maybe (MS (r (Method r))))
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe (MS (r (Method r)))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-864"></span><span>      </span><span class="annot"><a href="#local-6989586621679371664"><span class="hs-identifier hs-var">genDerived</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-865"></span><span>        </span><span id="local-6989586621679371679"><span class="annot"><span class="annottext">[CodeVarChunk]
</span><a href="#local-6989586621679371679"><span class="hs-identifier hs-var">ins</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenState [CodeVarChunk]
</span><a href="Language.Drasil.Code.Imperative.Parameters.html#getDerivedIns"><span class="hs-identifier hs-var">getDerivedIns</span></a></span><span>
</span><span id="line-866"></span><span>        </span><span id="local-6989586621679371680"><span class="annot"><span class="annottext">[CodeVarChunk]
</span><a href="#local-6989586621679371680"><span class="hs-identifier hs-var">outs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenState [CodeVarChunk]
</span><a href="Language.Drasil.Code.Imperative.Parameters.html#getDerivedOuts"><span class="hs-identifier hs-var">getDerivedOuts</span></a></span><span>
</span><span id="line-867"></span><span>        </span><span id="local-6989586621679371681"><span class="annot"><span class="annottext">[MS (r (Block r))]
</span><a href="#local-6989586621679371681"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(CodeDefinition -&gt; StateT DrasilState Identity (MS (r (Block r))))
-&gt; [CodeDefinition]
-&gt; StateT DrasilState Identity [MS (r (Block r))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679371682"><span class="annot"><span class="annottext">CodeDefinition
</span><a href="#local-6989586621679371682"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CalcType
-&gt; CodeDefinition
-&gt; CodeExpr
-&gt; StateT DrasilState Identity (MS (r (Block r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
CalcType -&gt; CodeDefinition -&gt; CodeExpr -&gt; GenState (MSBlock r)
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genCalcBlockProc"><span class="hs-identifier hs-var">genCalcBlockProc</span></a></span><span> </span><span class="annot"><span class="annottext">CalcType
</span><a href="Language.Drasil.Code.Imperative.Modules.html#CalcAssign"><span class="hs-identifier hs-var">CalcAssign</span></a></span><span> </span><span class="annot"><span class="annottext">CodeDefinition
</span><a href="#local-6989586621679371682"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeDefinition
</span><a href="#local-6989586621679371682"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CodeDefinition
-&gt; Getting CodeExpr CodeDefinition CodeExpr -&gt; CodeExpr
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting CodeExpr CodeDefinition CodeExpr
forall c. DefiningCodeExpr c =&gt; Lens' c CodeExpr
Lens' CodeDefinition CodeExpr
</span><span class="hs-identifier hs-var">codeExpr</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CodeDefinition]
</span><a href="#local-6989586621679371493"><span class="hs-identifier hs-var">dvals</span></a></span><span>
</span><span id="line-868"></span><span>        </span><span id="local-6989586621679371683"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679371683"><span class="hs-identifier hs-var">desc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenState String
</span><a href="Language.Drasil.Code.Imperative.Descriptions.html#dvFuncDesc"><span class="hs-identifier hs-var">dvFuncDesc</span></a></span><span>
</span><span id="line-869"></span><span>        </span><span id="local-6989586621679371684"><span class="annot"><span class="annottext">MS (r (Method r))
</span><a href="#local-6989586621679371684"><span class="hs-identifier hs-var">mthd</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VisibilityTag
-&gt; String
-&gt; String
-&gt; [CodeVarChunk]
-&gt; [CodeVarChunk]
-&gt; [MS (r (Block r))]
-&gt; StateT DrasilState Identity (MS (r (Method r)))
forall {r :: * -&gt; *}.
SharedProg r =&gt;
VisibilityTag
-&gt; String
-&gt; String
-&gt; [CodeVarChunk]
-&gt; [CodeVarChunk]
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="#local-6989586621679371662"><span class="hs-identifier hs-var">getFunc</span></a></span><span> </span><span class="annot"><span class="annottext">VisibilityTag
</span><a href="#local-6989586621679371487"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679371490"><span class="hs-identifier hs-var">dvName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679371683"><span class="hs-identifier hs-var">desc</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeVarChunk]
</span><a href="#local-6989586621679371679"><span class="hs-identifier hs-var">ins</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeVarChunk]
</span><a href="#local-6989586621679371680"><span class="hs-identifier hs-var">outs</span></a></span><span> </span><span class="annot"><span class="annottext">[MS (r (Block r))]
</span><a href="#local-6989586621679371681"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-870"></span><span>        </span><span class="annot"><span class="annottext">Maybe (MS (r (Method r)))
-&gt; StateT DrasilState Identity (Maybe (MS (r (Method r))))
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (MS (r (Method r)))
 -&gt; StateT DrasilState Identity (Maybe (MS (r (Method r)))))
-&gt; Maybe (MS (r (Method r)))
-&gt; StateT DrasilState Identity (Maybe (MS (r (Method r))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MS (r (Method r)) -&gt; Maybe (MS (r (Method r)))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">MS (r (Method r))
</span><a href="#local-6989586621679371684"><span class="hs-identifier hs-var">mthd</span></a></span><span>
</span><span id="line-871"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; GenState (Maybe (SMethod r))
forall (r :: * -&gt; *).
SharedProg r =&gt;
Bool -&gt; GenState (Maybe (SMethod r))
</span><a href="#local-6989586621679371664"><span class="hs-identifier hs-var">genDerived</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; GenState (Maybe (SMethod r)))
-&gt; Bool -&gt; GenState (Maybe (SMethod r))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679371490"><span class="hs-identifier hs-var">dvName</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Set String -&gt; Bool
forall a. Eq a =&gt; a -&gt; Set a -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; Set String
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#defSet"><span class="hs-identifier hs-var">defSet</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679371488"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-872"></span><span>
</span><span id="line-873"></span><span class="annot"><span class="hs-comment">-- | Generates function that checks constraints on the input.</span></span><span>
</span><span id="line-874"></span><span id="local-6989586621679371685"><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genInputConstraintsProc"><span class="hs-identifier hs-type">genInputConstraintsProc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679371685"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VisibilityTag</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-875"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679371685"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-876"></span><span id="genInputConstraintsProc"><span class="annot"><span class="annottext">genInputConstraintsProc :: forall (r :: * -&gt; *).
SharedProg r =&gt;
VisibilityTag -&gt; GenState (Maybe (SMethod r))
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genInputConstraintsProc"><span class="hs-identifier hs-var hs-var">genInputConstraintsProc</span></a></span></span><span> </span><span id="local-6989586621679371695"><span class="annot"><span class="annottext">VisibilityTag
</span><a href="#local-6989586621679371695"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-877"></span><span>  </span><span id="local-6989586621679371696"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679371696"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-878"></span><span>  </span><span class="annot"><span class="annottext">(DrasilState -&gt; DrasilState) -&gt; StateT DrasilState Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679371697"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679371697"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679371697"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#currentScope"><span class="hs-identifier hs-var">currentScope</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#Local"><span class="hs-identifier hs-type">Local</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-879"></span><span>  </span><span id="local-6989586621679371698"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679371698"><span class="hs-identifier hs-var">icName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">InternalConcept -&gt; GenState String
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#genICName"><span class="hs-identifier hs-var">genICName</span></a></span><span> </span><span class="annot"><span class="annottext">InternalConcept
</span><a href="Language.Drasil.Choices.html#InputConstraintsFn"><span class="hs-identifier hs-var">InputConstraintsFn</span></a></span><span>
</span><span id="line-880"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679371701"><span class="annot"><span class="annottext">cm :: ConstraintCEMap
</span><a href="#local-6989586621679371701"><span class="hs-identifier hs-var hs-var">cm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; CodeSpec
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#codeSpec"><span class="hs-identifier hs-var">codeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679371696"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">CodeSpec
-&gt; Getting ConstraintCEMap CodeSpec ConstraintCEMap
-&gt; ConstraintCEMap
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting ConstraintCEMap CodeSpec ConstraintCEMap
forall c. HasOldCodeSpec c =&gt; Lens' c ConstraintCEMap
Lens' CodeSpec ConstraintCEMap
</span><a href="Language.Drasil.CodeSpec.html#cMapO"><span class="hs-identifier hs-var">cMapO</span></a></span><span>
</span><span id="line-881"></span><span>      </span><span id="local-6989586621679371870"><span class="annot"><span class="annottext">getFunc :: VisibilityTag
-&gt; String
-&gt; VSType r
-&gt; String
-&gt; [ParameterChunk]
-&gt; Maybe String
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="#local-6989586621679371870"><span class="hs-identifier hs-var hs-var">getFunc</span></a></span></span><span> </span><span class="annot"><span class="annottext">VisibilityTag
</span><span class="hs-identifier hs-var">Pub</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; VSType r
-&gt; String
-&gt; [ParameterChunk]
-&gt; Maybe String
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
String
-&gt; VSType r
-&gt; String
-&gt; [ParameterChunk]
-&gt; Maybe String
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#publicFuncProc"><span class="hs-identifier hs-var">publicFuncProc</span></a></span><span>
</span><span id="line-882"></span><span>      </span><span class="annot"><a href="#local-6989586621679371870"><span class="hs-identifier hs-var">getFunc</span></a></span><span> </span><span class="annot"><span class="annottext">VisibilityTag
</span><span class="hs-identifier hs-var">Priv</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; VSType r
-&gt; String
-&gt; [ParameterChunk]
-&gt; Maybe String
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
String
-&gt; VSType r
-&gt; String
-&gt; [ParameterChunk]
-&gt; Maybe String
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#privateFuncProc"><span class="hs-identifier hs-var">privateFuncProc</span></a></span><span>
</span><span id="line-883"></span><span>      </span><span id="local-6989586621679371871"><span class="annot"><a href="#local-6989586621679371872"><span class="hs-identifier hs-type">genConstraints</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679371871"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span>
</span><span id="line-884"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679371871"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-885"></span><span>      </span><span id="local-6989586621679371872"><span class="annot"><span class="annottext">genConstraints :: forall (r :: * -&gt; *).
SharedProg r =&gt;
Bool -&gt; GenState (Maybe (SMethod r))
</span><a href="#local-6989586621679371872"><span class="hs-identifier hs-var hs-var">genConstraints</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (MS (r (Method r)))
-&gt; StateT DrasilState Identity (Maybe (MS (r (Method r))))
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe (MS (r (Method r)))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-886"></span><span>      </span><span class="annot"><a href="#local-6989586621679371872"><span class="hs-identifier hs-var">genConstraints</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-887"></span><span>        </span><span id="local-6989586621679371893"><span class="annot"><span class="annottext">[CodeVarChunk]
</span><a href="#local-6989586621679371893"><span class="hs-identifier hs-var">parms</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenState [CodeVarChunk]
</span><a href="Language.Drasil.Code.Imperative.Parameters.html#getConstraintParams"><span class="hs-identifier hs-var">getConstraintParams</span></a></span><span>
</span><span id="line-888"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679371900"><span class="annot"><span class="annottext">varsList :: [CodeVarChunk]
</span><a href="#local-6989586621679371900"><span class="hs-identifier hs-var hs-var">varsList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CodeVarChunk -&gt; Bool) -&gt; [CodeVarChunk] -&gt; [CodeVarChunk]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679371901"><span class="annot"><span class="annottext">CodeVarChunk
</span><a href="#local-6989586621679371901"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UID -&gt; ConstraintCEMap -&gt; Bool
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Bool
</span><span class="hs-identifier hs-var">member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeVarChunk
</span><a href="#local-6989586621679371901"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">CodeVarChunk -&gt; Getting UID CodeVarChunk UID -&gt; UID
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting UID CodeVarChunk UID
forall c. HasUID c =&gt; Getter c UID
Getter CodeVarChunk UID
</span><span class="hs-identifier hs-var">uid</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ConstraintCEMap
</span><a href="#local-6989586621679371701"><span class="hs-identifier hs-var">cm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; CodeSpec
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#codeSpec"><span class="hs-identifier hs-var">codeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679371696"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">CodeSpec
-&gt; Getting [CodeVarChunk] CodeSpec [CodeVarChunk] -&gt; [CodeVarChunk]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting [CodeVarChunk] CodeSpec [CodeVarChunk]
forall c. HasOldCodeSpec c =&gt; Lens' c [CodeVarChunk]
Lens' CodeSpec [CodeVarChunk]
</span><a href="Language.Drasil.CodeSpec.html#inputsO"><span class="hs-identifier hs-var">inputsO</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-889"></span><span>            </span><span id="local-6989586621679371903"><span class="annot"><span class="annottext">sfwrCs :: [(CodeVarChunk, [ConstraintCE])]
</span><a href="#local-6989586621679371903"><span class="hs-identifier hs-var hs-var">sfwrCs</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CodeVarChunk -&gt; (CodeVarChunk, [ConstraintCE]))
-&gt; [CodeVarChunk] -&gt; [(CodeVarChunk, [ConstraintCE])]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConstraintCEMap -&gt; CodeVarChunk -&gt; (CodeVarChunk, [ConstraintCE])
forall q. HasUID q =&gt; ConstraintCEMap -&gt; q -&gt; (q, [ConstraintCE])
</span><a href="Language.Drasil.Chunk.ConstraintMap.html#sfwrLookup"><span class="hs-identifier hs-var">sfwrLookup</span></a></span><span> </span><span class="annot"><span class="annottext">ConstraintCEMap
</span><a href="#local-6989586621679371701"><span class="hs-identifier hs-var">cm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CodeVarChunk]
</span><a href="#local-6989586621679371900"><span class="hs-identifier hs-var">varsList</span></a></span><span>
</span><span id="line-890"></span><span>            </span><span id="local-6989586621679371905"><span class="annot"><span class="annottext">physCs :: [(CodeVarChunk, [ConstraintCE])]
</span><a href="#local-6989586621679371905"><span class="hs-identifier hs-var hs-var">physCs</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CodeVarChunk -&gt; (CodeVarChunk, [ConstraintCE]))
-&gt; [CodeVarChunk] -&gt; [(CodeVarChunk, [ConstraintCE])]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConstraintCEMap -&gt; CodeVarChunk -&gt; (CodeVarChunk, [ConstraintCE])
forall q. HasUID q =&gt; ConstraintCEMap -&gt; q -&gt; (q, [ConstraintCE])
</span><a href="Language.Drasil.Chunk.ConstraintMap.html#physLookup"><span class="hs-identifier hs-var">physLookup</span></a></span><span> </span><span class="annot"><span class="annottext">ConstraintCEMap
</span><a href="#local-6989586621679371701"><span class="hs-identifier hs-var">cm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CodeVarChunk]
</span><a href="#local-6989586621679371900"><span class="hs-identifier hs-var">varsList</span></a></span><span>
</span><span id="line-891"></span><span>        </span><span id="local-6989586621679371906"><span class="annot"><span class="annottext">[MS (r (Statement r))]
</span><a href="#local-6989586621679371906"><span class="hs-identifier hs-var">sf</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(CodeVarChunk, [ConstraintCE])]
-&gt; StateT DrasilState Identity [MS (r (Statement r))]
forall (r :: * -&gt; *).
SharedProg r =&gt;
[(CodeVarChunk, [ConstraintCE])] -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Modules.html#sfwrCBodyProc"><span class="hs-identifier hs-var">sfwrCBodyProc</span></a></span><span> </span><span class="annot"><span class="annottext">[(CodeVarChunk, [ConstraintCE])]
</span><a href="#local-6989586621679371903"><span class="hs-identifier hs-var">sfwrCs</span></a></span><span>
</span><span id="line-892"></span><span>        </span><span id="local-6989586621679371908"><span class="annot"><span class="annottext">[MS (r (Statement r))]
</span><a href="#local-6989586621679371908"><span class="hs-identifier hs-var">ph</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(CodeVarChunk, [ConstraintCE])]
-&gt; StateT DrasilState Identity [MS (r (Statement r))]
forall (r :: * -&gt; *).
SharedProg r =&gt;
[(CodeVarChunk, [ConstraintCE])] -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Modules.html#physCBodyProc"><span class="hs-identifier hs-var">physCBodyProc</span></a></span><span> </span><span class="annot"><span class="annottext">[(CodeVarChunk, [ConstraintCE])]
</span><a href="#local-6989586621679371905"><span class="hs-identifier hs-var">physCs</span></a></span><span>
</span><span id="line-893"></span><span>        </span><span id="local-6989586621679371910"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679371910"><span class="hs-identifier hs-var">desc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenState String
</span><a href="Language.Drasil.Code.Imperative.Descriptions.html#inConsFuncDesc"><span class="hs-identifier hs-var">inConsFuncDesc</span></a></span><span>
</span><span id="line-894"></span><span>        </span><span id="local-6989586621679371911"><span class="annot"><span class="annottext">MS (r (Method r))
</span><a href="#local-6989586621679371911"><span class="hs-identifier hs-var">mthd</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VisibilityTag
-&gt; String
-&gt; VS (r (Type r))
-&gt; String
-&gt; [ParameterChunk]
-&gt; Maybe String
-&gt; [MS (r (Block r))]
-&gt; StateT DrasilState Identity (MS (r (Method r)))
forall {r :: * -&gt; *}.
SharedProg r =&gt;
VisibilityTag
-&gt; String
-&gt; VSType r
-&gt; String
-&gt; [ParameterChunk]
-&gt; Maybe String
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="#local-6989586621679371870"><span class="hs-identifier hs-var">getFunc</span></a></span><span> </span><span class="annot"><span class="annottext">VisibilityTag
</span><a href="#local-6989586621679371695"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679371698"><span class="hs-identifier hs-var">icName</span></a></span><span> </span><span class="annot"><span class="annottext">VS (r (Type r))
forall (r :: * -&gt; *). TypeSym r =&gt; VSType r
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679371910"><span class="hs-identifier hs-var">desc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CodeVarChunk -&gt; ParameterChunk)
-&gt; [CodeVarChunk] -&gt; [ParameterChunk]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">CodeVarChunk -&gt; ParameterChunk
forall c. CodeIdea c =&gt; c -&gt; ParameterChunk
</span><a href="Language.Drasil.Chunk.Parameter.html#pcAuto"><span class="hs-identifier hs-var">pcAuto</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeVarChunk]
</span><a href="#local-6989586621679371893"><span class="hs-identifier hs-var">parms</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-895"></span><span>          </span><span class="annot"><span class="annottext">Maybe String
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[MS (r (Statement r))] -&gt; MS (r (Block r))
forall (r :: * -&gt; *). BlockSym r =&gt; [MSStatement r] -&gt; MSBlock r
</span><span class="hs-identifier hs-var">block</span></span><span> </span><span class="annot"><span class="annottext">[MS (r (Statement r))]
</span><a href="#local-6989586621679371906"><span class="hs-identifier hs-var">sf</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[MS (r (Statement r))] -&gt; MS (r (Block r))
forall (r :: * -&gt; *). BlockSym r =&gt; [MSStatement r] -&gt; MSBlock r
</span><span class="hs-identifier hs-var">block</span></span><span> </span><span class="annot"><span class="annottext">[MS (r (Statement r))]
</span><a href="#local-6989586621679371908"><span class="hs-identifier hs-var">ph</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-896"></span><span>        </span><span class="annot"><span class="annottext">Maybe (MS (r (Method r)))
-&gt; StateT DrasilState Identity (Maybe (MS (r (Method r))))
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (MS (r (Method r)))
 -&gt; StateT DrasilState Identity (Maybe (MS (r (Method r)))))
-&gt; Maybe (MS (r (Method r)))
-&gt; StateT DrasilState Identity (Maybe (MS (r (Method r))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MS (r (Method r)) -&gt; Maybe (MS (r (Method r)))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">MS (r (Method r))
</span><a href="#local-6989586621679371911"><span class="hs-identifier hs-var">mthd</span></a></span><span>
</span><span id="line-897"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; GenState (Maybe (SMethod r))
forall (r :: * -&gt; *).
SharedProg r =&gt;
Bool -&gt; GenState (Maybe (SMethod r))
</span><a href="#local-6989586621679371872"><span class="hs-identifier hs-var">genConstraints</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; GenState (Maybe (SMethod r)))
-&gt; Bool -&gt; GenState (Maybe (SMethod r))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679371698"><span class="hs-identifier hs-var">icName</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Set String -&gt; Bool
forall a. Eq a =&gt; a -&gt; Set a -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; Set String
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#defSet"><span class="hs-identifier hs-var">defSet</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679371696"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-898"></span><span>
</span><span id="line-899"></span><span class="annot"><span class="hs-comment">-- | Generates input constraints code block for checking software constraints.</span></span><span>
</span><span id="line-900"></span><span id="local-6989586621679363512"><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#sfwrCBodyProc"><span class="hs-identifier hs-type">sfwrCBodyProc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679363512"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CodeVarChunk</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#ConstraintCE"><span class="hs-identifier hs-type">ConstraintCE</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-901"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSStatement</span></span><span> </span><span class="annot"><a href="#local-6989586621679363512"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-902"></span><span id="sfwrCBodyProc"><span class="annot"><span class="annottext">sfwrCBodyProc :: forall (r :: * -&gt; *).
SharedProg r =&gt;
[(CodeVarChunk, [ConstraintCE])] -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Modules.html#sfwrCBodyProc"><span class="hs-identifier hs-var hs-var">sfwrCBodyProc</span></a></span></span><span> </span><span id="local-6989586621679371916"><span class="annot"><span class="annottext">[(CodeVarChunk, [ConstraintCE])]
</span><a href="#local-6989586621679371916"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-903"></span><span>  </span><span id="local-6989586621679371917"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679371917"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-904"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679371918"><span class="annot"><span class="annottext">cb :: ConstraintBehaviour
</span><a href="#local-6989586621679371918"><span class="hs-identifier hs-var hs-var">cb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; ConstraintBehaviour
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#onSfwrC"><span class="hs-identifier hs-var">onSfwrC</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679371917"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-905"></span><span>  </span><span class="annot"><span class="annottext">ConstraintBehaviour
-&gt; [(CodeVarChunk, [ConstraintCE])] -&gt; GenState [MSStatement r]
forall (r :: * -&gt; *).
SharedProg r =&gt;
ConstraintBehaviour
-&gt; [(CodeVarChunk, [ConstraintCE])] -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Modules.html#chooseConstrProc"><span class="hs-identifier hs-var">chooseConstrProc</span></a></span><span> </span><span class="annot"><span class="annottext">ConstraintBehaviour
</span><a href="#local-6989586621679371918"><span class="hs-identifier hs-var">cb</span></a></span><span> </span><span class="annot"><span class="annottext">[(CodeVarChunk, [ConstraintCE])]
</span><a href="#local-6989586621679371916"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-906"></span><span>
</span><span id="line-907"></span><span class="annot"><span class="hs-comment">-- | Generates input constraints code block for checking physical constraints.</span></span><span>
</span><span id="line-908"></span><span id="local-6989586621679371920"><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#physCBodyProc"><span class="hs-identifier hs-type">physCBodyProc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679371920"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CodeVarChunk</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#ConstraintCE"><span class="hs-identifier hs-type">ConstraintCE</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-909"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSStatement</span></span><span> </span><span class="annot"><a href="#local-6989586621679371920"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-910"></span><span id="physCBodyProc"><span class="annot"><span class="annottext">physCBodyProc :: forall (r :: * -&gt; *).
SharedProg r =&gt;
[(CodeVarChunk, [ConstraintCE])] -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Modules.html#physCBodyProc"><span class="hs-identifier hs-var hs-var">physCBodyProc</span></a></span></span><span> </span><span id="local-6989586621679371925"><span class="annot"><span class="annottext">[(CodeVarChunk, [ConstraintCE])]
</span><a href="#local-6989586621679371925"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-911"></span><span>  </span><span id="local-6989586621679371926"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679371926"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-912"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679371927"><span class="annot"><span class="annottext">cb :: ConstraintBehaviour
</span><a href="#local-6989586621679371927"><span class="hs-identifier hs-var hs-var">cb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; ConstraintBehaviour
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#onPhysC"><span class="hs-identifier hs-var">onPhysC</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679371926"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-913"></span><span>  </span><span class="annot"><span class="annottext">ConstraintBehaviour
-&gt; [(CodeVarChunk, [ConstraintCE])] -&gt; GenState [MSStatement r]
forall (r :: * -&gt; *).
SharedProg r =&gt;
ConstraintBehaviour
-&gt; [(CodeVarChunk, [ConstraintCE])] -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Modules.html#chooseConstrProc"><span class="hs-identifier hs-var">chooseConstrProc</span></a></span><span> </span><span class="annot"><span class="annottext">ConstraintBehaviour
</span><a href="#local-6989586621679371927"><span class="hs-identifier hs-var">cb</span></a></span><span> </span><span class="annot"><span class="annottext">[(CodeVarChunk, [ConstraintCE])]
</span><a href="#local-6989586621679371925"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-914"></span><span>
</span><span id="line-915"></span><span class="hs-comment">-- | Generates conditional statements for checking constraints, where the</span><span>
</span><span id="line-916"></span><span class="hs-comment">-- bodies depend on user's choice of constraint violation behaviour.</span><span>
</span><span id="line-917"></span><span id="local-6989586621679363514"><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#chooseConstrProc"><span class="hs-identifier hs-type">chooseConstrProc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679363514"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#ConstraintBehaviour"><span class="hs-identifier hs-type">ConstraintBehaviour</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-918"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CodeVarChunk</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#ConstraintCE"><span class="hs-identifier hs-type">ConstraintCE</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSStatement</span></span><span> </span><span class="annot"><a href="#local-6989586621679363514"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-919"></span><span id="chooseConstrProc"><span class="annot"><span class="annottext">chooseConstrProc :: forall (r :: * -&gt; *).
SharedProg r =&gt;
ConstraintBehaviour
-&gt; [(CodeVarChunk, [ConstraintCE])] -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Modules.html#chooseConstrProc"><span class="hs-identifier hs-var hs-var">chooseConstrProc</span></a></span></span><span> </span><span id="local-6989586621679371947"><span class="annot"><span class="annottext">ConstraintBehaviour
</span><a href="#local-6989586621679371947"><span class="hs-identifier hs-var">cb</span></a></span></span><span> </span><span id="local-6989586621679371948"><span class="annot"><span class="annottext">[(CodeVarChunk, [ConstraintCE])]
</span><a href="#local-6989586621679371948"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-920"></span><span>  </span><span id="local-6989586621679371949"><span class="annot"><span class="annottext">[[VS (r (Value r))]]
</span><a href="#local-6989586621679371949"><span class="hs-identifier hs-var">conds</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((CodeVarChunk, [ConstraintCE])
 -&gt; StateT DrasilState Identity [VS (r (Value r))])
-&gt; [(CodeVarChunk, [ConstraintCE])]
-&gt; StateT DrasilState Identity [[VS (r (Value r))]]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679371950"><span class="annot"><span class="annottext">CodeVarChunk
</span><a href="#local-6989586621679371950"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679371951"><span class="annot"><span class="annottext">[ConstraintCE]
</span><a href="#local-6989586621679371951"><span class="hs-identifier hs-var">cns</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(ConstraintCE -&gt; StateT DrasilState Identity (VS (r (Value r))))
-&gt; [ConstraintCE] -&gt; StateT DrasilState Identity [VS (r (Value r))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">(CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r))))
-&gt; (ConstraintCE -&gt; CodeExpr)
-&gt; ConstraintCE
-&gt; StateT DrasilState Identity (VS (r (Value r)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CodeVarChunk -&gt; ConstraintCE -&gt; CodeExpr
forall c. (HasUID c, HasSymbol c) =&gt; c -&gt; ConstraintCE -&gt; CodeExpr
</span><a href="Language.Drasil.Code.Imperative.Import.html#renderC"><span class="hs-identifier hs-var">renderC</span></a></span><span> </span><span class="annot"><span class="annottext">CodeVarChunk
</span><a href="#local-6989586621679371950"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ConstraintCE]
</span><a href="#local-6989586621679371951"><span class="hs-identifier hs-var">cns</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(CodeVarChunk, [ConstraintCE])]
</span><a href="#local-6989586621679371948"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-921"></span><span>  </span><span id="local-6989586621679371952"><span class="annot"><span class="annottext">[[MS (r (Body r))]]
</span><a href="#local-6989586621679371952"><span class="hs-identifier hs-var">bods</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((CodeVarChunk, [ConstraintCE])
 -&gt; StateT DrasilState Identity [MS (r (Body r))])
-&gt; [(CodeVarChunk, [ConstraintCE])]
-&gt; StateT DrasilState Identity [[MS (r (Body r))]]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConstraintBehaviour
-&gt; (CodeVarChunk, [ConstraintCE])
-&gt; StateT DrasilState Identity [MS (r (Body r))]
forall {r :: * -&gt; *}.
SharedProg r =&gt;
ConstraintBehaviour
-&gt; (CodeVarChunk, [ConstraintCE]) -&gt; GenState [MS (r (Body r))]
</span><a href="#local-6989586621679371953"><span class="hs-identifier hs-var">chooseCB</span></a></span><span> </span><span class="annot"><span class="annottext">ConstraintBehaviour
</span><a href="#local-6989586621679371947"><span class="hs-identifier hs-var">cb</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(CodeVarChunk, [ConstraintCE])]
</span><a href="#local-6989586621679371948"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-922"></span><span>  </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; GenState [MSStatement r]
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([MSStatement r] -&gt; GenState [MSStatement r])
-&gt; [MSStatement r] -&gt; GenState [MSStatement r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[MSStatement r]] -&gt; [MSStatement r]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">([[MSStatement r]] -&gt; [MSStatement r])
-&gt; [[MSStatement r]] -&gt; [MSStatement r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">([VS (r (Value r))] -&gt; [MS (r (Body r))] -&gt; [MSStatement r])
-&gt; [[VS (r (Value r))]] -&gt; [[MS (r (Body r))]] -&gt; [[MSStatement r]]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(VS (r (Value r)) -&gt; MS (r (Body r)) -&gt; MSStatement r)
-&gt; [VS (r (Value r))] -&gt; [MS (r (Body r))] -&gt; [MSStatement r]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679371954"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679371954"><span class="hs-identifier hs-var">cond</span></a></span></span><span> </span><span id="local-6989586621679371955"><span class="annot"><span class="annottext">MS (r (Body r))
</span><a href="#local-6989586621679371955"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[(VS (r (Value r)), MS (r (Body r)))] -&gt; MSStatement r
forall (r :: * -&gt; *).
ControlStatement r =&gt;
[(SValue r, MSBody r)] -&gt; MSStatement r
</span><span class="hs-identifier hs-var">ifNoElse</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">VS (r (Value r)) -&gt; VS (r (Value r))
forall (r :: * -&gt; *). BooleanExpression r =&gt; SValue r -&gt; SValue r
</span><span class="hs-operator hs-var">(?!)</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679371954"><span class="hs-identifier hs-var">cond</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MS (r (Body r))
</span><a href="#local-6989586621679371955"><span class="hs-identifier hs-var">bod</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-923"></span><span>    </span><span class="annot"><span class="annottext">[[VS (r (Value r))]]
</span><a href="#local-6989586621679371949"><span class="hs-identifier hs-var">conds</span></a></span><span> </span><span class="annot"><span class="annottext">[[MS (r (Body r))]]
</span><a href="#local-6989586621679371952"><span class="hs-identifier hs-var">bods</span></a></span><span>
</span><span id="line-924"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679371953"><span class="annot"><span class="annottext">chooseCB :: ConstraintBehaviour
-&gt; (CodeVarChunk, [ConstraintCE]) -&gt; GenState [MS (r (Body r))]
</span><a href="#local-6989586621679371953"><span class="hs-identifier hs-var hs-var">chooseCB</span></a></span></span><span> </span><span class="annot"><span class="annottext">ConstraintBehaviour
</span><a href="Language.Drasil.Choices.html#Warning"><span class="hs-identifier hs-var">Warning</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CodeVarChunk, [ConstraintCE]) -&gt; GenState [MS (r (Body r))]
forall (r :: * -&gt; *).
SharedProg r =&gt;
(CodeVarChunk, [ConstraintCE]) -&gt; GenState [MSBody r]
</span><a href="Language.Drasil.Code.Imperative.Modules.html#constrWarnProc"><span class="hs-identifier hs-var">constrWarnProc</span></a></span><span>
</span><span id="line-925"></span><span>        </span><span class="annot"><a href="#local-6989586621679371953"><span class="hs-identifier hs-var">chooseCB</span></a></span><span> </span><span class="annot"><span class="annottext">ConstraintBehaviour
</span><a href="Language.Drasil.Choices.html#Exception"><span class="hs-identifier hs-var">Exception</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CodeVarChunk, [ConstraintCE]) -&gt; GenState [MS (r (Body r))]
forall (r :: * -&gt; *).
SharedProg r =&gt;
(CodeVarChunk, [ConstraintCE]) -&gt; GenState [MSBody r]
</span><a href="Language.Drasil.Code.Imperative.Modules.html#constrExcProc"><span class="hs-identifier hs-var">constrExcProc</span></a></span><span>
</span><span id="line-926"></span><span>
</span><span id="line-927"></span><span class="hs-comment">-- | Generates body defining constraint violation behaviour if Warning chosen from 'chooseConstr'.</span><span>
</span><span id="line-928"></span><span class="hs-comment">-- Prints a \&quot;Warning\&quot; message followed by a message that says</span><span>
</span><span id="line-929"></span><span class="hs-comment">-- what value was \&quot;suggested\&quot;.</span><span>
</span><span id="line-930"></span><span id="local-6989586621679363518"><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#constrWarnProc"><span class="hs-identifier hs-type">constrWarnProc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679363518"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CodeVarChunk</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#ConstraintCE"><span class="hs-identifier hs-type">ConstraintCE</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-931"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSBody</span></span><span> </span><span class="annot"><a href="#local-6989586621679363518"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-932"></span><span id="constrWarnProc"><span class="annot"><span class="annottext">constrWarnProc :: forall (r :: * -&gt; *).
SharedProg r =&gt;
(CodeVarChunk, [ConstraintCE]) -&gt; GenState [MSBody r]
</span><a href="Language.Drasil.Code.Imperative.Modules.html#constrWarnProc"><span class="hs-identifier hs-var hs-var">constrWarnProc</span></a></span></span><span> </span><span id="local-6989586621679372137"><span class="annot"><span class="annottext">(CodeVarChunk, [ConstraintCE])
</span><a href="#local-6989586621679372137"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-933"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679372138"><span class="annot"><span class="annottext">q :: CodeVarChunk
</span><a href="#local-6989586621679372138"><span class="hs-identifier hs-var hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CodeVarChunk, [ConstraintCE]) -&gt; CodeVarChunk
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(CodeVarChunk, [ConstraintCE])
</span><a href="#local-6989586621679372137"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-934"></span><span>      </span><span id="local-6989586621679372139"><span class="annot"><span class="annottext">cs :: [ConstraintCE]
</span><a href="#local-6989586621679372139"><span class="hs-identifier hs-var hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CodeVarChunk, [ConstraintCE]) -&gt; [ConstraintCE]
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(CodeVarChunk, [ConstraintCE])
</span><a href="#local-6989586621679372137"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-935"></span><span>  </span><span id="local-6989586621679372140"><span class="annot"><span class="annottext">[[MS (r (Statement r))]]
</span><a href="#local-6989586621679372140"><span class="hs-identifier hs-var">msgs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ConstraintCE
 -&gt; StateT DrasilState Identity [MS (r (Statement r))])
-&gt; [ConstraintCE]
-&gt; StateT DrasilState Identity [[MS (r (Statement r))]]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeVarChunk
-&gt; String
-&gt; ConstraintCE
-&gt; StateT DrasilState Identity [MS (r (Statement r))]
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeVarChunk -&gt; String -&gt; ConstraintCE -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Modules.html#constraintViolatedMsgProc"><span class="hs-identifier hs-var">constraintViolatedMsgProc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeVarChunk
</span><a href="#local-6989586621679372138"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;suggested&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ConstraintCE]
</span><a href="#local-6989586621679372139"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-936"></span><span>  </span><span class="annot"><span class="annottext">[MSBody r] -&gt; GenState [MSBody r]
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([MSBody r] -&gt; GenState [MSBody r])
-&gt; [MSBody r] -&gt; GenState [MSBody r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">([MS (r (Statement r))] -&gt; MSBody r)
-&gt; [[MS (r (Statement r))]] -&gt; [MSBody r]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MS (r (Statement r))] -&gt; MSBody r
forall (r :: * -&gt; *). BodySym r =&gt; [MSStatement r] -&gt; MSBody r
</span><span class="hs-identifier hs-var">bodyStatements</span></span><span> </span><span class="annot"><span class="annottext">([MS (r (Statement r))] -&gt; MSBody r)
-&gt; ([MS (r (Statement r))] -&gt; [MS (r (Statement r))])
-&gt; [MS (r (Statement r))]
-&gt; MSBody r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; MS (r (Statement r))
forall (r :: * -&gt; *). IOStatement r =&gt; String -&gt; MSStatement r
</span><span class="hs-identifier hs-var">printStr</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Warning: &quot;</span></span><span> </span><span class="annot"><span class="annottext">MS (r (Statement r))
-&gt; [MS (r (Statement r))] -&gt; [MS (r (Statement r))]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[[MS (r (Statement r))]]
</span><a href="#local-6989586621679372140"><span class="hs-identifier hs-var">msgs</span></a></span><span>
</span><span id="line-937"></span><span>
</span><span id="line-938"></span><span class="hs-comment">-- | Generates body defining constraint violation behaviour if Exception chosen from 'chooseConstr'.</span><span>
</span><span id="line-939"></span><span class="hs-comment">-- Prints a message that says what value was \&quot;expected\&quot;,</span><span>
</span><span id="line-940"></span><span class="hs-comment">-- followed by throwing an exception.</span><span>
</span><span id="line-941"></span><span id="local-6989586621679372142"><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#constrExcProc"><span class="hs-identifier hs-type">constrExcProc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679372142"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CodeVarChunk</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#ConstraintCE"><span class="hs-identifier hs-type">ConstraintCE</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-942"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSBody</span></span><span> </span><span class="annot"><a href="#local-6989586621679372142"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-943"></span><span id="constrExcProc"><span class="annot"><span class="annottext">constrExcProc :: forall (r :: * -&gt; *).
SharedProg r =&gt;
(CodeVarChunk, [ConstraintCE]) -&gt; GenState [MSBody r]
</span><a href="Language.Drasil.Code.Imperative.Modules.html#constrExcProc"><span class="hs-identifier hs-var hs-var">constrExcProc</span></a></span></span><span> </span><span id="local-6989586621679372153"><span class="annot"><span class="annottext">(CodeVarChunk, [ConstraintCE])
</span><a href="#local-6989586621679372153"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-944"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679372154"><span class="annot"><span class="annottext">q :: CodeVarChunk
</span><a href="#local-6989586621679372154"><span class="hs-identifier hs-var hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CodeVarChunk, [ConstraintCE]) -&gt; CodeVarChunk
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(CodeVarChunk, [ConstraintCE])
</span><a href="#local-6989586621679372153"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-945"></span><span>      </span><span id="local-6989586621679372155"><span class="annot"><span class="annottext">cs :: [ConstraintCE]
</span><a href="#local-6989586621679372155"><span class="hs-identifier hs-var hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CodeVarChunk, [ConstraintCE]) -&gt; [ConstraintCE]
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(CodeVarChunk, [ConstraintCE])
</span><a href="#local-6989586621679372153"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-946"></span><span>  </span><span id="local-6989586621679372156"><span class="annot"><span class="annottext">[[MS (r (Statement r))]]
</span><a href="#local-6989586621679372156"><span class="hs-identifier hs-var">msgs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ConstraintCE
 -&gt; StateT DrasilState Identity [MS (r (Statement r))])
-&gt; [ConstraintCE]
-&gt; StateT DrasilState Identity [[MS (r (Statement r))]]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeVarChunk
-&gt; String
-&gt; ConstraintCE
-&gt; StateT DrasilState Identity [MS (r (Statement r))]
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeVarChunk -&gt; String -&gt; ConstraintCE -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Modules.html#constraintViolatedMsgProc"><span class="hs-identifier hs-var">constraintViolatedMsgProc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeVarChunk
</span><a href="#local-6989586621679372154"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;expected&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ConstraintCE]
</span><a href="#local-6989586621679372155"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-947"></span><span>  </span><span class="annot"><span class="annottext">[MSBody r] -&gt; GenState [MSBody r]
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([MSBody r] -&gt; GenState [MSBody r])
-&gt; [MSBody r] -&gt; GenState [MSBody r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">([MS (r (Statement r))] -&gt; MSBody r)
-&gt; [[MS (r (Statement r))]] -&gt; [MSBody r]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MS (r (Statement r))] -&gt; MSBody r
forall (r :: * -&gt; *). BodySym r =&gt; [MSStatement r] -&gt; MSBody r
</span><span class="hs-identifier hs-var">bodyStatements</span></span><span> </span><span class="annot"><span class="annottext">([MS (r (Statement r))] -&gt; MSBody r)
-&gt; ([MS (r (Statement r))] -&gt; [MS (r (Statement r))])
-&gt; [MS (r (Statement r))]
-&gt; MSBody r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MS (r (Statement r))]
-&gt; [MS (r (Statement r))] -&gt; [MS (r (Statement r))]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; MS (r (Statement r))
forall (r :: * -&gt; *). ControlStatement r =&gt; String -&gt; MSStatement r
</span><span class="hs-identifier hs-var">throw</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;InputError&quot;</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[[MS (r (Statement r))]]
</span><a href="#local-6989586621679372156"><span class="hs-identifier hs-var">msgs</span></a></span><span>
</span><span id="line-948"></span><span>
</span><span id="line-949"></span><span class="hs-comment">-- | Generates statements that print a message for when a constraint is violated.</span><span>
</span><span id="line-950"></span><span class="hs-comment">-- Message includes the name of the cosntraint quantity, its value, and a</span><span>
</span><span id="line-951"></span><span class="hs-comment">-- description of the constraint that is violated.</span><span>
</span><span id="line-952"></span><span id="local-6989586621679363520"><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#constraintViolatedMsgProc"><span class="hs-identifier hs-type">constraintViolatedMsgProc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679363520"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CodeVarChunk</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-953"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#ConstraintCE"><span class="hs-identifier hs-type">ConstraintCE</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSStatement</span></span><span> </span><span class="annot"><a href="#local-6989586621679363520"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-954"></span><span id="constraintViolatedMsgProc"><span class="annot"><span class="annottext">constraintViolatedMsgProc :: forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeVarChunk -&gt; String -&gt; ConstraintCE -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Modules.html#constraintViolatedMsgProc"><span class="hs-identifier hs-var hs-var">constraintViolatedMsgProc</span></a></span></span><span> </span><span id="local-6989586621679372174"><span class="annot"><span class="annottext">CodeVarChunk
</span><a href="#local-6989586621679372174"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621679372175"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679372175"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679372176"><span class="annot"><span class="annottext">ConstraintCE
</span><a href="#local-6989586621679372176"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-955"></span><span>  </span><span id="local-6989586621679372177"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679372177"><span class="hs-identifier hs-var">pc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ConstraintCE -&gt; GenState [MSStatement r]
forall (r :: * -&gt; *).
SharedProg r =&gt;
ConstraintCE -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Modules.html#printConstraintProc"><span class="hs-identifier hs-var">printConstraintProc</span></a></span><span> </span><span class="annot"><span class="annottext">ConstraintCE
</span><a href="#local-6989586621679372176"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-956"></span><span>  </span><span id="local-6989586621679372179"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679372179"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeVarChunk -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeVarChunk -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkValProc"><span class="hs-identifier hs-var">mkValProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeVarChunk -&gt; CodeVarChunk
forall c.
(Quantity c, MayHaveUnit c, Concept c) =&gt;
c -&gt; CodeVarChunk
</span><a href="Language.Drasil.Chunk.CodeBase.html#quantvar"><span class="hs-identifier hs-var">quantvar</span></a></span><span> </span><span class="annot"><span class="annottext">CodeVarChunk
</span><a href="#local-6989586621679372174"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-957"></span><span>  </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; GenState [MSStatement r]
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([MSStatement r] -&gt; GenState [MSStatement r])
-&gt; [MSStatement r] -&gt; GenState [MSStatement r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; MSStatement r
forall (r :: * -&gt; *). IOStatement r =&gt; String -&gt; MSStatement r
</span><span class="hs-identifier hs-var">printStr</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; MSStatement r) -&gt; String -&gt; MSStatement r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CodeVarChunk -&gt; String
forall c. CodeIdea c =&gt; c -&gt; String
</span><span class="hs-identifier hs-var">codeName</span></span><span> </span><span class="annot"><span class="annottext">CodeVarChunk
</span><a href="#local-6989586621679372174"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; has value &quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-958"></span><span>    </span><span class="annot"><span class="annottext">VS (r (Value r)) -&gt; MSStatement r
forall (r :: * -&gt; *). IOStatement r =&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679372179"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-959"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; MSStatement r
forall (r :: * -&gt; *). IOStatement r =&gt; String -&gt; MSStatement r
</span><span class="hs-identifier hs-var">printStr</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; MSStatement r) -&gt; String -&gt; MSStatement r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;, but is &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679372175"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; to be &quot;</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; [MSStatement r] -&gt; [MSStatement r]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679372177"><span class="hs-identifier hs-var">pc</span></a></span><span>
</span><span id="line-960"></span><span>
</span><span id="line-961"></span><span class="hs-comment">-- | Generates statements to print descriptions of constraints, using words and</span><span>
</span><span id="line-962"></span><span class="hs-comment">-- the constrained values. Constrained values are followed by printing the</span><span>
</span><span id="line-963"></span><span class="hs-comment">-- expression they originated from, using printExpr.</span><span>
</span><span id="line-964"></span><span id="local-6989586621679363523"><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#printConstraintProc"><span class="hs-identifier hs-type">printConstraintProc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679363523"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#ConstraintCE"><span class="hs-identifier hs-type">ConstraintCE</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-965"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSStatement</span></span><span> </span><span class="annot"><a href="#local-6989586621679363523"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-966"></span><span id="printConstraintProc"><span class="annot"><span class="annottext">printConstraintProc :: forall (r :: * -&gt; *).
SharedProg r =&gt;
ConstraintCE -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Modules.html#printConstraintProc"><span class="hs-identifier hs-var hs-var">printConstraintProc</span></a></span></span><span> </span><span id="local-6989586621679372184"><span class="annot"><span class="annottext">ConstraintCE
</span><a href="#local-6989586621679372184"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-967"></span><span>  </span><span id="local-6989586621679372185"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679372185"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-968"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679372188"><span class="annot"><span class="annottext">db :: ChunkDB
</span><a href="#local-6989586621679372188"><span class="hs-identifier hs-var hs-var">db</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; CodeSpec
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#codeSpec"><span class="hs-identifier hs-var">codeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679372185"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">CodeSpec -&gt; Getting ChunkDB CodeSpec ChunkDB -&gt; ChunkDB
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting ChunkDB CodeSpec ChunkDB
forall c. HasOldCodeSpec c =&gt; Lens' c ChunkDB
Lens' CodeSpec ChunkDB
</span><a href="Language.Drasil.CodeSpec.html#systemdbO"><span class="hs-identifier hs-var">systemdbO</span></a></span><span>
</span><span id="line-969"></span><span>      </span><span id="local-6989586621679372189"><span class="annot"><a href="#local-6989586621679372190"><span class="hs-identifier hs-type">printConstraint'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679372189"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#ConstraintCE"><span class="hs-identifier hs-type">ConstraintCE</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span>
</span><span id="line-970"></span><span>        </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSStatement</span></span><span> </span><span class="annot"><a href="#local-6989586621679372189"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-971"></span><span>      </span><span id="local-6989586621679372190"><span class="annot"><span class="annottext">printConstraint' :: forall (r :: * -&gt; *).
SharedProg r =&gt;
ConstraintCE -&gt; GenState [MSStatement r]
</span><a href="#local-6989586621679372190"><span class="hs-identifier hs-var hs-var">printConstraint'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Range</span></span><span> </span><span class="annot"><span class="annottext">ConstraintReason
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bounded</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Inclusive
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679372225"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679372225"><span class="hs-identifier hs-var">e1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Inclusive
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679372226"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679372226"><span class="hs-identifier hs-var">e2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-972"></span><span>        </span><span id="local-6989586621679372227"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679372227"><span class="hs-identifier hs-var">lb</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679372225"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-973"></span><span>        </span><span id="local-6989586621679372228"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679372228"><span class="hs-identifier hs-var">ub</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679372226"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-974"></span><span>        </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; GenState [MSStatement r]
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([MSStatement r] -&gt; GenState [MSStatement r])
-&gt; [MSStatement r] -&gt; GenState [MSStatement r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; MSStatement r
forall (r :: * -&gt; *). IOStatement r =&gt; String -&gt; MSStatement r
</span><span class="hs-identifier hs-var">printStr</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;between &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VS (r (Value r)) -&gt; MSStatement r
forall (r :: * -&gt; *). IOStatement r =&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679372227"><span class="hs-identifier hs-var">lb</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; [MSStatement r] -&gt; [MSStatement r]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; ChunkDB -&gt; [MSStatement r]
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; ChunkDB -&gt; [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Modules.html#printExpr"><span class="hs-identifier hs-var">printExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679372225"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679372188"><span class="hs-identifier hs-var">db</span></a></span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; [MSStatement r] -&gt; [MSStatement r]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-975"></span><span>          </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; MSStatement r
forall (r :: * -&gt; *). IOStatement r =&gt; String -&gt; MSStatement r
</span><span class="hs-identifier hs-var">printStr</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; and &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VS (r (Value r)) -&gt; MSStatement r
forall (r :: * -&gt; *). IOStatement r =&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679372228"><span class="hs-identifier hs-var">ub</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; [MSStatement r] -&gt; [MSStatement r]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; ChunkDB -&gt; [MSStatement r]
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; ChunkDB -&gt; [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Modules.html#printExpr"><span class="hs-identifier hs-var">printExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679372226"><span class="hs-identifier hs-var">e2</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679372188"><span class="hs-identifier hs-var">db</span></a></span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; [MSStatement r] -&gt; [MSStatement r]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; MSStatement r
forall (r :: * -&gt; *). IOStatement r =&gt; String -&gt; MSStatement r
</span><span class="hs-identifier hs-var">printStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-976"></span><span>      </span><span class="annot"><a href="#local-6989586621679372190"><span class="hs-identifier hs-var">printConstraint'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Range</span></span><span> </span><span class="annot"><span class="annottext">ConstraintReason
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UpTo</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Inclusive
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679372229"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679372229"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-977"></span><span>        </span><span id="local-6989586621679372230"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679372230"><span class="hs-identifier hs-var">ub</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679372229"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-978"></span><span>        </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; GenState [MSStatement r]
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([MSStatement r] -&gt; GenState [MSStatement r])
-&gt; [MSStatement r] -&gt; GenState [MSStatement r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; MSStatement r
forall (r :: * -&gt; *). IOStatement r =&gt; String -&gt; MSStatement r
</span><span class="hs-identifier hs-var">printStr</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;below &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VS (r (Value r)) -&gt; MSStatement r
forall (r :: * -&gt; *). IOStatement r =&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679372230"><span class="hs-identifier hs-var">ub</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; [MSStatement r] -&gt; [MSStatement r]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; ChunkDB -&gt; [MSStatement r]
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; ChunkDB -&gt; [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Modules.html#printExpr"><span class="hs-identifier hs-var">printExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679372229"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679372188"><span class="hs-identifier hs-var">db</span></a></span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; [MSStatement r] -&gt; [MSStatement r]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-979"></span><span>          </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; MSStatement r
forall (r :: * -&gt; *). IOStatement r =&gt; String -&gt; MSStatement r
</span><span class="hs-identifier hs-var">printStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-980"></span><span>      </span><span class="annot"><a href="#local-6989586621679372190"><span class="hs-identifier hs-var">printConstraint'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Range</span></span><span> </span><span class="annot"><span class="annottext">ConstraintReason
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UpFrom</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Inclusive
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679372231"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679372231"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-981"></span><span>        </span><span id="local-6989586621679372232"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679372232"><span class="hs-identifier hs-var">lb</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679372231"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-982"></span><span>        </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; GenState [MSStatement r]
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([MSStatement r] -&gt; GenState [MSStatement r])
-&gt; [MSStatement r] -&gt; GenState [MSStatement r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; MSStatement r
forall (r :: * -&gt; *). IOStatement r =&gt; String -&gt; MSStatement r
</span><span class="hs-identifier hs-var">printStr</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;above &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VS (r (Value r)) -&gt; MSStatement r
forall (r :: * -&gt; *). IOStatement r =&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679372232"><span class="hs-identifier hs-var">lb</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; [MSStatement r] -&gt; [MSStatement r]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; ChunkDB -&gt; [MSStatement r]
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; ChunkDB -&gt; [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Modules.html#printExpr"><span class="hs-identifier hs-var">printExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679372231"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679372188"><span class="hs-identifier hs-var">db</span></a></span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; [MSStatement r] -&gt; [MSStatement r]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; MSStatement r
forall (r :: * -&gt; *). IOStatement r =&gt; String -&gt; MSStatement r
</span><span class="hs-identifier hs-var">printStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-983"></span><span>      </span><span class="annot"><a href="#local-6989586621679372190"><span class="hs-identifier hs-var">printConstraint'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Elem</span></span><span> </span><span class="annot"><span class="annottext">ConstraintReason
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679372233"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679372233"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-984"></span><span>        </span><span id="local-6989586621679372234"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679372234"><span class="hs-identifier hs-var">lb</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679372233"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-985"></span><span>        </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; GenState [MSStatement r]
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([MSStatement r] -&gt; GenState [MSStatement r])
-&gt; [MSStatement r] -&gt; GenState [MSStatement r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; MSStatement r
forall (r :: * -&gt; *). IOStatement r =&gt; String -&gt; MSStatement r
</span><span class="hs-identifier hs-var">printStr</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;an element of the set &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VS (r (Value r)) -&gt; MSStatement r
forall (r :: * -&gt; *). IOStatement r =&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679372234"><span class="hs-identifier hs-var">lb</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; [MSStatement r] -&gt; [MSStatement r]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; MSStatement r
forall (r :: * -&gt; *). IOStatement r =&gt; String -&gt; MSStatement r
</span><span class="hs-identifier hs-var">printStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-986"></span><span>  </span><span class="annot"><span class="annottext">ConstraintCE -&gt; GenState [MSStatement r]
forall (r :: * -&gt; *).
SharedProg r =&gt;
ConstraintCE -&gt; GenState [MSStatement r]
</span><a href="#local-6989586621679372190"><span class="hs-identifier hs-var">printConstraint'</span></a></span><span> </span><span class="annot"><span class="annottext">ConstraintCE
</span><a href="#local-6989586621679372184"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-987"></span><span>
</span><span id="line-988"></span><span class="annot"><span class="hs-comment">-- | Generates a module containing the function for printing outputs.</span></span><span>
</span><span id="line-989"></span><span id="local-6989586621679372235"><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genOutputModProc"><span class="hs-identifier hs-type">genOutputModProc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ProcProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679372235"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Proc.SFile</span></span><span> </span><span class="annot"><a href="#local-6989586621679372235"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-990"></span><span id="genOutputModProc"><span class="annot"><span class="annottext">genOutputModProc :: forall (r :: * -&gt; *). ProcProg r =&gt; GenState [SFile r]
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genOutputModProc"><span class="hs-identifier hs-var hs-var">genOutputModProc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-991"></span><span>  </span><span id="local-6989586621679372242"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679372242"><span class="hs-identifier hs-var">ofName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">InternalConcept -&gt; GenState String
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#genICName"><span class="hs-identifier hs-var">genICName</span></a></span><span> </span><span class="annot"><span class="annottext">InternalConcept
</span><a href="Language.Drasil.Choices.html#OutputFormat"><span class="hs-identifier hs-var">OutputFormat</span></a></span><span>
</span><span id="line-992"></span><span>  </span><span id="local-6989586621679372243"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679372243"><span class="hs-identifier hs-var">ofDesc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenState [String] -&gt; GenState String
</span><a href="Language.Drasil.Code.Imperative.Descriptions.html#modDesc"><span class="hs-identifier hs-var">modDesc</span></a></span><span> </span><span class="annot"><span class="annottext">(GenState [String] -&gt; GenState String)
-&gt; GenState [String] -&gt; GenState String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GenState String -&gt; GenState [String]
forall a b. State a b -&gt; State a [b]
</span><a href="Language.Drasil.Code.Imperative.Helpers.html#liftS"><span class="hs-identifier hs-var">liftS</span></a></span><span> </span><span class="annot"><span class="annottext">GenState String
</span><a href="Language.Drasil.Code.Imperative.Descriptions.html#outputFormatDesc"><span class="hs-identifier hs-var">outputFormatDesc</span></a></span><span>
</span><span id="line-993"></span><span>  </span><span class="annot"><span class="annottext">State DrasilState (SFile r) -&gt; GenState [SFile r]
forall a b. State a b -&gt; State a [b]
</span><a href="Language.Drasil.Code.Imperative.Helpers.html#liftS"><span class="hs-identifier hs-var">liftS</span></a></span><span> </span><span class="annot"><span class="annottext">(State DrasilState (SFile r) -&gt; GenState [SFile r])
-&gt; State DrasilState (SFile r) -&gt; GenState [SFile r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
-&gt; String
-&gt; [GenState (Maybe (SMethod r))]
-&gt; State DrasilState (SFile r)
forall (r :: * -&gt; *).
ProcProg r =&gt;
String
-&gt; String -&gt; [GenState (Maybe (SMethod r))] -&gt; GenState (SFile r)
</span><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html#genModuleProc"><span class="hs-identifier hs-var">genModuleProc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679372242"><span class="hs-identifier hs-var">ofName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679372243"><span class="hs-identifier hs-var">ofDesc</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">GenState (Maybe (SMethod r))
forall (r :: * -&gt; *). SharedProg r =&gt; GenState (Maybe (SMethod r))
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genOutputFormatProc"><span class="hs-identifier hs-var">genOutputFormatProc</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-994"></span><span>
</span><span id="line-995"></span><span class="annot"><span class="hs-comment">-- | Generates a function for printing output values.</span></span><span>
</span><span id="line-996"></span><span id="local-6989586621679372244"><span class="annot"><a href="Language.Drasil.Code.Imperative.Modules.html#genOutputFormatProc"><span class="hs-identifier hs-type">genOutputFormatProc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679372244"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679372244"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-997"></span><span id="genOutputFormatProc"><span class="annot"><span class="annottext">genOutputFormatProc :: forall (r :: * -&gt; *). SharedProg r =&gt; GenState (Maybe (SMethod r))
</span><a href="Language.Drasil.Code.Imperative.Modules.html#genOutputFormatProc"><span class="hs-identifier hs-var hs-var">genOutputFormatProc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-998"></span><span>  </span><span id="local-6989586621679372253"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679372253"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-999"></span><span>  </span><span class="annot"><span class="annottext">(DrasilState -&gt; DrasilState) -&gt; StateT DrasilState Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679372254"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679372254"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679372254"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#currentScope"><span class="hs-identifier hs-var">currentScope</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#Local"><span class="hs-identifier hs-type">Local</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-1000"></span><span>  </span><span id="local-6989586621679372255"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679372255"><span class="hs-identifier hs-var">woName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">InternalConcept -&gt; GenState String
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#genICName"><span class="hs-identifier hs-var">genICName</span></a></span><span> </span><span class="annot"><span class="annottext">InternalConcept
</span><a href="Language.Drasil.Choices.html#WriteOutput"><span class="hs-identifier hs-var">WriteOutput</span></a></span><span>
</span><span id="line-1001"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679363529"><span class="annot"><a href="#local-6989586621679372256"><span class="hs-identifier hs-type">genOutput</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679363529"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679363529"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-1002"></span><span>      </span><span id="local-6989586621679372256"><span class="annot"><span class="annottext">genOutput :: forall (r :: * -&gt; *).
SharedProg r =&gt;
Maybe String -&gt; GenState (Maybe (SMethod r))
</span><a href="#local-6989586621679372256"><span class="hs-identifier hs-var hs-var">genOutput</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (MS (r (Method r)))
-&gt; StateT DrasilState Identity (Maybe (MS (r (Method r))))
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe (MS (r (Method r)))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1003"></span><span>      </span><span class="annot"><a href="#local-6989586621679372256"><span class="hs-identifier hs-var">genOutput</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1004"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679372298"><span class="annot"><span class="annottext">l_outfile :: String
</span><a href="#local-6989586621679372298"><span class="hs-identifier hs-var hs-var">l_outfile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;outputfile&quot;</span></span><span>
</span><span id="line-1005"></span><span>            </span><span id="local-6989586621679372302"><span class="annot"><span class="annottext">var_outfile :: SVariable r
</span><a href="#local-6989586621679372302"><span class="hs-identifier hs-var hs-var">var_outfile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; VSType r -&gt; SVariable r
forall (r :: * -&gt; *).
VariableSym r =&gt;
String -&gt; VSType r -&gt; SVariable r
</span><span class="hs-identifier hs-var">var</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679372298"><span class="hs-identifier hs-var">l_outfile</span></a></span><span> </span><span class="annot"><span class="annottext">VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; VSType r
</span><span class="hs-identifier hs-var">outfile</span></span><span>
</span><span id="line-1006"></span><span>            </span><span id="local-6989586621679372308"><span class="annot"><span class="annottext">v_outfile :: SValue r
</span><a href="#local-6989586621679372308"><span class="hs-identifier hs-var hs-var">v_outfile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SVariable r -&gt; SValue r
forall (r :: * -&gt; *). VariableValue r =&gt; SVariable r -&gt; SValue r
</span><span class="hs-identifier hs-var">valueOf</span></span><span> </span><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679372302"><span class="hs-identifier hs-var">var_outfile</span></a></span><span>
</span><span id="line-1007"></span><span>        </span><span id="local-6989586621679372309"><span class="annot"><span class="annottext">[CodeVarChunk]
</span><a href="#local-6989586621679372309"><span class="hs-identifier hs-var">parms</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenState [CodeVarChunk]
</span><a href="Language.Drasil.Code.Imperative.Parameters.html#getOutputParams"><span class="hs-identifier hs-var">getOutputParams</span></a></span><span>
</span><span id="line-1008"></span><span>        </span><span id="local-6989586621679372310"><span class="annot"><span class="annottext">[[MS (r (Statement r))]]
</span><a href="#local-6989586621679372310"><span class="hs-identifier hs-var">outp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(CodeVarChunk
 -&gt; StateT DrasilState Identity [MS (r (Statement r))])
-&gt; [CodeVarChunk]
-&gt; StateT DrasilState Identity [[MS (r (Statement r))]]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679372311"><span class="annot"><span class="annottext">CodeVarChunk
</span><a href="#local-6989586621679372311"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1009"></span><span>          </span><span id="local-6989586621679372312"><span class="annot"><span class="annottext">SValue r
</span><a href="#local-6989586621679372312"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeVarChunk -&gt; StateT DrasilState Identity (SValue r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeVarChunk -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkValProc"><span class="hs-identifier hs-var">mkValProc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeVarChunk
</span><a href="#local-6989586621679372311"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1010"></span><span>          </span><span class="annot"><span class="annottext">[MS (r (Statement r))]
-&gt; StateT DrasilState Identity [MS (r (Statement r))]
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; String -&gt; MS (r (Statement r))
forall (r :: * -&gt; *).
IOStatement r =&gt;
SValue r -&gt; String -&gt; MSStatement r
</span><span class="hs-identifier hs-var">printFileStr</span></span><span> </span><span class="annot"><span class="annottext">SValue r
</span><a href="#local-6989586621679372308"><span class="hs-identifier hs-var">v_outfile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeVarChunk -&gt; String
forall c. CodeIdea c =&gt; c -&gt; String
</span><span class="hs-identifier hs-var">codeName</span></span><span> </span><span class="annot"><span class="annottext">CodeVarChunk
</span><a href="#local-6989586621679372311"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; = &quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1011"></span><span>                   </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r -&gt; MS (r (Statement r))
forall (r :: * -&gt; *).
IOStatement r =&gt;
SValue r -&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">printFileLn</span></span><span> </span><span class="annot"><span class="annottext">SValue r
</span><a href="#local-6989586621679372308"><span class="hs-identifier hs-var">v_outfile</span></a></span><span> </span><span class="annot"><span class="annottext">SValue r
</span><a href="#local-6989586621679372312"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-1012"></span><span>                 </span><span class="hs-special">]</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; CodeSpec
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#codeSpec"><span class="hs-identifier hs-var">codeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679372253"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">CodeSpec
-&gt; Getting [CodeVarChunk] CodeSpec [CodeVarChunk] -&gt; [CodeVarChunk]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting [CodeVarChunk] CodeSpec [CodeVarChunk]
forall c. HasOldCodeSpec c =&gt; Lens' c [CodeVarChunk]
Lens' CodeSpec [CodeVarChunk]
</span><a href="Language.Drasil.CodeSpec.html#outputsO"><span class="hs-identifier hs-var">outputsO</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1013"></span><span>        </span><span id="local-6989586621679372313"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679372313"><span class="hs-identifier hs-var">desc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenState String
</span><a href="Language.Drasil.Code.Imperative.Descriptions.html#woFuncDesc"><span class="hs-identifier hs-var">woFuncDesc</span></a></span><span>
</span><span id="line-1014"></span><span>        </span><span id="local-6989586621679372314"><span class="annot"><span class="annottext">MS (r (Method r))
</span><a href="#local-6989586621679372314"><span class="hs-identifier hs-var">mthd</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; VSType r
-&gt; String
-&gt; [ParameterChunk]
-&gt; Maybe String
-&gt; [MSBlock r]
-&gt; StateT DrasilState Identity (MS (r (Method r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
String
-&gt; VSType r
-&gt; String
-&gt; [ParameterChunk]
-&gt; Maybe String
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#publicFuncProc"><span class="hs-identifier hs-var">publicFuncProc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679372255"><span class="hs-identifier hs-var">woName</span></a></span><span> </span><span class="annot"><span class="annottext">VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; VSType r
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679372313"><span class="hs-identifier hs-var">desc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CodeVarChunk -&gt; ParameterChunk)
-&gt; [CodeVarChunk] -&gt; [ParameterChunk]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">CodeVarChunk -&gt; ParameterChunk
forall c. CodeIdea c =&gt; c -&gt; ParameterChunk
</span><a href="Language.Drasil.Chunk.Parameter.html#pcAuto"><span class="hs-identifier hs-var">pcAuto</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeVarChunk]
</span><a href="#local-6989586621679372309"><span class="hs-identifier hs-var">parms</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe String
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1015"></span><span>          </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[MS (r (Statement r))] -&gt; MSBlock r
forall (r :: * -&gt; *). BlockSym r =&gt; [MSStatement r] -&gt; MSBlock r
</span><span class="hs-identifier hs-var">block</span></span><span> </span><span class="annot"><span class="annottext">([MS (r (Statement r))] -&gt; MSBlock r)
-&gt; [MS (r (Statement r))] -&gt; MSBlock r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-1016"></span><span>          </span><span class="annot"><span class="annottext">SVariable r -&gt; r (Scope r) -&gt; MS (r (Statement r))
forall (r :: * -&gt; *).
DeclStatement r =&gt;
SVariable r -&gt; r (Scope r) -&gt; MSStatement r
</span><span class="hs-identifier hs-var">varDec</span></span><span> </span><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679372302"><span class="hs-identifier hs-var">var_outfile</span></a></span><span> </span><span class="annot"><span class="annottext">r (Scope r)
forall (r :: * -&gt; *). ScopeSym r =&gt; r (Scope r)
</span><span class="hs-identifier hs-var">local</span></span><span class="hs-special">,</span><span>
</span><span id="line-1017"></span><span>          </span><span class="annot"><span class="annottext">SVariable r -&gt; SValue r -&gt; MS (r (Statement r))
forall (r :: * -&gt; *).
IOStatement r =&gt;
SVariable r -&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">openFileW</span></span><span> </span><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679372302"><span class="hs-identifier hs-var">var_outfile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SValue r
forall (r :: * -&gt; *). Literal r =&gt; String -&gt; SValue r
</span><span class="hs-identifier hs-var">litString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;output.txt&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[MS (r (Statement r))]
-&gt; [MS (r (Statement r))] -&gt; [MS (r (Statement r))]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-1018"></span><span>          </span><span class="annot"><span class="annottext">[[MS (r (Statement r))]] -&gt; [MS (r (Statement r))]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">[[MS (r (Statement r))]]
</span><a href="#local-6989586621679372310"><span class="hs-identifier hs-var">outp</span></a></span><span> </span><span class="annot"><span class="annottext">[MS (r (Statement r))]
-&gt; [MS (r (Statement r))] -&gt; [MS (r (Statement r))]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; MS (r (Statement r))
forall (r :: * -&gt; *). IOStatement r =&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">closeFile</span></span><span> </span><span class="annot"><span class="annottext">SValue r
</span><a href="#local-6989586621679372308"><span class="hs-identifier hs-var">v_outfile</span></a></span><span> </span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-1019"></span><span>        </span><span class="annot"><span class="annottext">Maybe (MS (r (Method r)))
-&gt; StateT DrasilState Identity (Maybe (MS (r (Method r))))
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (MS (r (Method r)))
 -&gt; StateT DrasilState Identity (Maybe (MS (r (Method r)))))
-&gt; Maybe (MS (r (Method r)))
-&gt; StateT DrasilState Identity (Maybe (MS (r (Method r))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MS (r (Method r)) -&gt; Maybe (MS (r (Method r)))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">MS (r (Method r))
</span><a href="#local-6989586621679372314"><span class="hs-identifier hs-var">mthd</span></a></span><span>
</span><span id="line-1020"></span><span>  </span><span class="annot"><span class="annottext">Maybe String -&gt; GenState (Maybe (SMethod r))
forall (r :: * -&gt; *).
SharedProg r =&gt;
Maybe String -&gt; GenState (Maybe (SMethod r))
</span><a href="#local-6989586621679372256"><span class="hs-identifier hs-var">genOutput</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe String -&gt; GenState (Maybe (SMethod r)))
-&gt; Maybe String -&gt; GenState (Maybe (SMethod r))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Map String String -&gt; Maybe String
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679372255"><span class="hs-identifier hs-var">woName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; Map String String
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#eMap"><span class="hs-identifier hs-var">eMap</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679372253"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1021"></span></pre></body></html>