<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE PostfixOperators, Rank2Types #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-redundant-constraints #-}</span><span>
</span><span id="line-3"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Language.Drasil.Code.Imperative.Import</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#codeType"><span class="hs-identifier">codeType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#spaceCodeType"><span class="hs-identifier">spaceCodeType</span></a></span><span class="hs-special">,</span><span> </span><span>
</span><span id="line-4"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#publicFunc"><span class="hs-identifier">publicFunc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#privateMethod"><span class="hs-identifier">privateMethod</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#publicInOutFunc"><span class="hs-identifier">publicInOutFunc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#privateInOutMethod"><span class="hs-identifier">privateInOutMethod</span></a></span><span class="hs-special">,</span><span> </span><span>
</span><span id="line-5"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#genConstructor"><span class="hs-identifier">genConstructor</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier">mkVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#mkVal"><span class="hs-identifier">mkVal</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier">convExpr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier">convStmt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#genModDef"><span class="hs-identifier">genModDef</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#genModFuncs"><span class="hs-identifier">genModFuncs</span></a></span><span class="hs-special">,</span><span> </span><span>
</span><span id="line-6"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#genModClasses"><span class="hs-identifier">genModClasses</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#readData"><span class="hs-identifier">readData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#renderC"><span class="hs-identifier">renderC</span></a></span><span>
</span><span id="line-7"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Language.Drasil</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">HasSymbol</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">HasUID</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">HasSpace</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-10"></span><span>  </span><span class="annot"><span class="hs-identifier">Space</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">RealInterval</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">UID</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Constraint</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Inclusive</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Database.Drasil</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">symbResolve</span></span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Language.Drasil.CodeExpr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">sy</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">($&lt;)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">($&gt;)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">($&lt;=)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">($&gt;=)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">($&amp;&amp;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Language.Drasil.Code.Expr.Development</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">CodeExpr</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ArithBinOp</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>  </span><span class="annot"><span class="hs-identifier">AssocArithOper</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">AssocBoolOper</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">BoolBinOp</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">EqBinOp</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>  </span><span class="annot"><span class="hs-identifier">LABinOp</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">OrdBinOp</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">UFunc</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">UFuncB</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">UFuncVV</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">UFuncVN</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>  </span><span class="annot"><span class="hs-identifier">VVNBinOp</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">VVVBinOp</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Comments.html"><span class="hs-identifier">Language.Drasil.Code.Imperative.Comments</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Code.Imperative.Comments.html#getComment"><span class="hs-identifier">getComment</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.ConceptMatch.html"><span class="hs-identifier">Language.Drasil.Code.Imperative.ConceptMatch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Code.Imperative.ConceptMatch.html#conceptToGOOL"><span class="hs-identifier">conceptToGOOL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html"><span class="hs-identifier">Language.Drasil.Code.Imperative.GenerateGOOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html#auxClass"><span class="hs-identifier">auxClass</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html#fApp"><span class="hs-identifier">fApp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html#ctorCall"><span class="hs-identifier">ctorCall</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html#genModuleWithImports"><span class="hs-identifier">genModuleWithImports</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html#primaryClass"><span class="hs-identifier">primaryClass</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Helpers.html"><span class="hs-identifier">Language.Drasil.Code.Imperative.Helpers</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Code.Imperative.Helpers.html#lookupC"><span class="hs-identifier">lookupC</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Logging.html"><span class="hs-identifier">Language.Drasil.Code.Imperative.Logging</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Code.Imperative.Logging.html#maybeLog"><span class="hs-identifier">maybeLog</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Logging.html#logBody"><span class="hs-identifier">logBody</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html"><span class="hs-identifier">Language.Drasil.Code.Imperative.DrasilState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier">GenState</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#DrasilState"><span class="hs-identifier">DrasilState</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.Chunk.Code.html"><span class="hs-identifier">Language.Drasil.Chunk.Code</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">CodeIdea</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">codeName</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">CodeVarChunk</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">obv</span></span><span class="hs-special">,</span><span> </span><span>
</span><span id="line-25"></span><span>  </span><span class="annot"><span class="hs-identifier">quantvar</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">quantfunc</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Chunk.Code.html#ccObjVar"><span class="hs-identifier">ccObjVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">DefiningCodeExpr</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.Chunk.Parameter.html"><span class="hs-identifier">Language.Drasil.Chunk.Parameter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Chunk.Parameter.html#ParameterChunk"><span class="hs-identifier">ParameterChunk</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Chunk.Parameter.html#PassBy"><span class="hs-identifier">PassBy</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Chunk.Parameter.html#pcAuto"><span class="hs-identifier">pcAuto</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.Code.CodeQuantityDicts.html"><span class="hs-identifier">Language.Drasil.Code.CodeQuantityDicts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Code.CodeQuantityDicts.html#inFileName"><span class="hs-identifier">inFileName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.CodeQuantityDicts.html#inParams"><span class="hs-identifier">inParams</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.CodeQuantityDicts.html#consts"><span class="hs-identifier">consts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html"><span class="hs-identifier">Language.Drasil.Choices</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Choices.html#Comments"><span class="hs-identifier">Comments</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#ConstantRepr"><span class="hs-identifier">ConstantRepr</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>  </span><span class="annot"><a href="Language.Drasil.Choices.html#ConstantStructure"><span class="hs-identifier">ConstantStructure</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#Structure"><span class="hs-identifier">Structure</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.CodeSpec.html"><span class="hs-identifier">Language.Drasil.CodeSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.CodeSpec.html#CodeSpec"><span class="hs-identifier">CodeSpec</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html"><span class="hs-identifier">Language.Drasil.Code.DataDesc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#DataItem"><span class="hs-identifier">DataItem</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#LinePattern"><span class="hs-identifier">LinePattern</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#Repeat"><span class="hs-identifier">Repeat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#Straight"><span class="hs-identifier">Straight</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span>
</span><span id="line-32"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#Data"><span class="hs-identifier">Data</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#Line"><span class="hs-identifier">Line</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#Lines"><span class="hs-identifier">Lines</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#JunkData"><span class="hs-identifier">JunkData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#Singleton"><span class="hs-identifier">Singleton</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#DataDesc"><span class="hs-identifier">DataDesc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#isLine"><span class="hs-identifier">isLine</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#isLines"><span class="hs-identifier">isLines</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#getInputs"><span class="hs-identifier">getInputs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#getPatternInputs"><span class="hs-identifier">getPatternInputs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html"><span class="hs-identifier">Language.Drasil.Mod</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#Func"><span class="hs-identifier">Func</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#FuncData"><span class="hs-identifier">FuncData</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#FuncDef"><span class="hs-identifier">FuncDef</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#FuncStmt"><span class="hs-identifier">FuncStmt</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span>
</span><span id="line-35"></span><span>  </span><span class="annot"><a href="Language.Drasil.Mod.html#Mod"><span class="hs-identifier">Mod</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Name"><span class="hs-identifier">Name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Description"><span class="hs-identifier">Description</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#StateVariable"><span class="hs-identifier">StateVariable</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#fstdecl"><span class="hs-identifier">fstdecl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html"><span class="hs-identifier">Language.Drasil.Mod</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#Class"><span class="hs-identifier">Class</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GOOL.Drasil</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Label</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">SFile</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">MSBody</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">MSBlock</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">VSType</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">SVariable</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">SValue</span></span><span class="hs-special">,</span><span> </span><span>
</span><span id="line-39"></span><span>  </span><span class="annot"><span class="hs-identifier">MSStatement</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">MSParameter</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">SMethod</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">CSStateVar</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">SClass</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">NamedArgs</span></span><span class="hs-special">,</span><span> </span><span>
</span><span id="line-40"></span><span>  </span><span class="annot"><span class="hs-identifier">Initializers</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">OOProg</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">PermanenceSym</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">bodyStatements</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">BlockSym</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span>
</span><span id="line-41"></span><span>  </span><span class="annot"><span class="hs-identifier">TypeSym</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">VariableSym</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">VariableElim</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">($-&gt;)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ValueSym</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span>
</span><span id="line-42"></span><span>  </span><span class="annot"><span class="hs-identifier">Literal</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">VariableValue</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">NumericExpression</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">BooleanExpression</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span>
</span><span id="line-43"></span><span>  </span><span class="annot"><span class="hs-identifier">Comparison</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ValueExpression</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">objMethodCallMixedArgs</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">List</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span>
</span><span id="line-44"></span><span>  </span><span class="annot"><span class="hs-identifier">StatementSym</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">AssignStatement</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">DeclStatement</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">IOStatement</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>  </span><span class="annot"><span class="hs-identifier">StringStatement</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ControlStatement</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ifNoElse</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ScopeSym</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span>
</span><span id="line-46"></span><span>  </span><span class="annot"><span class="hs-identifier">ParameterSym</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">MethodSym</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">pubDVar</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">privDVar</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">nonInitConstructor</span></span><span class="hs-special">,</span><span> </span><span>
</span><span id="line-47"></span><span>  </span><span class="annot"><span class="hs-identifier">convType</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ScopeTag</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">CodeType</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">onStateValue</span></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">GOOL.Drasil</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">C</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">CodeType</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">List</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Array</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">sin</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">cos</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">tan</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">log</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">exp</span></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(\\)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">intersect</span></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">lookup</span></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">liftM2</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">liftM3</span></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.State</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">get</span></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(^.)</span></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="hs-comment">-- | Gets a chunk's 'CodeType', by checking which 'CodeType' the user has chosen to </span><span>
</span><span id="line-58"></span><span class="hs-comment">-- match the chunk's 'Space' to.</span><span>
</span><span id="line-59"></span><span id="local-6989586621679329113"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#codeType"><span class="hs-identifier hs-type">codeType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">HasSpace</span></span><span> </span><span class="annot"><a href="#local-6989586621679329113"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679329113"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CodeType</span></span></span><span>
</span><span id="line-60"></span><span id="codeType"><span class="annot"><span class="annottext">codeType :: c -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#codeType"><span class="hs-identifier hs-var hs-var">codeType</span></a></span></span><span> </span><span id="local-6989586621679328776"><span class="annot"><span class="annottext">c :: c
</span><a href="#local-6989586621679328776"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Space -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#spaceCodeType"><span class="hs-identifier hs-var">spaceCodeType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679328776"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">c -&gt; Getting Space c Space -&gt; Space
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting Space c Space
forall c. HasSpace c =&gt; Lens' c Space
</span><span class="hs-identifier hs-var">typ</span></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="hs-comment">-- | Gets the 'CodeType' for a 'Space', based on the user's choice.</span><span>
</span><span id="line-63"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#spaceCodeType"><span class="hs-identifier hs-type">spaceCodeType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Space</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CodeType</span></span><span>
</span><span id="line-64"></span><span id="spaceCodeType"><span class="annot"><span class="annottext">spaceCodeType :: Space -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#spaceCodeType"><span class="hs-identifier hs-var hs-var">spaceCodeType</span></a></span></span><span> </span><span id="local-6989586621679328774"><span class="annot"><span class="annottext">s :: Space
</span><a href="#local-6989586621679328774"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-65"></span><span>  </span><span id="local-6989586621679328773"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679328773"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-66"></span><span>  </span><span class="annot"><span class="annottext">DrasilState -&gt; Space -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#spaceMatches"><span class="hs-identifier hs-var hs-var">spaceMatches</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679328773"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621679328774"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-comment">-- | If 'UID' for the variable is matched to a concept, call 'conceptToGOOL' to get </span><span>
</span><span id="line-69"></span><span class="hs-comment">-- the GOOL code for the concept, and return.</span><span>
</span><span id="line-70"></span><span class="hs-comment">-- If 'UID' is for a constant and user has chosen 'Inline', convert the constant's </span><span>
</span><span id="line-71"></span><span class="hs-comment">-- defining 'Expr' to a value with 'convExpr'.</span><span>
</span><span id="line-72"></span><span class="hs-comment">-- Otherwise, just a regular variable: construct it by calling the variable, then </span><span>
</span><span id="line-73"></span><span class="hs-comment">-- call 'valueOf' to reference its value.</span><span>
</span><span id="line-74"></span><span id="local-6989586621679329109"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#value"><span class="hs-identifier hs-type">value</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679329109"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VSType</span></span><span> </span><span class="annot"><a href="#local-6989586621679329109"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679329109"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-75"></span><span id="value"><span class="annot"><span class="annottext">value :: UID -&gt; UID -&gt; VSType r -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#value"><span class="hs-identifier hs-var hs-var">value</span></a></span></span><span> </span><span id="local-6989586621679328770"><span class="annot"><span class="annottext">u :: UID
</span><a href="#local-6989586621679328770"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621679328769"><span class="annot"><span class="annottext">s :: UID
</span><a href="#local-6989586621679328769"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679328768"><span class="annot"><span class="annottext">t :: VSType r
</span><a href="#local-6989586621679328768"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-76"></span><span>  </span><span id="local-6989586621679328767"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679328767"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-77"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679328766"><span class="annot"><span class="annottext">cs :: CodeSpec
</span><a href="#local-6989586621679328766"><span class="hs-identifier hs-var hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; CodeSpec
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#codeSpec"><span class="hs-identifier hs-var hs-var">codeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679328767"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-78"></span><span>      </span><span id="local-6989586621679328764"><span class="annot"><span class="annottext">mm :: ConstantMap
</span><a href="#local-6989586621679328764"><span class="hs-identifier hs-var hs-var">mm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CodeSpec -&gt; ConstantMap
</span><a href="Language.Drasil.CodeSpec.html#constMap"><span class="hs-identifier hs-var hs-var">constMap</span></a></span><span> </span><span class="annot"><span class="annottext">CodeSpec
</span><a href="#local-6989586621679328766"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-79"></span><span>      </span><span id="local-6989586621679328762"><span class="annot"><span class="annottext">constDef :: Maybe CodeDefinition
</span><a href="#local-6989586621679328762"><span class="hs-identifier hs-var hs-var">constDef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-80"></span><span>        </span><span id="local-6989586621679328761"><span class="annot"><span class="annottext">CodeDefinition
</span><a href="#local-6989586621679328761"><span class="hs-identifier hs-var">cd</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UID -&gt; ConstantMap -&gt; Maybe CodeDefinition
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328770"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">ConstantMap
</span><a href="#local-6989586621679328764"><span class="hs-identifier hs-var">mm</span></a></span><span>
</span><span id="line-81"></span><span>        </span><span class="annot"><span class="annottext">ConstantStructure -&gt; CodeDefinition -&gt; Maybe CodeDefinition
forall a. ConstantStructure -&gt; a -&gt; Maybe a
</span><a href="#local-6989586621679328760"><span class="hs-identifier hs-var">maybeInline</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; ConstantStructure
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#conStruct"><span class="hs-identifier hs-var hs-var">conStruct</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679328767"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CodeDefinition
</span><a href="#local-6989586621679328761"><span class="hs-identifier hs-var">cd</span></a></span><span>
</span><span id="line-82"></span><span>      </span><span id="local-6989586621679328760"><span class="annot"><span class="annottext">maybeInline :: ConstantStructure -&gt; a -&gt; Maybe a
</span><a href="#local-6989586621679328760"><span class="hs-identifier hs-var hs-var">maybeInline</span></a></span></span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#Inline"><span class="hs-identifier hs-type">Inline</span></a></span><span> </span><span id="local-6989586621679328757"><span class="annot"><span class="annottext">m :: a
</span><a href="#local-6989586621679328757"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679328757"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-83"></span><span>      </span><span class="annot"><a href="#local-6989586621679328760"><span class="hs-identifier hs-var">maybeInline</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-84"></span><span>      </span><span id="local-6989586621679328756"><span class="annot"><span class="annottext">cm :: MatchedConceptMap
</span><a href="#local-6989586621679328756"><span class="hs-identifier hs-var hs-var">cm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; MatchedConceptMap
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#concMatches"><span class="hs-identifier hs-var hs-var">concMatches</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679328767"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-85"></span><span>      </span><span id="local-6989586621679328754"><span class="annot"><span class="annottext">cdCncpt :: Maybe CodeConcept
</span><a href="#local-6989586621679328754"><span class="hs-identifier hs-var hs-var">cdCncpt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UID -&gt; MatchedConceptMap -&gt; Maybe CodeConcept
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328770"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">MatchedConceptMap
</span><a href="#local-6989586621679328756"><span class="hs-identifier hs-var">cm</span></a></span><span>
</span><span id="line-86"></span><span>  </span><span id="local-6989586621679328753"><span class="annot"><span class="annottext">SValue r
</span><a href="#local-6989586621679328753"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenState (SValue r)
-&gt; (CodeDefinition -&gt; GenState (SValue r))
-&gt; Maybe CodeDefinition
-&gt; GenState (SValue r)
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SVariable r -&gt; SValue r
forall (r :: * -&gt; *). VariableValue r =&gt; SVariable r -&gt; SValue r
</span><span class="hs-identifier hs-var">valueOf</span></span><span> </span><span class="annot"><span class="annottext">(SVariable r -&gt; SValue r)
-&gt; StateT DrasilState Identity (SVariable r) -&gt; GenState (SValue r)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">UID -&gt; VSType r -&gt; StateT DrasilState Identity (SVariable r)
forall (r :: * -&gt; *).
OOProg r =&gt;
UID -&gt; VSType r -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#variable"><span class="hs-identifier hs-var">variable</span></a></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328769"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">VSType r
</span><a href="#local-6989586621679328768"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">(CodeExpr -&gt; GenState (SValue r))
-&gt; (CodeDefinition -&gt; CodeExpr)
-&gt; CodeDefinition
-&gt; GenState (SValue r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeDefinition
-&gt; Getting CodeExpr CodeDefinition CodeExpr -&gt; CodeExpr
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting CodeExpr CodeDefinition CodeExpr
forall c. DefiningCodeExpr c =&gt; Lens' c CodeExpr
</span><span class="hs-identifier hs-var">codeExpr</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe CodeDefinition
</span><a href="#local-6989586621679328762"><span class="hs-identifier hs-var">constDef</span></a></span><span>
</span><span id="line-87"></span><span>  </span><span class="annot"><span class="annottext">SValue r -&gt; GenState (SValue r)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; GenState (SValue r))
-&gt; SValue r -&gt; GenState (SValue r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SValue r
-&gt; (CodeConcept -&gt; SValue r) -&gt; Maybe CodeConcept -&gt; SValue r
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">SValue r
</span><a href="#local-6989586621679328753"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">CodeConcept -&gt; SValue r
forall (r :: * -&gt; *). OOProg r =&gt; CodeConcept -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.ConceptMatch.html#conceptToGOOL"><span class="hs-identifier hs-var">conceptToGOOL</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe CodeConcept
</span><a href="#local-6989586621679328754"><span class="hs-identifier hs-var">cdCncpt</span></a></span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="hs-comment">-- | If variable is an input, construct it with 'var' and pass to inputVariable.</span><span>
</span><span id="line-90"></span><span class="hs-comment">-- If variable is a constant and 'Var' constant representation is chosen,</span><span>
</span><span id="line-91"></span><span class="hs-comment">-- construct it with 'var' and pass to 'constVariable'.</span><span>
</span><span id="line-92"></span><span class="hs-comment">-- If variable is a constant and 'Const' constant representation is chosen,</span><span>
</span><span id="line-93"></span><span class="hs-comment">-- construct it with 'staticVar' and pass to 'constVariable'.</span><span>
</span><span id="line-94"></span><span class="hs-comment">-- If variable is neither, just construct it with 'var' and return it.</span><span>
</span><span id="line-95"></span><span id="local-6989586621679329170"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#variable"><span class="hs-identifier hs-type">variable</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679329170"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VSType</span></span><span> </span><span class="annot"><a href="#local-6989586621679329170"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SVariable</span></span><span> </span><span class="annot"><a href="#local-6989586621679329170"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-96"></span><span id="variable"><span class="annot"><span class="annottext">variable :: UID -&gt; VSType r -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#variable"><span class="hs-identifier hs-var hs-var">variable</span></a></span></span><span> </span><span id="local-6989586621679328746"><span class="annot"><span class="annottext">s :: UID
</span><a href="#local-6989586621679328746"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679328745"><span class="annot"><span class="annottext">t :: VSType r
</span><a href="#local-6989586621679328745"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-97"></span><span>  </span><span id="local-6989586621679328744"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679328744"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-98"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679328743"><span class="annot"><span class="annottext">cs :: CodeSpec
</span><a href="#local-6989586621679328743"><span class="hs-identifier hs-var hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; CodeSpec
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#codeSpec"><span class="hs-identifier hs-var hs-var">codeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679328744"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-99"></span><span>      </span><span id="local-6989586621679328742"><span class="annot"><span class="annottext">defFunc :: ConstantRepr -&gt; UID -&gt; VS (r (Type r)) -&gt; VS (r (Variable r))
</span><a href="#local-6989586621679328742"><span class="hs-identifier hs-var hs-var">defFunc</span></a></span></span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UID -&gt; VS (r (Type r)) -&gt; VS (r (Variable r))
forall (r :: * -&gt; *).
VariableSym r =&gt;
UID -&gt; VSType r -&gt; SVariable r
</span><span class="hs-identifier hs-var">var</span></span><span>
</span><span id="line-100"></span><span>      </span><span class="annot"><a href="#local-6989586621679328742"><span class="hs-identifier hs-var">defFunc</span></a></span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#Const"><span class="hs-identifier hs-type">Const</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UID -&gt; VS (r (Type r)) -&gt; VS (r (Variable r))
forall (r :: * -&gt; *).
VariableSym r =&gt;
UID -&gt; VSType r -&gt; SVariable r
</span><span class="hs-identifier hs-var">staticVar</span></span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328746"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">UID -&gt; [UID] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">(Input -&gt; UID) -&gt; [Input] -&gt; [UID]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Input -&gt; UID
forall c. CodeIdea c =&gt; c -&gt; UID
</span><span class="hs-identifier hs-var">codeName</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeSpec -&gt; [Input]
</span><a href="Language.Drasil.CodeSpec.html#inputs"><span class="hs-identifier hs-var hs-var">inputs</span></a></span><span> </span><span class="annot"><span class="annottext">CodeSpec
</span><a href="#local-6989586621679328743"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-102"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Structure -&gt; ConstantRepr -&gt; SVariable r -&gt; GenState (SVariable r)
forall (r :: * -&gt; *).
OOProg r =&gt;
Structure -&gt; ConstantRepr -&gt; SVariable r -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#inputVariable"><span class="hs-identifier hs-var">inputVariable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; Structure
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#inStruct"><span class="hs-identifier hs-var hs-var">inStruct</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679328744"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ConstantRepr
</span><a href="Language.Drasil.Choices.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UID -&gt; VSType r -&gt; SVariable r
forall (r :: * -&gt; *).
VariableSym r =&gt;
UID -&gt; VSType r -&gt; SVariable r
</span><span class="hs-identifier hs-var">var</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328746"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">VSType r
</span><a href="#local-6989586621679328745"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328746"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">UID -&gt; [UID] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">(CodeDefinition -&gt; UID) -&gt; [CodeDefinition] -&gt; [UID]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">CodeDefinition -&gt; UID
forall c. CodeIdea c =&gt; c -&gt; UID
</span><span class="hs-identifier hs-var">codeName</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeSpec -&gt; [CodeDefinition]
</span><a href="Language.Drasil.CodeSpec.html#constants"><span class="hs-identifier hs-var hs-var">constants</span></a></span><span> </span><span class="annot"><span class="annottext">(CodeSpec -&gt; [CodeDefinition]) -&gt; CodeSpec -&gt; [CodeDefinition]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; CodeSpec
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#codeSpec"><span class="hs-identifier hs-var hs-var">codeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679328744"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ConstantStructure
-&gt; ConstantRepr -&gt; SVariable r -&gt; GenState (SVariable r)
forall (r :: * -&gt; *).
OOProg r =&gt;
ConstantStructure
-&gt; ConstantRepr -&gt; SVariable r -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#constVariable"><span class="hs-identifier hs-var">constVariable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; ConstantStructure
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#conStruct"><span class="hs-identifier hs-var hs-var">conStruct</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679328744"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; ConstantRepr
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#conRepr"><span class="hs-identifier hs-var hs-var">conRepr</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679328744"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConstantRepr -&gt; UID -&gt; VSType r -&gt; SVariable r
forall (r :: * -&gt; *).
VariableSym r =&gt;
ConstantRepr -&gt; UID -&gt; VS (r (Type r)) -&gt; VS (r (Variable r))
</span><a href="#local-6989586621679328742"><span class="hs-identifier hs-var">defFunc</span></a></span><span> </span><span class="annot"><span class="annottext">(ConstantRepr -&gt; UID -&gt; VSType r -&gt; SVariable r)
-&gt; ConstantRepr -&gt; UID -&gt; VSType r -&gt; SVariable r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; ConstantRepr
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#conRepr"><span class="hs-identifier hs-var hs-var">conRepr</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679328744"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328746"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">VSType r
</span><a href="#local-6989586621679328745"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">SVariable r -&gt; GenState (SVariable r)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SVariable r -&gt; GenState (SVariable r))
-&gt; SVariable r -&gt; GenState (SVariable r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UID -&gt; VSType r -&gt; SVariable r
forall (r :: * -&gt; *).
VariableSym r =&gt;
UID -&gt; VSType r -&gt; SVariable r
</span><span class="hs-identifier hs-var">var</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328746"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">VSType r
</span><a href="#local-6989586621679328745"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-106"></span><span>  </span><span>
</span><span id="line-107"></span><span class="hs-comment">-- | If 'Unbundled' inputs, just return variable as-is.</span><span>
</span><span id="line-108"></span><span class="hs-comment">-- If 'Bundled' inputs, access variable through object, where the object is self </span><span>
</span><span id="line-109"></span><span class="hs-comment">-- if current module is InputParameters, 'inParams' otherwise.</span><span>
</span><span id="line-110"></span><span class="hs-comment">-- Final case is for when 'constVariable' calls inputVariable, when user chooses </span><span>
</span><span id="line-111"></span><span class="hs-comment">-- WithInputs for constant structure, inputs are 'Bundled', and constant</span><span>
</span><span id="line-112"></span><span class="hs-comment">-- representation is 'Const'. Variable should be accessed through class, so </span><span>
</span><span id="line-113"></span><span class="hs-comment">-- 'classVariable' is called.</span><span>
</span><span id="line-114"></span><span id="local-6989586621679329139"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#inputVariable"><span class="hs-identifier hs-type">inputVariable</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679329139"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#Structure"><span class="hs-identifier hs-type">Structure</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#ConstantRepr"><span class="hs-identifier hs-type">ConstantRepr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SVariable</span></span><span> </span><span class="annot"><a href="#local-6989586621679329139"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span>
</span><span id="line-115"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SVariable</span></span><span> </span><span class="annot"><a href="#local-6989586621679329139"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-116"></span><span id="inputVariable"><span class="annot"><span class="annottext">inputVariable :: Structure -&gt; ConstantRepr -&gt; SVariable r -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#inputVariable"><span class="hs-identifier hs-var hs-var">inputVariable</span></a></span></span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#Unbundled"><span class="hs-identifier hs-type">Unbundled</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679328729"><span class="annot"><span class="annottext">v :: SVariable r
</span><a href="#local-6989586621679328729"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SVariable r -&gt; GenState (SVariable r)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679328729"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-117"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#inputVariable"><span class="hs-identifier hs-var">inputVariable</span></a></span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#Bundled"><span class="hs-identifier hs-type">Bundled</span></a></span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621679328727"><span class="annot"><span class="annottext">v :: SVariable r
</span><a href="#local-6989586621679328727"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-118"></span><span>  </span><span id="local-6989586621679328726"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679328726"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-119"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679328725"><span class="annot"><span class="annottext">inClsName :: UID
</span><a href="#local-6989586621679328725"><span class="hs-identifier hs-var hs-var">inClsName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;InputParameters&quot;</span></span><span>
</span><span id="line-120"></span><span>  </span><span id="local-6989586621679328724"><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679328724"><span class="hs-identifier hs-var">ip</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input -&gt; GenState (SVariable r)
forall (r :: * -&gt; *). OOProg r =&gt; Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QuantityDict -&gt; Input
forall c. (Quantity c, MayHaveUnit c) =&gt; c -&gt; Input
</span><span class="hs-identifier hs-var">quantvar</span></span><span> </span><span class="annot"><span class="annottext">QuantityDict
</span><a href="Language.Drasil.Code.CodeQuantityDicts.html#inParams"><span class="hs-identifier hs-var">inParams</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>  </span><span class="annot"><span class="annottext">SVariable r -&gt; GenState (SVariable r)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SVariable r -&gt; GenState (SVariable r))
-&gt; SVariable r -&gt; GenState (SVariable r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; UID
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#currentClass"><span class="hs-identifier hs-var hs-var">currentClass</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679328726"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">UID -&gt; UID -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328725"><span class="hs-identifier hs-var">inClsName</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">SVariable r -&gt; SVariable r
forall (r :: * -&gt; *). VariableSym r =&gt; SVariable r -&gt; SVariable r
</span><span class="hs-identifier hs-var">objVarSelf</span></span><span> </span><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679328727"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679328724"><span class="hs-identifier hs-var">ip</span></a></span><span> </span><span class="annot"><span class="annottext">SVariable r -&gt; SVariable r -&gt; SVariable r
forall (r :: * -&gt; *).
VariableSym r =&gt;
SVariable r -&gt; SVariable r -&gt; SVariable r
</span><span class="hs-operator hs-var">$-&gt;</span></span><span> </span><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679328727"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-122"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#inputVariable"><span class="hs-identifier hs-var">inputVariable</span></a></span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#Bundled"><span class="hs-identifier hs-type">Bundled</span></a></span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#Const"><span class="hs-identifier hs-type">Const</span></a></span><span> </span><span id="local-6989586621679328721"><span class="annot"><span class="annottext">v :: SVariable r
</span><a href="#local-6989586621679328721"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-123"></span><span>  </span><span id="local-6989586621679328720"><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679328720"><span class="hs-identifier hs-var">ip</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input -&gt; GenState (SVariable r)
forall (r :: * -&gt; *). OOProg r =&gt; Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QuantityDict -&gt; Input
forall c. (Quantity c, MayHaveUnit c) =&gt; c -&gt; Input
</span><span class="hs-identifier hs-var">quantvar</span></span><span> </span><span class="annot"><span class="annottext">QuantityDict
</span><a href="Language.Drasil.Code.CodeQuantityDicts.html#inParams"><span class="hs-identifier hs-var">inParams</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>  </span><span class="annot"><span class="annottext">SVariable r -&gt; SVariable r -&gt; GenState (SVariable r)
forall (r :: * -&gt; *).
OOProg r =&gt;
SVariable r -&gt; SVariable r -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#classVariable"><span class="hs-identifier hs-var">classVariable</span></a></span><span> </span><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679328720"><span class="hs-identifier hs-var">ip</span></a></span><span> </span><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679328721"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span class="hs-comment">-- | If 'Unbundled' constants, just return variable as-is.</span><span>
</span><span id="line-127"></span><span class="hs-comment">-- If 'Bundled' constants and 'Var' constant representation, access variable </span><span>
</span><span id="line-128"></span><span class="hs-comment">-- through 'consts' object.</span><span>
</span><span id="line-129"></span><span class="hs-comment">-- If 'Bundled' constants and 'Const' constant representation, access variable </span><span>
</span><span id="line-130"></span><span class="hs-comment">-- through class, so call 'classVariable'.</span><span>
</span><span id="line-131"></span><span class="hs-comment">-- If constants stored 'WithInputs', call 'inputVariable'.</span><span>
</span><span id="line-132"></span><span class="hs-comment">-- If constants are 'Inline'd, the generator should not be attempting to make a </span><span>
</span><span id="line-133"></span><span class="hs-comment">-- variable for one of the constants.</span><span>
</span><span id="line-134"></span><span id="local-6989586621679329138"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#constVariable"><span class="hs-identifier hs-type">constVariable</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679329138"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#ConstantStructure"><span class="hs-identifier hs-type">ConstantStructure</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#ConstantRepr"><span class="hs-identifier hs-type">ConstantRepr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span>
</span><span id="line-135"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">SVariable</span></span><span> </span><span class="annot"><a href="#local-6989586621679329138"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SVariable</span></span><span> </span><span class="annot"><a href="#local-6989586621679329138"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-136"></span><span id="constVariable"><span class="annot"><span class="annottext">constVariable :: ConstantStructure
-&gt; ConstantRepr -&gt; SVariable r -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#constVariable"><span class="hs-identifier hs-var hs-var">constVariable</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Choices.html#Store"><span class="hs-identifier hs-type">Store</span></a></span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#Unbundled"><span class="hs-identifier hs-type">Unbundled</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679328717"><span class="annot"><span class="annottext">v :: SVariable r
</span><a href="#local-6989586621679328717"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SVariable r -&gt; GenState (SVariable r)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679328717"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-137"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#constVariable"><span class="hs-identifier hs-var">constVariable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Choices.html#Store"><span class="hs-identifier hs-type">Store</span></a></span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#Bundled"><span class="hs-identifier hs-type">Bundled</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621679328716"><span class="annot"><span class="annottext">v :: SVariable r
</span><a href="#local-6989586621679328716"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-138"></span><span>  </span><span id="local-6989586621679328715"><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679328715"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input -&gt; GenState (SVariable r)
forall (r :: * -&gt; *). OOProg r =&gt; Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QuantityDict -&gt; Input
forall c. (Quantity c, MayHaveUnit c) =&gt; c -&gt; Input
</span><span class="hs-identifier hs-var">quantvar</span></span><span> </span><span class="annot"><span class="annottext">QuantityDict
</span><a href="Language.Drasil.Code.CodeQuantityDicts.html#consts"><span class="hs-identifier hs-var">consts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span>  </span><span class="annot"><span class="annottext">SVariable r -&gt; GenState (SVariable r)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SVariable r -&gt; GenState (SVariable r))
-&gt; SVariable r -&gt; GenState (SVariable r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679328715"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">SVariable r -&gt; SVariable r -&gt; SVariable r
forall (r :: * -&gt; *).
VariableSym r =&gt;
SVariable r -&gt; SVariable r -&gt; SVariable r
</span><span class="hs-operator hs-var">$-&gt;</span></span><span> </span><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679328716"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-140"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#constVariable"><span class="hs-identifier hs-var">constVariable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Choices.html#Store"><span class="hs-identifier hs-type">Store</span></a></span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#Bundled"><span class="hs-identifier hs-type">Bundled</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#Const"><span class="hs-identifier hs-type">Const</span></a></span><span> </span><span id="local-6989586621679328714"><span class="annot"><span class="annottext">v :: SVariable r
</span><a href="#local-6989586621679328714"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-141"></span><span>  </span><span id="local-6989586621679328713"><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679328713"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input -&gt; GenState (SVariable r)
forall (r :: * -&gt; *). OOProg r =&gt; Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QuantityDict -&gt; Input
forall c. (Quantity c, MayHaveUnit c) =&gt; c -&gt; Input
</span><span class="hs-identifier hs-var">quantvar</span></span><span> </span><span class="annot"><span class="annottext">QuantityDict
</span><a href="Language.Drasil.Code.CodeQuantityDicts.html#consts"><span class="hs-identifier hs-var">consts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span>  </span><span class="annot"><span class="annottext">SVariable r -&gt; SVariable r -&gt; GenState (SVariable r)
forall (r :: * -&gt; *).
OOProg r =&gt;
SVariable r -&gt; SVariable r -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#classVariable"><span class="hs-identifier hs-var">classVariable</span></a></span><span> </span><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679328713"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679328714"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-143"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#constVariable"><span class="hs-identifier hs-var">constVariable</span></a></span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#WithInputs"><span class="hs-identifier hs-type">WithInputs</span></a></span><span> </span><span id="local-6989586621679328711"><span class="annot"><span class="annottext">cr :: ConstantRepr
</span><a href="#local-6989586621679328711"><span class="hs-identifier hs-var">cr</span></a></span></span><span> </span><span id="local-6989586621679328710"><span class="annot"><span class="annottext">v :: SVariable r
</span><a href="#local-6989586621679328710"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-144"></span><span>  </span><span id="local-6989586621679328709"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679328709"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-145"></span><span>  </span><span class="annot"><span class="annottext">Structure -&gt; ConstantRepr -&gt; SVariable r -&gt; GenState (SVariable r)
forall (r :: * -&gt; *).
OOProg r =&gt;
Structure -&gt; ConstantRepr -&gt; SVariable r -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#inputVariable"><span class="hs-identifier hs-var">inputVariable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; Structure
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#inStruct"><span class="hs-identifier hs-var hs-var">inStruct</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679328709"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ConstantRepr
</span><a href="#local-6989586621679328711"><span class="hs-identifier hs-var">cr</span></a></span><span> </span><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679328710"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-146"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#constVariable"><span class="hs-identifier hs-var">constVariable</span></a></span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#Inline"><span class="hs-identifier hs-type">Inline</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UID -&gt; GenState (SVariable r)
forall a. HasCallStack =&gt; UID -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(UID -&gt; GenState (SVariable r)) -&gt; UID -&gt; GenState (SVariable r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;mkVar called on a constant, but user &quot;</span></span><span> </span><span class="annot"><span class="annottext">UID -&gt; UID -&gt; UID
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-147"></span><span>  </span><span class="annot"><span class="hs-string">&quot;chose to Inline constants. Generator has a bug.&quot;</span></span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span class="hs-comment">-- | For generating GOOL for a variable that is accessed through a class.</span><span>
</span><span id="line-150"></span><span class="hs-comment">-- If the variable is not in the export map, then it is not a public class variable </span><span>
</span><span id="line-151"></span><span class="hs-comment">-- and cannot be accessed, so throw an error.</span><span>
</span><span id="line-152"></span><span class="hs-comment">-- If the variable is exported by the current module, use 'classVar'.</span><span>
</span><span id="line-153"></span><span class="hs-comment">-- If the variable is exported by a different module, use 'extClassVar'.</span><span>
</span><span id="line-154"></span><span id="local-6989586621679329129"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#classVariable"><span class="hs-identifier hs-type">classVariable</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679329129"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SVariable</span></span><span> </span><span class="annot"><a href="#local-6989586621679329129"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SVariable</span></span><span> </span><span class="annot"><a href="#local-6989586621679329129"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span>
</span><span id="line-155"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SVariable</span></span><span> </span><span class="annot"><a href="#local-6989586621679329129"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-156"></span><span id="classVariable"><span class="annot"><span class="annottext">classVariable :: SVariable r -&gt; SVariable r -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#classVariable"><span class="hs-identifier hs-var hs-var">classVariable</span></a></span></span><span> </span><span id="local-6989586621679328707"><span class="annot"><span class="annottext">c :: SVariable r
</span><a href="#local-6989586621679328707"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679328706"><span class="annot"><span class="annottext">v :: SVariable r
</span><a href="#local-6989586621679328706"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-157"></span><span>  </span><span id="local-6989586621679328705"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679328705"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-158"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679328704"><span class="annot"><span class="annottext">checkCurrent :: UID
-&gt; VS (r (Type r)) -&gt; VS (r (Variable r)) -&gt; VS (r (Variable r))
</span><a href="#local-6989586621679328704"><span class="hs-identifier hs-var hs-var">checkCurrent</span></a></span></span><span> </span><span id="local-6989586621679328703"><span class="annot"><span class="annottext">m :: UID
</span><a href="#local-6989586621679328703"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; UID
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#currentModule"><span class="hs-identifier hs-var hs-var">currentModule</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679328705"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">UID -&gt; UID -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328703"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">VS (r (Type r)) -&gt; VS (r (Variable r)) -&gt; VS (r (Variable r))
forall (r :: * -&gt; *).
VariableSym r =&gt;
VSType r -&gt; SVariable r -&gt; SVariable r
</span><span class="hs-identifier hs-var">classVar</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">VS (r (Type r)) -&gt; VS (r (Variable r)) -&gt; VS (r (Variable r))
forall (r :: * -&gt; *).
VariableSym r =&gt;
VSType r -&gt; SVariable r -&gt; SVariable r
</span><span class="hs-identifier hs-var">extClassVar</span></span><span>
</span><span id="line-159"></span><span>  </span><span class="annot"><span class="annottext">SVariable r -&gt; GenState (SVariable r)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SVariable r -&gt; GenState (SVariable r))
-&gt; SVariable r -&gt; GenState (SVariable r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-160"></span><span>    </span><span id="local-6989586621679328699"><span class="annot"><span class="annottext">r (Variable r)
</span><a href="#local-6989586621679328699"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679328706"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-161"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679328698"><span class="annot"><span class="annottext">nm :: UID
</span><a href="#local-6989586621679328698"><span class="hs-identifier hs-var hs-var">nm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r (Variable r) -&gt; UID
forall (r :: * -&gt; *). VariableElim r =&gt; r (Variable r) -&gt; UID
</span><span class="hs-identifier hs-var">variableName</span></span><span> </span><span class="annot"><span class="annottext">r (Variable r)
</span><a href="#local-6989586621679328699"><span class="hs-identifier hs-var">v'</span></a></span><span>
</span><span id="line-162"></span><span>    </span><span class="annot"><span class="annottext">(State ValueState (r (Type r)) -&gt; SVariable r -&gt; SVariable r)
-&gt; (UID
    -&gt; State ValueState (r (Type r)) -&gt; SVariable r -&gt; SVariable r)
-&gt; Maybe UID
-&gt; State ValueState (r (Type r))
-&gt; SVariable r
-&gt; SVariable r
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UID -&gt; State ValueState (r (Type r)) -&gt; SVariable r -&gt; SVariable r
forall a. HasCallStack =&gt; UID -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(UID
 -&gt; State ValueState (r (Type r)) -&gt; SVariable r -&gt; SVariable r)
-&gt; UID
-&gt; State ValueState (r (Type r))
-&gt; SVariable r
-&gt; SVariable r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Variable &quot;</span></span><span> </span><span class="annot"><span class="annottext">UID -&gt; UID -&gt; UID
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328698"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">UID -&gt; UID -&gt; UID
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot; missing from export map&quot;</span></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-163"></span><span>      </span><span class="annot"><span class="annottext">UID -&gt; State ValueState (r (Type r)) -&gt; SVariable r -&gt; SVariable r
forall (r :: * -&gt; *).
VariableSym r =&gt;
UID
-&gt; VS (r (Type r)) -&gt; VS (r (Variable r)) -&gt; VS (r (Variable r))
</span><a href="#local-6989586621679328704"><span class="hs-identifier hs-var">checkCurrent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UID -&gt; Map UID UID -&gt; Maybe UID
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328698"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; Map UID UID
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#eMap"><span class="hs-identifier hs-var hs-var">eMap</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679328705"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(r (Variable r) -&gt; r (Type r))
-&gt; SVariable r -&gt; State ValueState (r (Type r))
forall a b s. (a -&gt; b) -&gt; State s a -&gt; State s b
</span><span class="hs-identifier hs-var">onStateValue</span></span><span> </span><span class="annot"><span class="annottext">r (Variable r) -&gt; r (Type r)
forall (r :: * -&gt; *).
VariableElim r =&gt;
r (Variable r) -&gt; r (Type r)
</span><span class="hs-identifier hs-var">variableType</span></span><span> </span><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679328707"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679328706"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span class="hs-comment">-- | Generates a GOOL Value for a variable represented by a 'CodeVarChunk'.</span><span>
</span><span id="line-166"></span><span id="local-6989586621679329037"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#mkVal"><span class="hs-identifier hs-type">mkVal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679329037"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CodeVarChunk</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679329037"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-167"></span><span id="mkVal"><span class="annot"><span class="annottext">mkVal :: Input -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVal"><span class="hs-identifier hs-var hs-var">mkVal</span></a></span></span><span> </span><span id="local-6989586621679328694"><span class="annot"><span class="annottext">v :: Input
</span><a href="#local-6989586621679328694"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-168"></span><span>  </span><span id="local-6989586621679328693"><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679328693"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input -&gt; GenState CodeType
forall c. HasSpace c =&gt; c -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#codeType"><span class="hs-identifier hs-var">codeType</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679328694"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679328692"><span class="annot"><span class="annottext">toGOOLVal :: Maybe c -&gt; StateT DrasilState Identity (VS (r (Value r)))
</span><a href="#local-6989586621679328692"><span class="hs-identifier hs-var hs-var">toGOOLVal</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UID
-&gt; UID
-&gt; VSType r
-&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *).
OOProg r =&gt;
UID -&gt; UID -&gt; VSType r -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#value"><span class="hs-identifier hs-var">value</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679328694"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Input -&gt; Getting UID Input UID -&gt; UID
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting UID Input UID
forall c. HasUID c =&gt; Lens' c UID
</span><span class="hs-identifier hs-var">uid</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input -&gt; UID
forall c. CodeIdea c =&gt; c -&gt; UID
</span><span class="hs-identifier hs-var">codeName</span></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679328694"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeType -&gt; VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; CodeType -&gt; VSType r
</span><span class="hs-identifier hs-var">convType</span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679328693"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>      </span><span class="annot"><a href="#local-6989586621679328692"><span class="hs-identifier hs-var">toGOOLVal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679328690"><span class="annot"><span class="annottext">o :: c
</span><a href="#local-6989586621679328690"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-171"></span><span>        </span><span id="local-6989586621679328689"><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679328689"><span class="hs-identifier hs-var">ot</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">c -&gt; GenState CodeType
forall c. HasSpace c =&gt; c -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#codeType"><span class="hs-identifier hs-var">codeType</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679328690"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-172"></span><span>        </span><span class="annot"><span class="annottext">VS (r (Value r)) -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(VS (r (Value r))
 -&gt; StateT DrasilState Identity (VS (r (Value r))))
-&gt; VS (r (Value r))
-&gt; StateT DrasilState Identity (VS (r (Value r)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SVariable r -&gt; VS (r (Value r))
forall (r :: * -&gt; *). VariableValue r =&gt; SVariable r -&gt; SValue r
</span><span class="hs-identifier hs-var">valueOf</span></span><span> </span><span class="annot"><span class="annottext">(SVariable r -&gt; VS (r (Value r)))
-&gt; SVariable r -&gt; VS (r (Value r))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SVariable r -&gt; SVariable r -&gt; SVariable r
forall (r :: * -&gt; *).
VariableSym r =&gt;
SVariable r -&gt; SVariable r -&gt; SVariable r
</span><span class="hs-identifier hs-var">objVar</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UID -&gt; VSType r -&gt; SVariable r
forall (r :: * -&gt; *).
VariableSym r =&gt;
UID -&gt; VSType r -&gt; SVariable r
</span><span class="hs-identifier hs-var">var</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">c -&gt; UID
forall c. CodeIdea c =&gt; c -&gt; UID
</span><span class="hs-identifier hs-var">codeName</span></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679328690"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeType -&gt; VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; CodeType -&gt; VSType r
</span><span class="hs-identifier hs-var">convType</span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679328689"><span class="hs-identifier hs-var">ot</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-173"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UID -&gt; VSType r -&gt; SVariable r
forall (r :: * -&gt; *).
VariableSym r =&gt;
UID -&gt; VSType r -&gt; SVariable r
</span><span class="hs-identifier hs-var">var</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input -&gt; UID
forall c. CodeIdea c =&gt; c -&gt; UID
</span><span class="hs-identifier hs-var">codeName</span></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679328694"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeType -&gt; VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; CodeType -&gt; VSType r
</span><span class="hs-identifier hs-var">convType</span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679328693"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span>  </span><span class="annot"><span class="annottext">Maybe CodeChunk -&gt; GenState (SValue r)
forall (r :: * -&gt; *) c.
(OOProg r, HasSpace c, CodeIdea c) =&gt;
Maybe c -&gt; StateT DrasilState Identity (VS (r (Value r)))
</span><a href="#local-6989586621679328692"><span class="hs-identifier hs-var">toGOOLVal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679328694"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Input
-&gt; Getting (Maybe CodeChunk) Input (Maybe CodeChunk)
-&gt; Maybe CodeChunk
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting (Maybe CodeChunk) Input (Maybe CodeChunk)
Lens' Input (Maybe CodeChunk)
</span><span class="hs-identifier hs-var">obv</span></span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span class="hs-comment">-- | Generates a GOOL Variable for a variable represented by a 'CodeVarChunk'.</span><span>
</span><span id="line-177"></span><span id="local-6989586621679329136"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-type">mkVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679329136"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CodeVarChunk</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SVariable</span></span><span> </span><span class="annot"><a href="#local-6989586621679329136"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-178"></span><span id="mkVar"><span class="annot"><span class="annottext">mkVar :: Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var hs-var">mkVar</span></a></span></span><span> </span><span id="local-6989586621679328687"><span class="annot"><span class="annottext">v :: Input
</span><a href="#local-6989586621679328687"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-179"></span><span>  </span><span id="local-6989586621679328686"><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679328686"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input -&gt; GenState CodeType
forall c. HasSpace c =&gt; c -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#codeType"><span class="hs-identifier hs-var">codeType</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679328687"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-180"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679328685"><span class="annot"><span class="annottext">toGOOLVar :: Maybe c -&gt; StateT DrasilState Identity (VS (r (Variable r)))
</span><a href="#local-6989586621679328685"><span class="hs-identifier hs-var hs-var">toGOOLVar</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UID
-&gt; VSType r -&gt; StateT DrasilState Identity (VS (r (Variable r)))
forall (r :: * -&gt; *).
OOProg r =&gt;
UID -&gt; VSType r -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#variable"><span class="hs-identifier hs-var">variable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input -&gt; UID
forall c. CodeIdea c =&gt; c -&gt; UID
</span><span class="hs-identifier hs-var">codeName</span></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679328687"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeType -&gt; VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; CodeType -&gt; VSType r
</span><span class="hs-identifier hs-var">convType</span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679328686"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span>      </span><span class="annot"><a href="#local-6989586621679328685"><span class="hs-identifier hs-var">toGOOLVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679328684"><span class="annot"><span class="annottext">o :: c
</span><a href="#local-6989586621679328684"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-182"></span><span>        </span><span id="local-6989586621679328683"><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679328683"><span class="hs-identifier hs-var">ot</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">c -&gt; GenState CodeType
forall c. HasSpace c =&gt; c -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#codeType"><span class="hs-identifier hs-var">codeType</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679328684"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-183"></span><span>        </span><span class="annot"><span class="annottext">VS (r (Variable r))
-&gt; StateT DrasilState Identity (VS (r (Variable r)))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(VS (r (Variable r))
 -&gt; StateT DrasilState Identity (VS (r (Variable r))))
-&gt; VS (r (Variable r))
-&gt; StateT DrasilState Identity (VS (r (Variable r)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r)) -&gt; VS (r (Variable r)) -&gt; VS (r (Variable r))
forall (r :: * -&gt; *).
VariableSym r =&gt;
SVariable r -&gt; SVariable r -&gt; SVariable r
</span><span class="hs-identifier hs-var">objVar</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UID -&gt; VSType r -&gt; VS (r (Variable r))
forall (r :: * -&gt; *).
VariableSym r =&gt;
UID -&gt; VSType r -&gt; SVariable r
</span><span class="hs-identifier hs-var">var</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">c -&gt; UID
forall c. CodeIdea c =&gt; c -&gt; UID
</span><span class="hs-identifier hs-var">codeName</span></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679328684"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeType -&gt; VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; CodeType -&gt; VSType r
</span><span class="hs-identifier hs-var">convType</span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679328683"><span class="hs-identifier hs-var">ot</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-184"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UID -&gt; VSType r -&gt; VS (r (Variable r))
forall (r :: * -&gt; *).
VariableSym r =&gt;
UID -&gt; VSType r -&gt; SVariable r
</span><span class="hs-identifier hs-var">var</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input -&gt; UID
forall c. CodeIdea c =&gt; c -&gt; UID
</span><span class="hs-identifier hs-var">codeName</span></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679328687"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeType -&gt; VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; CodeType -&gt; VSType r
</span><span class="hs-identifier hs-var">convType</span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679328686"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>  </span><span class="annot"><span class="annottext">Maybe CodeChunk -&gt; GenState (SVariable r)
forall (r :: * -&gt; *) c.
(OOProg r, HasSpace c, CodeIdea c) =&gt;
Maybe c -&gt; StateT DrasilState Identity (VS (r (Variable r)))
</span><a href="#local-6989586621679328685"><span class="hs-identifier hs-var">toGOOLVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679328687"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Input
-&gt; Getting (Maybe CodeChunk) Input (Maybe CodeChunk)
-&gt; Maybe CodeChunk
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting (Maybe CodeChunk) Input (Maybe CodeChunk)
Lens' Input (Maybe CodeChunk)
</span><span class="hs-identifier hs-var">obv</span></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span class="hs-comment">-- | Generates a GOOL Parameter for a parameter represented by a 'ParameterChunk'.</span><span>
</span><span id="line-188"></span><span id="local-6989586621679329062"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#mkParam"><span class="hs-identifier hs-type">mkParam</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679329062"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Chunk.Parameter.html#ParameterChunk"><span class="hs-identifier hs-type">ParameterChunk</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MSParameter</span></span><span> </span><span class="annot"><a href="#local-6989586621679329062"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-189"></span><span id="mkParam"><span class="annot"><span class="annottext">mkParam :: ParameterChunk -&gt; GenState (MSParameter r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkParam"><span class="hs-identifier hs-var hs-var">mkParam</span></a></span></span><span> </span><span id="local-6989586621679328681"><span class="annot"><span class="annottext">p :: ParameterChunk
</span><a href="#local-6989586621679328681"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-190"></span><span>  </span><span id="local-6989586621679328680"><span class="annot"><span class="annottext">VS (r (Variable r))
</span><a href="#local-6989586621679328680"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input -&gt; GenState (VS (r (Variable r)))
forall (r :: * -&gt; *). OOProg r =&gt; Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParameterChunk -&gt; Input
forall c. (Quantity c, MayHaveUnit c) =&gt; c -&gt; Input
</span><span class="hs-identifier hs-var">quantvar</span></span><span> </span><span class="annot"><span class="annottext">ParameterChunk
</span><a href="#local-6989586621679328681"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-191"></span><span>  </span><span class="annot"><span class="annottext">MSParameter r -&gt; GenState (MSParameter r)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSParameter r -&gt; GenState (MSParameter r))
-&gt; MSParameter r -&gt; GenState (MSParameter r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PassBy -&gt; VS (r (Variable r)) -&gt; MSParameter r
forall (r :: * -&gt; *).
ParameterSym r =&gt;
PassBy -&gt; VS (r (Variable r)) -&gt; MS (r (Parameter r))
</span><a href="#local-6989586621679328679"><span class="hs-identifier hs-var">paramFunc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParameterChunk -&gt; PassBy
</span><a href="Language.Drasil.Chunk.Parameter.html#passBy"><span class="hs-identifier hs-var hs-var">passBy</span></a></span><span> </span><span class="annot"><span class="annottext">ParameterChunk
</span><a href="#local-6989586621679328681"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
</span><a href="#local-6989586621679328680"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-192"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679328679"><span class="annot"><span class="annottext">paramFunc :: PassBy -&gt; VS (r (Variable r)) -&gt; MS (r (Parameter r))
</span><a href="#local-6989586621679328679"><span class="hs-identifier hs-var hs-var">paramFunc</span></a></span></span><span> </span><span class="annot"><a href="Language.Drasil.Chunk.Parameter.html#Ref"><span class="hs-identifier hs-type">Ref</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r)) -&gt; MS (r (Parameter r))
forall (r :: * -&gt; *).
ParameterSym r =&gt;
SVariable r -&gt; MSParameter r
</span><span class="hs-identifier hs-var">pointerParam</span></span><span>
</span><span id="line-193"></span><span>        </span><span class="annot"><a href="#local-6989586621679328679"><span class="hs-identifier hs-var">paramFunc</span></a></span><span> </span><span class="annot"><a href="Language.Drasil.Chunk.Parameter.html#Val"><span class="hs-identifier hs-type">Val</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r)) -&gt; MS (r (Parameter r))
forall (r :: * -&gt; *).
ParameterSym r =&gt;
SVariable r -&gt; MSParameter r
</span><span class="hs-identifier hs-var">param</span></span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span class="hs-comment">-- | Generates a public function.</span><span>
</span><span id="line-196"></span><span id="local-6989586621679328948"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#publicFunc"><span class="hs-identifier hs-type">publicFunc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679328948"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Label</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VSType</span></span><span> </span><span class="annot"><a href="#local-6989586621679328948"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Description"><span class="hs-identifier hs-type">Description</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span>
</span><span id="line-197"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Chunk.Parameter.html#ParameterChunk"><span class="hs-identifier hs-type">ParameterChunk</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Description"><span class="hs-identifier hs-type">Description</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSBlock</span></span><span> </span><span class="annot"><a href="#local-6989586621679328948"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span>
</span><span id="line-198"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679328948"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-199"></span><span id="publicFunc"><span class="annot"><span class="annottext">publicFunc :: UID
-&gt; VSType r
-&gt; UID
-&gt; [ParameterChunk]
-&gt; Maybe UID
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#publicFunc"><span class="hs-identifier hs-var hs-var">publicFunc</span></a></span></span><span> </span><span id="local-6989586621679328673"><span class="annot"><span class="annottext">n :: UID
</span><a href="#local-6989586621679328673"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679328672"><span class="annot"><span class="annottext">t :: VSType r
</span><a href="#local-6989586621679328672"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([MSParameter r] -&gt; MSBody r -&gt; SMethod r)
-&gt; UID
-&gt; UID
-&gt; [ParameterChunk]
-&gt; Maybe UID
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
forall (r :: * -&gt; *).
OOProg r =&gt;
([MSParameter r] -&gt; MSBody r -&gt; SMethod r)
-&gt; UID
-&gt; UID
-&gt; [ParameterChunk]
-&gt; Maybe UID
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genMethod"><span class="hs-identifier hs-var">genMethod</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UID
-&gt; r (Scope r)
-&gt; VSType r
-&gt; [MSParameter r]
-&gt; MSBody r
-&gt; SMethod r
forall (r :: * -&gt; *).
MethodSym r =&gt;
UID
-&gt; r (Scope r)
-&gt; VSType r
-&gt; [MSParameter r]
-&gt; MSBody r
-&gt; SMethod r
</span><span class="hs-identifier hs-var">function</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328673"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">r (Scope r)
forall (r :: * -&gt; *). ScopeSym r =&gt; r (Scope r)
</span><span class="hs-identifier hs-var">public</span></span><span> </span><span class="annot"><span class="annottext">VSType r
</span><a href="#local-6989586621679328672"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328673"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="hs-comment">-- | Generates a public method.</span><span>
</span><span id="line-202"></span><span id="local-6989586621679328668"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#publicMethod"><span class="hs-identifier hs-type">publicMethod</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679328668"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Label</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VSType</span></span><span> </span><span class="annot"><a href="#local-6989586621679328668"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Description"><span class="hs-identifier hs-type">Description</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span>
</span><span id="line-203"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Chunk.Parameter.html#ParameterChunk"><span class="hs-identifier hs-type">ParameterChunk</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Description"><span class="hs-identifier hs-type">Description</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSBlock</span></span><span> </span><span class="annot"><a href="#local-6989586621679328668"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span>
</span><span id="line-204"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679328668"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-205"></span><span id="publicMethod"><span class="annot"><span class="annottext">publicMethod :: UID
-&gt; VSType r
-&gt; UID
-&gt; [ParameterChunk]
-&gt; Maybe UID
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#publicMethod"><span class="hs-identifier hs-var hs-var">publicMethod</span></a></span></span><span> </span><span id="local-6989586621679328666"><span class="annot"><span class="annottext">n :: UID
</span><a href="#local-6989586621679328666"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679328665"><span class="annot"><span class="annottext">t :: VSType r
</span><a href="#local-6989586621679328665"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([MSParameter r] -&gt; MSBody r -&gt; SMethod r)
-&gt; UID
-&gt; UID
-&gt; [ParameterChunk]
-&gt; Maybe UID
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
forall (r :: * -&gt; *).
OOProg r =&gt;
([MSParameter r] -&gt; MSBody r -&gt; SMethod r)
-&gt; UID
-&gt; UID
-&gt; [ParameterChunk]
-&gt; Maybe UID
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genMethod"><span class="hs-identifier hs-var">genMethod</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UID
-&gt; r (Scope r)
-&gt; r (Permanence r)
-&gt; VSType r
-&gt; [MSParameter r]
-&gt; MSBody r
-&gt; SMethod r
forall (r :: * -&gt; *).
MethodSym r =&gt;
UID
-&gt; r (Scope r)
-&gt; r (Permanence r)
-&gt; VSType r
-&gt; [MSParameter r]
-&gt; MSBody r
-&gt; SMethod r
</span><span class="hs-identifier hs-var">method</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328666"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">r (Scope r)
forall (r :: * -&gt; *). ScopeSym r =&gt; r (Scope r)
</span><span class="hs-identifier hs-var">public</span></span><span> </span><span class="annot"><span class="annottext">r (Permanence r)
forall (r :: * -&gt; *). PermanenceSym r =&gt; r (Permanence r)
</span><span class="hs-keyword hs-var">dynamic</span></span><span> </span><span class="annot"><span class="annottext">VSType r
</span><a href="#local-6989586621679328665"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328666"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span class="hs-comment">-- | Generates a private method.</span><span>
</span><span id="line-208"></span><span id="local-6989586621679328662"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#privateMethod"><span class="hs-identifier hs-type">privateMethod</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679328662"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Label</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VSType</span></span><span> </span><span class="annot"><a href="#local-6989586621679328662"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Description"><span class="hs-identifier hs-type">Description</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span>
</span><span id="line-209"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Chunk.Parameter.html#ParameterChunk"><span class="hs-identifier hs-type">ParameterChunk</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Description"><span class="hs-identifier hs-type">Description</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSBlock</span></span><span> </span><span class="annot"><a href="#local-6989586621679328662"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span>
</span><span id="line-210"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679328662"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-211"></span><span id="privateMethod"><span class="annot"><span class="annottext">privateMethod :: UID
-&gt; VSType r
-&gt; UID
-&gt; [ParameterChunk]
-&gt; Maybe UID
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#privateMethod"><span class="hs-identifier hs-var hs-var">privateMethod</span></a></span></span><span> </span><span id="local-6989586621679328661"><span class="annot"><span class="annottext">n :: UID
</span><a href="#local-6989586621679328661"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679328660"><span class="annot"><span class="annottext">t :: VSType r
</span><a href="#local-6989586621679328660"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([MSParameter r] -&gt; MSBody r -&gt; SMethod r)
-&gt; UID
-&gt; UID
-&gt; [ParameterChunk]
-&gt; Maybe UID
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
forall (r :: * -&gt; *).
OOProg r =&gt;
([MSParameter r] -&gt; MSBody r -&gt; SMethod r)
-&gt; UID
-&gt; UID
-&gt; [ParameterChunk]
-&gt; Maybe UID
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genMethod"><span class="hs-identifier hs-var">genMethod</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UID
-&gt; r (Scope r)
-&gt; r (Permanence r)
-&gt; VSType r
-&gt; [MSParameter r]
-&gt; MSBody r
-&gt; SMethod r
forall (r :: * -&gt; *).
MethodSym r =&gt;
UID
-&gt; r (Scope r)
-&gt; r (Permanence r)
-&gt; VSType r
-&gt; [MSParameter r]
-&gt; MSBody r
-&gt; SMethod r
</span><span class="hs-identifier hs-var">method</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328661"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">r (Scope r)
forall (r :: * -&gt; *). ScopeSym r =&gt; r (Scope r)
</span><span class="hs-identifier hs-var">private</span></span><span> </span><span class="annot"><span class="annottext">r (Permanence r)
forall (r :: * -&gt; *). PermanenceSym r =&gt; r (Permanence r)
</span><span class="hs-keyword hs-var">dynamic</span></span><span> </span><span class="annot"><span class="annottext">VSType r
</span><a href="#local-6989586621679328660"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328661"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span class="hs-comment">-- | Generates a public function, defined by its inputs and outputs.</span><span>
</span><span id="line-214"></span><span id="local-6989586621679328658"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#publicInOutFunc"><span class="hs-identifier hs-type">publicInOutFunc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679328658"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Label</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Description"><span class="hs-identifier hs-type">Description</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">CodeVarChunk</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span>
</span><span id="line-215"></span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">CodeVarChunk</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSBlock</span></span><span> </span><span class="annot"><a href="#local-6989586621679328658"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679328658"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-216"></span><span id="publicInOutFunc"><span class="annot"><span class="annottext">publicInOutFunc :: UID
-&gt; UID -&gt; [Input] -&gt; [Input] -&gt; [MSBlock r] -&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#publicInOutFunc"><span class="hs-identifier hs-var hs-var">publicInOutFunc</span></a></span></span><span> </span><span id="local-6989586621679328657"><span class="annot"><span class="annottext">n :: UID
</span><a href="#local-6989586621679328657"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([SVariable r]
 -&gt; [SVariable r] -&gt; [SVariable r] -&gt; MSBody r -&gt; SMethod r)
-&gt; (UID
    -&gt; [(UID, SVariable r)]
    -&gt; [(UID, SVariable r)]
    -&gt; [(UID, SVariable r)]
    -&gt; MSBody r
    -&gt; SMethod r)
-&gt; UID
-&gt; UID
-&gt; [Input]
-&gt; [Input]
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
forall (r :: * -&gt; *).
OOProg r =&gt;
([SVariable r]
 -&gt; [SVariable r] -&gt; [SVariable r] -&gt; MSBody r -&gt; SMethod r)
-&gt; (UID
    -&gt; [(UID, SVariable r)]
    -&gt; [(UID, SVariable r)]
    -&gt; [(UID, SVariable r)]
    -&gt; MSBody r
    -&gt; SMethod r)
-&gt; UID
-&gt; UID
-&gt; [Input]
-&gt; [Input]
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genInOutFunc"><span class="hs-identifier hs-var">genInOutFunc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UID
-&gt; r (Scope r)
-&gt; [SVariable r]
-&gt; [SVariable r]
-&gt; [SVariable r]
-&gt; MSBody r
-&gt; SMethod r
forall (r :: * -&gt; *).
MethodSym r =&gt;
UID -&gt; r (Scope r) -&gt; InOutFunc r
</span><span class="hs-identifier hs-var">inOutFunc</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328657"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">r (Scope r)
forall (r :: * -&gt; *). ScopeSym r =&gt; r (Scope r)
</span><span class="hs-identifier hs-var">public</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UID
-&gt; r (Scope r)
-&gt; UID
-&gt; [(UID, SVariable r)]
-&gt; [(UID, SVariable r)]
-&gt; [(UID, SVariable r)]
-&gt; MSBody r
-&gt; SMethod r
forall (r :: * -&gt; *).
MethodSym r =&gt;
UID -&gt; r (Scope r) -&gt; DocInOutFunc r
</span><span class="hs-identifier hs-var">docInOutFunc</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328657"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">r (Scope r)
forall (r :: * -&gt; *). ScopeSym r =&gt; r (Scope r)
</span><span class="hs-identifier hs-var">public</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328657"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-217"></span><span>
</span><span id="line-218"></span><span class="hs-comment">-- | Generates a private method, defined by its inputs and outputs.</span><span>
</span><span id="line-219"></span><span id="local-6989586621679328653"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#privateInOutMethod"><span class="hs-identifier hs-type">privateInOutMethod</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679328653"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Label</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Description"><span class="hs-identifier hs-type">Description</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">CodeVarChunk</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span>
</span><span id="line-220"></span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">CodeVarChunk</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSBlock</span></span><span> </span><span class="annot"><a href="#local-6989586621679328653"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679328653"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-221"></span><span id="privateInOutMethod"><span class="annot"><span class="annottext">privateInOutMethod :: UID
-&gt; UID -&gt; [Input] -&gt; [Input] -&gt; [MSBlock r] -&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#privateInOutMethod"><span class="hs-identifier hs-var hs-var">privateInOutMethod</span></a></span></span><span> </span><span id="local-6989586621679328652"><span class="annot"><span class="annottext">n :: UID
</span><a href="#local-6989586621679328652"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([SVariable r]
 -&gt; [SVariable r] -&gt; [SVariable r] -&gt; MSBody r -&gt; SMethod r)
-&gt; (UID
    -&gt; [(UID, SVariable r)]
    -&gt; [(UID, SVariable r)]
    -&gt; [(UID, SVariable r)]
    -&gt; MSBody r
    -&gt; SMethod r)
-&gt; UID
-&gt; UID
-&gt; [Input]
-&gt; [Input]
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
forall (r :: * -&gt; *).
OOProg r =&gt;
([SVariable r]
 -&gt; [SVariable r] -&gt; [SVariable r] -&gt; MSBody r -&gt; SMethod r)
-&gt; (UID
    -&gt; [(UID, SVariable r)]
    -&gt; [(UID, SVariable r)]
    -&gt; [(UID, SVariable r)]
    -&gt; MSBody r
    -&gt; SMethod r)
-&gt; UID
-&gt; UID
-&gt; [Input]
-&gt; [Input]
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genInOutFunc"><span class="hs-identifier hs-var">genInOutFunc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UID
-&gt; r (Scope r)
-&gt; r (Permanence r)
-&gt; [SVariable r]
-&gt; [SVariable r]
-&gt; [SVariable r]
-&gt; MSBody r
-&gt; SMethod r
forall (r :: * -&gt; *).
MethodSym r =&gt;
UID -&gt; r (Scope r) -&gt; r (Permanence r) -&gt; InOutFunc r
</span><span class="hs-identifier hs-var">inOutMethod</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328652"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">r (Scope r)
forall (r :: * -&gt; *). ScopeSym r =&gt; r (Scope r)
</span><span class="hs-identifier hs-var">private</span></span><span> </span><span class="annot"><span class="annottext">r (Permanence r)
forall (r :: * -&gt; *). PermanenceSym r =&gt; r (Permanence r)
</span><span class="hs-keyword hs-var">dynamic</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UID
-&gt; r (Scope r)
-&gt; r (Permanence r)
-&gt; UID
-&gt; [(UID, SVariable r)]
-&gt; [(UID, SVariable r)]
-&gt; [(UID, SVariable r)]
-&gt; MSBody r
-&gt; SMethod r
forall (r :: * -&gt; *).
MethodSym r =&gt;
UID -&gt; r (Scope r) -&gt; r (Permanence r) -&gt; DocInOutFunc r
</span><span class="hs-identifier hs-var">docInOutMethod</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328652"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">r (Scope r)
forall (r :: * -&gt; *). ScopeSym r =&gt; r (Scope r)
</span><span class="hs-identifier hs-var">private</span></span><span> </span><span class="annot"><span class="annottext">r (Permanence r)
forall (r :: * -&gt; *). PermanenceSym r =&gt; r (Permanence r)
</span><span class="hs-keyword hs-var">dynamic</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328652"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span class="hs-comment">-- | Generates a constructor.</span><span>
</span><span id="line-224"></span><span id="local-6989586621679328649"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#genConstructor"><span class="hs-identifier hs-type">genConstructor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679328649"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Label</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Description"><span class="hs-identifier hs-type">Description</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Chunk.Parameter.html#ParameterChunk"><span class="hs-identifier hs-type">ParameterChunk</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span>
</span><span id="line-225"></span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSBlock</span></span><span> </span><span class="annot"><a href="#local-6989586621679328649"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679328649"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-226"></span><span id="genConstructor"><span class="annot"><span class="annottext">genConstructor :: UID
-&gt; UID -&gt; [ParameterChunk] -&gt; [MSBlock r] -&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genConstructor"><span class="hs-identifier hs-var hs-var">genConstructor</span></a></span></span><span> </span><span id="local-6989586621679328648"><span class="annot"><span class="annottext">n :: UID
</span><a href="#local-6989586621679328648"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679328647"><span class="annot"><span class="annottext">desc :: UID
</span><a href="#local-6989586621679328647"><span class="hs-identifier hs-var">desc</span></a></span></span><span> </span><span id="local-6989586621679328646"><span class="annot"><span class="annottext">p :: [ParameterChunk]
</span><a href="#local-6989586621679328646"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([MSParameter r] -&gt; MSBody r -&gt; SMethod r)
-&gt; UID
-&gt; UID
-&gt; [ParameterChunk]
-&gt; Maybe UID
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
forall (r :: * -&gt; *).
OOProg r =&gt;
([MSParameter r] -&gt; MSBody r -&gt; SMethod r)
-&gt; UID
-&gt; UID
-&gt; [ParameterChunk]
-&gt; Maybe UID
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genMethod"><span class="hs-identifier hs-var">genMethod</span></a></span><span> </span><span class="annot"><span class="annottext">[MSParameter r] -&gt; MSBody r -&gt; SMethod r
forall (r :: * -&gt; *).
MethodSym r =&gt;
[MSParameter r] -&gt; MSBody r -&gt; SMethod r
</span><span class="hs-identifier hs-var">nonInitConstructor</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328648"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328647"><span class="hs-identifier hs-var">desc</span></a></span><span> </span><span class="annot"><span class="annottext">[ParameterChunk]
</span><a href="#local-6989586621679328646"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe UID
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span class="hs-comment">-- | Generates a constructor that includes initialization of variables.</span><span>
</span><span id="line-229"></span><span id="local-6989586621679328924"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#genInitConstructor"><span class="hs-identifier hs-type">genInitConstructor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679328924"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Label</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Description"><span class="hs-identifier hs-type">Description</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Chunk.Parameter.html#ParameterChunk"><span class="hs-identifier hs-type">ParameterChunk</span></a></span><span class="hs-special">]</span><span> </span><span>
</span><span id="line-230"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Initializers</span></span><span> </span><span class="annot"><a href="#local-6989586621679328924"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSBlock</span></span><span> </span><span class="annot"><a href="#local-6989586621679328924"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679328924"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-231"></span><span id="genInitConstructor"><span class="annot"><span class="annottext">genInitConstructor :: UID
-&gt; UID
-&gt; [ParameterChunk]
-&gt; Initializers r
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genInitConstructor"><span class="hs-identifier hs-var hs-var">genInitConstructor</span></a></span></span><span> </span><span id="local-6989586621679328644"><span class="annot"><span class="annottext">n :: UID
</span><a href="#local-6989586621679328644"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679328643"><span class="annot"><span class="annottext">desc :: UID
</span><a href="#local-6989586621679328643"><span class="hs-identifier hs-var">desc</span></a></span></span><span> </span><span id="local-6989586621679328642"><span class="annot"><span class="annottext">p :: [ParameterChunk]
</span><a href="#local-6989586621679328642"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679328641"><span class="annot"><span class="annottext">is :: Initializers r
</span><a href="#local-6989586621679328641"><span class="hs-identifier hs-var">is</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([MSParameter r] -&gt; MSBody r -&gt; SMethod r)
-&gt; UID
-&gt; UID
-&gt; [ParameterChunk]
-&gt; Maybe UID
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
forall (r :: * -&gt; *).
OOProg r =&gt;
([MSParameter r] -&gt; MSBody r -&gt; SMethod r)
-&gt; UID
-&gt; UID
-&gt; [ParameterChunk]
-&gt; Maybe UID
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genMethod"><span class="hs-identifier hs-var">genMethod</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MSParameter r] -&gt; Initializers r -&gt; MSBody r -&gt; SMethod r
forall (r :: * -&gt; *).
MethodSym r =&gt;
[MSParameter r] -&gt; Initializers r -&gt; MSBody r -&gt; SMethod r
</span><span class="hs-operator hs-var">`constructor`</span></span><span> </span><span class="annot"><span class="annottext">Initializers r
</span><a href="#local-6989586621679328641"><span class="hs-identifier hs-var">is</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328644"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328643"><span class="hs-identifier hs-var">desc</span></a></span><span> </span><span class="annot"><span class="annottext">[ParameterChunk]
</span><a href="#local-6989586621679328642"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span>
</span><span id="line-232"></span><span>  </span><span class="annot"><span class="annottext">Maybe UID
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-233"></span><span>
</span><span id="line-234"></span><span class="hs-comment">-- | Generates a function or method using the passed GOOL constructor. Other </span><span>
</span><span id="line-235"></span><span class="hs-comment">-- parameters are the method's name, description, list of parameters, </span><span>
</span><span id="line-236"></span><span class="hs-comment">-- description of what is returned (if applicable), and body.</span><span>
</span><span id="line-237"></span><span id="local-6989586621679329087"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#genMethod"><span class="hs-identifier hs-type">genMethod</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679329087"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSParameter</span></span><span> </span><span class="annot"><a href="#local-6989586621679329087"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MSBody</span></span><span> </span><span class="annot"><a href="#local-6989586621679329087"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679329087"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span>
</span><span id="line-238"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Label</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Description"><span class="hs-identifier hs-type">Description</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Chunk.Parameter.html#ParameterChunk"><span class="hs-identifier hs-type">ParameterChunk</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Description"><span class="hs-identifier hs-type">Description</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSBlock</span></span><span> </span><span class="annot"><a href="#local-6989586621679329087"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span> </span><span>
</span><span id="line-239"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679329087"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-240"></span><span id="genMethod"><span class="annot"><span class="annottext">genMethod :: ([MSParameter r] -&gt; MSBody r -&gt; SMethod r)
-&gt; UID
-&gt; UID
-&gt; [ParameterChunk]
-&gt; Maybe UID
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genMethod"><span class="hs-identifier hs-var hs-var">genMethod</span></a></span></span><span> </span><span id="local-6989586621679328639"><span class="annot"><span class="annottext">f :: [MSParameter r] -&gt; MSBody r -&gt; SMethod r
</span><a href="#local-6989586621679328639"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679328638"><span class="annot"><span class="annottext">n :: UID
</span><a href="#local-6989586621679328638"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679328637"><span class="annot"><span class="annottext">desc :: UID
</span><a href="#local-6989586621679328637"><span class="hs-identifier hs-var">desc</span></a></span></span><span> </span><span id="local-6989586621679328636"><span class="annot"><span class="annottext">p :: [ParameterChunk]
</span><a href="#local-6989586621679328636"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679328635"><span class="annot"><span class="annottext">r :: Maybe UID
</span><a href="#local-6989586621679328635"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679328634"><span class="annot"><span class="annottext">b :: [MSBlock r]
</span><a href="#local-6989586621679328634"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-241"></span><span>  </span><span id="local-6989586621679328633"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679328633"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-242"></span><span>  </span><span id="local-6989586621679328632"><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679328632"><span class="hs-identifier hs-var">vars</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ParameterChunk
 -&gt; StateT DrasilState Identity (VS (r (Variable r))))
-&gt; [ParameterChunk]
-&gt; StateT DrasilState Identity [VS (r (Variable r))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input -&gt; StateT DrasilState Identity (VS (r (Variable r)))
forall (r :: * -&gt; *). OOProg r =&gt; Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="annot"><span class="annottext">(Input -&gt; StateT DrasilState Identity (VS (r (Variable r))))
-&gt; (ParameterChunk -&gt; Input)
-&gt; ParameterChunk
-&gt; StateT DrasilState Identity (VS (r (Variable r)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ParameterChunk -&gt; Input
forall c. (Quantity c, MayHaveUnit c) =&gt; c -&gt; Input
</span><span class="hs-identifier hs-var">quantvar</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ParameterChunk]
</span><a href="#local-6989586621679328636"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-243"></span><span>  </span><span id="local-6989586621679328630"><span class="annot"><span class="annottext">[MSParameter r]
</span><a href="#local-6989586621679328630"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ParameterChunk -&gt; StateT DrasilState Identity (MSParameter r))
-&gt; [ParameterChunk] -&gt; StateT DrasilState Identity [MSParameter r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">ParameterChunk -&gt; StateT DrasilState Identity (MSParameter r)
forall (r :: * -&gt; *).
OOProg r =&gt;
ParameterChunk -&gt; GenState (MSParameter r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkParam"><span class="hs-identifier hs-var">mkParam</span></a></span><span> </span><span class="annot"><span class="annottext">[ParameterChunk]
</span><a href="#local-6989586621679328636"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-244"></span><span>  </span><span id="local-6989586621679328629"><span class="annot"><span class="annottext">MSBody r
</span><a href="#local-6989586621679328629"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UID -&gt; [VS (r (Variable r))] -&gt; [MSBlock r] -&gt; GenState (MSBody r)
forall (r :: * -&gt; *).
OOProg r =&gt;
UID -&gt; [SVariable r] -&gt; [MSBlock r] -&gt; GenState (MSBody r)
</span><a href="Language.Drasil.Code.Imperative.Logging.html#logBody"><span class="hs-identifier hs-var">logBody</span></a></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328638"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679328632"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="annot"><span class="annottext">[MSBlock r]
</span><a href="#local-6989586621679328634"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-245"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679328628"><span class="annot"><span class="annottext">fn :: SMethod r
</span><a href="#local-6989586621679328628"><span class="hs-identifier hs-var hs-var">fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[MSParameter r] -&gt; MSBody r -&gt; SMethod r
</span><a href="#local-6989586621679328639"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[MSParameter r]
</span><a href="#local-6989586621679328630"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">MSBody r
</span><a href="#local-6989586621679328629"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-246"></span><span>  </span><span id="local-6989586621679328627"><span class="annot"><span class="annottext">[UID]
</span><a href="#local-6989586621679328627"><span class="hs-identifier hs-var">pComms</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ParameterChunk -&gt; StateT DrasilState Identity UID)
-&gt; [ParameterChunk] -&gt; StateT DrasilState Identity [UID]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">ParameterChunk -&gt; StateT DrasilState Identity UID
forall c. CodeIdea c =&gt; c -&gt; StateT DrasilState Identity UID
</span><a href="Language.Drasil.Code.Imperative.Comments.html#getComment"><span class="hs-identifier hs-var">getComment</span></a></span><span> </span><span class="annot"><span class="annottext">[ParameterChunk]
</span><a href="#local-6989586621679328636"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-247"></span><span>  </span><span class="annot"><span class="annottext">SMethod r -&gt; GenState (SMethod r)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SMethod r -&gt; GenState (SMethod r))
-&gt; SMethod r -&gt; GenState (SMethod r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Comments
</span><a href="Language.Drasil.Choices.html#CommentFunc"><span class="hs-identifier hs-var">CommentFunc</span></a></span><span> </span><span class="annot"><span class="annottext">Comments -&gt; [Comments] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; [Comments]
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#commented"><span class="hs-identifier hs-var hs-var">commented</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679328633"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-248"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">UID -&gt; [UID] -&gt; Maybe UID -&gt; SMethod r -&gt; SMethod r
forall (r :: * -&gt; *).
MethodSym r =&gt;
UID -&gt; [UID] -&gt; Maybe UID -&gt; SMethod r -&gt; SMethod r
</span><span class="hs-identifier hs-var">docFunc</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328637"><span class="hs-identifier hs-var">desc</span></a></span><span> </span><span class="annot"><span class="annottext">[UID]
</span><a href="#local-6989586621679328627"><span class="hs-identifier hs-var">pComms</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe UID
</span><a href="#local-6989586621679328635"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">SMethod r
</span><a href="#local-6989586621679328628"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">SMethod r
</span><a href="#local-6989586621679328628"><span class="hs-identifier hs-var">fn</span></a></span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span class="hs-comment">-- | Generates a function or method defined by its inputs and outputs. </span><span>
</span><span id="line-251"></span><span class="hs-comment">-- Parameters are: the GOOL constructor to use, the equivalent GOOL constructor </span><span>
</span><span id="line-252"></span><span class="hs-comment">-- for a documented function/method, the scope, permanence, name, description, </span><span>
</span><span id="line-253"></span><span class="hs-comment">-- list of inputs, list of outputs, and body.</span><span>
</span><span id="line-254"></span><span id="local-6989586621679329075"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#genInOutFunc"><span class="hs-identifier hs-type">genInOutFunc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679329075"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">SVariable</span></span><span> </span><span class="annot"><a href="#local-6989586621679329075"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">SVariable</span></span><span> </span><span class="annot"><a href="#local-6989586621679329075"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span>
</span><span id="line-255"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">SVariable</span></span><span> </span><span class="annot"><a href="#local-6989586621679329075"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MSBody</span></span><span> </span><span class="annot"><a href="#local-6989586621679329075"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679329075"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span>
</span><span id="line-256"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SVariable</span></span><span> </span><span class="annot"><a href="#local-6989586621679329075"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SVariable</span></span><span> </span><span class="annot"><a href="#local-6989586621679329075"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span>
</span><span id="line-257"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SVariable</span></span><span> </span><span class="annot"><a href="#local-6989586621679329075"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MSBody</span></span><span> </span><span class="annot"><a href="#local-6989586621679329075"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679329075"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Label</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Description"><span class="hs-identifier hs-type">Description</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">CodeVarChunk</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">CodeVarChunk</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span>
</span><span id="line-259"></span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSBlock</span></span><span> </span><span class="annot"><a href="#local-6989586621679329075"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679329075"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-260"></span><span id="genInOutFunc"><span class="annot"><span class="annottext">genInOutFunc :: ([SVariable r]
 -&gt; [SVariable r] -&gt; [SVariable r] -&gt; MSBody r -&gt; SMethod r)
-&gt; (UID
    -&gt; [(UID, SVariable r)]
    -&gt; [(UID, SVariable r)]
    -&gt; [(UID, SVariable r)]
    -&gt; MSBody r
    -&gt; SMethod r)
-&gt; UID
-&gt; UID
-&gt; [Input]
-&gt; [Input]
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genInOutFunc"><span class="hs-identifier hs-var hs-var">genInOutFunc</span></a></span></span><span> </span><span id="local-6989586621679328622"><span class="annot"><span class="annottext">f :: [SVariable r]
-&gt; [SVariable r] -&gt; [SVariable r] -&gt; MSBody r -&gt; SMethod r
</span><a href="#local-6989586621679328622"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679328621"><span class="annot"><span class="annottext">docf :: UID
-&gt; [(UID, SVariable r)]
-&gt; [(UID, SVariable r)]
-&gt; [(UID, SVariable r)]
-&gt; MSBody r
-&gt; SMethod r
</span><a href="#local-6989586621679328621"><span class="hs-identifier hs-var">docf</span></a></span></span><span> </span><span id="local-6989586621679328620"><span class="annot"><span class="annottext">n :: UID
</span><a href="#local-6989586621679328620"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679328619"><span class="annot"><span class="annottext">desc :: UID
</span><a href="#local-6989586621679328619"><span class="hs-identifier hs-var">desc</span></a></span></span><span> </span><span id="local-6989586621679328618"><span class="annot"><span class="annottext">ins' :: [Input]
</span><a href="#local-6989586621679328618"><span class="hs-identifier hs-var">ins'</span></a></span></span><span> </span><span id="local-6989586621679328617"><span class="annot"><span class="annottext">outs' :: [Input]
</span><a href="#local-6989586621679328617"><span class="hs-identifier hs-var">outs'</span></a></span></span><span> </span><span id="local-6989586621679328616"><span class="annot"><span class="annottext">b :: [MSBlock r]
</span><a href="#local-6989586621679328616"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-261"></span><span>  </span><span id="local-6989586621679328615"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679328615"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-262"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679328614"><span class="annot"><span class="annottext">ins :: [Input]
</span><a href="#local-6989586621679328614"><span class="hs-identifier hs-var hs-var">ins</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679328618"><span class="hs-identifier hs-var">ins'</span></a></span><span> </span><span class="annot"><span class="annottext">[Input] -&gt; [Input] -&gt; [Input]
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">\\</span></span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679328617"><span class="hs-identifier hs-var">outs'</span></a></span><span>
</span><span id="line-263"></span><span>      </span><span id="local-6989586621679328613"><span class="annot"><span class="annottext">outs :: [Input]
</span><a href="#local-6989586621679328613"><span class="hs-identifier hs-var hs-var">outs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679328617"><span class="hs-identifier hs-var">outs'</span></a></span><span> </span><span class="annot"><span class="annottext">[Input] -&gt; [Input] -&gt; [Input]
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">\\</span></span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679328618"><span class="hs-identifier hs-var">ins'</span></a></span><span>
</span><span id="line-264"></span><span>      </span><span id="local-6989586621679328612"><span class="annot"><span class="annottext">both :: [Input]
</span><a href="#local-6989586621679328612"><span class="hs-identifier hs-var hs-var">both</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679328618"><span class="hs-identifier hs-var">ins'</span></a></span><span> </span><span class="annot"><span class="annottext">[Input] -&gt; [Input] -&gt; [Input]
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">`intersect`</span></span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679328617"><span class="hs-identifier hs-var">outs'</span></a></span><span>
</span><span id="line-265"></span><span>  </span><span id="local-6989586621679328611"><span class="annot"><span class="annottext">[SVariable r]
</span><a href="#local-6989586621679328611"><span class="hs-identifier hs-var">inVs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Input -&gt; StateT DrasilState Identity (SVariable r))
-&gt; [Input] -&gt; StateT DrasilState Identity [SVariable r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Input -&gt; StateT DrasilState Identity (SVariable r)
forall (r :: * -&gt; *). OOProg r =&gt; Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679328614"><span class="hs-identifier hs-var">ins</span></a></span><span>
</span><span id="line-266"></span><span>  </span><span id="local-6989586621679328610"><span class="annot"><span class="annottext">[SVariable r]
</span><a href="#local-6989586621679328610"><span class="hs-identifier hs-var">outVs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Input -&gt; StateT DrasilState Identity (SVariable r))
-&gt; [Input] -&gt; StateT DrasilState Identity [SVariable r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Input -&gt; StateT DrasilState Identity (SVariable r)
forall (r :: * -&gt; *). OOProg r =&gt; Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679328613"><span class="hs-identifier hs-var">outs</span></a></span><span>
</span><span id="line-267"></span><span>  </span><span id="local-6989586621679328609"><span class="annot"><span class="annottext">[SVariable r]
</span><a href="#local-6989586621679328609"><span class="hs-identifier hs-var">bothVs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Input -&gt; StateT DrasilState Identity (SVariable r))
-&gt; [Input] -&gt; StateT DrasilState Identity [SVariable r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Input -&gt; StateT DrasilState Identity (SVariable r)
forall (r :: * -&gt; *). OOProg r =&gt; Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679328612"><span class="hs-identifier hs-var">both</span></a></span><span>
</span><span id="line-268"></span><span>  </span><span id="local-6989586621679328608"><span class="annot"><span class="annottext">MSBody r
</span><a href="#local-6989586621679328608"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UID -&gt; [SVariable r] -&gt; [MSBlock r] -&gt; GenState (MSBody r)
forall (r :: * -&gt; *).
OOProg r =&gt;
UID -&gt; [SVariable r] -&gt; [MSBlock r] -&gt; GenState (MSBody r)
</span><a href="Language.Drasil.Code.Imperative.Logging.html#logBody"><span class="hs-identifier hs-var">logBody</span></a></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328620"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SVariable r]
</span><a href="#local-6989586621679328609"><span class="hs-identifier hs-var">bothVs</span></a></span><span> </span><span class="annot"><span class="annottext">[SVariable r] -&gt; [SVariable r] -&gt; [SVariable r]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[SVariable r]
</span><a href="#local-6989586621679328611"><span class="hs-identifier hs-var">inVs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[MSBlock r]
</span><a href="#local-6989586621679328616"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-269"></span><span>  </span><span id="local-6989586621679328607"><span class="annot"><span class="annottext">[UID]
</span><a href="#local-6989586621679328607"><span class="hs-identifier hs-var">pComms</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Input -&gt; StateT DrasilState Identity UID)
-&gt; [Input] -&gt; StateT DrasilState Identity [UID]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Input -&gt; StateT DrasilState Identity UID
forall c. CodeIdea c =&gt; c -&gt; StateT DrasilState Identity UID
</span><a href="Language.Drasil.Code.Imperative.Comments.html#getComment"><span class="hs-identifier hs-var">getComment</span></a></span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679328614"><span class="hs-identifier hs-var">ins</span></a></span><span>
</span><span id="line-270"></span><span>  </span><span id="local-6989586621679328606"><span class="annot"><span class="annottext">[UID]
</span><a href="#local-6989586621679328606"><span class="hs-identifier hs-var">oComms</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Input -&gt; StateT DrasilState Identity UID)
-&gt; [Input] -&gt; StateT DrasilState Identity [UID]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Input -&gt; StateT DrasilState Identity UID
forall c. CodeIdea c =&gt; c -&gt; StateT DrasilState Identity UID
</span><a href="Language.Drasil.Code.Imperative.Comments.html#getComment"><span class="hs-identifier hs-var">getComment</span></a></span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679328613"><span class="hs-identifier hs-var">outs</span></a></span><span>
</span><span id="line-271"></span><span>  </span><span id="local-6989586621679328605"><span class="annot"><span class="annottext">[UID]
</span><a href="#local-6989586621679328605"><span class="hs-identifier hs-var">bComms</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Input -&gt; StateT DrasilState Identity UID)
-&gt; [Input] -&gt; StateT DrasilState Identity [UID]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Input -&gt; StateT DrasilState Identity UID
forall c. CodeIdea c =&gt; c -&gt; StateT DrasilState Identity UID
</span><a href="Language.Drasil.Code.Imperative.Comments.html#getComment"><span class="hs-identifier hs-var">getComment</span></a></span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679328612"><span class="hs-identifier hs-var">both</span></a></span><span>
</span><span id="line-272"></span><span>  </span><span class="annot"><span class="annottext">SMethod r -&gt; GenState (SMethod r)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SMethod r -&gt; GenState (SMethod r))
-&gt; SMethod r -&gt; GenState (SMethod r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Comments
</span><a href="Language.Drasil.Choices.html#CommentFunc"><span class="hs-identifier hs-var">CommentFunc</span></a></span><span> </span><span class="annot"><span class="annottext">Comments -&gt; [Comments] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; [Comments]
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#commented"><span class="hs-identifier hs-var hs-var">commented</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679328615"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span>
</span><span id="line-273"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">UID
-&gt; [(UID, SVariable r)]
-&gt; [(UID, SVariable r)]
-&gt; [(UID, SVariable r)]
-&gt; MSBody r
-&gt; SMethod r
</span><a href="#local-6989586621679328621"><span class="hs-identifier hs-var">docf</span></a></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328619"><span class="hs-identifier hs-var">desc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[UID] -&gt; [SVariable r] -&gt; [(UID, SVariable r)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[UID]
</span><a href="#local-6989586621679328607"><span class="hs-identifier hs-var">pComms</span></a></span><span> </span><span class="annot"><span class="annottext">[SVariable r]
</span><a href="#local-6989586621679328611"><span class="hs-identifier hs-var">inVs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[UID] -&gt; [SVariable r] -&gt; [(UID, SVariable r)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[UID]
</span><a href="#local-6989586621679328606"><span class="hs-identifier hs-var">oComms</span></a></span><span> </span><span class="annot"><span class="annottext">[SVariable r]
</span><a href="#local-6989586621679328610"><span class="hs-identifier hs-var">outVs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[UID] -&gt; [SVariable r] -&gt; [(UID, SVariable r)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span>
</span><span id="line-274"></span><span>    </span><span class="annot"><span class="annottext">[UID]
</span><a href="#local-6989586621679328605"><span class="hs-identifier hs-var">bComms</span></a></span><span> </span><span class="annot"><span class="annottext">[SVariable r]
</span><a href="#local-6989586621679328609"><span class="hs-identifier hs-var">bothVs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MSBody r
</span><a href="#local-6989586621679328608"><span class="hs-identifier hs-var">bod</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[SVariable r]
-&gt; [SVariable r] -&gt; [SVariable r] -&gt; MSBody r -&gt; SMethod r
</span><a href="#local-6989586621679328622"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[SVariable r]
</span><a href="#local-6989586621679328611"><span class="hs-identifier hs-var">inVs</span></a></span><span> </span><span class="annot"><span class="annottext">[SVariable r]
</span><a href="#local-6989586621679328610"><span class="hs-identifier hs-var">outVs</span></a></span><span> </span><span class="annot"><span class="annottext">[SVariable r]
</span><a href="#local-6989586621679328609"><span class="hs-identifier hs-var">bothVs</span></a></span><span> </span><span class="annot"><span class="annottext">MSBody r
</span><a href="#local-6989586621679328608"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span class="hs-comment">-- | Converts an 'Expr' to a GOOL Value.</span><span>
</span><span id="line-277"></span><span id="local-6989586621679329167"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-type">convExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679329167"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CodeExpr</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679329167"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-278"></span><span id="convExpr"><span class="annot"><span class="annottext">convExpr :: CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var hs-var">convExpr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dbl</span></span><span> </span><span id="local-6989586621679328603"><span class="annot"><span class="annottext">d :: Double
</span><a href="#local-6989586621679328603"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-279"></span><span>  </span><span id="local-6989586621679328602"><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679328602"><span class="hs-identifier hs-var">sm</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Space -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#spaceCodeType"><span class="hs-identifier hs-var">spaceCodeType</span></a></span><span> </span><span class="annot"><span class="annottext">Space
</span><span class="hs-identifier hs-var">Real</span></span><span>
</span><span id="line-280"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679328600"><span class="annot"><span class="annottext">getLiteral :: CodeType -&gt; StateT ValueState Identity (r (Value r))
</span><a href="#local-6989586621679328600"><span class="hs-identifier hs-var hs-var">getLiteral</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; StateT ValueState Identity (r (Value r))
forall (r :: * -&gt; *). Literal r =&gt; Double -&gt; SValue r
</span><span class="hs-identifier hs-var">litDouble</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679328603"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-281"></span><span>      </span><span class="annot"><a href="#local-6989586621679328600"><span class="hs-identifier hs-var">getLiteral</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; StateT ValueState Identity (r (Value r))
forall (r :: * -&gt; *). Literal r =&gt; Float -&gt; SValue r
</span><span class="hs-identifier hs-var">litFloat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Float
forall a b. (Real a, Fractional b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">realToFrac</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679328603"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-282"></span><span>      </span><span class="annot"><a href="#local-6989586621679328600"><span class="hs-identifier hs-var">getLiteral</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UID -&gt; StateT ValueState Identity (r (Value r))
forall a. HasCallStack =&gt; UID -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="hs-string">&quot;convExpr: Real space matched to invalid CodeType; should be Double or Float&quot;</span></span><span>
</span><span id="line-283"></span><span>  </span><span class="annot"><span class="annottext">SValue r -&gt; GenState (SValue r)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; GenState (SValue r))
-&gt; SValue r -&gt; GenState (SValue r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CodeType -&gt; SValue r
forall (r :: * -&gt; *).
Literal r =&gt;
CodeType -&gt; StateT ValueState Identity (r (Value r))
</span><a href="#local-6989586621679328600"><span class="hs-identifier hs-var">getLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679328602"><span class="hs-identifier hs-var">sm</span></a></span><span>
</span><span id="line-284"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ExactDbl</span></span><span> </span><span id="local-6989586621679328594"><span class="annot"><span class="annottext">d :: Integer
</span><a href="#local-6989586621679328594"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">(CodeExpr -&gt; GenState (SValue r))
-&gt; CodeExpr -&gt; GenState (SValue r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; CodeExpr
</span><span class="hs-identifier hs-var">Dbl</span></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; CodeExpr) -&gt; Double -&gt; CodeExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Double
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679328594"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-285"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span id="local-6989586621679328592"><span class="annot"><span class="annottext">i :: Integer
</span><a href="#local-6989586621679328592"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; GenState (SValue r)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; GenState (SValue r))
-&gt; SValue r -&gt; GenState (SValue r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; SValue r
forall (r :: * -&gt; *). Literal r =&gt; Integer -&gt; SValue r
</span><span class="hs-identifier hs-var">litInt</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679328592"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-286"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Str</span></span><span> </span><span id="local-6989586621679328589"><span class="annot"><span class="annottext">s :: UID
</span><a href="#local-6989586621679328589"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; GenState (SValue r)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; GenState (SValue r))
-&gt; SValue r -&gt; GenState (SValue r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UID -&gt; SValue r
forall (r :: * -&gt; *). Literal r =&gt; UID -&gt; SValue r
</span><span class="hs-identifier hs-var">litString</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328589"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-287"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Perc</span></span><span> </span><span id="local-6989586621679328586"><span class="annot"><span class="annottext">a :: Integer
</span><a href="#local-6989586621679328586"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679328585"><span class="annot"><span class="annottext">b :: Integer
</span><a href="#local-6989586621679328585"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-288"></span><span>  </span><span id="local-6989586621679328584"><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679328584"><span class="hs-identifier hs-var">sm</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Space -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#spaceCodeType"><span class="hs-identifier hs-var">spaceCodeType</span></a></span><span> </span><span class="annot"><span class="annottext">Space
</span><span class="hs-identifier hs-var">Rational</span></span><span>
</span><span id="line-289"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679328582"><span class="annot"><span class="annottext">getLiteral :: CodeType -&gt; Double -&gt; VS (r (Value r))
</span><a href="#local-6989586621679328582"><span class="hs-identifier hs-var hs-var">getLiteral</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; VS (r (Value r))
forall (r :: * -&gt; *). Literal r =&gt; Double -&gt; SValue r
</span><span class="hs-identifier hs-var">litDouble</span></span><span>
</span><span id="line-290"></span><span>      </span><span class="annot"><a href="#local-6989586621679328582"><span class="hs-identifier hs-var">getLiteral</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; VS (r (Value r))
forall (r :: * -&gt; *). Literal r =&gt; Float -&gt; SValue r
</span><span class="hs-identifier hs-var">litFloat</span></span><span> </span><span class="annot"><span class="annottext">(Float -&gt; VS (r (Value r)))
-&gt; (Double -&gt; Float) -&gt; Double -&gt; VS (r (Value r))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Float
forall a b. (Real a, Fractional b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">realToFrac</span></span><span>
</span><span id="line-291"></span><span>      </span><span class="annot"><a href="#local-6989586621679328582"><span class="hs-identifier hs-var">getLiteral</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UID -&gt; Double -&gt; VS (r (Value r))
forall a. HasCallStack =&gt; UID -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="hs-string">&quot;convExpr: Rational space matched to invalid CodeType; should be Double or Float&quot;</span></span><span>
</span><span id="line-292"></span><span>  </span><span class="annot"><span class="annottext">SValue r -&gt; GenState (SValue r)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; GenState (SValue r))
-&gt; SValue r -&gt; GenState (SValue r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CodeType -&gt; Double -&gt; SValue r
forall (r :: * -&gt; *).
Literal r =&gt;
CodeType -&gt; Double -&gt; VS (r (Value r))
</span><a href="#local-6989586621679328582"><span class="hs-identifier hs-var">getLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679328584"><span class="hs-identifier hs-var">sm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679328586"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">**</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679328585"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-293"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AssocA</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">AddI</span></span><span> </span><span id="local-6989586621679328577"><span class="annot"><span class="annottext">l :: [CodeExpr]
</span><a href="#local-6989586621679328577"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r -&gt; SValue r) -&gt; [SValue r] -&gt; SValue r
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; a -&gt; a) -&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">foldl1</span></span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
NumericExpression r =&gt;
SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-operator hs-var">(#+)</span></span><span>  </span><span class="annot"><span class="annottext">([SValue r] -&gt; SValue r)
-&gt; StateT DrasilState Identity [SValue r] -&gt; GenState (SValue r)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(CodeExpr -&gt; GenState (SValue r))
-&gt; [CodeExpr] -&gt; StateT DrasilState Identity [SValue r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679328577"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-294"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AssocA</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">AddRe</span></span><span> </span><span id="local-6989586621679328573"><span class="annot"><span class="annottext">l :: [CodeExpr]
</span><a href="#local-6989586621679328573"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r -&gt; SValue r) -&gt; [SValue r] -&gt; SValue r
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; a -&gt; a) -&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">foldl1</span></span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
NumericExpression r =&gt;
SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-operator hs-var">(#+)</span></span><span>  </span><span class="annot"><span class="annottext">([SValue r] -&gt; SValue r)
-&gt; StateT DrasilState Identity [SValue r] -&gt; GenState (SValue r)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(CodeExpr -&gt; GenState (SValue r))
-&gt; [CodeExpr] -&gt; StateT DrasilState Identity [SValue r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679328573"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-295"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AssocA</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">MulI</span></span><span> </span><span id="local-6989586621679328571"><span class="annot"><span class="annottext">l :: [CodeExpr]
</span><a href="#local-6989586621679328571"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r -&gt; SValue r) -&gt; [SValue r] -&gt; SValue r
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; a -&gt; a) -&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">foldl1</span></span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
NumericExpression r =&gt;
SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-operator hs-var">(#*)</span></span><span>  </span><span class="annot"><span class="annottext">([SValue r] -&gt; SValue r)
-&gt; StateT DrasilState Identity [SValue r] -&gt; GenState (SValue r)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(CodeExpr -&gt; GenState (SValue r))
-&gt; [CodeExpr] -&gt; StateT DrasilState Identity [SValue r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679328571"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-296"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AssocA</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">MulRe</span></span><span> </span><span id="local-6989586621679328568"><span class="annot"><span class="annottext">l :: [CodeExpr]
</span><a href="#local-6989586621679328568"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r -&gt; SValue r) -&gt; [SValue r] -&gt; SValue r
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; a -&gt; a) -&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">foldl1</span></span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
NumericExpression r =&gt;
SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-operator hs-var">(#*)</span></span><span>  </span><span class="annot"><span class="annottext">([SValue r] -&gt; SValue r)
-&gt; StateT DrasilState Identity [SValue r] -&gt; GenState (SValue r)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(CodeExpr -&gt; GenState (SValue r))
-&gt; [CodeExpr] -&gt; StateT DrasilState Identity [SValue r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679328568"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-297"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AssocB</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">And</span></span><span> </span><span id="local-6989586621679328565"><span class="annot"><span class="annottext">l :: [CodeExpr]
</span><a href="#local-6989586621679328565"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r -&gt; SValue r) -&gt; [SValue r] -&gt; SValue r
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; a -&gt; a) -&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">foldl1</span></span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
BooleanExpression r =&gt;
SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-operator hs-var">(?&amp;&amp;)</span></span><span> </span><span class="annot"><span class="annottext">([SValue r] -&gt; SValue r)
-&gt; StateT DrasilState Identity [SValue r] -&gt; GenState (SValue r)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(CodeExpr -&gt; GenState (SValue r))
-&gt; [CodeExpr] -&gt; StateT DrasilState Identity [SValue r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679328565"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-298"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AssocB</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Or</span></span><span> </span><span id="local-6989586621679328562"><span class="annot"><span class="annottext">l :: [CodeExpr]
</span><a href="#local-6989586621679328562"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r -&gt; SValue r) -&gt; [SValue r] -&gt; SValue r
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; a -&gt; a) -&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">foldl1</span></span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
BooleanExpression r =&gt;
SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-operator hs-var">(?||)</span></span><span> </span><span class="annot"><span class="annottext">([SValue r] -&gt; SValue r)
-&gt; StateT DrasilState Identity [SValue r] -&gt; GenState (SValue r)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(CodeExpr -&gt; GenState (SValue r))
-&gt; [CodeExpr] -&gt; StateT DrasilState Identity [SValue r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679328562"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-299"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">C</span></span><span> </span><span id="local-6989586621679328559"><span class="annot"><span class="annottext">c :: UID
</span><a href="#local-6989586621679328559"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-300"></span><span>  </span><span id="local-6989586621679328558"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679328558"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-301"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679328557"><span class="annot"><span class="annottext">v :: Input
</span><a href="#local-6989586621679328557"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QuantityDict -&gt; Input
forall c. (Quantity c, MayHaveUnit c) =&gt; c -&gt; Input
</span><span class="hs-identifier hs-var">quantvar</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; UID -&gt; QuantityDict
</span><a href="Language.Drasil.Code.Imperative.Helpers.html#lookupC"><span class="hs-identifier hs-var">lookupC</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679328558"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328559"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-302"></span><span>  </span><span class="annot"><span class="annottext">Input -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; Input -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVal"><span class="hs-identifier hs-var">mkVal</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679328557"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-303"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FCall</span></span><span> </span><span id="local-6989586621679328555"><span class="annot"><span class="annottext">c :: UID
</span><a href="#local-6989586621679328555"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679328554"><span class="annot"><span class="annottext">x :: [CodeExpr]
</span><a href="#local-6989586621679328554"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679328553"><span class="annot"><span class="annottext">ns :: [(UID, CodeExpr)]
</span><a href="#local-6989586621679328553"><span class="hs-identifier hs-var">ns</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UID
-&gt; [CodeExpr]
-&gt; [(UID, CodeExpr)]
-&gt; (UID
    -&gt; UID
    -&gt; VSType r
    -&gt; [SValue r]
    -&gt; NamedArgs r
    -&gt; GenState (SValue r))
-&gt; (UID
    -&gt; UID -&gt; VSType r -&gt; [SValue r] -&gt; NamedArgs r -&gt; SValue r)
-&gt; GenState (SValue r)
forall (r :: * -&gt; *).
OOProg r =&gt;
UID
-&gt; [CodeExpr]
-&gt; [(UID, CodeExpr)]
-&gt; (UID
    -&gt; UID
    -&gt; VSType r
    -&gt; [SValue r]
    -&gt; NamedArgs r
    -&gt; GenState (SValue r))
-&gt; (UID
    -&gt; UID -&gt; VSType r -&gt; [SValue r] -&gt; NamedArgs r -&gt; SValue r)
-&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convCall"><span class="hs-identifier hs-var">convCall</span></a></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328555"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679328554"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">[(UID, CodeExpr)]
</span><a href="#local-6989586621679328553"><span class="hs-identifier hs-var">ns</span></a></span><span> </span><span class="annot"><span class="annottext">UID
-&gt; UID
-&gt; VSType r
-&gt; [SValue r]
-&gt; NamedArgs r
-&gt; GenState (SValue r)
forall (r :: * -&gt; *).
OOProg r =&gt;
UID
-&gt; UID
-&gt; VSType r
-&gt; [SValue r]
-&gt; NamedArgs r
-&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html#fApp"><span class="hs-identifier hs-var">fApp</span></a></span><span> </span><span class="annot"><span class="annottext">UID -&gt; UID -&gt; VSType r -&gt; [SValue r] -&gt; NamedArgs r -&gt; SValue r
forall (r :: * -&gt; *). ValueExpression r =&gt; UID -&gt; MixedCall r
</span><span class="hs-identifier hs-var">libFuncAppMixedArgs</span></span><span>
</span><span id="line-304"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">New</span></span><span> </span><span id="local-6989586621679328549"><span class="annot"><span class="annottext">c :: UID
</span><a href="#local-6989586621679328549"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679328548"><span class="annot"><span class="annottext">x :: [CodeExpr]
</span><a href="#local-6989586621679328548"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679328547"><span class="annot"><span class="annottext">ns :: [(UID, CodeExpr)]
</span><a href="#local-6989586621679328547"><span class="hs-identifier hs-var">ns</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UID
-&gt; [CodeExpr]
-&gt; [(UID, CodeExpr)]
-&gt; (UID
    -&gt; UID
    -&gt; VSType r
    -&gt; [SValue r]
    -&gt; NamedArgs r
    -&gt; GenState (SValue r))
-&gt; (UID
    -&gt; UID -&gt; VSType r -&gt; [SValue r] -&gt; NamedArgs r -&gt; SValue r)
-&gt; GenState (SValue r)
forall (r :: * -&gt; *).
OOProg r =&gt;
UID
-&gt; [CodeExpr]
-&gt; [(UID, CodeExpr)]
-&gt; (UID
    -&gt; UID
    -&gt; VSType r
    -&gt; [SValue r]
    -&gt; NamedArgs r
    -&gt; GenState (SValue r))
-&gt; (UID
    -&gt; UID -&gt; VSType r -&gt; [SValue r] -&gt; NamedArgs r -&gt; SValue r)
-&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convCall"><span class="hs-identifier hs-var">convCall</span></a></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328549"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679328548"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">[(UID, CodeExpr)]
</span><a href="#local-6989586621679328547"><span class="hs-identifier hs-var">ns</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679328546"><span class="annot"><span class="annottext">m :: UID
</span><a href="#local-6989586621679328546"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UID -&gt; VSType r -&gt; [SValue r] -&gt; NamedArgs r -&gt; GenState (SValue r)
forall (r :: * -&gt; *).
OOProg r =&gt;
UID -&gt; VSType r -&gt; [SValue r] -&gt; NamedArgs r -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html#ctorCall"><span class="hs-identifier hs-var">ctorCall</span></a></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328546"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-305"></span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679328545"><span class="annot"><span class="annottext">m :: UID
</span><a href="#local-6989586621679328545"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UID -&gt; VSType r -&gt; [SValue r] -&gt; NamedArgs r -&gt; SValue r
forall (r :: * -&gt; *). ValueExpression r =&gt; MixedCall r
</span><span class="hs-identifier hs-var">libNewObjMixedArgs</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328545"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-306"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Message</span></span><span> </span><span id="local-6989586621679328542"><span class="annot"><span class="annottext">a :: UID
</span><a href="#local-6989586621679328542"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679328541"><span class="annot"><span class="annottext">m :: UID
</span><a href="#local-6989586621679328541"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679328540"><span class="annot"><span class="annottext">x :: [CodeExpr]
</span><a href="#local-6989586621679328540"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679328539"><span class="annot"><span class="annottext">ns :: [(UID, CodeExpr)]
</span><a href="#local-6989586621679328539"><span class="hs-identifier hs-var">ns</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-307"></span><span>  </span><span id="local-6989586621679328538"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679328538"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-308"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679328537"><span class="annot"><span class="annottext">info :: ChunkDB
</span><a href="#local-6989586621679328537"><span class="hs-identifier hs-var hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CodeSpec -&gt; ChunkDB
</span><a href="Language.Drasil.CodeSpec.html#sysinfodb"><span class="hs-identifier hs-var hs-var">sysinfodb</span></a></span><span> </span><span class="annot"><span class="annottext">(CodeSpec -&gt; ChunkDB) -&gt; CodeSpec -&gt; ChunkDB
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; CodeSpec
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#codeSpec"><span class="hs-identifier hs-var hs-var">codeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679328538"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-309"></span><span>      </span><span id="local-6989586621679328535"><span class="annot"><span class="annottext">objCd :: Input
</span><a href="#local-6989586621679328535"><span class="hs-identifier hs-var hs-var">objCd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QuantityDict -&gt; Input
forall c. (Quantity c, MayHaveUnit c) =&gt; c -&gt; Input
</span><span class="hs-identifier hs-var">quantvar</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB -&gt; UID -&gt; QuantityDict
</span><span class="hs-identifier hs-var">symbResolve</span></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679328537"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328542"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span>  </span><span id="local-6989586621679328534"><span class="annot"><span class="annottext">SValue r
</span><a href="#local-6989586621679328534"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; Input -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVal"><span class="hs-identifier hs-var">mkVal</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679328535"><span class="hs-identifier hs-var">objCd</span></a></span><span>
</span><span id="line-311"></span><span>  </span><span class="annot"><span class="annottext">UID
-&gt; [CodeExpr]
-&gt; [(UID, CodeExpr)]
-&gt; (UID
    -&gt; UID
    -&gt; VSType r
    -&gt; [SValue r]
    -&gt; NamedArgs r
    -&gt; GenState (SValue r))
-&gt; (UID
    -&gt; UID -&gt; VSType r -&gt; [SValue r] -&gt; NamedArgs r -&gt; SValue r)
-&gt; GenState (SValue r)
forall (r :: * -&gt; *).
OOProg r =&gt;
UID
-&gt; [CodeExpr]
-&gt; [(UID, CodeExpr)]
-&gt; (UID
    -&gt; UID
    -&gt; VSType r
    -&gt; [SValue r]
    -&gt; NamedArgs r
    -&gt; GenState (SValue r))
-&gt; (UID
    -&gt; UID -&gt; VSType r -&gt; [SValue r] -&gt; NamedArgs r -&gt; SValue r)
-&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convCall"><span class="hs-identifier hs-var">convCall</span></a></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328541"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679328540"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">[(UID, CodeExpr)]
</span><a href="#local-6989586621679328539"><span class="hs-identifier hs-var">ns</span></a></span><span> </span><span>
</span><span id="line-312"></span><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679328533"><span class="annot"><span class="annottext">n :: UID
</span><a href="#local-6989586621679328533"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679328532"><span class="annot"><span class="annottext">t :: VSType r
</span><a href="#local-6989586621679328532"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679328531"><span class="annot"><span class="annottext">ps :: [SValue r]
</span><a href="#local-6989586621679328531"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621679328530"><span class="annot"><span class="annottext">nas :: NamedArgs r
</span><a href="#local-6989586621679328530"><span class="hs-identifier hs-var">nas</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; GenState (SValue r)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VSType r
-&gt; SValue r -&gt; UID -&gt; [SValue r] -&gt; NamedArgs r -&gt; SValue r
forall (r :: * -&gt; *).
InternalValueExp r =&gt;
VSType r
-&gt; SValue r -&gt; UID -&gt; [SValue r] -&gt; NamedArgs r -&gt; SValue r
</span><span class="hs-identifier hs-var">objMethodCallMixedArgs</span></span><span> </span><span class="annot"><span class="annottext">VSType r
</span><a href="#local-6989586621679328532"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">SValue r
</span><a href="#local-6989586621679328534"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328533"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[SValue r]
</span><a href="#local-6989586621679328531"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">NamedArgs r
</span><a href="#local-6989586621679328530"><span class="hs-identifier hs-var">nas</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-313"></span><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679328529"><span class="annot"><span class="annottext">n :: UID
</span><a href="#local-6989586621679328529"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679328528"><span class="annot"><span class="annottext">t :: VSType r
</span><a href="#local-6989586621679328528"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">VSType r
-&gt; SValue r -&gt; UID -&gt; [SValue r] -&gt; NamedArgs r -&gt; SValue r
forall (r :: * -&gt; *).
InternalValueExp r =&gt;
VSType r
-&gt; SValue r -&gt; UID -&gt; [SValue r] -&gt; NamedArgs r -&gt; SValue r
</span><span class="hs-identifier hs-var">objMethodCallMixedArgs</span></span><span> </span><span class="annot"><span class="annottext">VSType r
</span><a href="#local-6989586621679328528"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">SValue r
</span><a href="#local-6989586621679328534"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328529"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-314"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Field</span></span><span> </span><span id="local-6989586621679328526"><span class="annot"><span class="annottext">o :: UID
</span><a href="#local-6989586621679328526"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679328525"><span class="annot"><span class="annottext">f :: UID
</span><a href="#local-6989586621679328525"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-315"></span><span>  </span><span id="local-6989586621679328524"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679328524"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-316"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679328523"><span class="annot"><span class="annottext">ob :: Input
</span><a href="#local-6989586621679328523"><span class="hs-identifier hs-var hs-var">ob</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QuantityDict -&gt; Input
forall c. (Quantity c, MayHaveUnit c) =&gt; c -&gt; Input
</span><span class="hs-identifier hs-var">quantvar</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; UID -&gt; QuantityDict
</span><a href="Language.Drasil.Code.Imperative.Helpers.html#lookupC"><span class="hs-identifier hs-var">lookupC</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679328524"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328526"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-317"></span><span>      </span><span id="local-6989586621679328522"><span class="annot"><span class="annottext">fld :: Input
</span><a href="#local-6989586621679328522"><span class="hs-identifier hs-var hs-var">fld</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QuantityDict -&gt; Input
forall c. (Quantity c, MayHaveUnit c) =&gt; c -&gt; Input
</span><span class="hs-identifier hs-var">quantvar</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; UID -&gt; QuantityDict
</span><a href="Language.Drasil.Code.Imperative.Helpers.html#lookupC"><span class="hs-identifier hs-var">lookupC</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679328524"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328525"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-318"></span><span>  </span><span id="local-6989586621679328521"><span class="annot"><span class="annottext">VS (r (Variable r))
</span><a href="#local-6989586621679328521"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input -&gt; GenState (VS (r (Variable r)))
forall (r :: * -&gt; *). OOProg r =&gt; Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input -&gt; Input -&gt; Input
</span><a href="Language.Drasil.Chunk.Code.html#ccObjVar"><span class="hs-identifier hs-var">ccObjVar</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679328523"><span class="hs-identifier hs-var">ob</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679328522"><span class="hs-identifier hs-var">fld</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-319"></span><span>  </span><span class="annot"><span class="annottext">SValue r -&gt; GenState (SValue r)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; GenState (SValue r))
-&gt; SValue r -&gt; GenState (SValue r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r)) -&gt; SValue r
forall (r :: * -&gt; *). VariableValue r =&gt; SVariable r -&gt; SValue r
</span><span class="hs-identifier hs-var">valueOf</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
</span><a href="#local-6989586621679328521"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-320"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UnaryOp</span></span><span> </span><span id="local-6989586621679328519"><span class="annot"><span class="annottext">o :: UFunc
</span><a href="#local-6989586621679328519"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679328518"><span class="annot"><span class="annottext">u :: CodeExpr
</span><a href="#local-6989586621679328518"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r)
-&gt; GenState (SValue r) -&gt; GenState (SValue r)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UFunc -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *). OOProg r =&gt; UFunc -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#unop"><span class="hs-identifier hs-var">unop</span></a></span><span> </span><span class="annot"><span class="annottext">UFunc
</span><a href="#local-6989586621679328519"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679328518"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-321"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UnaryOpB</span></span><span> </span><span id="local-6989586621679328515"><span class="annot"><span class="annottext">o :: UFuncB
</span><a href="#local-6989586621679328515"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679328514"><span class="annot"><span class="annottext">u :: CodeExpr
</span><a href="#local-6989586621679328514"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r)
-&gt; GenState (SValue r) -&gt; GenState (SValue r)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UFuncB -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *). OOProg r =&gt; UFuncB -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#unopB"><span class="hs-identifier hs-var">unopB</span></a></span><span> </span><span class="annot"><span class="annottext">UFuncB
</span><a href="#local-6989586621679328515"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679328514"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-322"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UnaryOpVV</span></span><span> </span><span id="local-6989586621679328511"><span class="annot"><span class="annottext">o :: UFuncVV
</span><a href="#local-6989586621679328511"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679328510"><span class="annot"><span class="annottext">u :: CodeExpr
</span><a href="#local-6989586621679328510"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r)
-&gt; GenState (SValue r) -&gt; GenState (SValue r)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UFuncVV -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *). OOProg r =&gt; UFuncVV -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#unopVV"><span class="hs-identifier hs-var">unopVV</span></a></span><span> </span><span class="annot"><span class="annottext">UFuncVV
</span><a href="#local-6989586621679328511"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679328510"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-323"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UnaryOpVN</span></span><span> </span><span id="local-6989586621679328507"><span class="annot"><span class="annottext">o :: UFuncVN
</span><a href="#local-6989586621679328507"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679328506"><span class="annot"><span class="annottext">u :: CodeExpr
</span><a href="#local-6989586621679328506"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r)
-&gt; GenState (SValue r) -&gt; GenState (SValue r)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UFuncVN -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *). OOProg r =&gt; UFuncVN -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#unopVN"><span class="hs-identifier hs-var">unopVN</span></a></span><span> </span><span class="annot"><span class="annottext">UFuncVN
</span><a href="#local-6989586621679328507"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679328506"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-324"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ArithBinaryOp</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Frac</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span id="local-6989586621679328502"><span class="annot"><span class="annottext">a :: Integer
</span><a href="#local-6989586621679328502"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span id="local-6989586621679328501"><span class="annot"><span class="annottext">b :: Integer
</span><a href="#local-6989586621679328501"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-comment">-- hack to deal with integer division</span><span>
</span><span id="line-325"></span><span>  </span><span id="local-6989586621679328500"><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679328500"><span class="hs-identifier hs-var">sm</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Space -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#spaceCodeType"><span class="hs-identifier hs-var">spaceCodeType</span></a></span><span> </span><span class="annot"><span class="annottext">Space
</span><span class="hs-identifier hs-var">Rational</span></span><span>
</span><span id="line-326"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679328499"><span class="annot"><span class="annottext">getLiteral :: CodeType -&gt; StateT ValueState Identity (r (Value r))
</span><a href="#local-6989586621679328499"><span class="hs-identifier hs-var hs-var">getLiteral</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; StateT ValueState Identity (r (Value r))
forall (r :: * -&gt; *). Literal r =&gt; Double -&gt; SValue r
</span><span class="hs-identifier hs-var">litDouble</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679328502"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Value r))
-&gt; StateT ValueState Identity (r (Value r))
-&gt; StateT ValueState Identity (r (Value r))
forall (r :: * -&gt; *).
NumericExpression r =&gt;
SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-operator hs-var">#/</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; StateT ValueState Identity (r (Value r))
forall (r :: * -&gt; *). Literal r =&gt; Double -&gt; SValue r
</span><span class="hs-identifier hs-var">litDouble</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679328501"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-327"></span><span>      </span><span class="annot"><a href="#local-6989586621679328499"><span class="hs-identifier hs-var">getLiteral</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; StateT ValueState Identity (r (Value r))
forall (r :: * -&gt; *). Literal r =&gt; Float -&gt; SValue r
</span><span class="hs-identifier hs-var">litFloat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Float
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679328502"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Value r))
-&gt; StateT ValueState Identity (r (Value r))
-&gt; StateT ValueState Identity (r (Value r))
forall (r :: * -&gt; *).
NumericExpression r =&gt;
SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-operator hs-var">#/</span></span><span> </span><span class="annot"><span class="annottext">Float -&gt; StateT ValueState Identity (r (Value r))
forall (r :: * -&gt; *). Literal r =&gt; Float -&gt; SValue r
</span><span class="hs-identifier hs-var">litFloat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Float
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679328501"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-328"></span><span>      </span><span class="annot"><a href="#local-6989586621679328499"><span class="hs-identifier hs-var">getLiteral</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UID -&gt; StateT ValueState Identity (r (Value r))
forall a. HasCallStack =&gt; UID -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="hs-string">&quot;convExpr: Rational space matched to invalid CodeType; should be Double or Float&quot;</span></span><span>
</span><span id="line-329"></span><span>  </span><span class="annot"><span class="annottext">SValue r -&gt; GenState (SValue r)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; GenState (SValue r))
-&gt; SValue r -&gt; GenState (SValue r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CodeType -&gt; SValue r
forall (r :: * -&gt; *).
(NumericExpression r, Literal r) =&gt;
CodeType -&gt; StateT ValueState Identity (r (Value r))
</span><a href="#local-6989586621679328499"><span class="hs-identifier hs-var">getLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679328500"><span class="hs-identifier hs-var">sm</span></a></span><span>
</span><span id="line-330"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ArithBinaryOp</span></span><span> </span><span id="local-6989586621679328497"><span class="annot"><span class="annottext">o :: ArithBinOp
</span><a href="#local-6989586621679328497"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679328496"><span class="annot"><span class="annottext">a :: CodeExpr
</span><a href="#local-6989586621679328496"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679328495"><span class="annot"><span class="annottext">b :: CodeExpr
</span><a href="#local-6989586621679328495"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r -&gt; SValue r)
-&gt; GenState (SValue r)
-&gt; GenState (SValue r)
-&gt; GenState (SValue r)
forall (m :: * -&gt; *) a1 a2 r.
Monad m =&gt;
(a1 -&gt; a2 -&gt; r) -&gt; m a1 -&gt; m a2 -&gt; m r
</span><span class="hs-identifier hs-var">liftM2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArithBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
OOProg r =&gt;
ArithBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#arithBfunc"><span class="hs-identifier hs-var">arithBfunc</span></a></span><span> </span><span class="annot"><span class="annottext">ArithBinOp
</span><a href="#local-6989586621679328497"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679328496"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679328495"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-331"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">BoolBinaryOp</span></span><span> </span><span id="local-6989586621679328492"><span class="annot"><span class="annottext">o :: BoolBinOp
</span><a href="#local-6989586621679328492"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679328491"><span class="annot"><span class="annottext">a :: CodeExpr
</span><a href="#local-6989586621679328491"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679328490"><span class="annot"><span class="annottext">b :: CodeExpr
</span><a href="#local-6989586621679328490"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r -&gt; SValue r)
-&gt; GenState (SValue r)
-&gt; GenState (SValue r)
-&gt; GenState (SValue r)
forall (m :: * -&gt; *) a1 a2 r.
Monad m =&gt;
(a1 -&gt; a2 -&gt; r) -&gt; m a1 -&gt; m a2 -&gt; m r
</span><span class="hs-identifier hs-var">liftM2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BoolBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *). BoolBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#boolBfunc"><span class="hs-identifier hs-var">boolBfunc</span></a></span><span> </span><span class="annot"><span class="annottext">BoolBinOp
</span><a href="#local-6989586621679328492"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679328491"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679328490"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-332"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LABinaryOp</span></span><span> </span><span id="local-6989586621679328487"><span class="annot"><span class="annottext">o :: LABinOp
</span><a href="#local-6989586621679328487"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679328486"><span class="annot"><span class="annottext">a :: CodeExpr
</span><a href="#local-6989586621679328486"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679328485"><span class="annot"><span class="annottext">b :: CodeExpr
</span><a href="#local-6989586621679328485"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r -&gt; SValue r)
-&gt; GenState (SValue r)
-&gt; GenState (SValue r)
-&gt; GenState (SValue r)
forall (m :: * -&gt; *) a1 a2 r.
Monad m =&gt;
(a1 -&gt; a2 -&gt; r) -&gt; m a1 -&gt; m a2 -&gt; m r
</span><span class="hs-identifier hs-var">liftM2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LABinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
OOProg r =&gt;
LABinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#laBfunc"><span class="hs-identifier hs-var">laBfunc</span></a></span><span> </span><span class="annot"><span class="annottext">LABinOp
</span><a href="#local-6989586621679328487"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679328486"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679328485"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-333"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">EqBinaryOp</span></span><span> </span><span id="local-6989586621679328482"><span class="annot"><span class="annottext">o :: EqBinOp
</span><a href="#local-6989586621679328482"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679328481"><span class="annot"><span class="annottext">a :: CodeExpr
</span><a href="#local-6989586621679328481"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679328480"><span class="annot"><span class="annottext">b :: CodeExpr
</span><a href="#local-6989586621679328480"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r -&gt; SValue r)
-&gt; GenState (SValue r)
-&gt; GenState (SValue r)
-&gt; GenState (SValue r)
forall (m :: * -&gt; *) a1 a2 r.
Monad m =&gt;
(a1 -&gt; a2 -&gt; r) -&gt; m a1 -&gt; m a2 -&gt; m r
</span><span class="hs-identifier hs-var">liftM2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EqBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
OOProg r =&gt;
EqBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#eqBfunc"><span class="hs-identifier hs-var">eqBfunc</span></a></span><span> </span><span class="annot"><span class="annottext">EqBinOp
</span><a href="#local-6989586621679328482"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679328481"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679328480"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-334"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OrdBinaryOp</span></span><span> </span><span id="local-6989586621679328477"><span class="annot"><span class="annottext">o :: OrdBinOp
</span><a href="#local-6989586621679328477"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679328476"><span class="annot"><span class="annottext">a :: CodeExpr
</span><a href="#local-6989586621679328476"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679328475"><span class="annot"><span class="annottext">b :: CodeExpr
</span><a href="#local-6989586621679328475"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r -&gt; SValue r)
-&gt; GenState (SValue r)
-&gt; GenState (SValue r)
-&gt; GenState (SValue r)
forall (m :: * -&gt; *) a1 a2 r.
Monad m =&gt;
(a1 -&gt; a2 -&gt; r) -&gt; m a1 -&gt; m a2 -&gt; m r
</span><span class="hs-identifier hs-var">liftM2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OrdBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
OOProg r =&gt;
OrdBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#ordBfunc"><span class="hs-identifier hs-var">ordBfunc</span></a></span><span> </span><span class="annot"><span class="annottext">OrdBinOp
</span><a href="#local-6989586621679328477"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679328476"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679328475"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-335"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VVVBinaryOp</span></span><span> </span><span id="local-6989586621679328472"><span class="annot"><span class="annottext">o :: VVVBinOp
</span><a href="#local-6989586621679328472"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679328471"><span class="annot"><span class="annottext">a :: CodeExpr
</span><a href="#local-6989586621679328471"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679328470"><span class="annot"><span class="annottext">b :: CodeExpr
</span><a href="#local-6989586621679328470"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r -&gt; SValue r)
-&gt; GenState (SValue r)
-&gt; GenState (SValue r)
-&gt; GenState (SValue r)
forall (m :: * -&gt; *) a1 a2 r.
Monad m =&gt;
(a1 -&gt; a2 -&gt; r) -&gt; m a1 -&gt; m a2 -&gt; m r
</span><span class="hs-identifier hs-var">liftM2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VVVBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *). VVVBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#vecVecVecBfunc"><span class="hs-identifier hs-var">vecVecVecBfunc</span></a></span><span> </span><span class="annot"><span class="annottext">VVVBinOp
</span><a href="#local-6989586621679328472"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679328471"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679328470"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-336"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VVNBinaryOp</span></span><span> </span><span id="local-6989586621679328467"><span class="annot"><span class="annottext">o :: VVNBinOp
</span><a href="#local-6989586621679328467"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679328466"><span class="annot"><span class="annottext">a :: CodeExpr
</span><a href="#local-6989586621679328466"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679328465"><span class="annot"><span class="annottext">b :: CodeExpr
</span><a href="#local-6989586621679328465"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r -&gt; SValue r)
-&gt; GenState (SValue r)
-&gt; GenState (SValue r)
-&gt; GenState (SValue r)
forall (m :: * -&gt; *) a1 a2 r.
Monad m =&gt;
(a1 -&gt; a2 -&gt; r) -&gt; m a1 -&gt; m a2 -&gt; m r
</span><span class="hs-identifier hs-var">liftM2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VVNBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *). VVNBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#vecVecNumBfunc"><span class="hs-identifier hs-var">vecVecNumBfunc</span></a></span><span> </span><span class="annot"><span class="annottext">VVNBinOp
</span><a href="#local-6989586621679328467"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679328466"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679328465"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-337"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Case</span></span><span> </span><span id="local-6989586621679328462"><span class="annot"><span class="annottext">c :: Completeness
</span><a href="#local-6989586621679328462"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679328461"><span class="annot"><span class="annottext">l :: [(CodeExpr, CodeExpr)]
</span><a href="#local-6989586621679328461"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(CodeExpr, CodeExpr)] -&gt; GenState (SValue r)
forall (r :: * -&gt; *).
OOProg r =&gt;
[(CodeExpr, CodeExpr)]
-&gt; StateT DrasilState Identity (VS (r (Value r)))
</span><a href="#local-6989586621679328460"><span class="hs-identifier hs-var">doit</span></a></span><span> </span><span class="annot"><span class="annottext">[(CodeExpr, CodeExpr)]
</span><a href="#local-6989586621679328461"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-comment">-- FIXME this is sub-optimal</span><span>
</span><span id="line-338"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-339"></span><span>    </span><span id="local-6989586621679328460"><span class="annot"><span class="annottext">doit :: [(CodeExpr, CodeExpr)]
-&gt; StateT DrasilState Identity (VS (r (Value r)))
</span><a href="#local-6989586621679328460"><span class="hs-identifier hs-var hs-var">doit</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UID -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall a. HasCallStack =&gt; UID -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="hs-string">&quot;should never happen&quot;</span></span><span> </span><span class="hs-comment">-- TODO: change error message?</span><span>
</span><span id="line-340"></span><span>    </span><span class="annot"><a href="#local-6989586621679328460"><span class="hs-identifier hs-var">doit</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621679328459"><span class="annot"><span class="annottext">e :: CodeExpr
</span><a href="#local-6989586621679328459"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679328459"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-comment">-- should always be the else clause</span><span>
</span><span id="line-341"></span><span>    </span><span class="annot"><a href="#local-6989586621679328460"><span class="hs-identifier hs-var">doit</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679328458"><span class="annot"><span class="annottext">e :: CodeExpr
</span><a href="#local-6989586621679328458"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679328457"><span class="annot"><span class="annottext">cond :: CodeExpr
</span><a href="#local-6989586621679328457"><span class="hs-identifier hs-var">cond</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679328456"><span class="annot"><span class="annottext">xs :: [(CodeExpr, CodeExpr)]
</span><a href="#local-6989586621679328456"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(VS (r (Value r))
 -&gt; VS (r (Value r)) -&gt; VS (r (Value r)) -&gt; VS (r (Value r)))
-&gt; StateT DrasilState Identity (VS (r (Value r)))
-&gt; StateT DrasilState Identity (VS (r (Value r)))
-&gt; StateT DrasilState Identity (VS (r (Value r)))
-&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (m :: * -&gt; *) a1 a2 a3 r.
Monad m =&gt;
(a1 -&gt; a2 -&gt; a3 -&gt; r) -&gt; m a1 -&gt; m a2 -&gt; m a3 -&gt; m r
</span><span class="hs-identifier hs-var">liftM3</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
-&gt; VS (r (Value r)) -&gt; VS (r (Value r)) -&gt; VS (r (Value r))
forall (r :: * -&gt; *).
ValueExpression r =&gt;
SValue r -&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-identifier hs-var">inlineIf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679328457"><span class="hs-identifier hs-var">cond</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679328458"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-342"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Completeness -&gt; [(CodeExpr, CodeExpr)] -&gt; CodeExpr
</span><span class="hs-identifier hs-var">Case</span></span><span> </span><span class="annot"><span class="annottext">Completeness
</span><a href="#local-6989586621679328462"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">[(CodeExpr, CodeExpr)]
</span><a href="#local-6989586621679328456"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-343"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Matrix</span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679328453"><span class="annot"><span class="annottext">l :: [CodeExpr]
</span><a href="#local-6989586621679328453"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-344"></span><span>  </span><span id="local-6989586621679328452"><span class="annot"><span class="annottext">[SValue r]
</span><a href="#local-6989586621679328452"><span class="hs-identifier hs-var">ar</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(CodeExpr -&gt; GenState (SValue r))
-&gt; [CodeExpr] -&gt; StateT DrasilState Identity [SValue r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679328453"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-345"></span><span>                                    </span><span class="hs-comment">-- hd will never fail here</span><span>
</span><span id="line-346"></span><span>  </span><span class="annot"><span class="annottext">SValue r -&gt; GenState (SValue r)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; GenState (SValue r))
-&gt; SValue r -&gt; GenState (SValue r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VSType r -&gt; [SValue r] -&gt; SValue r
forall (r :: * -&gt; *).
Literal r =&gt;
VSType r -&gt; [SValue r] -&gt; SValue r
</span><span class="hs-identifier hs-var">litArray</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(r (Value r) -&gt; r (Type r)) -&gt; SValue r -&gt; VSType r
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">r (Value r) -&gt; r (Type r)
forall (r :: * -&gt; *). ValueSym r =&gt; r (Value r) -&gt; r (Type r)
</span><span class="hs-identifier hs-var">valueType</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SValue r] -&gt; SValue r
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[SValue r]
</span><a href="#local-6989586621679328452"><span class="hs-identifier hs-var">ar</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[SValue r]
</span><a href="#local-6989586621679328452"><span class="hs-identifier hs-var">ar</span></a></span><span>
</span><span id="line-347"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Matrix</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UID -&gt; GenState (SValue r)
forall a. HasCallStack =&gt; UID -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="hs-string">&quot;convExpr: Matrix&quot;</span></span><span>
</span><span id="line-348"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Operator</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UID -&gt; GenState (SValue r)
forall a. HasCallStack =&gt; UID -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="hs-string">&quot;convExpr: Operator&quot;</span></span><span>
</span><span id="line-349"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RealI</span></span><span> </span><span id="local-6989586621679328446"><span class="annot"><span class="annottext">c :: UID
</span><a href="#local-6989586621679328446"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679328445"><span class="annot"><span class="annottext">ri :: RealInterval CodeExpr CodeExpr
</span><a href="#local-6989586621679328445"><span class="hs-identifier hs-var">ri</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-350"></span><span>  </span><span id="local-6989586621679328444"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679328444"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-351"></span><span>  </span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">(CodeExpr -&gt; GenState (SValue r))
-&gt; CodeExpr -&gt; GenState (SValue r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QuantityDict -&gt; RealInterval CodeExpr CodeExpr -&gt; CodeExpr
forall c.
(HasUID c, HasSymbol c) =&gt;
c -&gt; RealInterval CodeExpr CodeExpr -&gt; CodeExpr
</span><a href="Language.Drasil.Code.Imperative.Import.html#renderRealInt"><span class="hs-identifier hs-var">renderRealInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; UID -&gt; QuantityDict
</span><a href="Language.Drasil.Code.Imperative.Helpers.html#lookupC"><span class="hs-identifier hs-var">lookupC</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679328444"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328446"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">RealInterval CodeExpr CodeExpr
</span><a href="#local-6989586621679328445"><span class="hs-identifier hs-var">ri</span></a></span><span>
</span><span id="line-352"></span><span>
</span><span id="line-353"></span><span class="hs-comment">-- | Generates a function/method call, based on the 'UID' of the chunk representing</span><span>
</span><span id="line-354"></span><span class="hs-comment">-- the function, the list of argument 'Expr's, the list of named argument 'Expr's,</span><span>
</span><span id="line-355"></span><span class="hs-comment">-- the function call generator to use, and the library version of the function</span><span>
</span><span id="line-356"></span><span class="hs-comment">-- call generator (used if the function is in the library export map).</span><span>
</span><span id="line-357"></span><span id="local-6989586621679329035"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convCall"><span class="hs-identifier hs-type">convCall</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679329035"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">CodeExpr</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CodeExpr</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span>
</span><span id="line-358"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VSType</span></span><span> </span><span class="annot"><a href="#local-6989586621679329035"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679329035"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NamedArgs</span></span><span> </span><span class="annot"><a href="#local-6989586621679329035"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span>
</span><span id="line-359"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679329035"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VSType</span></span><span> </span><span class="annot"><a href="#local-6989586621679329035"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679329035"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span> </span><span>
</span><span id="line-360"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NamedArgs</span></span><span> </span><span class="annot"><a href="#local-6989586621679329035"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679329035"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679329035"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-361"></span><span id="convCall"><span class="annot"><span class="annottext">convCall :: UID
-&gt; [CodeExpr]
-&gt; [(UID, CodeExpr)]
-&gt; (UID
    -&gt; UID
    -&gt; VSType r
    -&gt; [SValue r]
    -&gt; NamedArgs r
    -&gt; GenState (SValue r))
-&gt; (UID
    -&gt; UID -&gt; VSType r -&gt; [SValue r] -&gt; NamedArgs r -&gt; SValue r)
-&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convCall"><span class="hs-identifier hs-var hs-var">convCall</span></a></span></span><span> </span><span id="local-6989586621679328442"><span class="annot"><span class="annottext">c :: UID
</span><a href="#local-6989586621679328442"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679328441"><span class="annot"><span class="annottext">x :: [CodeExpr]
</span><a href="#local-6989586621679328441"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679328440"><span class="annot"><span class="annottext">ns :: [(UID, CodeExpr)]
</span><a href="#local-6989586621679328440"><span class="hs-identifier hs-var">ns</span></a></span></span><span> </span><span id="local-6989586621679328439"><span class="annot"><span class="annottext">f :: UID
-&gt; UID
-&gt; VSType r
-&gt; [SValue r]
-&gt; NamedArgs r
-&gt; GenState (SValue r)
</span><a href="#local-6989586621679328439"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679328438"><span class="annot"><span class="annottext">libf :: UID -&gt; UID -&gt; VSType r -&gt; [SValue r] -&gt; NamedArgs r -&gt; SValue r
</span><a href="#local-6989586621679328438"><span class="hs-identifier hs-var">libf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-362"></span><span>  </span><span id="local-6989586621679328437"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679328437"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-363"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679328436"><span class="annot"><span class="annottext">info :: ChunkDB
</span><a href="#local-6989586621679328436"><span class="hs-identifier hs-var hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CodeSpec -&gt; ChunkDB
</span><a href="Language.Drasil.CodeSpec.html#sysinfodb"><span class="hs-identifier hs-var hs-var">sysinfodb</span></a></span><span> </span><span class="annot"><span class="annottext">(CodeSpec -&gt; ChunkDB) -&gt; CodeSpec -&gt; ChunkDB
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; CodeSpec
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#codeSpec"><span class="hs-identifier hs-var hs-var">codeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679328437"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-364"></span><span>      </span><span id="local-6989586621679328435"><span class="annot"><span class="annottext">mem :: Map UID UID
</span><a href="#local-6989586621679328435"><span class="hs-identifier hs-var hs-var">mem</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; Map UID UID
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#eMap"><span class="hs-identifier hs-var hs-var">eMap</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679328437"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-365"></span><span>      </span><span id="local-6989586621679328434"><span class="annot"><span class="annottext">lem :: Map UID UID
</span><a href="#local-6989586621679328434"><span class="hs-identifier hs-var hs-var">lem</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; Map UID UID
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#libEMap"><span class="hs-identifier hs-var hs-var">libEMap</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679328437"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-366"></span><span>      </span><span id="local-6989586621679328432"><span class="annot"><span class="annottext">funcCd :: CodeFuncChunk
</span><a href="#local-6989586621679328432"><span class="hs-identifier hs-var hs-var">funcCd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QuantityDict -&gt; CodeFuncChunk
forall c. (Quantity c, MayHaveUnit c) =&gt; c -&gt; CodeFuncChunk
</span><span class="hs-identifier hs-var">quantfunc</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB -&gt; UID -&gt; QuantityDict
</span><span class="hs-identifier hs-var">symbResolve</span></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679328436"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328442"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-367"></span><span>      </span><span id="local-6989586621679328431"><span class="annot"><span class="annottext">funcNm :: UID
</span><a href="#local-6989586621679328431"><span class="hs-identifier hs-var hs-var">funcNm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CodeFuncChunk -&gt; UID
forall c. CodeIdea c =&gt; c -&gt; UID
</span><span class="hs-identifier hs-var">codeName</span></span><span> </span><span class="annot"><span class="annottext">CodeFuncChunk
</span><a href="#local-6989586621679328432"><span class="hs-identifier hs-var">funcCd</span></a></span><span>
</span><span id="line-368"></span><span>  </span><span id="local-6989586621679328430"><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679328430"><span class="hs-identifier hs-var">funcTp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeFuncChunk -&gt; GenState CodeType
forall c. HasSpace c =&gt; c -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#codeType"><span class="hs-identifier hs-var">codeType</span></a></span><span> </span><span class="annot"><span class="annottext">CodeFuncChunk
</span><a href="#local-6989586621679328432"><span class="hs-identifier hs-var">funcCd</span></a></span><span>
</span><span id="line-369"></span><span>  </span><span id="local-6989586621679328429"><span class="annot"><span class="annottext">[SValue r]
</span><a href="#local-6989586621679328429"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(CodeExpr -&gt; GenState (SValue r))
-&gt; [CodeExpr] -&gt; StateT DrasilState Identity [SValue r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679328441"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-370"></span><span>  </span><span id="local-6989586621679328428"><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679328428"><span class="hs-identifier hs-var">nms</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((UID, CodeExpr)
 -&gt; StateT DrasilState Identity (VS (r (Variable r))))
-&gt; [(UID, CodeExpr)]
-&gt; StateT DrasilState Identity [VS (r (Variable r))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input -&gt; StateT DrasilState Identity (VS (r (Variable r)))
forall (r :: * -&gt; *). OOProg r =&gt; Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="annot"><span class="annottext">(Input -&gt; StateT DrasilState Identity (VS (r (Variable r))))
-&gt; ((UID, CodeExpr) -&gt; Input)
-&gt; (UID, CodeExpr)
-&gt; StateT DrasilState Identity (VS (r (Variable r)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">QuantityDict -&gt; Input
forall c. (Quantity c, MayHaveUnit c) =&gt; c -&gt; Input
</span><span class="hs-identifier hs-var">quantvar</span></span><span> </span><span class="annot"><span class="annottext">(QuantityDict -&gt; Input)
-&gt; ((UID, CodeExpr) -&gt; QuantityDict) -&gt; (UID, CodeExpr) -&gt; Input
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ChunkDB -&gt; UID -&gt; QuantityDict
</span><span class="hs-identifier hs-var">symbResolve</span></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679328436"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">(UID -&gt; QuantityDict)
-&gt; ((UID, CodeExpr) -&gt; UID) -&gt; (UID, CodeExpr) -&gt; QuantityDict
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(UID, CodeExpr) -&gt; UID
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(UID, CodeExpr)]
</span><a href="#local-6989586621679328440"><span class="hs-identifier hs-var">ns</span></a></span><span> </span><span>
</span><span id="line-371"></span><span>  </span><span id="local-6989586621679328427"><span class="annot"><span class="annottext">[SValue r]
</span><a href="#local-6989586621679328427"><span class="hs-identifier hs-var">nargs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((UID, CodeExpr) -&gt; GenState (SValue r))
-&gt; [(UID, CodeExpr)] -&gt; StateT DrasilState Identity [SValue r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">(CodeExpr -&gt; GenState (SValue r))
-&gt; ((UID, CodeExpr) -&gt; CodeExpr)
-&gt; (UID, CodeExpr)
-&gt; GenState (SValue r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(UID, CodeExpr) -&gt; CodeExpr
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(UID, CodeExpr)]
</span><a href="#local-6989586621679328440"><span class="hs-identifier hs-var">ns</span></a></span><span>
</span><span id="line-372"></span><span>  </span><span class="annot"><span class="annottext">GenState (SValue r)
-&gt; (UID -&gt; GenState (SValue r)) -&gt; Maybe UID -&gt; GenState (SValue r)
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenState (SValue r)
-&gt; (UID -&gt; GenState (SValue r)) -&gt; Maybe UID -&gt; GenState (SValue r)
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UID -&gt; GenState (SValue r)
forall a. HasCallStack =&gt; UID -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(UID -&gt; GenState (SValue r)) -&gt; UID -&gt; GenState (SValue r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Call to non-existent function &quot;</span></span><span> </span><span class="annot"><span class="annottext">UID -&gt; UID -&gt; UID
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328431"><span class="hs-identifier hs-var">funcNm</span></a></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-373"></span><span>      </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679328426"><span class="annot"><span class="annottext">m :: UID
</span><a href="#local-6989586621679328426"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; GenState (SValue r)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; GenState (SValue r))
-&gt; SValue r -&gt; GenState (SValue r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UID -&gt; UID -&gt; VSType r -&gt; [SValue r] -&gt; NamedArgs r -&gt; SValue r
</span><a href="#local-6989586621679328438"><span class="hs-identifier hs-var">libf</span></a></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328426"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328431"><span class="hs-identifier hs-var">funcNm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeType -&gt; VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; CodeType -&gt; VSType r
</span><span class="hs-identifier hs-var">convType</span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679328430"><span class="hs-identifier hs-var">funcTp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[SValue r]
</span><a href="#local-6989586621679328429"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[VS (r (Variable r))] -&gt; [SValue r] -&gt; NamedArgs r
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679328428"><span class="hs-identifier hs-var">nms</span></a></span><span> </span><span class="annot"><span class="annottext">[SValue r]
</span><a href="#local-6989586621679328427"><span class="hs-identifier hs-var">nargs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-374"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UID -&gt; Map UID UID -&gt; Maybe UID
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328431"><span class="hs-identifier hs-var">funcNm</span></a></span><span> </span><span class="annot"><span class="annottext">Map UID UID
</span><a href="#local-6989586621679328434"><span class="hs-identifier hs-var">lem</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-375"></span><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679328425"><span class="annot"><span class="annottext">m :: UID
</span><a href="#local-6989586621679328425"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UID
-&gt; UID
-&gt; VSType r
-&gt; [SValue r]
-&gt; NamedArgs r
-&gt; GenState (SValue r)
</span><a href="#local-6989586621679328439"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328425"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328431"><span class="hs-identifier hs-var">funcNm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeType -&gt; VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; CodeType -&gt; VSType r
</span><span class="hs-identifier hs-var">convType</span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679328430"><span class="hs-identifier hs-var">funcTp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[SValue r]
</span><a href="#local-6989586621679328429"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[VS (r (Variable r))] -&gt; [SValue r] -&gt; NamedArgs r
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679328428"><span class="hs-identifier hs-var">nms</span></a></span><span> </span><span class="annot"><span class="annottext">[SValue r]
</span><a href="#local-6989586621679328427"><span class="hs-identifier hs-var">nargs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-376"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UID -&gt; Map UID UID -&gt; Maybe UID
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328431"><span class="hs-identifier hs-var">funcNm</span></a></span><span> </span><span class="annot"><span class="annottext">Map UID UID
</span><a href="#local-6989586621679328435"><span class="hs-identifier hs-var">mem</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-377"></span><span>  </span><span>
</span><span id="line-378"></span><span class="hs-comment">-- | Converts a 'Constraint' to a 'CodeExpr'.</span><span>
</span><span id="line-379"></span><span id="local-6989586621679328424"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#renderC"><span class="hs-identifier hs-type">renderC</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">HasUID</span></span><span> </span><span class="annot"><a href="#local-6989586621679328424"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasSymbol</span></span><span> </span><span class="annot"><a href="#local-6989586621679328424"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679328424"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Constraint</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CodeExpr</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CodeExpr</span></span></span><span>
</span><span id="line-380"></span><span id="renderC"><span class="annot"><span class="annottext">renderC :: c -&gt; Constraint CodeExpr -&gt; CodeExpr
</span><a href="Language.Drasil.Code.Imperative.Import.html#renderC"><span class="hs-identifier hs-var hs-var">renderC</span></a></span></span><span> </span><span id="local-6989586621679328423"><span class="annot"><span class="annottext">s :: c
</span><a href="#local-6989586621679328423"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Range</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679328421"><span class="annot"><span class="annottext">rr :: RealInterval CodeExpr CodeExpr
</span><a href="#local-6989586621679328421"><span class="hs-identifier hs-var">rr</span></a></span></span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">c -&gt; RealInterval CodeExpr CodeExpr -&gt; CodeExpr
forall c.
(HasUID c, HasSymbol c) =&gt;
c -&gt; RealInterval CodeExpr CodeExpr -&gt; CodeExpr
</span><a href="Language.Drasil.Code.Imperative.Import.html#renderRealInt"><span class="hs-identifier hs-var">renderRealInt</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679328423"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">RealInterval CodeExpr CodeExpr
</span><a href="#local-6989586621679328421"><span class="hs-identifier hs-var">rr</span></a></span><span>
</span><span id="line-381"></span><span>
</span><span id="line-382"></span><span class="hs-comment">-- | Converts an interval ('RealInterval') to a 'CodeExpr'.</span><span>
</span><span id="line-383"></span><span id="local-6989586621679328985"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#renderRealInt"><span class="hs-identifier hs-type">renderRealInt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">HasUID</span></span><span> </span><span class="annot"><a href="#local-6989586621679328985"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasSymbol</span></span><span> </span><span class="annot"><a href="#local-6989586621679328985"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679328985"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RealInterval</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CodeExpr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CodeExpr</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CodeExpr</span></span></span><span>
</span><span id="line-384"></span><span id="renderRealInt"><span class="annot"><span class="annottext">renderRealInt :: c -&gt; RealInterval CodeExpr CodeExpr -&gt; CodeExpr
</span><a href="Language.Drasil.Code.Imperative.Import.html#renderRealInt"><span class="hs-identifier hs-var hs-var">renderRealInt</span></a></span></span><span> </span><span id="local-6989586621679328420"><span class="annot"><span class="annottext">s :: c
</span><a href="#local-6989586621679328420"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bounded</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Inc</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679328417"><span class="annot"><span class="annottext">a :: CodeExpr
</span><a href="#local-6989586621679328417"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Inc</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679328416"><span class="annot"><span class="annottext">b :: CodeExpr
</span><a href="#local-6989586621679328416"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679328417"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; CodeExpr -&gt; CodeExpr
</span><span class="hs-operator hs-var">$&lt;=</span></span><span> </span><span class="annot"><span class="annottext">c -&gt; CodeExpr
forall u. (HasUID u, HasSymbol u) =&gt; u -&gt; CodeExpr
</span><span class="hs-identifier hs-var">sy</span></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679328420"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; CodeExpr -&gt; CodeExpr
</span><span class="hs-operator hs-var">$&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">c -&gt; CodeExpr
forall u. (HasUID u, HasSymbol u) =&gt; u -&gt; CodeExpr
</span><span class="hs-identifier hs-var">sy</span></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679328420"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; CodeExpr -&gt; CodeExpr
</span><span class="hs-operator hs-var">$&lt;=</span></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679328416"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-385"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#renderRealInt"><span class="hs-identifier hs-var">renderRealInt</span></a></span><span> </span><span id="local-6989586621679328415"><span class="annot"><span class="annottext">s :: c
</span><a href="#local-6989586621679328415"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bounded</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Inc</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679328414"><span class="annot"><span class="annottext">a :: CodeExpr
</span><a href="#local-6989586621679328414"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Exc</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679328412"><span class="annot"><span class="annottext">b :: CodeExpr
</span><a href="#local-6989586621679328412"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679328414"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; CodeExpr -&gt; CodeExpr
</span><span class="hs-operator hs-var">$&lt;=</span></span><span> </span><span class="annot"><span class="annottext">c -&gt; CodeExpr
forall u. (HasUID u, HasSymbol u) =&gt; u -&gt; CodeExpr
</span><span class="hs-identifier hs-var">sy</span></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679328415"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; CodeExpr -&gt; CodeExpr
</span><span class="hs-operator hs-var">$&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">c -&gt; CodeExpr
forall u. (HasUID u, HasSymbol u) =&gt; u -&gt; CodeExpr
</span><span class="hs-identifier hs-var">sy</span></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679328415"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; CodeExpr -&gt; CodeExpr
</span><span class="hs-operator hs-var">$&lt;</span></span><span>  </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679328412"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-386"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#renderRealInt"><span class="hs-identifier hs-var">renderRealInt</span></a></span><span> </span><span id="local-6989586621679328411"><span class="annot"><span class="annottext">s :: c
</span><a href="#local-6989586621679328411"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bounded</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Exc</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679328410"><span class="annot"><span class="annottext">a :: CodeExpr
</span><a href="#local-6989586621679328410"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Inc</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679328409"><span class="annot"><span class="annottext">b :: CodeExpr
</span><a href="#local-6989586621679328409"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679328410"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; CodeExpr -&gt; CodeExpr
</span><span class="hs-operator hs-var">$&lt;</span></span><span>  </span><span class="annot"><span class="annottext">c -&gt; CodeExpr
forall u. (HasUID u, HasSymbol u) =&gt; u -&gt; CodeExpr
</span><span class="hs-identifier hs-var">sy</span></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679328411"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; CodeExpr -&gt; CodeExpr
</span><span class="hs-operator hs-var">$&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">c -&gt; CodeExpr
forall u. (HasUID u, HasSymbol u) =&gt; u -&gt; CodeExpr
</span><span class="hs-identifier hs-var">sy</span></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679328411"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; CodeExpr -&gt; CodeExpr
</span><span class="hs-operator hs-var">$&lt;=</span></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679328409"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-387"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#renderRealInt"><span class="hs-identifier hs-var">renderRealInt</span></a></span><span> </span><span id="local-6989586621679328408"><span class="annot"><span class="annottext">s :: c
</span><a href="#local-6989586621679328408"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bounded</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Exc</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679328407"><span class="annot"><span class="annottext">a :: CodeExpr
</span><a href="#local-6989586621679328407"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Exc</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679328406"><span class="annot"><span class="annottext">b :: CodeExpr
</span><a href="#local-6989586621679328406"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679328407"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; CodeExpr -&gt; CodeExpr
</span><span class="hs-operator hs-var">$&lt;</span></span><span>  </span><span class="annot"><span class="annottext">c -&gt; CodeExpr
forall u. (HasUID u, HasSymbol u) =&gt; u -&gt; CodeExpr
</span><span class="hs-identifier hs-var">sy</span></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679328408"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; CodeExpr -&gt; CodeExpr
</span><span class="hs-operator hs-var">$&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">c -&gt; CodeExpr
forall u. (HasUID u, HasSymbol u) =&gt; u -&gt; CodeExpr
</span><span class="hs-identifier hs-var">sy</span></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679328408"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; CodeExpr -&gt; CodeExpr
</span><span class="hs-operator hs-var">$&lt;</span></span><span>  </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679328406"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-388"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#renderRealInt"><span class="hs-identifier hs-var">renderRealInt</span></a></span><span> </span><span id="local-6989586621679328405"><span class="annot"><span class="annottext">s :: c
</span><a href="#local-6989586621679328405"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UpTo</span></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Inc</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679328403"><span class="annot"><span class="annottext">a :: CodeExpr
</span><a href="#local-6989586621679328403"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">c -&gt; CodeExpr
forall u. (HasUID u, HasSymbol u) =&gt; u -&gt; CodeExpr
</span><span class="hs-identifier hs-var">sy</span></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679328405"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; CodeExpr -&gt; CodeExpr
</span><span class="hs-operator hs-var">$&lt;=</span></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679328403"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-389"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#renderRealInt"><span class="hs-identifier hs-var">renderRealInt</span></a></span><span> </span><span id="local-6989586621679328402"><span class="annot"><span class="annottext">s :: c
</span><a href="#local-6989586621679328402"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UpTo</span></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Exc</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679328401"><span class="annot"><span class="annottext">a :: CodeExpr
</span><a href="#local-6989586621679328401"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">c -&gt; CodeExpr
forall u. (HasUID u, HasSymbol u) =&gt; u -&gt; CodeExpr
</span><span class="hs-identifier hs-var">sy</span></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679328402"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; CodeExpr -&gt; CodeExpr
</span><span class="hs-operator hs-var">$&lt;</span></span><span>  </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679328401"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-390"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#renderRealInt"><span class="hs-identifier hs-var">renderRealInt</span></a></span><span> </span><span id="local-6989586621679328400"><span class="annot"><span class="annottext">s :: c
</span><a href="#local-6989586621679328400"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UpFrom</span></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Inc</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679328398"><span class="annot"><span class="annottext">a :: CodeExpr
</span><a href="#local-6989586621679328398"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">c -&gt; CodeExpr
forall u. (HasUID u, HasSymbol u) =&gt; u -&gt; CodeExpr
</span><span class="hs-identifier hs-var">sy</span></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679328400"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; CodeExpr -&gt; CodeExpr
</span><span class="hs-operator hs-var">$&gt;=</span></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679328398"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-391"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#renderRealInt"><span class="hs-identifier hs-var">renderRealInt</span></a></span><span> </span><span id="local-6989586621679328397"><span class="annot"><span class="annottext">s :: c
</span><a href="#local-6989586621679328397"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UpFrom</span></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Exc</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679328396"><span class="annot"><span class="annottext">a :: CodeExpr
</span><a href="#local-6989586621679328396"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">c -&gt; CodeExpr
forall u. (HasUID u, HasSymbol u) =&gt; u -&gt; CodeExpr
</span><span class="hs-identifier hs-var">sy</span></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679328397"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; CodeExpr -&gt; CodeExpr
</span><span class="hs-operator hs-var">$&gt;</span></span><span>  </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679328396"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-392"></span><span>
</span><span id="line-393"></span><span class="hs-comment">-- | Maps a 'UFunc' to the corresponding GOOL unary function.</span><span>
</span><span id="line-394"></span><span id="local-6989586621679329022"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#unop"><span class="hs-identifier hs-type">unop</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679329022"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UFunc</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679329022"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679329022"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-395"></span><span id="unop"><span class="annot"><span class="annottext">unop :: UFunc -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#unop"><span class="hs-identifier hs-var hs-var">unop</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Sqrt</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r
forall (r :: * -&gt; *). NumericExpression r =&gt; SValue r -&gt; SValue r
</span><span class="hs-operator hs-var">(#/^)</span></span><span>
</span><span id="line-396"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#unop"><span class="hs-identifier hs-var">unop</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Log</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r
forall (r :: * -&gt; *). NumericExpression r =&gt; SValue r -&gt; SValue r
</span><span class="hs-identifier hs-var">log</span></span><span>
</span><span id="line-397"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#unop"><span class="hs-identifier hs-var">unop</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ln</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r
forall (r :: * -&gt; *). NumericExpression r =&gt; SValue r -&gt; SValue r
</span><span class="hs-identifier hs-var">ln</span></span><span>
</span><span id="line-398"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#unop"><span class="hs-identifier hs-var">unop</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Abs</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r
forall (r :: * -&gt; *). NumericExpression r =&gt; SValue r -&gt; SValue r
</span><span class="hs-operator hs-var">(#|)</span></span><span>
</span><span id="line-399"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#unop"><span class="hs-identifier hs-var">unop</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r
forall (r :: * -&gt; *). NumericExpression r =&gt; SValue r -&gt; SValue r
</span><span class="hs-identifier hs-var">exp</span></span><span>
</span><span id="line-400"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#unop"><span class="hs-identifier hs-var">unop</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Sin</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r
forall (r :: * -&gt; *). NumericExpression r =&gt; SValue r -&gt; SValue r
</span><span class="hs-identifier hs-var">sin</span></span><span>
</span><span id="line-401"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#unop"><span class="hs-identifier hs-var">unop</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Cos</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r
forall (r :: * -&gt; *). NumericExpression r =&gt; SValue r -&gt; SValue r
</span><span class="hs-identifier hs-var">cos</span></span><span>
</span><span id="line-402"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#unop"><span class="hs-identifier hs-var">unop</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tan</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r
forall (r :: * -&gt; *). NumericExpression r =&gt; SValue r -&gt; SValue r
</span><span class="hs-identifier hs-var">tan</span></span><span>
</span><span id="line-403"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#unop"><span class="hs-identifier hs-var">unop</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Csc</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r
forall (r :: * -&gt; *). NumericExpression r =&gt; SValue r -&gt; SValue r
</span><span class="hs-identifier hs-var">csc</span></span><span>
</span><span id="line-404"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#unop"><span class="hs-identifier hs-var">unop</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Sec</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r
forall (r :: * -&gt; *). NumericExpression r =&gt; SValue r -&gt; SValue r
</span><span class="hs-identifier hs-var">sec</span></span><span>
</span><span id="line-405"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#unop"><span class="hs-identifier hs-var">unop</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Cot</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r
forall (r :: * -&gt; *). NumericExpression r =&gt; SValue r -&gt; SValue r
</span><span class="hs-identifier hs-var">cot</span></span><span>
</span><span id="line-406"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#unop"><span class="hs-identifier hs-var">unop</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Arcsin</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r
forall (r :: * -&gt; *). NumericExpression r =&gt; SValue r -&gt; SValue r
</span><span class="hs-identifier hs-var">arcsin</span></span><span>
</span><span id="line-407"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#unop"><span class="hs-identifier hs-var">unop</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Arccos</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r
forall (r :: * -&gt; *). NumericExpression r =&gt; SValue r -&gt; SValue r
</span><span class="hs-identifier hs-var">arccos</span></span><span>
</span><span id="line-408"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#unop"><span class="hs-identifier hs-var">unop</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Arctan</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r
forall (r :: * -&gt; *). NumericExpression r =&gt; SValue r -&gt; SValue r
</span><span class="hs-identifier hs-var">arctan</span></span><span>
</span><span id="line-409"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#unop"><span class="hs-identifier hs-var">unop</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Neg</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r
forall (r :: * -&gt; *). NumericExpression r =&gt; SValue r -&gt; SValue r
</span><span class="hs-operator hs-var">(#~)</span></span><span>
</span><span id="line-410"></span><span>
</span><span id="line-411"></span><span class="hs-comment">-- | Similar to 'unop', but for the 'Not' constructor.</span><span>
</span><span id="line-412"></span><span id="local-6989586621679329020"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#unopB"><span class="hs-identifier hs-type">unopB</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679329020"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UFuncB</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679329020"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679329020"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-413"></span><span id="unopB"><span class="annot"><span class="annottext">unopB :: UFuncB -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#unopB"><span class="hs-identifier hs-var hs-var">unopB</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Not</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r
forall (r :: * -&gt; *). BooleanExpression r =&gt; SValue r -&gt; SValue r
</span><span class="hs-operator hs-var">(?!)</span></span><span>
</span><span id="line-414"></span><span>
</span><span id="line-415"></span><span class="hs-comment">-- | Similar to 'unop', but for vectors.</span><span>
</span><span id="line-416"></span><span id="local-6989586621679329016"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#unopVN"><span class="hs-identifier hs-type">unopVN</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679329016"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UFuncVN</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679329016"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679329016"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-417"></span><span id="unopVN"><span class="annot"><span class="annottext">unopVN :: UFuncVN -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#unopVN"><span class="hs-identifier hs-var hs-var">unopVN</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dim</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r
forall (r :: * -&gt; *). List r =&gt; SValue r -&gt; SValue r
</span><span class="hs-identifier hs-var">listSize</span></span><span>
</span><span id="line-418"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#unopVN"><span class="hs-identifier hs-var">unopVN</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Norm</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UID -&gt; SValue r -&gt; SValue r
forall a. HasCallStack =&gt; UID -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="hs-string">&quot;unop: Norm not implemented&quot;</span></span><span> </span><span class="hs-comment">-- TODO</span><span>
</span><span id="line-419"></span><span>
</span><span id="line-420"></span><span class="hs-comment">-- | Similar to 'unop', but for vectors.</span><span>
</span><span id="line-421"></span><span id="local-6989586621679329018"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#unopVV"><span class="hs-identifier hs-type">unopVV</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679329018"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UFuncVV</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679329018"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679329018"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-422"></span><span id="unopVV"><span class="annot"><span class="annottext">unopVV :: UFuncVV -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#unopVV"><span class="hs-identifier hs-var hs-var">unopVV</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">NegV</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UID -&gt; SValue r -&gt; SValue r
forall a. HasCallStack =&gt; UID -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="hs-string">&quot;unop: Negation on Vectors not implemented&quot;</span></span><span> </span><span class="hs-comment">-- TODO</span><span>
</span><span id="line-423"></span><span>
</span><span id="line-424"></span><span class="hs-comment">-- Maps an 'ArithBinOp' to it's corresponding GOOL binary function.</span><span>
</span><span id="line-425"></span><span id="local-6989586621679329009"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#arithBfunc"><span class="hs-identifier hs-type">arithBfunc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679329009"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ArithBinOp</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679329009"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679329009"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679329009"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-426"></span><span id="arithBfunc"><span class="annot"><span class="annottext">arithBfunc :: ArithBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#arithBfunc"><span class="hs-identifier hs-var hs-var">arithBfunc</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pow</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
NumericExpression r =&gt;
SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-operator hs-var">(#^)</span></span><span>
</span><span id="line-427"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#arithBfunc"><span class="hs-identifier hs-var">arithBfunc</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Subt</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
NumericExpression r =&gt;
SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-operator hs-var">(#-)</span></span><span>
</span><span id="line-428"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#arithBfunc"><span class="hs-identifier hs-var">arithBfunc</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Frac</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
NumericExpression r =&gt;
SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-operator hs-var">(#/)</span></span><span>
</span><span id="line-429"></span><span>
</span><span id="line-430"></span><span class="hs-comment">-- Maps a 'BoolBinOp' to it's corresponding GOOL binary function.</span><span>
</span><span id="line-431"></span><span id="local-6989586621679329007"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#boolBfunc"><span class="hs-identifier hs-type">boolBfunc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BoolBinOp</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679329007"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679329007"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679329007"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-432"></span><span id="boolBfunc"><span class="annot"><span class="annottext">boolBfunc :: BoolBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#boolBfunc"><span class="hs-identifier hs-var hs-var">boolBfunc</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Impl</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UID -&gt; SValue r -&gt; SValue r -&gt; SValue r
forall a. HasCallStack =&gt; UID -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="hs-string">&quot;convExpr :=&gt;&quot;</span></span><span>
</span><span id="line-433"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#boolBfunc"><span class="hs-identifier hs-var">boolBfunc</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Iff</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UID -&gt; SValue r -&gt; SValue r -&gt; SValue r
forall a. HasCallStack =&gt; UID -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="hs-string">&quot;convExpr :&lt;=&gt;&quot;</span></span><span>
</span><span id="line-434"></span><span>
</span><span id="line-435"></span><span class="hs-comment">-- Maps an 'EqBinOp' to it's corresponding GOOL binary function.</span><span>
</span><span id="line-436"></span><span id="local-6989586621679329003"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#eqBfunc"><span class="hs-identifier hs-type">eqBfunc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679329003"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EqBinOp</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679329003"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679329003"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679329003"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-437"></span><span id="eqBfunc"><span class="annot"><span class="annottext">eqBfunc :: EqBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#eqBfunc"><span class="hs-identifier hs-var hs-var">eqBfunc</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
Comparison r =&gt;
SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-operator hs-var">(?==)</span></span><span>
</span><span id="line-438"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#eqBfunc"><span class="hs-identifier hs-var">eqBfunc</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">NEq</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
Comparison r =&gt;
SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-operator hs-var">(?!=)</span></span><span>
</span><span id="line-439"></span><span>
</span><span id="line-440"></span><span class="hs-comment">-- Maps an 'LABinOp' to it's corresponding GOOL binary function.</span><span>
</span><span id="line-441"></span><span id="local-6989586621679329005"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#laBfunc"><span class="hs-identifier hs-type">laBfunc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679329005"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LABinOp</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679329005"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679329005"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679329005"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-442"></span><span id="laBfunc"><span class="annot"><span class="annottext">laBfunc :: LABinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#laBfunc"><span class="hs-identifier hs-var hs-var">laBfunc</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Index</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *). List r =&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-identifier hs-var">listAccess</span></span><span>
</span><span id="line-443"></span><span>
</span><span id="line-444"></span><span class="hs-comment">-- Maps an 'OrdBinOp' to it's corresponding GOOL binary function.</span><span>
</span><span id="line-445"></span><span id="local-6989586621679329001"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#ordBfunc"><span class="hs-identifier hs-type">ordBfunc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679329001"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">OrdBinOp</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679329001"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679329001"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679329001"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-446"></span><span id="ordBfunc"><span class="annot"><span class="annottext">ordBfunc :: OrdBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#ordBfunc"><span class="hs-identifier hs-var hs-var">ordBfunc</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gt</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
Comparison r =&gt;
SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-operator hs-var">(?&gt;)</span></span><span>
</span><span id="line-447"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#ordBfunc"><span class="hs-identifier hs-var">ordBfunc</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lt</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
Comparison r =&gt;
SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-operator hs-var">(?&lt;)</span></span><span>
</span><span id="line-448"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#ordBfunc"><span class="hs-identifier hs-var">ordBfunc</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">LEq</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
Comparison r =&gt;
SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-operator hs-var">(?&lt;=)</span></span><span>
</span><span id="line-449"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#ordBfunc"><span class="hs-identifier hs-var">ordBfunc</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">GEq</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
Comparison r =&gt;
SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-operator hs-var">(?&gt;=)</span></span><span>
</span><span id="line-450"></span><span>
</span><span id="line-451"></span><span class="hs-comment">-- Maps a 'VVVBinOp' to it's corresponding GOOL binary function.</span><span>
</span><span id="line-452"></span><span id="local-6989586621679328999"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#vecVecVecBfunc"><span class="hs-identifier hs-type">vecVecVecBfunc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VVVBinOp</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679328999"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679328999"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679328999"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-453"></span><span id="vecVecVecBfunc"><span class="annot"><span class="annottext">vecVecVecBfunc :: VVVBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#vecVecVecBfunc"><span class="hs-identifier hs-var hs-var">vecVecVecBfunc</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Cross</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UID -&gt; SValue r -&gt; SValue r -&gt; SValue r
forall a. HasCallStack =&gt; UID -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="hs-string">&quot;bfunc: Cross not implemented&quot;</span></span><span>
</span><span id="line-454"></span><span>
</span><span id="line-455"></span><span class="hs-comment">-- Maps a 'VVNBinOp' to it's corresponding GOOL binary function.</span><span>
</span><span id="line-456"></span><span id="local-6989586621679328997"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#vecVecNumBfunc"><span class="hs-identifier hs-type">vecVecNumBfunc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VVNBinOp</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679328997"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679328997"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679328997"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-457"></span><span id="vecVecNumBfunc"><span class="annot"><span class="annottext">vecVecNumBfunc :: VVNBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#vecVecNumBfunc"><span class="hs-identifier hs-var hs-var">vecVecNumBfunc</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dot</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UID -&gt; SValue r -&gt; SValue r -&gt; SValue r
forall a. HasCallStack =&gt; UID -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="hs-string">&quot;convExpr DotProduct&quot;</span></span><span>
</span><span id="line-458"></span><span>
</span><span id="line-459"></span><span class="hs-comment">-- medium hacks --</span><span>
</span><span id="line-460"></span><span>
</span><span id="line-461"></span><span class="hs-comment">-- | Converts a 'Mod' to GOOL.</span><span>
</span><span id="line-462"></span><span id="local-6989586621679328337"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#genModDef"><span class="hs-identifier hs-type">genModDef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679328337"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Mod"><span class="hs-identifier hs-type">Mod</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SFile</span></span><span> </span><span class="annot"><a href="#local-6989586621679328337"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-463"></span><span id="genModDef"><span class="annot"><span class="annottext">genModDef :: Mod -&gt; GenState (SFile r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genModDef"><span class="hs-identifier hs-var hs-var">genModDef</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#Mod"><span class="hs-identifier hs-type">Mod</span></a></span><span> </span><span id="local-6989586621679328335"><span class="annot"><span class="annottext">n :: UID
</span><a href="#local-6989586621679328335"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679328334"><span class="annot"><span class="annottext">desc :: UID
</span><a href="#local-6989586621679328334"><span class="hs-identifier hs-var">desc</span></a></span></span><span> </span><span id="local-6989586621679328333"><span class="annot"><span class="annottext">is :: [UID]
</span><a href="#local-6989586621679328333"><span class="hs-identifier hs-var">is</span></a></span></span><span> </span><span id="local-6989586621679328332"><span class="annot"><span class="annottext">cs :: [Class]
</span><a href="#local-6989586621679328332"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span id="local-6989586621679328331"><span class="annot"><span class="annottext">fs :: [Func]
</span><a href="#local-6989586621679328331"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UID
-&gt; UID
-&gt; [UID]
-&gt; [GenState (Maybe (SMethod r))]
-&gt; [GenState (Maybe (SClass r))]
-&gt; GenState (SFile r)
forall (r :: * -&gt; *).
OOProg r =&gt;
UID
-&gt; UID
-&gt; [UID]
-&gt; [GenState (Maybe (SMethod r))]
-&gt; [GenState (Maybe (SClass r))]
-&gt; GenState (SFile r)
</span><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html#genModuleWithImports"><span class="hs-identifier hs-var">genModuleWithImports</span></a></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328335"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328334"><span class="hs-identifier hs-var">desc</span></a></span><span> </span><span class="annot"><span class="annottext">[UID]
</span><a href="#local-6989586621679328333"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Func -&gt; GenState (Maybe (SMethod r)))
-&gt; [Func] -&gt; [GenState (Maybe (SMethod r))]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(SMethod r -&gt; Maybe (SMethod r))
-&gt; StateT DrasilState Identity (SMethod r)
-&gt; GenState (Maybe (SMethod r))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span>
</span><span id="line-464"></span><span>  </span><span class="annot"><span class="annottext">SMethod r -&gt; Maybe (SMethod r)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(StateT DrasilState Identity (SMethod r)
 -&gt; GenState (Maybe (SMethod r)))
-&gt; (Func -&gt; StateT DrasilState Identity (SMethod r))
-&gt; Func
-&gt; GenState (Maybe (SMethod r))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(UID
 -&gt; VSType r
 -&gt; UID
 -&gt; [ParameterChunk]
 -&gt; Maybe UID
 -&gt; [MSBlock r]
 -&gt; StateT DrasilState Identity (SMethod r))
-&gt; [StateVariable]
-&gt; Func
-&gt; StateT DrasilState Identity (SMethod r)
forall (r :: * -&gt; *).
OOProg r =&gt;
(UID
 -&gt; VSType r
 -&gt; UID
 -&gt; [ParameterChunk]
 -&gt; Maybe UID
 -&gt; [MSBlock r]
 -&gt; GenState (SMethod r))
-&gt; [StateVariable] -&gt; Func -&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genFunc"><span class="hs-identifier hs-var">genFunc</span></a></span><span> </span><span class="annot"><span class="annottext">UID
-&gt; VSType r
-&gt; UID
-&gt; [ParameterChunk]
-&gt; Maybe UID
-&gt; [MSBlock r]
-&gt; StateT DrasilState Identity (SMethod r)
forall (r :: * -&gt; *).
OOProg r =&gt;
UID
-&gt; VSType r
-&gt; UID
-&gt; [ParameterChunk]
-&gt; Maybe UID
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#publicFunc"><span class="hs-identifier hs-var">publicFunc</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Func]
</span><a href="#local-6989586621679328331"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-465"></span><span>  </span><span class="hs-special">(</span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Class]
</span><a href="#local-6989586621679328332"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-466"></span><span>              </span><span class="hs-special">(</span><span id="local-6989586621679328329"><span class="annot"><span class="annottext">cl :: Class
</span><a href="#local-6989586621679328329"><span class="hs-identifier hs-var">cl</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679328328"><span class="annot"><span class="annottext">cls :: [Class]
</span><a href="#local-6989586621679328328"><span class="hs-identifier hs-var">cls</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(SClass r -&gt; Maybe (SClass r))
-&gt; StateT DrasilState Identity (SClass r)
-&gt; GenState (Maybe (SClass r))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">SClass r -&gt; Maybe (SClass r)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(UID
 -&gt; Maybe UID
 -&gt; UID
 -&gt; [CSStateVar r]
 -&gt; GenState [SMethod r]
 -&gt; StateT DrasilState Identity (SClass r))
-&gt; Class -&gt; StateT DrasilState Identity (SClass r)
forall (r :: * -&gt; *).
OOProg r =&gt;
(UID
 -&gt; Maybe UID
 -&gt; UID
 -&gt; [CSStateVar r]
 -&gt; GenState [SMethod r]
 -&gt; GenState (SClass r))
-&gt; Class -&gt; GenState (SClass r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genClass"><span class="hs-identifier hs-var">genClass</span></a></span><span> </span><span class="annot"><span class="annottext">UID
-&gt; Maybe UID
-&gt; UID
-&gt; [CSStateVar r]
-&gt; GenState [SMethod r]
-&gt; StateT DrasilState Identity (SClass r)
forall (r :: * -&gt; *).
OOProg r =&gt;
UID
-&gt; Maybe UID
-&gt; UID
-&gt; [CSStateVar r]
-&gt; GenState [SMethod r]
-&gt; GenState (SClass r)
</span><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html#primaryClass"><span class="hs-identifier hs-var">primaryClass</span></a></span><span> </span><span class="annot"><span class="annottext">Class
</span><a href="#local-6989586621679328329"><span class="hs-identifier hs-var">cl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">GenState (Maybe (SClass r))
-&gt; [GenState (Maybe (SClass r))] -&gt; [GenState (Maybe (SClass r))]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span>
</span><span id="line-467"></span><span>                </span><span class="annot"><span class="annottext">(Class -&gt; GenState (Maybe (SClass r)))
-&gt; [Class] -&gt; [GenState (Maybe (SClass r))]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(SClass r -&gt; Maybe (SClass r))
-&gt; StateT DrasilState Identity (SClass r)
-&gt; GenState (Maybe (SClass r))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">SClass r -&gt; Maybe (SClass r)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(StateT DrasilState Identity (SClass r)
 -&gt; GenState (Maybe (SClass r)))
-&gt; (Class -&gt; StateT DrasilState Identity (SClass r))
-&gt; Class
-&gt; GenState (Maybe (SClass r))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(UID
 -&gt; Maybe UID
 -&gt; UID
 -&gt; [CSStateVar r]
 -&gt; GenState [SMethod r]
 -&gt; StateT DrasilState Identity (SClass r))
-&gt; Class -&gt; StateT DrasilState Identity (SClass r)
forall (r :: * -&gt; *).
OOProg r =&gt;
(UID
 -&gt; Maybe UID
 -&gt; UID
 -&gt; [CSStateVar r]
 -&gt; GenState [SMethod r]
 -&gt; GenState (SClass r))
-&gt; Class -&gt; GenState (SClass r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genClass"><span class="hs-identifier hs-var">genClass</span></a></span><span> </span><span class="annot"><span class="annottext">UID
-&gt; Maybe UID
-&gt; UID
-&gt; [CSStateVar r]
-&gt; GenState [SMethod r]
-&gt; StateT DrasilState Identity (SClass r)
forall (r :: * -&gt; *).
OOProg r =&gt;
UID
-&gt; Maybe UID
-&gt; UID
-&gt; [CSStateVar r]
-&gt; GenState [SMethod r]
-&gt; GenState (SClass r)
</span><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html#auxClass"><span class="hs-identifier hs-var">auxClass</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Class]
</span><a href="#local-6989586621679328328"><span class="hs-identifier hs-var">cls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-468"></span><span>
</span><span id="line-469"></span><span class="hs-comment">-- | Converts a 'Mod'\'s functions to GOOL.</span><span>
</span><span id="line-470"></span><span id="local-6989586621679328326"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#genModFuncs"><span class="hs-identifier hs-type">genModFuncs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679328326"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Mod"><span class="hs-identifier hs-type">Mod</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679328326"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-471"></span><span id="genModFuncs"><span class="annot"><span class="annottext">genModFuncs :: Mod -&gt; [GenState (SMethod r)]
</span><a href="Language.Drasil.Code.Imperative.Import.html#genModFuncs"><span class="hs-identifier hs-var hs-var">genModFuncs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#Mod"><span class="hs-identifier hs-type">Mod</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679328325"><span class="annot"><span class="annottext">fs :: [Func]
</span><a href="#local-6989586621679328325"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Func -&gt; GenState (SMethod r)) -&gt; [Func] -&gt; [GenState (SMethod r)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(UID
 -&gt; VSType r
 -&gt; UID
 -&gt; [ParameterChunk]
 -&gt; Maybe UID
 -&gt; [MSBlock r]
 -&gt; GenState (SMethod r))
-&gt; [StateVariable] -&gt; Func -&gt; GenState (SMethod r)
forall (r :: * -&gt; *).
OOProg r =&gt;
(UID
 -&gt; VSType r
 -&gt; UID
 -&gt; [ParameterChunk]
 -&gt; Maybe UID
 -&gt; [MSBlock r]
 -&gt; GenState (SMethod r))
-&gt; [StateVariable] -&gt; Func -&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genFunc"><span class="hs-identifier hs-var">genFunc</span></a></span><span> </span><span class="annot"><span class="annottext">UID
-&gt; VSType r
-&gt; UID
-&gt; [ParameterChunk]
-&gt; Maybe UID
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
forall (r :: * -&gt; *).
OOProg r =&gt;
UID
-&gt; VSType r
-&gt; UID
-&gt; [ParameterChunk]
-&gt; Maybe UID
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#publicFunc"><span class="hs-identifier hs-var">publicFunc</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Func]
</span><a href="#local-6989586621679328325"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-472"></span><span>
</span><span id="line-473"></span><span class="hs-comment">-- | Converts a 'Mod'\'s classes to GOOL.</span><span>
</span><span id="line-474"></span><span id="local-6989586621679328324"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#genModClasses"><span class="hs-identifier hs-type">genModClasses</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679328324"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Mod"><span class="hs-identifier hs-type">Mod</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SClass</span></span><span> </span><span class="annot"><a href="#local-6989586621679328324"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-475"></span><span id="genModClasses"><span class="annot"><span class="annottext">genModClasses :: Mod -&gt; [GenState (SClass r)]
</span><a href="Language.Drasil.Code.Imperative.Import.html#genModClasses"><span class="hs-identifier hs-var hs-var">genModClasses</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#Mod"><span class="hs-identifier hs-type">Mod</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679328323"><span class="annot"><span class="annottext">cs :: [Class]
</span><a href="#local-6989586621679328323"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Class -&gt; GenState (SClass r)) -&gt; [Class] -&gt; [GenState (SClass r)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(UID
 -&gt; Maybe UID
 -&gt; UID
 -&gt; [CSStateVar r]
 -&gt; GenState [SMethod r]
 -&gt; GenState (SClass r))
-&gt; Class -&gt; GenState (SClass r)
forall (r :: * -&gt; *).
OOProg r =&gt;
(UID
 -&gt; Maybe UID
 -&gt; UID
 -&gt; [CSStateVar r]
 -&gt; GenState [SMethod r]
 -&gt; GenState (SClass r))
-&gt; Class -&gt; GenState (SClass r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genClass"><span class="hs-identifier hs-var">genClass</span></a></span><span> </span><span class="annot"><span class="annottext">UID
-&gt; Maybe UID
-&gt; UID
-&gt; [CSStateVar r]
-&gt; GenState [SMethod r]
-&gt; GenState (SClass r)
forall (r :: * -&gt; *).
OOProg r =&gt;
UID
-&gt; Maybe UID
-&gt; UID
-&gt; [CSStateVar r]
-&gt; GenState [SMethod r]
-&gt; GenState (SClass r)
</span><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html#auxClass"><span class="hs-identifier hs-var">auxClass</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Class]
</span><a href="#local-6989586621679328323"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-476"></span><span>
</span><span id="line-477"></span><span class="hs-comment">-- | Converts a Class (from the Mod AST) to GOOL. </span><span>
</span><span id="line-478"></span><span class="hs-comment">-- The class generator to use is passed as a parameter.</span><span>
</span><span id="line-479"></span><span id="local-6989586621679328946"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#genClass"><span class="hs-identifier hs-type">genClass</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679328946"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Description"><span class="hs-identifier hs-type">Description</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">CSStateVar</span></span><span> </span><span class="annot"><a href="#local-6989586621679328946"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span> </span><span>
</span><span id="line-480"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679328946"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SClass</span></span><span> </span><span class="annot"><a href="#local-6989586621679328946"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span>
</span><span id="line-481"></span><span>  </span><span class="annot"><a href="Language.Drasil.Mod.html#Class"><span class="hs-identifier hs-type">M.Class</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SClass</span></span><span> </span><span class="annot"><a href="#local-6989586621679328946"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-482"></span><span id="genClass"><span class="annot"><span class="annottext">genClass :: (UID
 -&gt; Maybe UID
 -&gt; UID
 -&gt; [CSStateVar r]
 -&gt; GenState [SMethod r]
 -&gt; GenState (SClass r))
-&gt; Class -&gt; GenState (SClass r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genClass"><span class="hs-identifier hs-var hs-var">genClass</span></a></span></span><span> </span><span id="local-6989586621679328322"><span class="annot"><span class="annottext">f :: UID
-&gt; Maybe UID
-&gt; UID
-&gt; [CSStateVar r]
-&gt; GenState [SMethod r]
-&gt; GenState (SClass r)
</span><a href="#local-6989586621679328322"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#ClassDef"><span class="hs-identifier hs-type">M.ClassDef</span></a></span><span> </span><span id="local-6989586621679328320"><span class="annot"><span class="annottext">n :: UID
</span><a href="#local-6989586621679328320"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679328319"><span class="annot"><span class="annottext">i :: Maybe UID
</span><a href="#local-6989586621679328319"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679328318"><span class="annot"><span class="annottext">desc :: UID
</span><a href="#local-6989586621679328318"><span class="hs-identifier hs-var">desc</span></a></span></span><span> </span><span id="local-6989586621679328317"><span class="annot"><span class="annottext">svs :: [StateVariable]
</span><a href="#local-6989586621679328317"><span class="hs-identifier hs-var">svs</span></a></span></span><span> </span><span id="local-6989586621679328316"><span class="annot"><span class="annottext">ms :: [Func]
</span><a href="#local-6989586621679328316"><span class="hs-identifier hs-var">ms</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679328315"><span class="annot"><span class="annottext">svar :: ScopeTag -&gt; VS (r (Variable r)) -&gt; CS (r (StateVar r))
</span><a href="#local-6989586621679328315"><span class="hs-identifier hs-var hs-var">svar</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pub</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r)) -&gt; CS (r (StateVar r))
forall (r :: * -&gt; *). StateVarSym r =&gt; SVariable r -&gt; CSStateVar r
</span><span class="hs-identifier hs-var">pubDVar</span></span><span>
</span><span id="line-483"></span><span>                                              </span><span class="annot"><a href="#local-6989586621679328315"><span class="hs-identifier hs-var">svar</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Priv</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r)) -&gt; CS (r (StateVar r))
forall (r :: * -&gt; *). StateVarSym r =&gt; SVariable r -&gt; CSStateVar r
</span><span class="hs-identifier hs-var">privDVar</span></span><span> </span><span>
</span><span id="line-484"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-485"></span><span>  </span><span id="local-6989586621679328312"><span class="annot"><span class="annottext">[CSStateVar r]
</span><a href="#local-6989586621679328312"><span class="hs-identifier hs-var">svrs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(StateVariable -&gt; StateT DrasilState Identity (CSStateVar r))
-&gt; [StateVariable] -&gt; StateT DrasilState Identity [CSStateVar r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#SV"><span class="hs-identifier hs-type">SV</span></a></span><span> </span><span id="local-6989586621679328310"><span class="annot"><span class="annottext">s :: ScopeTag
</span><a href="#local-6989586621679328310"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679328309"><span class="annot"><span class="annottext">v :: Input
</span><a href="#local-6989586621679328309"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(CodeType -&gt; CSStateVar r)
-&gt; GenState CodeType -&gt; StateT DrasilState Identity (CSStateVar r)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScopeTag -&gt; VS (r (Variable r)) -&gt; CSStateVar r
forall (r :: * -&gt; *).
StateVarSym r =&gt;
ScopeTag -&gt; VS (r (Variable r)) -&gt; CS (r (StateVar r))
</span><a href="#local-6989586621679328315"><span class="hs-identifier hs-var">svar</span></a></span><span> </span><span class="annot"><span class="annottext">ScopeTag
</span><a href="#local-6989586621679328310"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">(VS (r (Variable r)) -&gt; CSStateVar r)
-&gt; (CodeType -&gt; VS (r (Variable r))) -&gt; CodeType -&gt; CSStateVar r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">UID -&gt; VSType r -&gt; VS (r (Variable r))
forall (r :: * -&gt; *).
VariableSym r =&gt;
UID -&gt; VSType r -&gt; SVariable r
</span><span class="hs-identifier hs-var">var</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input -&gt; UID
forall c. CodeIdea c =&gt; c -&gt; UID
</span><span class="hs-identifier hs-var">codeName</span></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679328309"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(VSType r -&gt; VS (r (Variable r)))
-&gt; (CodeType -&gt; VSType r) -&gt; CodeType -&gt; VS (r (Variable r))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CodeType -&gt; VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; CodeType -&gt; VSType r
</span><span class="hs-identifier hs-var">convType</span></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-486"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input -&gt; GenState CodeType
forall c. HasSpace c =&gt; c -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#codeType"><span class="hs-identifier hs-var">codeType</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679328309"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[StateVariable]
</span><a href="#local-6989586621679328317"><span class="hs-identifier hs-var">svs</span></a></span><span>
</span><span id="line-487"></span><span>  </span><span class="annot"><span class="annottext">UID
-&gt; Maybe UID
-&gt; UID
-&gt; [CSStateVar r]
-&gt; GenState [SMethod r]
-&gt; GenState (SClass r)
</span><a href="#local-6989586621679328322"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328320"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe UID
</span><a href="#local-6989586621679328319"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328318"><span class="hs-identifier hs-var">desc</span></a></span><span> </span><span class="annot"><span class="annottext">[CSStateVar r]
</span><a href="#local-6989586621679328312"><span class="hs-identifier hs-var">svrs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Func -&gt; StateT DrasilState Identity (SMethod r))
-&gt; [Func] -&gt; GenState [SMethod r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(UID
 -&gt; VSType r
 -&gt; UID
 -&gt; [ParameterChunk]
 -&gt; Maybe UID
 -&gt; [MSBlock r]
 -&gt; StateT DrasilState Identity (SMethod r))
-&gt; [StateVariable]
-&gt; Func
-&gt; StateT DrasilState Identity (SMethod r)
forall (r :: * -&gt; *).
OOProg r =&gt;
(UID
 -&gt; VSType r
 -&gt; UID
 -&gt; [ParameterChunk]
 -&gt; Maybe UID
 -&gt; [MSBlock r]
 -&gt; GenState (SMethod r))
-&gt; [StateVariable] -&gt; Func -&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genFunc"><span class="hs-identifier hs-var">genFunc</span></a></span><span> </span><span class="annot"><span class="annottext">UID
-&gt; VSType r
-&gt; UID
-&gt; [ParameterChunk]
-&gt; Maybe UID
-&gt; [MSBlock r]
-&gt; StateT DrasilState Identity (SMethod r)
forall (r :: * -&gt; *).
OOProg r =&gt;
UID
-&gt; VSType r
-&gt; UID
-&gt; [ParameterChunk]
-&gt; Maybe UID
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#publicMethod"><span class="hs-identifier hs-var">publicMethod</span></a></span><span> </span><span class="annot"><span class="annottext">[StateVariable]
</span><a href="#local-6989586621679328317"><span class="hs-identifier hs-var">svs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Func]
</span><a href="#local-6989586621679328316"><span class="hs-identifier hs-var">ms</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-488"></span><span>
</span><span id="line-489"></span><span class="hs-comment">-- | Converts a 'Func' (from the Mod AST) to GOOL.</span><span>
</span><span id="line-490"></span><span class="hs-comment">-- The function generator to use is passed as a parameter. Automatically adds </span><span>
</span><span id="line-491"></span><span class="hs-comment">-- variable declaration statements for any undeclared variables. For methods, </span><span>
</span><span id="line-492"></span><span class="hs-comment">-- the list of StateVariables is needed so they can be included in the list of </span><span>
</span><span id="line-493"></span><span class="hs-comment">-- declared variables.</span><span>
</span><span id="line-494"></span><span id="local-6989586621679328949"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#genFunc"><span class="hs-identifier hs-type">genFunc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679328949"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VSType</span></span><span> </span><span class="annot"><a href="#local-6989586621679328949"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Description"><span class="hs-identifier hs-type">Description</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Chunk.Parameter.html#ParameterChunk"><span class="hs-identifier hs-type">ParameterChunk</span></a></span><span class="hs-special">]</span><span> </span><span>
</span><span id="line-495"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Description"><span class="hs-identifier hs-type">Description</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSBlock</span></span><span> </span><span class="annot"><a href="#local-6989586621679328949"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679328949"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span>
</span><span id="line-496"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Mod.html#StateVariable"><span class="hs-identifier hs-type">StateVariable</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Func"><span class="hs-identifier hs-type">Func</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679328949"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-497"></span><span id="genFunc"><span class="annot"><span class="annottext">genFunc :: (UID
 -&gt; VSType r
 -&gt; UID
 -&gt; [ParameterChunk]
 -&gt; Maybe UID
 -&gt; [MSBlock r]
 -&gt; GenState (SMethod r))
-&gt; [StateVariable] -&gt; Func -&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genFunc"><span class="hs-identifier hs-var hs-var">genFunc</span></a></span></span><span> </span><span id="local-6989586621679328308"><span class="annot"><span class="annottext">f :: UID
-&gt; VSType r
-&gt; UID
-&gt; [ParameterChunk]
-&gt; Maybe UID
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="#local-6989586621679328308"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679328307"><span class="annot"><span class="annottext">svs :: [StateVariable]
</span><a href="#local-6989586621679328307"><span class="hs-identifier hs-var">svs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FDef"><span class="hs-identifier hs-type">FDef</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FuncDef"><span class="hs-identifier hs-type">FuncDef</span></a></span><span> </span><span id="local-6989586621679328304"><span class="annot"><span class="annottext">n :: UID
</span><a href="#local-6989586621679328304"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679328303"><span class="annot"><span class="annottext">desc :: UID
</span><a href="#local-6989586621679328303"><span class="hs-identifier hs-var">desc</span></a></span></span><span> </span><span id="local-6989586621679328302"><span class="annot"><span class="annottext">parms :: [ParameterChunk]
</span><a href="#local-6989586621679328302"><span class="hs-identifier hs-var">parms</span></a></span></span><span> </span><span id="local-6989586621679328301"><span class="annot"><span class="annottext">o :: Space
</span><a href="#local-6989586621679328301"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679328300"><span class="annot"><span class="annottext">rd :: Maybe UID
</span><a href="#local-6989586621679328300"><span class="hs-identifier hs-var">rd</span></a></span></span><span> </span><span id="local-6989586621679328299"><span class="annot"><span class="annottext">s :: [FuncStmt]
</span><a href="#local-6989586621679328299"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-498"></span><span>  </span><span id="local-6989586621679328298"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679328298"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-499"></span><span>  </span><span id="local-6989586621679328297"><span class="annot"><span class="annottext">[MS (r (Statement r))]
</span><a href="#local-6989586621679328297"><span class="hs-identifier hs-var">stmts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FuncStmt -&gt; StateT DrasilState Identity (MS (r (Statement r))))
-&gt; [FuncStmt] -&gt; StateT DrasilState Identity [MS (r (Statement r))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">FuncStmt -&gt; StateT DrasilState Identity (MS (r (Statement r)))
forall (r :: * -&gt; *).
OOProg r =&gt;
FuncStmt -&gt; GenState (MSStatement r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679328299"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-500"></span><span>  </span><span id="local-6989586621679328296"><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679328296"><span class="hs-identifier hs-var">vars</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Input -&gt; StateT DrasilState Identity (VS (r (Variable r))))
-&gt; [Input] -&gt; StateT DrasilState Identity [VS (r (Variable r))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Input -&gt; StateT DrasilState Identity (VS (r (Variable r)))
forall (r :: * -&gt; *). OOProg r =&gt; Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB -&gt; [FuncStmt] -&gt; [Input]
</span><a href="Language.Drasil.Mod.html#fstdecl"><span class="hs-identifier hs-var">fstdecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeSpec -&gt; ChunkDB
</span><a href="Language.Drasil.CodeSpec.html#sysinfodb"><span class="hs-identifier hs-var hs-var">sysinfodb</span></a></span><span> </span><span class="annot"><span class="annottext">(CodeSpec -&gt; ChunkDB) -&gt; CodeSpec -&gt; ChunkDB
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; CodeSpec
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#codeSpec"><span class="hs-identifier hs-var hs-var">codeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679328298"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679328299"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span>
</span><span id="line-501"></span><span>    </span><span class="annot"><span class="annottext">[Input] -&gt; [Input] -&gt; [Input]
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">\\</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ParameterChunk -&gt; Input) -&gt; [ParameterChunk] -&gt; [Input]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">ParameterChunk -&gt; Input
forall c. (Quantity c, MayHaveUnit c) =&gt; c -&gt; Input
</span><span class="hs-identifier hs-var">quantvar</span></span><span> </span><span class="annot"><span class="annottext">[ParameterChunk]
</span><a href="#local-6989586621679328302"><span class="hs-identifier hs-var">parms</span></a></span><span> </span><span class="annot"><span class="annottext">[Input] -&gt; [Input] -&gt; [Input]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">(StateVariable -&gt; Input) -&gt; [StateVariable] -&gt; [Input]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">StateVariable -&gt; Input
</span><a href="Language.Drasil.Mod.html#stVar"><span class="hs-identifier hs-var hs-var">stVar</span></a></span><span> </span><span class="annot"><span class="annottext">[StateVariable]
</span><a href="#local-6989586621679328307"><span class="hs-identifier hs-var">svs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-502"></span><span>  </span><span id="local-6989586621679328294"><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679328294"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Space -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#spaceCodeType"><span class="hs-identifier hs-var">spaceCodeType</span></a></span><span> </span><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621679328301"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-503"></span><span>  </span><span class="annot"><span class="annottext">UID
-&gt; VSType r
-&gt; UID
-&gt; [ParameterChunk]
-&gt; Maybe UID
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="#local-6989586621679328308"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328304"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeType -&gt; VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; CodeType -&gt; VSType r
</span><span class="hs-identifier hs-var">convType</span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679328294"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328303"><span class="hs-identifier hs-var">desc</span></a></span><span> </span><span class="annot"><span class="annottext">[ParameterChunk]
</span><a href="#local-6989586621679328302"><span class="hs-identifier hs-var">parms</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe UID
</span><a href="#local-6989586621679328300"><span class="hs-identifier hs-var">rd</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[MS (r (Statement r))] -&gt; MSBlock r
forall (r :: * -&gt; *). BlockSym r =&gt; [MSStatement r] -&gt; MSBlock r
</span><span class="hs-identifier hs-var">block</span></span><span> </span><span class="annot"><span class="annottext">([MS (r (Statement r))] -&gt; MSBlock r)
-&gt; [MS (r (Statement r))] -&gt; MSBlock r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(VS (r (Variable r)) -&gt; MS (r (Statement r)))
-&gt; [VS (r (Variable r))] -&gt; [MS (r (Statement r))]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r)) -&gt; MS (r (Statement r))
forall (r :: * -&gt; *).
DeclStatement r =&gt;
SVariable r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">varDec</span></span><span> </span><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679328296"><span class="hs-identifier hs-var">vars</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[MS (r (Statement r))] -&gt; MSBlock r
forall (r :: * -&gt; *). BlockSym r =&gt; [MSStatement r] -&gt; MSBlock r
</span><span class="hs-identifier hs-var">block</span></span><span> </span><span class="annot"><span class="annottext">[MS (r (Statement r))]
</span><a href="#local-6989586621679328297"><span class="hs-identifier hs-var">stmts</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-504"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#genFunc"><span class="hs-identifier hs-var">genFunc</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679328291"><span class="annot"><span class="annottext">svs :: [StateVariable]
</span><a href="#local-6989586621679328291"><span class="hs-identifier hs-var">svs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FDef"><span class="hs-identifier hs-type">FDef</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#CtorDef"><span class="hs-identifier hs-type">CtorDef</span></a></span><span> </span><span id="local-6989586621679328289"><span class="annot"><span class="annottext">n :: UID
</span><a href="#local-6989586621679328289"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679328288"><span class="annot"><span class="annottext">desc :: UID
</span><a href="#local-6989586621679328288"><span class="hs-identifier hs-var">desc</span></a></span></span><span> </span><span id="local-6989586621679328287"><span class="annot"><span class="annottext">parms :: [ParameterChunk]
</span><a href="#local-6989586621679328287"><span class="hs-identifier hs-var">parms</span></a></span></span><span> </span><span id="local-6989586621679328286"><span class="annot"><span class="annottext">i :: [Initializer]
</span><a href="#local-6989586621679328286"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679328285"><span class="annot"><span class="annottext">s :: [FuncStmt]
</span><a href="#local-6989586621679328285"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-505"></span><span>  </span><span id="local-6989586621679328284"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679328284"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-506"></span><span>  </span><span id="local-6989586621679328283"><span class="annot"><span class="annottext">[VS (r (Value r))]
</span><a href="#local-6989586621679328283"><span class="hs-identifier hs-var">inits</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Initializer -&gt; StateT DrasilState Identity (VS (r (Value r))))
-&gt; [Initializer] -&gt; StateT DrasilState Identity [VS (r (Value r))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">(CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r))))
-&gt; (Initializer -&gt; CodeExpr)
-&gt; Initializer
-&gt; StateT DrasilState Identity (VS (r (Value r)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Initializer -&gt; CodeExpr
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Initializer]
</span><a href="#local-6989586621679328286"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-507"></span><span>  </span><span id="local-6989586621679328282"><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679328282"><span class="hs-identifier hs-var">initvars</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Initializer -&gt; StateT DrasilState Identity (VS (r (Variable r))))
-&gt; [Initializer]
-&gt; StateT DrasilState Identity [VS (r (Variable r))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679328281"><span class="annot"><span class="annottext">iv :: Input
</span><a href="#local-6989586621679328281"><span class="hs-identifier hs-var">iv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(CodeType -&gt; VS (r (Variable r)))
-&gt; GenState CodeType
-&gt; StateT DrasilState Identity (VS (r (Variable r)))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UID -&gt; VSType r -&gt; VS (r (Variable r))
forall (r :: * -&gt; *).
VariableSym r =&gt;
UID -&gt; VSType r -&gt; SVariable r
</span><span class="hs-identifier hs-var">var</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input -&gt; UID
forall c. CodeIdea c =&gt; c -&gt; UID
</span><span class="hs-identifier hs-var">codeName</span></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679328281"><span class="hs-identifier hs-var">iv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(VSType r -&gt; VS (r (Variable r)))
-&gt; (CodeType -&gt; VSType r) -&gt; CodeType -&gt; VS (r (Variable r))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CodeType -&gt; VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; CodeType -&gt; VSType r
</span><span class="hs-identifier hs-var">convType</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input -&gt; GenState CodeType
forall c. HasSpace c =&gt; c -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#codeType"><span class="hs-identifier hs-var">codeType</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679328281"><span class="hs-identifier hs-var">iv</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-508"></span><span>    </span><span class="annot"><span class="annottext">(Input -&gt; StateT DrasilState Identity (VS (r (Variable r))))
-&gt; (Initializer -&gt; Input)
-&gt; Initializer
-&gt; StateT DrasilState Identity (VS (r (Variable r)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Initializer -&gt; Input
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Initializer]
</span><a href="#local-6989586621679328286"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-509"></span><span>  </span><span id="local-6989586621679328280"><span class="annot"><span class="annottext">[MS (r (Statement r))]
</span><a href="#local-6989586621679328280"><span class="hs-identifier hs-var">stmts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FuncStmt -&gt; StateT DrasilState Identity (MS (r (Statement r))))
-&gt; [FuncStmt] -&gt; StateT DrasilState Identity [MS (r (Statement r))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">FuncStmt -&gt; StateT DrasilState Identity (MS (r (Statement r)))
forall (r :: * -&gt; *).
OOProg r =&gt;
FuncStmt -&gt; GenState (MSStatement r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679328285"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-510"></span><span>  </span><span id="local-6989586621679328279"><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679328279"><span class="hs-identifier hs-var">vars</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Input -&gt; StateT DrasilState Identity (VS (r (Variable r))))
-&gt; [Input] -&gt; StateT DrasilState Identity [VS (r (Variable r))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Input -&gt; StateT DrasilState Identity (VS (r (Variable r)))
forall (r :: * -&gt; *). OOProg r =&gt; Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB -&gt; [FuncStmt] -&gt; [Input]
</span><a href="Language.Drasil.Mod.html#fstdecl"><span class="hs-identifier hs-var">fstdecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeSpec -&gt; ChunkDB
</span><a href="Language.Drasil.CodeSpec.html#sysinfodb"><span class="hs-identifier hs-var hs-var">sysinfodb</span></a></span><span> </span><span class="annot"><span class="annottext">(CodeSpec -&gt; ChunkDB) -&gt; CodeSpec -&gt; ChunkDB
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; CodeSpec
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#codeSpec"><span class="hs-identifier hs-var hs-var">codeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679328284"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679328285"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span>
</span><span id="line-511"></span><span>    </span><span class="annot"><span class="annottext">[Input] -&gt; [Input] -&gt; [Input]
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">\\</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ParameterChunk -&gt; Input) -&gt; [ParameterChunk] -&gt; [Input]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">ParameterChunk -&gt; Input
forall c. (Quantity c, MayHaveUnit c) =&gt; c -&gt; Input
</span><span class="hs-identifier hs-var">quantvar</span></span><span> </span><span class="annot"><span class="annottext">[ParameterChunk]
</span><a href="#local-6989586621679328287"><span class="hs-identifier hs-var">parms</span></a></span><span> </span><span class="annot"><span class="annottext">[Input] -&gt; [Input] -&gt; [Input]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">(StateVariable -&gt; Input) -&gt; [StateVariable] -&gt; [Input]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">StateVariable -&gt; Input
</span><a href="Language.Drasil.Mod.html#stVar"><span class="hs-identifier hs-var hs-var">stVar</span></a></span><span> </span><span class="annot"><span class="annottext">[StateVariable]
</span><a href="#local-6989586621679328291"><span class="hs-identifier hs-var">svs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-512"></span><span>  </span><span class="annot"><span class="annottext">UID
-&gt; UID
-&gt; [ParameterChunk]
-&gt; Initializers r
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
forall (r :: * -&gt; *).
OOProg r =&gt;
UID
-&gt; UID
-&gt; [ParameterChunk]
-&gt; Initializers r
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genInitConstructor"><span class="hs-identifier hs-var">genInitConstructor</span></a></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328289"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328288"><span class="hs-identifier hs-var">desc</span></a></span><span> </span><span class="annot"><span class="annottext">[ParameterChunk]
</span><a href="#local-6989586621679328287"><span class="hs-identifier hs-var">parms</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[VS (r (Variable r))] -&gt; [VS (r (Value r))] -&gt; Initializers r
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679328282"><span class="hs-identifier hs-var">initvars</span></a></span><span> </span><span class="annot"><span class="annottext">[VS (r (Value r))]
</span><a href="#local-6989586621679328283"><span class="hs-identifier hs-var">inits</span></a></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-513"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[MS (r (Statement r))] -&gt; MSBlock r
forall (r :: * -&gt; *). BlockSym r =&gt; [MSStatement r] -&gt; MSBlock r
</span><span class="hs-identifier hs-var">block</span></span><span> </span><span class="annot"><span class="annottext">([MS (r (Statement r))] -&gt; MSBlock r)
-&gt; [MS (r (Statement r))] -&gt; MSBlock r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(VS (r (Variable r)) -&gt; MS (r (Statement r)))
-&gt; [VS (r (Variable r))] -&gt; [MS (r (Statement r))]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r)) -&gt; MS (r (Statement r))
forall (r :: * -&gt; *).
DeclStatement r =&gt;
SVariable r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">varDec</span></span><span> </span><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679328279"><span class="hs-identifier hs-var">vars</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[MS (r (Statement r))] -&gt; MSBlock r
forall (r :: * -&gt; *). BlockSym r =&gt; [MSStatement r] -&gt; MSBlock r
</span><span class="hs-identifier hs-var">block</span></span><span> </span><span class="annot"><span class="annottext">[MS (r (Statement r))]
</span><a href="#local-6989586621679328280"><span class="hs-identifier hs-var">stmts</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-514"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#genFunc"><span class="hs-identifier hs-var">genFunc</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FData"><span class="hs-identifier hs-type">FData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FuncData"><span class="hs-identifier hs-type">FuncData</span></a></span><span> </span><span id="local-6989586621679328276"><span class="annot"><span class="annottext">n :: UID
</span><a href="#local-6989586621679328276"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679328275"><span class="annot"><span class="annottext">desc :: UID
</span><a href="#local-6989586621679328275"><span class="hs-identifier hs-var">desc</span></a></span></span><span> </span><span id="local-6989586621679328274"><span class="annot"><span class="annottext">ddef :: DataDesc
</span><a href="#local-6989586621679328274"><span class="hs-identifier hs-var">ddef</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UID -&gt; UID -&gt; DataDesc -&gt; GenState (SMethod r)
forall (r :: * -&gt; *).
OOProg r =&gt;
UID -&gt; UID -&gt; DataDesc -&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genDataFunc"><span class="hs-identifier hs-var">genDataFunc</span></a></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328276"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328275"><span class="hs-identifier hs-var">desc</span></a></span><span> </span><span class="annot"><span class="annottext">DataDesc
</span><a href="#local-6989586621679328274"><span class="hs-identifier hs-var">ddef</span></a></span><span>
</span><span id="line-515"></span><span>
</span><span id="line-516"></span><span class="hs-comment">-- | Converts a 'FuncStmt' to a GOOL Statement.</span><span>
</span><span id="line-517"></span><span id="local-6989586621679328931"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-type">convStmt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679328931"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#FuncStmt"><span class="hs-identifier hs-type">FuncStmt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MSStatement</span></span><span> </span><span class="annot"><a href="#local-6989586621679328931"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-518"></span><span id="convStmt"><span class="annot"><span class="annottext">convStmt :: FuncStmt -&gt; GenState (MSStatement r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var hs-var">convStmt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FAsg"><span class="hs-identifier hs-type">FAsg</span></a></span><span> </span><span id="local-6989586621679328271"><span class="annot"><span class="annottext">v :: Input
</span><a href="#local-6989586621679328271"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Matrix</span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679328270"><span class="annot"><span class="annottext">es :: [CodeExpr]
</span><a href="#local-6989586621679328270"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-519"></span><span>  </span><span id="local-6989586621679328269"><span class="annot"><span class="annottext">[VS (r (Value r))]
</span><a href="#local-6989586621679328269"><span class="hs-identifier hs-var">els</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r))))
-&gt; [CodeExpr] -&gt; StateT DrasilState Identity [VS (r (Value r))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679328270"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-520"></span><span>  </span><span id="local-6989586621679328268"><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679328268"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input -&gt; GenState (StateT ValueState Identity (r (Variable r)))
forall (r :: * -&gt; *). OOProg r =&gt; Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679328271"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-521"></span><span>  </span><span id="local-6989586621679328267"><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679328267"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input -&gt; GenState CodeType
forall c. HasSpace c =&gt; c -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#codeType"><span class="hs-identifier hs-var">codeType</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679328271"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-522"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679328266"><span class="annot"><span class="annottext">listFunc :: CodeType
-&gt; VS (r (Type r)) -&gt; [VS (r (Value r))] -&gt; VS (r (Value r))
</span><a href="#local-6989586621679328266"><span class="hs-identifier hs-var hs-var">listFunc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">C.List</span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VS (r (Type r)) -&gt; [VS (r (Value r))] -&gt; VS (r (Value r))
forall (r :: * -&gt; *).
Literal r =&gt;
VSType r -&gt; [SValue r] -&gt; SValue r
</span><span class="hs-identifier hs-var">litList</span></span><span>
</span><span id="line-523"></span><span>      </span><span class="annot"><a href="#local-6989586621679328266"><span class="hs-identifier hs-var">listFunc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">C.Array</span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VS (r (Type r)) -&gt; [VS (r (Value r))] -&gt; VS (r (Value r))
forall (r :: * -&gt; *).
Literal r =&gt;
VSType r -&gt; [SValue r] -&gt; SValue r
</span><span class="hs-identifier hs-var">litArray</span></span><span>
</span><span id="line-524"></span><span>      </span><span class="annot"><a href="#local-6989586621679328266"><span class="hs-identifier hs-var">listFunc</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UID -&gt; VS (r (Type r)) -&gt; [VS (r (Value r))] -&gt; VS (r (Value r))
forall a. HasCallStack =&gt; UID -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Type mismatch between variable and value in assignment FuncStmt&quot;</span></span><span>
</span><span id="line-525"></span><span>  </span><span id="local-6989586621679328264"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679328264"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
-&gt; GenState [MSStatement r]
forall (r :: * -&gt; *).
OOProg r =&gt;
SVariable r -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Logging.html#maybeLog"><span class="hs-identifier hs-var">maybeLog</span></a></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679328268"><span class="hs-identifier hs-var">v'</span></a></span><span>
</span><span id="line-526"></span><span>  </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; GenState (MSStatement r))
-&gt; MSStatement r -&gt; GenState (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSStatement r
forall (r :: * -&gt; *).
StatementSym r =&gt;
[MSStatement r] -&gt; MSStatement r
</span><span class="hs-identifier hs-var">multi</span></span><span> </span><span class="annot"><span class="annottext">([MSStatement r] -&gt; MSStatement r)
-&gt; [MSStatement r] -&gt; MSStatement r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
-&gt; VS (r (Value r)) -&gt; MSStatement r
forall (r :: * -&gt; *).
AssignStatement r =&gt;
SVariable r -&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">assign</span></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679328268"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeType
-&gt; VS (r (Type r)) -&gt; [VS (r (Value r))] -&gt; VS (r (Value r))
forall (r :: * -&gt; *).
Literal r =&gt;
CodeType
-&gt; VS (r (Type r)) -&gt; [VS (r (Value r))] -&gt; VS (r (Value r))
</span><a href="#local-6989586621679328266"><span class="hs-identifier hs-var">listFunc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679328267"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VS (r (Type r)) -&gt; VS (r (Type r))
forall (r :: * -&gt; *). TypeSym r =&gt; VSType r -&gt; VSType r
</span><span class="hs-identifier hs-var">listInnerType</span></span><span> </span><span class="annot"><span class="annottext">(VS (r (Type r)) -&gt; VS (r (Type r)))
-&gt; VS (r (Type r)) -&gt; VS (r (Type r))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(r (Variable r) -&gt; r (Type r))
-&gt; StateT ValueState Identity (r (Variable r)) -&gt; VS (r (Type r))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">r (Variable r) -&gt; r (Type r)
forall (r :: * -&gt; *).
VariableElim r =&gt;
r (Variable r) -&gt; r (Type r)
</span><span class="hs-identifier hs-var">variableType</span></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679328268"><span class="hs-identifier hs-var">v'</span></a></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-527"></span><span>    </span><span class="annot"><span class="annottext">[VS (r (Value r))]
</span><a href="#local-6989586621679328269"><span class="hs-identifier hs-var">els</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MSStatement r -&gt; [MSStatement r] -&gt; [MSStatement r]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679328264"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-528"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FAsg"><span class="hs-identifier hs-type">FAsg</span></a></span><span> </span><span id="local-6989586621679328260"><span class="annot"><span class="annottext">v :: Input
</span><a href="#local-6989586621679328260"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679328259"><span class="annot"><span class="annottext">e :: CodeExpr
</span><a href="#local-6989586621679328259"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-529"></span><span>  </span><span id="local-6989586621679328258"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679328258"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679328259"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-530"></span><span>  </span><span id="local-6989586621679328257"><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679328257"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input -&gt; GenState (StateT ValueState Identity (r (Variable r)))
forall (r :: * -&gt; *). OOProg r =&gt; Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679328260"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-531"></span><span>  </span><span id="local-6989586621679328256"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679328256"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
-&gt; GenState [MSStatement r]
forall (r :: * -&gt; *).
OOProg r =&gt;
SVariable r -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Logging.html#maybeLog"><span class="hs-identifier hs-var">maybeLog</span></a></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679328257"><span class="hs-identifier hs-var">v'</span></a></span><span>
</span><span id="line-532"></span><span>  </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; GenState (MSStatement r))
-&gt; MSStatement r -&gt; GenState (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSStatement r
forall (r :: * -&gt; *).
StatementSym r =&gt;
[MSStatement r] -&gt; MSStatement r
</span><span class="hs-identifier hs-var">multi</span></span><span> </span><span class="annot"><span class="annottext">([MSStatement r] -&gt; MSStatement r)
-&gt; [MSStatement r] -&gt; MSStatement r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
-&gt; VS (r (Value r)) -&gt; MSStatement r
forall (r :: * -&gt; *).
AssignStatement r =&gt;
SVariable r -&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">assign</span></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679328257"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679328258"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="annot"><span class="annottext">MSStatement r -&gt; [MSStatement r] -&gt; [MSStatement r]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679328256"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-533"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FAsgIndex"><span class="hs-identifier hs-type">FAsgIndex</span></a></span><span> </span><span id="local-6989586621679328254"><span class="annot"><span class="annottext">v :: Input
</span><a href="#local-6989586621679328254"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679328253"><span class="annot"><span class="annottext">i :: Integer
</span><a href="#local-6989586621679328253"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679328252"><span class="annot"><span class="annottext">e :: CodeExpr
</span><a href="#local-6989586621679328252"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-534"></span><span>  </span><span id="local-6989586621679328251"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679328251"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679328252"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-535"></span><span>  </span><span id="local-6989586621679328250"><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679328250"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input -&gt; GenState (StateT ValueState Identity (r (Variable r)))
forall (r :: * -&gt; *). OOProg r =&gt; Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679328254"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-536"></span><span>  </span><span id="local-6989586621679328249"><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679328249"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input -&gt; GenState CodeType
forall c. HasSpace c =&gt; c -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#codeType"><span class="hs-identifier hs-var">codeType</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679328254"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-537"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679328248"><span class="annot"><span class="annottext">asgFunc :: CodeType -&gt; MSStatement r
</span><a href="#local-6989586621679328248"><span class="hs-identifier hs-var hs-var">asgFunc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">C.List</span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VS (r (Value r)) -&gt; MSStatement r
forall (r :: * -&gt; *). StatementSym r =&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">valStmt</span></span><span> </span><span class="annot"><span class="annottext">(VS (r (Value r)) -&gt; MSStatement r)
-&gt; VS (r (Value r)) -&gt; MSStatement r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
-&gt; VS (r (Value r)) -&gt; VS (r (Value r)) -&gt; VS (r (Value r))
forall (r :: * -&gt; *).
List r =&gt;
SValue r -&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-identifier hs-var">listSet</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r)) -&gt; VS (r (Value r))
forall (r :: * -&gt; *). VariableValue r =&gt; SVariable r -&gt; SValue r
</span><span class="hs-identifier hs-var">valueOf</span></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679328250"><span class="hs-identifier hs-var">v'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; VS (r (Value r))
forall (r :: * -&gt; *). Literal r =&gt; Integer -&gt; SValue r
</span><span class="hs-identifier hs-var">litInt</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679328253"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679328251"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-538"></span><span>      </span><span class="annot"><a href="#local-6989586621679328248"><span class="hs-identifier hs-var">asgFunc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">C.Array</span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
-&gt; VS (r (Value r)) -&gt; MSStatement r
forall (r :: * -&gt; *).
AssignStatement r =&gt;
SVariable r -&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">assign</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
-&gt; StateT ValueState Identity (r (Variable r))
-&gt; StateT ValueState Identity (r (Variable r))
forall (r :: * -&gt; *).
VariableSym r =&gt;
Integer -&gt; SVariable r -&gt; SVariable r
</span><span class="hs-identifier hs-var">arrayElem</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679328253"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679328250"><span class="hs-identifier hs-var">v'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679328251"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-539"></span><span>      </span><span class="annot"><a href="#local-6989586621679328248"><span class="hs-identifier hs-var">asgFunc</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UID -&gt; MSStatement r
forall a. HasCallStack =&gt; UID -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="hs-string">&quot;FAsgIndex used with non-indexed value&quot;</span></span><span>
</span><span id="line-540"></span><span>      </span><span id="local-6989586621679328244"><span class="annot"><span class="annottext">vi :: StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679328244"><span class="hs-identifier hs-var hs-var">vi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
-&gt; StateT ValueState Identity (r (Variable r))
-&gt; StateT ValueState Identity (r (Variable r))
forall (r :: * -&gt; *).
VariableSym r =&gt;
Integer -&gt; SVariable r -&gt; SVariable r
</span><span class="hs-identifier hs-var">arrayElem</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679328253"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679328250"><span class="hs-identifier hs-var">v'</span></a></span><span>
</span><span id="line-541"></span><span>  </span><span id="local-6989586621679328243"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679328243"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
-&gt; GenState [MSStatement r]
forall (r :: * -&gt; *).
OOProg r =&gt;
SVariable r -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Logging.html#maybeLog"><span class="hs-identifier hs-var">maybeLog</span></a></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679328244"><span class="hs-identifier hs-var">vi</span></a></span><span>
</span><span id="line-542"></span><span>  </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; GenState (MSStatement r))
-&gt; MSStatement r -&gt; GenState (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSStatement r
forall (r :: * -&gt; *).
StatementSym r =&gt;
[MSStatement r] -&gt; MSStatement r
</span><span class="hs-identifier hs-var">multi</span></span><span> </span><span class="annot"><span class="annottext">([MSStatement r] -&gt; MSStatement r)
-&gt; [MSStatement r] -&gt; MSStatement r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CodeType -&gt; MSStatement r
</span><a href="#local-6989586621679328248"><span class="hs-identifier hs-var">asgFunc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679328249"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">MSStatement r -&gt; [MSStatement r] -&gt; [MSStatement r]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679328243"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-543"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FFor"><span class="hs-identifier hs-type">FFor</span></a></span><span> </span><span id="local-6989586621679328241"><span class="annot"><span class="annottext">v :: Input
</span><a href="#local-6989586621679328241"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679328240"><span class="annot"><span class="annottext">start :: CodeExpr
</span><a href="#local-6989586621679328240"><span class="hs-identifier hs-var">start</span></a></span></span><span> </span><span id="local-6989586621679328239"><span class="annot"><span class="annottext">end :: CodeExpr
</span><a href="#local-6989586621679328239"><span class="hs-identifier hs-var">end</span></a></span></span><span> </span><span id="local-6989586621679328238"><span class="annot"><span class="annottext">step :: CodeExpr
</span><a href="#local-6989586621679328238"><span class="hs-identifier hs-var">step</span></a></span></span><span> </span><span id="local-6989586621679328237"><span class="annot"><span class="annottext">st :: [FuncStmt]
</span><a href="#local-6989586621679328237"><span class="hs-identifier hs-var">st</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-544"></span><span>  </span><span id="local-6989586621679328236"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679328236"><span class="hs-identifier hs-var">stmts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FuncStmt -&gt; GenState (MSStatement r))
-&gt; [FuncStmt] -&gt; GenState [MSStatement r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">FuncStmt -&gt; GenState (MSStatement r)
forall (r :: * -&gt; *).
OOProg r =&gt;
FuncStmt -&gt; GenState (MSStatement r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679328237"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-545"></span><span>  </span><span id="local-6989586621679328235"><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679328235"><span class="hs-identifier hs-var">vari</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input -&gt; GenState (StateT ValueState Identity (r (Variable r)))
forall (r :: * -&gt; *). OOProg r =&gt; Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679328241"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-546"></span><span>  </span><span id="local-6989586621679328234"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679328234"><span class="hs-identifier hs-var">start'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679328240"><span class="hs-identifier hs-var">start</span></a></span><span>
</span><span id="line-547"></span><span>  </span><span id="local-6989586621679328233"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679328233"><span class="hs-identifier hs-var">end'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679328239"><span class="hs-identifier hs-var">end</span></a></span><span>
</span><span id="line-548"></span><span>  </span><span id="local-6989586621679328232"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679328232"><span class="hs-identifier hs-var">step'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679328238"><span class="hs-identifier hs-var">step</span></a></span><span>
</span><span id="line-549"></span><span>  </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; GenState (MSStatement r))
-&gt; MSStatement r -&gt; GenState (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
-&gt; VS (r (Value r))
-&gt; VS (r (Value r))
-&gt; VS (r (Value r))
-&gt; MSBody r
-&gt; MSStatement r
forall (r :: * -&gt; *).
ControlStatement r =&gt;
SVariable r
-&gt; SValue r -&gt; SValue r -&gt; SValue r -&gt; MSBody r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">forRange</span></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679328235"><span class="hs-identifier hs-var">vari</span></a></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679328234"><span class="hs-identifier hs-var">start'</span></a></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679328233"><span class="hs-identifier hs-var">end'</span></a></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679328232"><span class="hs-identifier hs-var">step'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSBody r
forall (r :: * -&gt; *). BodySym r =&gt; [MSStatement r] -&gt; MSBody r
</span><span class="hs-identifier hs-var">bodyStatements</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679328236"><span class="hs-identifier hs-var">stmts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-550"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FForEach"><span class="hs-identifier hs-type">FForEach</span></a></span><span> </span><span id="local-6989586621679328229"><span class="annot"><span class="annottext">v :: Input
</span><a href="#local-6989586621679328229"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679328228"><span class="annot"><span class="annottext">e :: CodeExpr
</span><a href="#local-6989586621679328228"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679328227"><span class="annot"><span class="annottext">st :: [FuncStmt]
</span><a href="#local-6989586621679328227"><span class="hs-identifier hs-var">st</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-551"></span><span>  </span><span id="local-6989586621679328226"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679328226"><span class="hs-identifier hs-var">stmts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FuncStmt -&gt; GenState (MSStatement r))
-&gt; [FuncStmt] -&gt; GenState [MSStatement r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">FuncStmt -&gt; GenState (MSStatement r)
forall (r :: * -&gt; *).
OOProg r =&gt;
FuncStmt -&gt; GenState (MSStatement r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679328227"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-552"></span><span>  </span><span id="local-6989586621679328225"><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679328225"><span class="hs-identifier hs-var">vari</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input -&gt; GenState (StateT ValueState Identity (r (Variable r)))
forall (r :: * -&gt; *). OOProg r =&gt; Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679328229"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-553"></span><span>  </span><span id="local-6989586621679328224"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679328224"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679328228"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-554"></span><span>  </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; GenState (MSStatement r))
-&gt; MSStatement r -&gt; GenState (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
-&gt; VS (r (Value r)) -&gt; MSBody r -&gt; MSStatement r
forall (r :: * -&gt; *).
ControlStatement r =&gt;
SVariable r -&gt; SValue r -&gt; MSBody r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">forEach</span></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679328225"><span class="hs-identifier hs-var">vari</span></a></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679328224"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSBody r
forall (r :: * -&gt; *). BodySym r =&gt; [MSStatement r] -&gt; MSBody r
</span><span class="hs-identifier hs-var">bodyStatements</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679328226"><span class="hs-identifier hs-var">stmts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-555"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FWhile"><span class="hs-identifier hs-type">FWhile</span></a></span><span> </span><span id="local-6989586621679328221"><span class="annot"><span class="annottext">e :: CodeExpr
</span><a href="#local-6989586621679328221"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679328220"><span class="annot"><span class="annottext">st :: [FuncStmt]
</span><a href="#local-6989586621679328220"><span class="hs-identifier hs-var">st</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-556"></span><span>  </span><span id="local-6989586621679328219"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679328219"><span class="hs-identifier hs-var">stmts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FuncStmt -&gt; GenState (MSStatement r))
-&gt; [FuncStmt] -&gt; GenState [MSStatement r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">FuncStmt -&gt; GenState (MSStatement r)
forall (r :: * -&gt; *).
OOProg r =&gt;
FuncStmt -&gt; GenState (MSStatement r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679328220"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-557"></span><span>  </span><span id="local-6989586621679328218"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679328218"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679328221"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-558"></span><span>  </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; GenState (MSStatement r))
-&gt; MSStatement r -&gt; GenState (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r)) -&gt; MSBody r -&gt; MSStatement r
forall (r :: * -&gt; *).
ControlStatement r =&gt;
SValue r -&gt; MSBody r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">while</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679328218"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSBody r
forall (r :: * -&gt; *). BodySym r =&gt; [MSStatement r] -&gt; MSBody r
</span><span class="hs-identifier hs-var">bodyStatements</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679328219"><span class="hs-identifier hs-var">stmts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-559"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FCond"><span class="hs-identifier hs-type">FCond</span></a></span><span> </span><span id="local-6989586621679328215"><span class="annot"><span class="annottext">e :: CodeExpr
</span><a href="#local-6989586621679328215"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679328214"><span class="annot"><span class="annottext">tSt :: [FuncStmt]
</span><a href="#local-6989586621679328214"><span class="hs-identifier hs-var">tSt</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-560"></span><span>  </span><span id="local-6989586621679328213"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679328213"><span class="hs-identifier hs-var">stmts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FuncStmt -&gt; GenState (MSStatement r))
-&gt; [FuncStmt] -&gt; GenState [MSStatement r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">FuncStmt -&gt; GenState (MSStatement r)
forall (r :: * -&gt; *).
OOProg r =&gt;
FuncStmt -&gt; GenState (MSStatement r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679328214"><span class="hs-identifier hs-var">tSt</span></a></span><span>
</span><span id="line-561"></span><span>  </span><span id="local-6989586621679328212"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679328212"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679328215"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-562"></span><span>  </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; GenState (MSStatement r))
-&gt; MSStatement r -&gt; GenState (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(VS (r (Value r)), MSBody r)] -&gt; MSStatement r
forall (r :: * -&gt; *).
ControlStatement r =&gt;
[(SValue r, MSBody r)] -&gt; MSStatement r
</span><span class="hs-identifier hs-var">ifNoElse</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679328212"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSBody r
forall (r :: * -&gt; *). BodySym r =&gt; [MSStatement r] -&gt; MSBody r
</span><span class="hs-identifier hs-var">bodyStatements</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679328213"><span class="hs-identifier hs-var">stmts</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-563"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FCond"><span class="hs-identifier hs-type">FCond</span></a></span><span> </span><span id="local-6989586621679328211"><span class="annot"><span class="annottext">e :: CodeExpr
</span><a href="#local-6989586621679328211"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679328210"><span class="annot"><span class="annottext">tSt :: [FuncStmt]
</span><a href="#local-6989586621679328210"><span class="hs-identifier hs-var">tSt</span></a></span></span><span> </span><span id="local-6989586621679328209"><span class="annot"><span class="annottext">eSt :: [FuncStmt]
</span><a href="#local-6989586621679328209"><span class="hs-identifier hs-var">eSt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-564"></span><span>  </span><span id="local-6989586621679328208"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679328208"><span class="hs-identifier hs-var">stmt1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FuncStmt -&gt; GenState (MSStatement r))
-&gt; [FuncStmt] -&gt; GenState [MSStatement r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">FuncStmt -&gt; GenState (MSStatement r)
forall (r :: * -&gt; *).
OOProg r =&gt;
FuncStmt -&gt; GenState (MSStatement r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679328210"><span class="hs-identifier hs-var">tSt</span></a></span><span>
</span><span id="line-565"></span><span>  </span><span id="local-6989586621679328207"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679328207"><span class="hs-identifier hs-var">stmt2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FuncStmt -&gt; GenState (MSStatement r))
-&gt; [FuncStmt] -&gt; GenState [MSStatement r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">FuncStmt -&gt; GenState (MSStatement r)
forall (r :: * -&gt; *).
OOProg r =&gt;
FuncStmt -&gt; GenState (MSStatement r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679328209"><span class="hs-identifier hs-var">eSt</span></a></span><span>
</span><span id="line-566"></span><span>  </span><span id="local-6989586621679328206"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679328206"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679328211"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-567"></span><span>  </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; GenState (MSStatement r))
-&gt; MSStatement r -&gt; GenState (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(VS (r (Value r)), MSBody r)] -&gt; MSBody r -&gt; MSStatement r
forall (r :: * -&gt; *).
ControlStatement r =&gt;
[(SValue r, MSBody r)] -&gt; MSBody r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">ifCond</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679328206"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSBody r
forall (r :: * -&gt; *). BodySym r =&gt; [MSStatement r] -&gt; MSBody r
</span><span class="hs-identifier hs-var">bodyStatements</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679328208"><span class="hs-identifier hs-var">stmt1</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSBody r
forall (r :: * -&gt; *). BodySym r =&gt; [MSStatement r] -&gt; MSBody r
</span><span class="hs-identifier hs-var">bodyStatements</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679328207"><span class="hs-identifier hs-var">stmt2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-568"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FRet"><span class="hs-identifier hs-type">FRet</span></a></span><span> </span><span id="local-6989586621679328203"><span class="annot"><span class="annottext">e :: CodeExpr
</span><a href="#local-6989586621679328203"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-569"></span><span>  </span><span id="local-6989586621679328202"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679328202"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679328203"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-570"></span><span>  </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; GenState (MSStatement r))
-&gt; MSStatement r -&gt; GenState (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r)) -&gt; MSStatement r
forall (r :: * -&gt; *).
ControlStatement r =&gt;
SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">returnStmt</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679328202"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-571"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FThrow"><span class="hs-identifier hs-type">FThrow</span></a></span><span> </span><span id="local-6989586621679328199"><span class="annot"><span class="annottext">s :: UID
</span><a href="#local-6989586621679328199"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; GenState (MSStatement r))
-&gt; MSStatement r -&gt; GenState (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UID -&gt; MSStatement r
forall (r :: * -&gt; *). ControlStatement r =&gt; UID -&gt; MSStatement r
</span><span class="hs-identifier hs-var">throw</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328199"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-572"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FTry"><span class="hs-identifier hs-type">FTry</span></a></span><span> </span><span id="local-6989586621679328196"><span class="annot"><span class="annottext">t :: [FuncStmt]
</span><a href="#local-6989586621679328196"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679328195"><span class="annot"><span class="annottext">c :: [FuncStmt]
</span><a href="#local-6989586621679328195"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-573"></span><span>  </span><span id="local-6989586621679328194"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679328194"><span class="hs-identifier hs-var">stmt1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FuncStmt -&gt; GenState (MSStatement r))
-&gt; [FuncStmt] -&gt; GenState [MSStatement r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">FuncStmt -&gt; GenState (MSStatement r)
forall (r :: * -&gt; *).
OOProg r =&gt;
FuncStmt -&gt; GenState (MSStatement r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679328196"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-574"></span><span>  </span><span id="local-6989586621679328193"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679328193"><span class="hs-identifier hs-var">stmt2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FuncStmt -&gt; GenState (MSStatement r))
-&gt; [FuncStmt] -&gt; GenState [MSStatement r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">FuncStmt -&gt; GenState (MSStatement r)
forall (r :: * -&gt; *).
OOProg r =&gt;
FuncStmt -&gt; GenState (MSStatement r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679328195"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-575"></span><span>  </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; GenState (MSStatement r))
-&gt; MSStatement r -&gt; GenState (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MSBody r -&gt; MSBody r -&gt; MSStatement r
forall (r :: * -&gt; *).
ControlStatement r =&gt;
MSBody r -&gt; MSBody r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">tryCatch</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSBody r
forall (r :: * -&gt; *). BodySym r =&gt; [MSStatement r] -&gt; MSBody r
</span><span class="hs-identifier hs-var">bodyStatements</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679328194"><span class="hs-identifier hs-var">stmt1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSBody r
forall (r :: * -&gt; *). BodySym r =&gt; [MSStatement r] -&gt; MSBody r
</span><span class="hs-identifier hs-var">bodyStatements</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679328193"><span class="hs-identifier hs-var">stmt2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-576"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#FContinue"><span class="hs-identifier hs-type">FContinue</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">MSStatement r
forall (r :: * -&gt; *). ControlStatement r =&gt; MSStatement r
</span><span class="hs-identifier hs-var">continue</span></span><span>
</span><span id="line-577"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FDecDef"><span class="hs-identifier hs-type">FDecDef</span></a></span><span> </span><span id="local-6989586621679328188"><span class="annot"><span class="annottext">v :: Input
</span><a href="#local-6989586621679328188"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Matrix</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-578"></span><span>  </span><span id="local-6989586621679328187"><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679328187"><span class="hs-identifier hs-var">vari</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input -&gt; GenState (StateT ValueState Identity (r (Variable r)))
forall (r :: * -&gt; *). OOProg r =&gt; Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679328188"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-579"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679328186"><span class="annot"><span class="annottext">convDec :: CodeType -&gt; MSStatement r
</span><a href="#local-6989586621679328186"><span class="hs-identifier hs-var hs-var">convDec</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">C.List</span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
-&gt; StateT ValueState Identity (r (Variable r)) -&gt; MSStatement r
forall (r :: * -&gt; *).
DeclStatement r =&gt;
Integer -&gt; SVariable r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">listDec</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679328187"><span class="hs-identifier hs-var">vari</span></a></span><span>
</span><span id="line-580"></span><span>      </span><span class="annot"><a href="#local-6989586621679328186"><span class="hs-identifier hs-var">convDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">C.Array</span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
-&gt; StateT ValueState Identity (r (Variable r)) -&gt; MSStatement r
forall (r :: * -&gt; *).
DeclStatement r =&gt;
Integer -&gt; SVariable r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">arrayDec</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679328187"><span class="hs-identifier hs-var">vari</span></a></span><span>
</span><span id="line-581"></span><span>      </span><span class="annot"><a href="#local-6989586621679328186"><span class="hs-identifier hs-var">convDec</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r)) -&gt; MSStatement r
forall (r :: * -&gt; *).
DeclStatement r =&gt;
SVariable r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">varDec</span></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679328187"><span class="hs-identifier hs-var">vari</span></a></span><span>
</span><span id="line-582"></span><span>  </span><span class="annot"><span class="annottext">(CodeType -&gt; MSStatement r)
-&gt; GenState CodeType -&gt; GenState (MSStatement r)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">CodeType -&gt; MSStatement r
</span><a href="#local-6989586621679328186"><span class="hs-identifier hs-var">convDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input -&gt; GenState CodeType
forall c. HasSpace c =&gt; c -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#codeType"><span class="hs-identifier hs-var">codeType</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679328188"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-583"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FDecDef"><span class="hs-identifier hs-type">FDecDef</span></a></span><span> </span><span id="local-6989586621679328183"><span class="annot"><span class="annottext">v :: Input
</span><a href="#local-6989586621679328183"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679328182"><span class="annot"><span class="annottext">e :: CodeExpr
</span><a href="#local-6989586621679328182"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-584"></span><span>  </span><span id="local-6989586621679328181"><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679328181"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input -&gt; GenState (StateT ValueState Identity (r (Variable r)))
forall (r :: * -&gt; *). OOProg r =&gt; Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679328183"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-585"></span><span>  </span><span id="local-6989586621679328180"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679328180"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
-&gt; GenState [MSStatement r]
forall (r :: * -&gt; *).
OOProg r =&gt;
SVariable r -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Logging.html#maybeLog"><span class="hs-identifier hs-var">maybeLog</span></a></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679328181"><span class="hs-identifier hs-var">v'</span></a></span><span>
</span><span id="line-586"></span><span>  </span><span id="local-6989586621679328179"><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679328179"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input -&gt; GenState CodeType
forall c. HasSpace c =&gt; c -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#codeType"><span class="hs-identifier hs-var">codeType</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679328183"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-587"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679328178"><span class="annot"><span class="annottext">convDecDef :: CodeExpr -&gt; GenState (MSStatement r)
</span><a href="#local-6989586621679328178"><span class="hs-identifier hs-var hs-var">convDecDef</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Matrix</span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679328177"><span class="annot"><span class="annottext">lst :: [CodeExpr]
</span><a href="#local-6989586621679328177"><span class="hs-identifier hs-var">lst</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-588"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679328176"><span class="annot"><span class="annottext">contDecDef :: CodeType
-&gt; VS (r (Variable r))
-&gt; [VS (r (Value r))]
-&gt; MS (r (Statement r))
</span><a href="#local-6989586621679328176"><span class="hs-identifier hs-var hs-var">contDecDef</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">C.List</span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r)) -&gt; [VS (r (Value r))] -&gt; MS (r (Statement r))
forall (r :: * -&gt; *).
DeclStatement r =&gt;
SVariable r -&gt; [SValue r] -&gt; MSStatement r
</span><span class="hs-identifier hs-var">listDecDef</span></span><span>
</span><span id="line-589"></span><span>            </span><span class="annot"><a href="#local-6989586621679328176"><span class="hs-identifier hs-var">contDecDef</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">C.Array</span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r)) -&gt; [VS (r (Value r))] -&gt; MS (r (Statement r))
forall (r :: * -&gt; *).
DeclStatement r =&gt;
SVariable r -&gt; [SValue r] -&gt; MSStatement r
</span><span class="hs-identifier hs-var">arrayDecDef</span></span><span>
</span><span id="line-590"></span><span>            </span><span class="annot"><a href="#local-6989586621679328176"><span class="hs-identifier hs-var">contDecDef</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UID
-&gt; VS (r (Variable r))
-&gt; [VS (r (Value r))]
-&gt; MS (r (Statement r))
forall a. HasCallStack =&gt; UID -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Type mismatch between variable and value in declare-define FuncStmt&quot;</span></span><span>
</span><span id="line-591"></span><span>        </span><span id="local-6989586621679328173"><span class="annot"><span class="annottext">[VS (r (Value r))]
</span><a href="#local-6989586621679328173"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r))))
-&gt; [CodeExpr] -&gt; StateT DrasilState Identity [VS (r (Value r))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679328177"><span class="hs-identifier hs-var">lst</span></a></span><span>
</span><span id="line-592"></span><span>        </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; GenState (MSStatement r))
-&gt; MSStatement r -&gt; GenState (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CodeType
-&gt; StateT ValueState Identity (r (Variable r))
-&gt; [VS (r (Value r))]
-&gt; MSStatement r
forall (r :: * -&gt; *).
DeclStatement r =&gt;
CodeType
-&gt; VS (r (Variable r))
-&gt; [VS (r (Value r))]
-&gt; MS (r (Statement r))
</span><a href="#local-6989586621679328176"><span class="hs-identifier hs-var">contDecDef</span></a></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679328179"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679328181"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">[VS (r (Value r))]
</span><a href="#local-6989586621679328173"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-593"></span><span>      </span><span class="annot"><a href="#local-6989586621679328178"><span class="hs-identifier hs-var">convDecDef</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-594"></span><span>        </span><span id="local-6989586621679328172"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679328172"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679328182"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-595"></span><span>        </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; GenState (MSStatement r))
-&gt; MSStatement r -&gt; GenState (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
-&gt; VS (r (Value r)) -&gt; MSStatement r
forall (r :: * -&gt; *).
DeclStatement r =&gt;
SVariable r -&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">varDecDef</span></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679328181"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679328172"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-596"></span><span>  </span><span id="local-6989586621679328170"><span class="annot"><span class="annottext">MSStatement r
</span><a href="#local-6989586621679328170"><span class="hs-identifier hs-var">dd</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (MSStatement r)
</span><a href="#local-6989586621679328178"><span class="hs-identifier hs-var">convDecDef</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679328182"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-597"></span><span>  </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; GenState (MSStatement r))
-&gt; MSStatement r -&gt; GenState (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSStatement r
forall (r :: * -&gt; *).
StatementSym r =&gt;
[MSStatement r] -&gt; MSStatement r
</span><span class="hs-identifier hs-var">multi</span></span><span> </span><span class="annot"><span class="annottext">([MSStatement r] -&gt; MSStatement r)
-&gt; [MSStatement r] -&gt; MSStatement r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MSStatement r
</span><a href="#local-6989586621679328170"><span class="hs-identifier hs-var">dd</span></a></span><span> </span><span class="annot"><span class="annottext">MSStatement r -&gt; [MSStatement r] -&gt; [MSStatement r]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679328180"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-598"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FFuncDef"><span class="hs-identifier hs-type">FFuncDef</span></a></span><span> </span><span id="local-6989586621679328168"><span class="annot"><span class="annottext">f :: CodeFuncChunk
</span><a href="#local-6989586621679328168"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679328167"><span class="annot"><span class="annottext">ps :: [ParameterChunk]
</span><a href="#local-6989586621679328167"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621679328166"><span class="annot"><span class="annottext">sts :: [FuncStmt]
</span><a href="#local-6989586621679328166"><span class="hs-identifier hs-var">sts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-599"></span><span>  </span><span id="local-6989586621679328165"><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679328165"><span class="hs-identifier hs-var">f'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input -&gt; GenState (StateT ValueState Identity (r (Variable r)))
forall (r :: * -&gt; *). OOProg r =&gt; Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="annot"><span class="annottext">(Input -&gt; GenState (StateT ValueState Identity (r (Variable r))))
-&gt; Input -&gt; GenState (StateT ValueState Identity (r (Variable r)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CodeFuncChunk -&gt; Input
forall c. (Quantity c, MayHaveUnit c) =&gt; c -&gt; Input
</span><span class="hs-identifier hs-var">quantvar</span></span><span> </span><span class="annot"><span class="annottext">CodeFuncChunk
</span><a href="#local-6989586621679328168"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-600"></span><span>  </span><span id="local-6989586621679328164"><span class="annot"><span class="annottext">[StateT ValueState Identity (r (Variable r))]
</span><a href="#local-6989586621679328164"><span class="hs-identifier hs-var">pms</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ParameterChunk
 -&gt; GenState (StateT ValueState Identity (r (Variable r))))
-&gt; [ParameterChunk]
-&gt; StateT
     DrasilState Identity [StateT ValueState Identity (r (Variable r))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input -&gt; GenState (StateT ValueState Identity (r (Variable r)))
forall (r :: * -&gt; *). OOProg r =&gt; Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="annot"><span class="annottext">(Input -&gt; GenState (StateT ValueState Identity (r (Variable r))))
-&gt; (ParameterChunk -&gt; Input)
-&gt; ParameterChunk
-&gt; GenState (StateT ValueState Identity (r (Variable r)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ParameterChunk -&gt; Input
forall c. (Quantity c, MayHaveUnit c) =&gt; c -&gt; Input
</span><span class="hs-identifier hs-var">quantvar</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ParameterChunk]
</span><a href="#local-6989586621679328167"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-601"></span><span>  </span><span id="local-6989586621679328163"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679328163"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FuncStmt -&gt; GenState (MSStatement r))
-&gt; [FuncStmt] -&gt; GenState [MSStatement r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">FuncStmt -&gt; GenState (MSStatement r)
forall (r :: * -&gt; *).
OOProg r =&gt;
FuncStmt -&gt; GenState (MSStatement r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679328166"><span class="hs-identifier hs-var">sts</span></a></span><span>
</span><span id="line-602"></span><span>  </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; GenState (MSStatement r))
-&gt; MSStatement r -&gt; GenState (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
-&gt; [StateT ValueState Identity (r (Variable r))]
-&gt; MSBody r
-&gt; MSStatement r
forall (r :: * -&gt; *).
DeclStatement r =&gt;
SVariable r -&gt; [SVariable r] -&gt; MSBody r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">funcDecDef</span></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679328165"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="annot"><span class="annottext">[StateT ValueState Identity (r (Variable r))]
</span><a href="#local-6989586621679328164"><span class="hs-identifier hs-var">pms</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSBody r
forall (r :: * -&gt; *). BodySym r =&gt; [MSStatement r] -&gt; MSBody r
</span><span class="hs-identifier hs-var">bodyStatements</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679328163"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-603"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FVal"><span class="hs-identifier hs-type">FVal</span></a></span><span> </span><span id="local-6989586621679328160"><span class="annot"><span class="annottext">e :: CodeExpr
</span><a href="#local-6989586621679328160"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-604"></span><span>  </span><span id="local-6989586621679328159"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679328159"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679328160"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-605"></span><span>  </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; GenState (MSStatement r))
-&gt; MSStatement r -&gt; GenState (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r)) -&gt; MSStatement r
forall (r :: * -&gt; *). StatementSym r =&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">valStmt</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679328159"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-606"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FMulti"><span class="hs-identifier hs-type">FMulti</span></a></span><span> </span><span id="local-6989586621679328157"><span class="annot"><span class="annottext">ss :: [FuncStmt]
</span><a href="#local-6989586621679328157"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-607"></span><span>  </span><span id="local-6989586621679328156"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679328156"><span class="hs-identifier hs-var">stmts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FuncStmt -&gt; GenState (MSStatement r))
-&gt; [FuncStmt] -&gt; GenState [MSStatement r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">FuncStmt -&gt; GenState (MSStatement r)
forall (r :: * -&gt; *).
OOProg r =&gt;
FuncStmt -&gt; GenState (MSStatement r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679328157"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-608"></span><span>  </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; GenState (MSStatement r))
-&gt; MSStatement r -&gt; GenState (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSStatement r
forall (r :: * -&gt; *).
StatementSym r =&gt;
[MSStatement r] -&gt; MSStatement r
</span><span class="hs-identifier hs-var">multi</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679328156"><span class="hs-identifier hs-var">stmts</span></a></span><span>
</span><span id="line-609"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FAppend"><span class="hs-identifier hs-type">FAppend</span></a></span><span> </span><span id="local-6989586621679328154"><span class="annot"><span class="annottext">a :: CodeExpr
</span><a href="#local-6989586621679328154"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679328153"><span class="annot"><span class="annottext">b :: CodeExpr
</span><a href="#local-6989586621679328153"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-610"></span><span>  </span><span id="local-6989586621679328152"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679328152"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679328154"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-611"></span><span>  </span><span id="local-6989586621679328151"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679328151"><span class="hs-identifier hs-var">b'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679328153"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-612"></span><span>  </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; GenState (MSStatement r))
-&gt; MSStatement r -&gt; GenState (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r)) -&gt; MSStatement r
forall (r :: * -&gt; *). StatementSym r =&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">valStmt</span></span><span> </span><span class="annot"><span class="annottext">(VS (r (Value r)) -&gt; MSStatement r)
-&gt; VS (r (Value r)) -&gt; MSStatement r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r)) -&gt; VS (r (Value r)) -&gt; VS (r (Value r))
forall (r :: * -&gt; *). List r =&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-identifier hs-var">listAppend</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679328152"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679328151"><span class="hs-identifier hs-var">b'</span></a></span><span>
</span><span id="line-613"></span><span>
</span><span id="line-614"></span><span class="hs-comment">-- | Generates a function that reads a file whose format is based on the passed </span><span>
</span><span id="line-615"></span><span class="hs-comment">-- 'DataDesc'.</span><span>
</span><span id="line-616"></span><span id="local-6989586621679328921"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#genDataFunc"><span class="hs-identifier hs-type">genDataFunc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679328921"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Description"><span class="hs-identifier hs-type">Description</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#DataDesc"><span class="hs-identifier hs-type">DataDesc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span>
</span><span id="line-617"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679328921"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-618"></span><span id="genDataFunc"><span class="annot"><span class="annottext">genDataFunc :: UID -&gt; UID -&gt; DataDesc -&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genDataFunc"><span class="hs-identifier hs-var hs-var">genDataFunc</span></a></span></span><span> </span><span id="local-6989586621679328149"><span class="annot"><span class="annottext">nameTitle :: UID
</span><a href="#local-6989586621679328149"><span class="hs-identifier hs-var">nameTitle</span></a></span></span><span> </span><span id="local-6989586621679328148"><span class="annot"><span class="annottext">desc :: UID
</span><a href="#local-6989586621679328148"><span class="hs-identifier hs-var">desc</span></a></span></span><span> </span><span id="local-6989586621679328147"><span class="annot"><span class="annottext">ddef :: DataDesc
</span><a href="#local-6989586621679328147"><span class="hs-identifier hs-var">ddef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-619"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679328146"><span class="annot"><span class="annottext">parms :: [Input]
</span><a href="#local-6989586621679328146"><span class="hs-identifier hs-var hs-var">parms</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataDesc -&gt; [Input]
</span><a href="Language.Drasil.Code.DataDesc.html#getInputs"><span class="hs-identifier hs-var">getInputs</span></a></span><span> </span><span class="annot"><span class="annottext">DataDesc
</span><a href="#local-6989586621679328147"><span class="hs-identifier hs-var">ddef</span></a></span><span>
</span><span id="line-620"></span><span>  </span><span id="local-6989586621679328145"><span class="annot"><span class="annottext">[MS (r (Block r))]
</span><a href="#local-6989586621679328145"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DataDesc -&gt; GenState [MS (r (Block r))]
forall (r :: * -&gt; *). OOProg r =&gt; DataDesc -&gt; GenState [MSBlock r]
</span><a href="Language.Drasil.Code.Imperative.Import.html#readData"><span class="hs-identifier hs-var">readData</span></a></span><span> </span><span class="annot"><span class="annottext">DataDesc
</span><a href="#local-6989586621679328147"><span class="hs-identifier hs-var">ddef</span></a></span><span>
</span><span id="line-621"></span><span>  </span><span class="annot"><span class="annottext">UID
-&gt; VSType r
-&gt; UID
-&gt; [ParameterChunk]
-&gt; Maybe UID
-&gt; [MS (r (Block r))]
-&gt; GenState (SMethod r)
forall (r :: * -&gt; *).
OOProg r =&gt;
UID
-&gt; VSType r
-&gt; UID
-&gt; [ParameterChunk]
-&gt; Maybe UID
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#publicFunc"><span class="hs-identifier hs-var">publicFunc</span></a></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328149"><span class="hs-identifier hs-var">nameTitle</span></a></span><span> </span><span class="annot"><span class="annottext">VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; VSType r
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328148"><span class="hs-identifier hs-var">desc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Input -&gt; ParameterChunk) -&gt; [Input] -&gt; [ParameterChunk]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Input -&gt; ParameterChunk
forall c. CodeIdea c =&gt; c -&gt; ParameterChunk
</span><a href="Language.Drasil.Chunk.Parameter.html#pcAuto"><span class="hs-identifier hs-var">pcAuto</span></a></span><span> </span><span class="annot"><span class="annottext">([Input] -&gt; [ParameterChunk]) -&gt; [Input] -&gt; [ParameterChunk]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QuantityDict -&gt; Input
forall c. (Quantity c, MayHaveUnit c) =&gt; c -&gt; Input
</span><span class="hs-identifier hs-var">quantvar</span></span><span> </span><span class="annot"><span class="annottext">QuantityDict
</span><a href="Language.Drasil.Code.CodeQuantityDicts.html#inFileName"><span class="hs-identifier hs-var">inFileName</span></a></span><span> </span><span class="annot"><span class="annottext">Input -&gt; [Input] -&gt; [Input]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679328146"><span class="hs-identifier hs-var">parms</span></a></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-622"></span><span>    </span><span class="annot"><span class="annottext">Maybe UID
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">[MS (r (Block r))]
</span><a href="#local-6989586621679328145"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-623"></span><span>
</span><span id="line-624"></span><span class="hs-comment">-- this is really ugly!!</span><span>
</span><span id="line-625"></span><span class="hs-comment">-- | Read from a data description into a 'MSBlock' of 'MSStatement's.</span><span>
</span><span id="line-626"></span><span id="local-6989586621679328904"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#readData"><span class="hs-identifier hs-type">readData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679328904"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#DataDesc"><span class="hs-identifier hs-type">DataDesc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSBlock</span></span><span> </span><span class="annot"><a href="#local-6989586621679328904"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-627"></span><span id="readData"><span class="annot"><span class="annottext">readData :: DataDesc -&gt; GenState [MSBlock r]
</span><a href="Language.Drasil.Code.Imperative.Import.html#readData"><span class="hs-identifier hs-var hs-var">readData</span></a></span></span><span> </span><span id="local-6989586621679328143"><span class="annot"><span class="annottext">ddef :: DataDesc
</span><a href="#local-6989586621679328143"><span class="hs-identifier hs-var">ddef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-628"></span><span>  </span><span id="local-6989586621679328142"><span class="annot"><span class="annottext">[[MS (r (Statement r))]]
</span><a href="#local-6989586621679328142"><span class="hs-identifier hs-var">inD</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Data -&gt; StateT DrasilState Identity [MS (r (Statement r))])
-&gt; DataDesc -&gt; StateT DrasilState Identity [[MS (r (Statement r))]]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Data -&gt; StateT DrasilState Identity [MS (r (Statement r))]
forall (r :: * -&gt; *). OOProg r =&gt; Data -&gt; GenState [MSStatement r]
</span><a href="#local-6989586621679328141"><span class="hs-identifier hs-var">inData</span></a></span><span> </span><span class="annot"><span class="annottext">DataDesc
</span><a href="#local-6989586621679328143"><span class="hs-identifier hs-var">ddef</span></a></span><span>
</span><span id="line-629"></span><span>  </span><span id="local-6989586621679328140"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679328140"><span class="hs-identifier hs-var">v_filename</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input -&gt; GenState (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; Input -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVal"><span class="hs-identifier hs-var">mkVal</span></a></span><span> </span><span class="annot"><span class="annottext">(Input -&gt; GenState (VS (r (Value r))))
-&gt; Input -&gt; GenState (VS (r (Value r)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QuantityDict -&gt; Input
forall c. (Quantity c, MayHaveUnit c) =&gt; c -&gt; Input
</span><span class="hs-identifier hs-var">quantvar</span></span><span> </span><span class="annot"><span class="annottext">QuantityDict
</span><a href="Language.Drasil.Code.CodeQuantityDicts.html#inFileName"><span class="hs-identifier hs-var">inFileName</span></a></span><span>
</span><span id="line-630"></span><span>  </span><span class="annot"><span class="annottext">[MSBlock r] -&gt; GenState [MSBlock r]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[MS (r (Statement r))] -&gt; MSBlock r
forall (r :: * -&gt; *). BlockSym r =&gt; [MSStatement r] -&gt; MSBlock r
</span><span class="hs-identifier hs-var">block</span></span><span> </span><span class="annot"><span class="annottext">([MS (r (Statement r))] -&gt; MSBlock r)
-&gt; [MS (r (Statement r))] -&gt; MSBlock r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span>
</span><span id="line-631"></span><span>    </span><span class="annot"><span class="annottext">SVariable r -&gt; MS (r (Statement r))
forall (r :: * -&gt; *).
DeclStatement r =&gt;
SVariable r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">varDec</span></span><span> </span><span class="annot"><span class="annottext">SVariable r
forall (r :: * -&gt; *). OOProg r =&gt; SVariable r
</span><a href="#local-6989586621679328139"><span class="hs-identifier hs-var">var_infile</span></a></span><span> </span><span class="annot"><span class="annottext">MS (r (Statement r))
-&gt; [MS (r (Statement r))] -&gt; [MS (r (Statement r))]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span>
</span><span id="line-632"></span><span>    </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">(Data -&gt; Bool) -&gt; DataDesc -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679328137"><span class="annot"><span class="annottext">d :: Data
</span><a href="#local-6989586621679328137"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Data -&gt; Bool
</span><a href="Language.Drasil.Code.DataDesc.html#isLine"><span class="hs-identifier hs-var">isLine</span></a></span><span> </span><span class="annot"><span class="annottext">Data
</span><a href="#local-6989586621679328137"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Data -&gt; Bool
</span><a href="Language.Drasil.Code.DataDesc.html#isLines"><span class="hs-identifier hs-var">isLines</span></a></span><span> </span><span class="annot"><span class="annottext">Data
</span><a href="#local-6989586621679328137"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DataDesc
</span><a href="#local-6989586621679328143"><span class="hs-identifier hs-var">ddef</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SVariable r -&gt; MS (r (Statement r))
forall (r :: * -&gt; *).
DeclStatement r =&gt;
SVariable r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">varDec</span></span><span> </span><span class="annot"><span class="annottext">SVariable r
forall (r :: * -&gt; *). OOProg r =&gt; SVariable r
</span><a href="#local-6989586621679328135"><span class="hs-identifier hs-var">var_line</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; SVariable r -&gt; MS (r (Statement r))
forall (r :: * -&gt; *).
DeclStatement r =&gt;
Integer -&gt; SVariable r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">listDec</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">SVariable r
forall (r :: * -&gt; *). OOProg r =&gt; SVariable r
</span><a href="#local-6989586621679328134"><span class="hs-identifier hs-var">var_linetokens</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[MS (r (Statement r))]
-&gt; [MS (r (Statement r))] -&gt; [MS (r (Statement r))]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-633"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer -&gt; SVariable r -&gt; MS (r (Statement r))
forall (r :: * -&gt; *).
DeclStatement r =&gt;
Integer -&gt; SVariable r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">listDec</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">SVariable r
forall (r :: * -&gt; *). OOProg r =&gt; SVariable r
</span><a href="#local-6989586621679328133"><span class="hs-identifier hs-var">var_lines</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(Data -&gt; Bool) -&gt; DataDesc -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="annot"><span class="annottext">Data -&gt; Bool
</span><a href="Language.Drasil.Code.DataDesc.html#isLines"><span class="hs-identifier hs-var">isLines</span></a></span><span> </span><span class="annot"><span class="annottext">DataDesc
</span><a href="#local-6989586621679328143"><span class="hs-identifier hs-var">ddef</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[MS (r (Statement r))]
-&gt; [MS (r (Statement r))] -&gt; [MS (r (Statement r))]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-634"></span><span>    </span><span class="annot"><span class="annottext">SVariable r -&gt; VS (r (Value r)) -&gt; MS (r (Statement r))
forall (r :: * -&gt; *).
IOStatement r =&gt;
SVariable r -&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">openFileR</span></span><span> </span><span class="annot"><span class="annottext">SVariable r
forall (r :: * -&gt; *). OOProg r =&gt; SVariable r
</span><a href="#local-6989586621679328139"><span class="hs-identifier hs-var">var_infile</span></a></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679328140"><span class="hs-identifier hs-var">v_filename</span></a></span><span> </span><span class="annot"><span class="annottext">MS (r (Statement r))
-&gt; [MS (r (Statement r))] -&gt; [MS (r (Statement r))]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span>
</span><span id="line-635"></span><span>    </span><span class="annot"><span class="annottext">[[MS (r (Statement r))]] -&gt; [MS (r (Statement r))]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">[[MS (r (Statement r))]]
</span><a href="#local-6989586621679328142"><span class="hs-identifier hs-var">inD</span></a></span><span> </span><span class="annot"><span class="annottext">[MS (r (Statement r))]
-&gt; [MS (r (Statement r))] -&gt; [MS (r (Statement r))]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-636"></span><span>    </span><span class="annot"><span class="annottext">VS (r (Value r)) -&gt; MS (r (Statement r))
forall (r :: * -&gt; *). IOStatement r =&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">closeFile</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
forall (r :: * -&gt; *). OOProg r =&gt; SValue r
</span><a href="#local-6989586621679328129"><span class="hs-identifier hs-var">v_infile</span></a></span><span> </span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-637"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679328900"><span class="annot"><a href="#local-6989586621679328141"><span class="hs-identifier hs-type">inData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679328900"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#Data"><span class="hs-identifier hs-type">Data</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSStatement</span></span><span> </span><span class="annot"><a href="#local-6989586621679328900"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-638"></span><span>        </span><span id="local-6989586621679328141"><span class="annot"><span class="annottext">inData :: Data -&gt; GenState [MSStatement r]
</span><a href="#local-6989586621679328141"><span class="hs-identifier hs-var hs-var">inData</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span id="local-6989586621679328128"><span class="annot"><span class="annottext">v :: Input
</span><a href="#local-6989586621679328128"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-639"></span><span>            </span><span id="local-6989586621679328127"><span class="annot"><span class="annottext">VS (r (Variable r))
</span><a href="#local-6989586621679328127"><span class="hs-identifier hs-var">vv</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input -&gt; GenState (VS (r (Variable r)))
forall (r :: * -&gt; *). OOProg r =&gt; Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679328128"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-640"></span><span>            </span><span id="local-6989586621679328126"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679328126"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r)) -&gt; GenState [MSStatement r]
forall (r :: * -&gt; *).
OOProg r =&gt;
SVariable r -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Logging.html#maybeLog"><span class="hs-identifier hs-var">maybeLog</span></a></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
</span><a href="#local-6989586621679328127"><span class="hs-identifier hs-var">vv</span></a></span><span>
</span><span id="line-641"></span><span>            </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; GenState [MSStatement r]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSStatement r
forall (r :: * -&gt; *).
StatementSym r =&gt;
[MSStatement r] -&gt; MSStatement r
</span><span class="hs-identifier hs-var">multi</span></span><span> </span><span class="annot"><span class="annottext">([MSStatement r] -&gt; MSStatement r)
-&gt; [MSStatement r] -&gt; MSStatement r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; VS (r (Variable r)) -&gt; MSStatement r
forall (r :: * -&gt; *).
IOStatement r =&gt;
SValue r -&gt; SVariable r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">getFileInput</span></span><span> </span><span class="annot"><span class="annottext">SValue r
forall (r :: * -&gt; *). OOProg r =&gt; SValue r
</span><a href="#local-6989586621679328129"><span class="hs-identifier hs-var">v_infile</span></a></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
</span><a href="#local-6989586621679328127"><span class="hs-identifier hs-var">vv</span></a></span><span> </span><span class="annot"><span class="annottext">MSStatement r -&gt; [MSStatement r] -&gt; [MSStatement r]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679328126"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-642"></span><span>        </span><span class="annot"><a href="#local-6989586621679328141"><span class="hs-identifier hs-var">inData</span></a></span><span> </span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#JunkData"><span class="hs-identifier hs-type">JunkData</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; GenState [MSStatement r]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SValue r -&gt; MSStatement r
forall (r :: * -&gt; *). IOStatement r =&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">discardFileLine</span></span><span> </span><span class="annot"><span class="annottext">SValue r
forall (r :: * -&gt; *). OOProg r =&gt; SValue r
</span><a href="#local-6989586621679328129"><span class="hs-identifier hs-var">v_infile</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-643"></span><span>        </span><span class="annot"><a href="#local-6989586621679328141"><span class="hs-identifier hs-var">inData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#Line"><span class="hs-identifier hs-type">Line</span></a></span><span> </span><span id="local-6989586621679328123"><span class="annot"><span class="annottext">lp :: LinePattern
</span><a href="#local-6989586621679328123"><span class="hs-identifier hs-var">lp</span></a></span></span><span> </span><span id="local-6989586621679328122"><span class="annot"><span class="annottext">d :: Delim
</span><a href="#local-6989586621679328122"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-644"></span><span>          </span><span id="local-6989586621679328121"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679328121"><span class="hs-identifier hs-var">lnI</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe UID -&gt; LinePattern -&gt; GenState [MSStatement r]
forall (r :: * -&gt; *).
OOProg r =&gt;
Maybe UID -&gt; LinePattern -&gt; GenState [MSStatement r]
</span><a href="#local-6989586621679328120"><span class="hs-identifier hs-var">lineData</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe UID
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">LinePattern
</span><a href="#local-6989586621679328123"><span class="hs-identifier hs-var">lp</span></a></span><span>
</span><span id="line-645"></span><span>          </span><span id="local-6989586621679328119"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679328119"><span class="hs-identifier hs-var">logs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LinePattern -&gt; GenState [MSStatement r]
forall (r :: * -&gt; *).
OOProg r =&gt;
LinePattern -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Import.html#getEntryVarLogs"><span class="hs-identifier hs-var">getEntryVarLogs</span></a></span><span> </span><span class="annot"><span class="annottext">LinePattern
</span><a href="#local-6989586621679328123"><span class="hs-identifier hs-var">lp</span></a></span><span>
</span><span id="line-646"></span><span>          </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; GenState [MSStatement r]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([MSStatement r] -&gt; GenState [MSStatement r])
-&gt; [MSStatement r] -&gt; GenState [MSStatement r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SValue r -&gt; VS (r (Variable r)) -&gt; MSStatement r
forall (r :: * -&gt; *).
IOStatement r =&gt;
SValue r -&gt; SVariable r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">getFileInputLine</span></span><span> </span><span class="annot"><span class="annottext">SValue r
forall (r :: * -&gt; *). OOProg r =&gt; SValue r
</span><a href="#local-6989586621679328129"><span class="hs-identifier hs-var">v_infile</span></a></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
forall (r :: * -&gt; *). OOProg r =&gt; SVariable r
</span><a href="#local-6989586621679328135"><span class="hs-identifier hs-var">var_line</span></a></span><span class="hs-special">,</span><span> </span><span>
</span><span id="line-647"></span><span>            </span><span class="annot"><span class="annottext">Delim -&gt; VS (r (Variable r)) -&gt; SValue r -&gt; MSStatement r
forall (r :: * -&gt; *).
StringStatement r =&gt;
Delim -&gt; SVariable r -&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">stringSplit</span></span><span> </span><span class="annot"><span class="annottext">Delim
</span><a href="#local-6989586621679328122"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
forall (r :: * -&gt; *). OOProg r =&gt; SVariable r
</span><a href="#local-6989586621679328134"><span class="hs-identifier hs-var">var_linetokens</span></a></span><span> </span><span class="annot"><span class="annottext">SValue r
forall (r :: * -&gt; *). OOProg r =&gt; SValue r
</span><a href="#local-6989586621679328115"><span class="hs-identifier hs-var">v_line</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; [MSStatement r] -&gt; [MSStatement r]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679328121"><span class="hs-identifier hs-var">lnI</span></a></span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; [MSStatement r] -&gt; [MSStatement r]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679328119"><span class="hs-identifier hs-var">logs</span></a></span><span>
</span><span id="line-648"></span><span>        </span><span class="annot"><a href="#local-6989586621679328141"><span class="hs-identifier hs-var">inData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#Lines"><span class="hs-identifier hs-type">Lines</span></a></span><span> </span><span id="local-6989586621679328114"><span class="annot"><span class="annottext">lp :: LinePattern
</span><a href="#local-6989586621679328114"><span class="hs-identifier hs-var">lp</span></a></span></span><span> </span><span id="local-6989586621679328113"><span class="annot"><span class="annottext">ls :: Maybe Integer
</span><a href="#local-6989586621679328113"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span id="local-6989586621679328112"><span class="annot"><span class="annottext">d :: Delim
</span><a href="#local-6989586621679328112"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-649"></span><span>          </span><span id="local-6989586621679328111"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679328111"><span class="hs-identifier hs-var">lnV</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe UID -&gt; LinePattern -&gt; GenState [MSStatement r]
forall (r :: * -&gt; *).
OOProg r =&gt;
Maybe UID -&gt; LinePattern -&gt; GenState [MSStatement r]
</span><a href="#local-6989586621679328120"><span class="hs-identifier hs-var">lineData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UID -&gt; Maybe UID
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="hs-string">&quot;_temp&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LinePattern
</span><a href="#local-6989586621679328114"><span class="hs-identifier hs-var">lp</span></a></span><span>
</span><span id="line-650"></span><span>          </span><span id="local-6989586621679328110"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679328110"><span class="hs-identifier hs-var">logs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LinePattern -&gt; GenState [MSStatement r]
forall (r :: * -&gt; *).
OOProg r =&gt;
LinePattern -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Import.html#getEntryVarLogs"><span class="hs-identifier hs-var">getEntryVarLogs</span></a></span><span> </span><span class="annot"><span class="annottext">LinePattern
</span><a href="#local-6989586621679328114"><span class="hs-identifier hs-var">lp</span></a></span><span>
</span><span id="line-651"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679328109"><span class="annot"><span class="annottext">readLines :: Maybe Integer -&gt; [MSStatement r]
</span><a href="#local-6989586621679328109"><span class="hs-identifier hs-var hs-var">readLines</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SValue r -&gt; VS (r (Variable r)) -&gt; MSStatement r
forall (r :: * -&gt; *).
IOStatement r =&gt;
SValue r -&gt; SVariable r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">getFileInputAll</span></span><span> </span><span class="annot"><span class="annottext">SValue r
forall (r :: * -&gt; *). OOProg r =&gt; SValue r
</span><a href="#local-6989586621679328129"><span class="hs-identifier hs-var">v_infile</span></a></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
forall (r :: * -&gt; *). OOProg r =&gt; SVariable r
</span><a href="#local-6989586621679328133"><span class="hs-identifier hs-var">var_lines</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-652"></span><span>                </span><span class="annot"><span class="annottext">VS (r (Variable r))
-&gt; SValue r -&gt; SValue r -&gt; SValue r -&gt; MSBody r -&gt; MSStatement r
forall (r :: * -&gt; *).
ControlStatement r =&gt;
SVariable r
-&gt; SValue r -&gt; SValue r -&gt; SValue r -&gt; MSBody r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">forRange</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
forall (r :: * -&gt; *). OOProg r =&gt; SVariable r
</span><a href="#local-6989586621679328107"><span class="hs-identifier hs-var">var_i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; SValue r
forall (r :: * -&gt; *). Literal r =&gt; Integer -&gt; SValue r
</span><span class="hs-identifier hs-var">litInt</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SValue r -&gt; SValue r
forall (r :: * -&gt; *). List r =&gt; SValue r -&gt; SValue r
</span><span class="hs-identifier hs-var">listSize</span></span><span> </span><span class="annot"><span class="annottext">SValue r
forall (r :: * -&gt; *). OOProg r =&gt; SValue r
</span><a href="#local-6989586621679328106"><span class="hs-identifier hs-var">v_lines</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; SValue r
forall (r :: * -&gt; *). Literal r =&gt; Integer -&gt; SValue r
</span><span class="hs-identifier hs-var">litInt</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-653"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSBody r
forall (r :: * -&gt; *). BodySym r =&gt; [MSStatement r] -&gt; MSBody r
</span><span class="hs-identifier hs-var">bodyStatements</span></span><span> </span><span class="annot"><span class="annottext">([MSStatement r] -&gt; MSBody r) -&gt; [MSStatement r] -&gt; MSBody r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Delim -&gt; VS (r (Variable r)) -&gt; SValue r -&gt; MSStatement r
forall (r :: * -&gt; *).
StringStatement r =&gt;
Delim -&gt; SVariable r -&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">stringSplit</span></span><span> </span><span class="annot"><span class="annottext">Delim
</span><a href="#local-6989586621679328112"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
forall (r :: * -&gt; *). OOProg r =&gt; SVariable r
</span><a href="#local-6989586621679328134"><span class="hs-identifier hs-var">var_linetokens</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-654"></span><span>                  </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *). List r =&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-identifier hs-var">listAccess</span></span><span> </span><span class="annot"><span class="annottext">SValue r
forall (r :: * -&gt; *). OOProg r =&gt; SValue r
</span><a href="#local-6989586621679328106"><span class="hs-identifier hs-var">v_lines</span></a></span><span> </span><span class="annot"><span class="annottext">SValue r
forall (r :: * -&gt; *). OOProg r =&gt; SValue r
</span><a href="#local-6989586621679328105"><span class="hs-identifier hs-var">v_i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MSStatement r -&gt; [MSStatement r] -&gt; [MSStatement r]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679328111"><span class="hs-identifier hs-var">lnV</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-655"></span><span>              </span><span class="annot"><a href="#local-6989586621679328109"><span class="hs-identifier hs-var">readLines</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679328104"><span class="annot"><span class="annottext">numLines :: Integer
</span><a href="#local-6989586621679328104"><span class="hs-identifier hs-var">numLines</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">VS (r (Variable r))
-&gt; SValue r -&gt; SValue r -&gt; SValue r -&gt; MSBody r -&gt; MSStatement r
forall (r :: * -&gt; *).
ControlStatement r =&gt;
SVariable r
-&gt; SValue r -&gt; SValue r -&gt; SValue r -&gt; MSBody r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">forRange</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
forall (r :: * -&gt; *). OOProg r =&gt; SVariable r
</span><a href="#local-6989586621679328107"><span class="hs-identifier hs-var">var_i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; SValue r
forall (r :: * -&gt; *). Literal r =&gt; Integer -&gt; SValue r
</span><span class="hs-identifier hs-var">litInt</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-656"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; SValue r
forall (r :: * -&gt; *). Literal r =&gt; Integer -&gt; SValue r
</span><span class="hs-identifier hs-var">litInt</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679328104"><span class="hs-identifier hs-var">numLines</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; SValue r
forall (r :: * -&gt; *). Literal r =&gt; Integer -&gt; SValue r
</span><span class="hs-identifier hs-var">litInt</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-657"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSBody r
forall (r :: * -&gt; *). BodySym r =&gt; [MSStatement r] -&gt; MSBody r
</span><span class="hs-identifier hs-var">bodyStatements</span></span><span> </span><span class="annot"><span class="annottext">([MSStatement r] -&gt; MSBody r) -&gt; [MSStatement r] -&gt; MSBody r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-658"></span><span>                  </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SValue r -&gt; VS (r (Variable r)) -&gt; MSStatement r
forall (r :: * -&gt; *).
IOStatement r =&gt;
SValue r -&gt; SVariable r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">getFileInputLine</span></span><span> </span><span class="annot"><span class="annottext">SValue r
forall (r :: * -&gt; *). OOProg r =&gt; SValue r
</span><a href="#local-6989586621679328129"><span class="hs-identifier hs-var">v_infile</span></a></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
forall (r :: * -&gt; *). OOProg r =&gt; SVariable r
</span><a href="#local-6989586621679328135"><span class="hs-identifier hs-var">var_line</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-659"></span><span>                   </span><span class="annot"><span class="annottext">Delim -&gt; VS (r (Variable r)) -&gt; SValue r -&gt; MSStatement r
forall (r :: * -&gt; *).
StringStatement r =&gt;
Delim -&gt; SVariable r -&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">stringSplit</span></span><span> </span><span class="annot"><span class="annottext">Delim
</span><a href="#local-6989586621679328112"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
forall (r :: * -&gt; *). OOProg r =&gt; SVariable r
</span><a href="#local-6989586621679328134"><span class="hs-identifier hs-var">var_linetokens</span></a></span><span> </span><span class="annot"><span class="annottext">SValue r
forall (r :: * -&gt; *). OOProg r =&gt; SValue r
</span><a href="#local-6989586621679328115"><span class="hs-identifier hs-var">v_line</span></a></span><span>
</span><span id="line-660"></span><span>                  </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; [MSStatement r] -&gt; [MSStatement r]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679328111"><span class="hs-identifier hs-var">lnV</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-661"></span><span>          </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; GenState [MSStatement r]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([MSStatement r] -&gt; GenState [MSStatement r])
-&gt; [MSStatement r] -&gt; GenState [MSStatement r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe Integer -&gt; [MSStatement r]
</span><a href="#local-6989586621679328109"><span class="hs-identifier hs-var">readLines</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Integer
</span><a href="#local-6989586621679328113"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; [MSStatement r] -&gt; [MSStatement r]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679328110"><span class="hs-identifier hs-var">logs</span></a></span><span>
</span><span id="line-662"></span><span>        </span><span class="hs-comment">---------------</span><span>
</span><span id="line-663"></span><span>        </span><span id="local-6989586621679328888"><span class="annot"><a href="#local-6989586621679328120"><span class="hs-identifier hs-type">lineData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679328888"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#LinePattern"><span class="hs-identifier hs-type">LinePattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span>
</span><span id="line-664"></span><span>          </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSStatement</span></span><span> </span><span class="annot"><a href="#local-6989586621679328888"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-665"></span><span>        </span><span id="local-6989586621679328120"><span class="annot"><span class="annottext">lineData :: Maybe UID -&gt; LinePattern -&gt; GenState [MSStatement r]
</span><a href="#local-6989586621679328120"><span class="hs-identifier hs-var hs-var">lineData</span></a></span></span><span> </span><span id="local-6989586621679328103"><span class="annot"><span class="annottext">s :: Maybe UID
</span><a href="#local-6989586621679328103"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679328102"><span class="annot"><span class="annottext">p :: LinePattern
</span><a href="#local-6989586621679328102"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#Straight"><span class="hs-identifier hs-type">Straight</span></a></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-666"></span><span>          </span><span id="local-6989586621679328101"><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679328101"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe UID -&gt; LinePattern -&gt; GenState [VS (r (Variable r))]
forall (r :: * -&gt; *).
OOProg r =&gt;
Maybe UID -&gt; LinePattern -&gt; GenState [SVariable r]
</span><a href="Language.Drasil.Code.Imperative.Import.html#getEntryVars"><span class="hs-identifier hs-var">getEntryVars</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe UID
</span><a href="#local-6989586621679328103"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">LinePattern
</span><a href="#local-6989586621679328102"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-667"></span><span>          </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; GenState [MSStatement r]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[VS (r (Variable r))] -&gt; SValue r -&gt; MSStatement r
forall (r :: * -&gt; *).
StringStatement r =&gt;
[SVariable r] -&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">stringListVals</span></span><span> </span><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679328101"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">SValue r
forall (r :: * -&gt; *). OOProg r =&gt; SValue r
</span><a href="#local-6989586621679328098"><span class="hs-identifier hs-var">v_linetokens</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-668"></span><span>        </span><span class="annot"><a href="#local-6989586621679328120"><span class="hs-identifier hs-var">lineData</span></a></span><span> </span><span id="local-6989586621679328097"><span class="annot"><span class="annottext">s :: Maybe UID
</span><a href="#local-6989586621679328097"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679328096"><span class="annot"><span class="annottext">p :: LinePattern
</span><a href="#local-6989586621679328096"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#Repeat"><span class="hs-identifier hs-type">Repeat</span></a></span><span> </span><span id="local-6989586621679328095"><span class="annot"><span class="annottext">ds :: [Input]
</span><a href="#local-6989586621679328095"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-669"></span><span>          </span><span id="local-6989586621679328094"><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679328094"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe UID -&gt; LinePattern -&gt; GenState [VS (r (Variable r))]
forall (r :: * -&gt; *).
OOProg r =&gt;
Maybe UID -&gt; LinePattern -&gt; GenState [SVariable r]
</span><a href="Language.Drasil.Code.Imperative.Import.html#getEntryVars"><span class="hs-identifier hs-var">getEntryVars</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe UID
</span><a href="#local-6989586621679328097"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">LinePattern
</span><a href="#local-6989586621679328096"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-670"></span><span>          </span><span class="annot"><span class="annottext">[StateT DrasilState Identity (MSStatement r)]
-&gt; GenState [MSStatement r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
</span><span class="hs-identifier hs-var">sequence</span></span><span> </span><span class="annot"><span class="annottext">([StateT DrasilState Identity (MSStatement r)]
 -&gt; GenState [MSStatement r])
-&gt; [StateT DrasilState Identity (MSStatement r)]
-&gt; GenState [MSStatement r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe UID
-&gt; [Input] -&gt; [StateT DrasilState Identity (MSStatement r)]
forall (r :: * -&gt; *).
OOProg r =&gt;
Maybe UID -&gt; [Input] -&gt; [GenState (MSStatement r)]
</span><a href="#local-6989586621679328092"><span class="hs-identifier hs-var">clearTemps</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe UID
</span><a href="#local-6989586621679328097"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679328095"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="annot"><span class="annottext">[StateT DrasilState Identity (MSStatement r)]
-&gt; [StateT DrasilState Identity (MSStatement r)]
-&gt; [StateT DrasilState Identity (MSStatement r)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">MSStatement r -&gt; StateT DrasilState Identity (MSStatement r)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[VS (r (Variable r))] -&gt; SValue r -&gt; MSStatement r
forall (r :: * -&gt; *).
StringStatement r =&gt;
[SVariable r] -&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">stringListLists</span></span><span> </span><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679328094"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">SValue r
forall (r :: * -&gt; *). OOProg r =&gt; SValue r
</span><a href="#local-6989586621679328098"><span class="hs-identifier hs-var">v_linetokens</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-671"></span><span>            </span><span class="annot"><span class="annottext">StateT DrasilState Identity (MSStatement r)
-&gt; [StateT DrasilState Identity (MSStatement r)]
-&gt; [StateT DrasilState Identity (MSStatement r)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Maybe UID
-&gt; [Input] -&gt; [StateT DrasilState Identity (MSStatement r)]
forall (r :: * -&gt; *).
OOProg r =&gt;
Maybe UID -&gt; [Input] -&gt; [GenState (MSStatement r)]
</span><a href="#local-6989586621679328090"><span class="hs-identifier hs-var">appendTemps</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe UID
</span><a href="#local-6989586621679328097"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679328095"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-672"></span><span>        </span><span class="hs-comment">---------------</span><span>
</span><span id="line-673"></span><span>        </span><span id="local-6989586621679328880"><span class="annot"><a href="#local-6989586621679328092"><span class="hs-identifier hs-type">clearTemps</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679328880"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#DataItem"><span class="hs-identifier hs-type">DataItem</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span>
</span><span id="line-674"></span><span>          </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MSStatement</span></span><span> </span><span class="annot"><a href="#local-6989586621679328880"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-675"></span><span>        </span><span id="local-6989586621679328092"><span class="annot"><span class="annottext">clearTemps :: Maybe UID -&gt; [Input] -&gt; [GenState (MSStatement r)]
</span><a href="#local-6989586621679328092"><span class="hs-identifier hs-var hs-var">clearTemps</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-676"></span><span>        </span><span class="annot"><a href="#local-6989586621679328092"><span class="hs-identifier hs-var">clearTemps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679328089"><span class="annot"><span class="annottext">sfx :: UID
</span><a href="#local-6989586621679328089"><span class="hs-identifier hs-var">sfx</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679328088"><span class="annot"><span class="annottext">es :: [Input]
</span><a href="#local-6989586621679328088"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Input -&gt; GenState (MSStatement r))
-&gt; [Input] -&gt; [GenState (MSStatement r)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UID -&gt; Input -&gt; GenState (MSStatement r)
forall (r :: * -&gt; *).
OOProg r =&gt;
UID -&gt; Input -&gt; GenState (MSStatement r)
</span><a href="#local-6989586621679328087"><span class="hs-identifier hs-var">clearTemp</span></a></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328089"><span class="hs-identifier hs-var">sfx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679328088"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-677"></span><span>        </span><span class="hs-comment">---------------</span><span>
</span><span id="line-678"></span><span>        </span><span id="local-6989586621679328878"><span class="annot"><a href="#local-6989586621679328087"><span class="hs-identifier hs-type">clearTemp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679328878"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#DataItem"><span class="hs-identifier hs-type">DataItem</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span>
</span><span id="line-679"></span><span>          </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MSStatement</span></span><span> </span><span class="annot"><a href="#local-6989586621679328878"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-680"></span><span>        </span><span id="local-6989586621679328087"><span class="annot"><span class="annottext">clearTemp :: UID -&gt; Input -&gt; GenState (MSStatement r)
</span><a href="#local-6989586621679328087"><span class="hs-identifier hs-var hs-var">clearTemp</span></a></span></span><span> </span><span id="local-6989586621679328086"><span class="annot"><span class="annottext">sfx :: UID
</span><a href="#local-6989586621679328086"><span class="hs-identifier hs-var">sfx</span></a></span></span><span> </span><span id="local-6989586621679328085"><span class="annot"><span class="annottext">v :: Input
</span><a href="#local-6989586621679328085"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CodeType -&gt; MSStatement r)
-&gt; GenState CodeType -&gt; GenState (MSStatement r)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679328084"><span class="annot"><span class="annottext">t :: CodeType
</span><a href="#local-6989586621679328084"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SVariable r -&gt; [SValue r] -&gt; MSStatement r
forall (r :: * -&gt; *).
DeclStatement r =&gt;
SVariable r -&gt; [SValue r] -&gt; MSStatement r
</span><span class="hs-identifier hs-var">listDecDef</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UID -&gt; VSType r -&gt; SVariable r
forall (r :: * -&gt; *).
VariableSym r =&gt;
UID -&gt; VSType r -&gt; SVariable r
</span><span class="hs-identifier hs-var">var</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input -&gt; UID
forall c. CodeIdea c =&gt; c -&gt; UID
</span><span class="hs-identifier hs-var">codeName</span></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679328085"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">UID -&gt; UID -&gt; UID
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328086"><span class="hs-identifier hs-var">sfx</span></a></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-681"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VSType r -&gt; VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; VSType r -&gt; VSType r
</span><span class="hs-identifier hs-var">listInnerType</span></span><span> </span><span class="annot"><span class="annottext">(VSType r -&gt; VSType r) -&gt; VSType r -&gt; VSType r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CodeType -&gt; VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; CodeType -&gt; VSType r
</span><span class="hs-identifier hs-var">convType</span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679328084"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input -&gt; GenState CodeType
forall c. HasSpace c =&gt; c -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#codeType"><span class="hs-identifier hs-var">codeType</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679328085"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-682"></span><span>        </span><span class="hs-comment">---------------</span><span>
</span><span id="line-683"></span><span>        </span><span id="local-6989586621679328083"><span class="annot"><a href="#local-6989586621679328090"><span class="hs-identifier hs-type">appendTemps</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679328083"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#DataItem"><span class="hs-identifier hs-type">DataItem</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span>
</span><span id="line-684"></span><span>          </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MSStatement</span></span><span> </span><span class="annot"><a href="#local-6989586621679328083"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-685"></span><span>        </span><span id="local-6989586621679328090"><span class="annot"><span class="annottext">appendTemps :: Maybe UID -&gt; [Input] -&gt; [GenState (MSStatement r)]
</span><a href="#local-6989586621679328090"><span class="hs-identifier hs-var hs-var">appendTemps</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-686"></span><span>        </span><span class="annot"><a href="#local-6989586621679328090"><span class="hs-identifier hs-var">appendTemps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679328082"><span class="annot"><span class="annottext">sfx :: UID
</span><a href="#local-6989586621679328082"><span class="hs-identifier hs-var">sfx</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679328081"><span class="annot"><span class="annottext">es :: [Input]
</span><a href="#local-6989586621679328081"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Input -&gt; GenState (MSStatement r))
-&gt; [Input] -&gt; [GenState (MSStatement r)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UID -&gt; Input -&gt; GenState (MSStatement r)
forall (r :: * -&gt; *).
OOProg r =&gt;
UID -&gt; Input -&gt; GenState (MSStatement r)
</span><a href="#local-6989586621679328080"><span class="hs-identifier hs-var">appendTemp</span></a></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328082"><span class="hs-identifier hs-var">sfx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679328081"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-687"></span><span>        </span><span class="hs-comment">---------------</span><span>
</span><span id="line-688"></span><span>        </span><span id="local-6989586621679328079"><span class="annot"><a href="#local-6989586621679328080"><span class="hs-identifier hs-type">appendTemp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679328079"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#DataItem"><span class="hs-identifier hs-type">DataItem</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span>
</span><span id="line-689"></span><span>          </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MSStatement</span></span><span> </span><span class="annot"><a href="#local-6989586621679328079"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-690"></span><span>        </span><span id="local-6989586621679328080"><span class="annot"><span class="annottext">appendTemp :: UID -&gt; Input -&gt; GenState (MSStatement r)
</span><a href="#local-6989586621679328080"><span class="hs-identifier hs-var hs-var">appendTemp</span></a></span></span><span> </span><span id="local-6989586621679328078"><span class="annot"><span class="annottext">sfx :: UID
</span><a href="#local-6989586621679328078"><span class="hs-identifier hs-var">sfx</span></a></span></span><span> </span><span id="local-6989586621679328077"><span class="annot"><span class="annottext">v :: Input
</span><a href="#local-6989586621679328077"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CodeType -&gt; MSStatement r)
-&gt; GenState CodeType -&gt; GenState (MSStatement r)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679328076"><span class="annot"><span class="annottext">t :: CodeType
</span><a href="#local-6989586621679328076"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; MSStatement r
forall (r :: * -&gt; *). StatementSym r =&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">valStmt</span></span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; MSStatement r) -&gt; SValue r -&gt; MSStatement r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *). List r =&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-identifier hs-var">listAppend</span></span><span> </span><span>
</span><span id="line-691"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SVariable r -&gt; SValue r
forall (r :: * -&gt; *). VariableValue r =&gt; SVariable r -&gt; SValue r
</span><span class="hs-identifier hs-var">valueOf</span></span><span> </span><span class="annot"><span class="annottext">(SVariable r -&gt; SValue r) -&gt; SVariable r -&gt; SValue r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UID -&gt; VSType r -&gt; SVariable r
forall (r :: * -&gt; *).
VariableSym r =&gt;
UID -&gt; VSType r -&gt; SVariable r
</span><span class="hs-identifier hs-var">var</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input -&gt; UID
forall c. CodeIdea c =&gt; c -&gt; UID
</span><span class="hs-identifier hs-var">codeName</span></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679328077"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeType -&gt; VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; CodeType -&gt; VSType r
</span><span class="hs-identifier hs-var">convType</span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679328076"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-692"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SVariable r -&gt; SValue r
forall (r :: * -&gt; *). VariableValue r =&gt; SVariable r -&gt; SValue r
</span><span class="hs-identifier hs-var">valueOf</span></span><span> </span><span class="annot"><span class="annottext">(SVariable r -&gt; SValue r) -&gt; SVariable r -&gt; SValue r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UID -&gt; VSType r -&gt; SVariable r
forall (r :: * -&gt; *).
VariableSym r =&gt;
UID -&gt; VSType r -&gt; SVariable r
</span><span class="hs-identifier hs-var">var</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input -&gt; UID
forall c. CodeIdea c =&gt; c -&gt; UID
</span><span class="hs-identifier hs-var">codeName</span></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679328077"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">UID -&gt; UID -&gt; UID
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328078"><span class="hs-identifier hs-var">sfx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeType -&gt; VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; CodeType -&gt; VSType r
</span><span class="hs-identifier hs-var">convType</span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679328076"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input -&gt; GenState CodeType
forall c. HasSpace c =&gt; c -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#codeType"><span class="hs-identifier hs-var">codeType</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679328077"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-693"></span><span>        </span><span class="hs-comment">---------------</span><span>
</span><span id="line-694"></span><span>        </span><span class="annot"><a href="#local-6989586621679328075"><span class="hs-identifier hs-type">l_line</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679328074"><span class="hs-identifier hs-type">l_lines</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679328073"><span class="hs-identifier hs-type">l_linetokens</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679328072"><span class="hs-identifier hs-type">l_infile</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679328071"><span class="hs-identifier hs-type">l_i</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Label</span></span><span>
</span><span id="line-695"></span><span>        </span><span id="local-6989586621679328899"><span class="annot"><a href="#local-6989586621679328135"><span class="hs-identifier hs-type">var_line</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679328133"><span class="hs-identifier hs-type">var_lines</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679328134"><span class="hs-identifier hs-type">var_linetokens</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679328139"><span class="hs-identifier hs-type">var_infile</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679328107"><span class="hs-identifier hs-type">var_i</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span>
</span><span id="line-696"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679328899"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SVariable</span></span><span> </span><span class="annot"><a href="#local-6989586621679328899"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-697"></span><span>        </span><span id="local-6989586621679328892"><span class="annot"><a href="#local-6989586621679328115"><span class="hs-identifier hs-type">v_line</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679328106"><span class="hs-identifier hs-type">v_lines</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679328098"><span class="hs-identifier hs-type">v_linetokens</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679328129"><span class="hs-identifier hs-type">v_infile</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679328105"><span class="hs-identifier hs-type">v_i</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-698"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679328892"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679328892"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-699"></span><span>        </span><span id="local-6989586621679328075"><span class="annot"><span class="annottext">l_line :: UID
</span><a href="#local-6989586621679328075"><span class="hs-identifier hs-var hs-var">l_line</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;line&quot;</span></span><span>
</span><span id="line-700"></span><span>        </span><span id="local-6989586621679328135"><span class="annot"><span class="annottext">var_line :: SVariable r
</span><a href="#local-6989586621679328135"><span class="hs-identifier hs-var hs-var">var_line</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UID -&gt; VSType r -&gt; SVariable r
forall (r :: * -&gt; *).
VariableSym r =&gt;
UID -&gt; VSType r -&gt; SVariable r
</span><span class="hs-identifier hs-var">var</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328075"><span class="hs-identifier hs-var">l_line</span></a></span><span> </span><span class="annot"><span class="annottext">VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; VSType r
</span><span class="hs-identifier hs-var">string</span></span><span>
</span><span id="line-701"></span><span>        </span><span id="local-6989586621679328115"><span class="annot"><span class="annottext">v_line :: SValue r
</span><a href="#local-6989586621679328115"><span class="hs-identifier hs-var hs-var">v_line</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SVariable r -&gt; SValue r
forall (r :: * -&gt; *). VariableValue r =&gt; SVariable r -&gt; SValue r
</span><span class="hs-identifier hs-var">valueOf</span></span><span> </span><span class="annot"><span class="annottext">SVariable r
forall (r :: * -&gt; *). OOProg r =&gt; SVariable r
</span><a href="#local-6989586621679328135"><span class="hs-identifier hs-var">var_line</span></a></span><span>
</span><span id="line-702"></span><span>        </span><span id="local-6989586621679328074"><span class="annot"><span class="annottext">l_lines :: UID
</span><a href="#local-6989586621679328074"><span class="hs-identifier hs-var hs-var">l_lines</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;lines&quot;</span></span><span>
</span><span id="line-703"></span><span>        </span><span id="local-6989586621679328133"><span class="annot"><span class="annottext">var_lines :: SVariable r
</span><a href="#local-6989586621679328133"><span class="hs-identifier hs-var hs-var">var_lines</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UID -&gt; VSType r -&gt; SVariable r
forall (r :: * -&gt; *).
VariableSym r =&gt;
UID -&gt; VSType r -&gt; SVariable r
</span><span class="hs-identifier hs-var">var</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328074"><span class="hs-identifier hs-var">l_lines</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VSType r -&gt; VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; VSType r -&gt; VSType r
</span><span class="hs-identifier hs-var">listType</span></span><span> </span><span class="annot"><span class="annottext">VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; VSType r
</span><span class="hs-identifier hs-var">string</span></span><span class="hs-special">)</span><span>
</span><span id="line-704"></span><span>        </span><span id="local-6989586621679328106"><span class="annot"><span class="annottext">v_lines :: SValue r
</span><a href="#local-6989586621679328106"><span class="hs-identifier hs-var hs-var">v_lines</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SVariable r -&gt; SValue r
forall (r :: * -&gt; *). VariableValue r =&gt; SVariable r -&gt; SValue r
</span><span class="hs-identifier hs-var">valueOf</span></span><span> </span><span class="annot"><span class="annottext">SVariable r
forall (r :: * -&gt; *). OOProg r =&gt; SVariable r
</span><a href="#local-6989586621679328133"><span class="hs-identifier hs-var">var_lines</span></a></span><span>
</span><span id="line-705"></span><span>        </span><span id="local-6989586621679328073"><span class="annot"><span class="annottext">l_linetokens :: UID
</span><a href="#local-6989586621679328073"><span class="hs-identifier hs-var hs-var">l_linetokens</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;linetokens&quot;</span></span><span>
</span><span id="line-706"></span><span>        </span><span id="local-6989586621679328134"><span class="annot"><span class="annottext">var_linetokens :: SVariable r
</span><a href="#local-6989586621679328134"><span class="hs-identifier hs-var hs-var">var_linetokens</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UID -&gt; VSType r -&gt; SVariable r
forall (r :: * -&gt; *).
VariableSym r =&gt;
UID -&gt; VSType r -&gt; SVariable r
</span><span class="hs-identifier hs-var">var</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328073"><span class="hs-identifier hs-var">l_linetokens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VSType r -&gt; VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; VSType r -&gt; VSType r
</span><span class="hs-identifier hs-var">listType</span></span><span> </span><span class="annot"><span class="annottext">VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; VSType r
</span><span class="hs-identifier hs-var">string</span></span><span class="hs-special">)</span><span>
</span><span id="line-707"></span><span>        </span><span id="local-6989586621679328098"><span class="annot"><span class="annottext">v_linetokens :: SValue r
</span><a href="#local-6989586621679328098"><span class="hs-identifier hs-var hs-var">v_linetokens</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SVariable r -&gt; SValue r
forall (r :: * -&gt; *). VariableValue r =&gt; SVariable r -&gt; SValue r
</span><span class="hs-identifier hs-var">valueOf</span></span><span> </span><span class="annot"><span class="annottext">SVariable r
forall (r :: * -&gt; *). OOProg r =&gt; SVariable r
</span><a href="#local-6989586621679328134"><span class="hs-identifier hs-var">var_linetokens</span></a></span><span>
</span><span id="line-708"></span><span>        </span><span id="local-6989586621679328072"><span class="annot"><span class="annottext">l_infile :: UID
</span><a href="#local-6989586621679328072"><span class="hs-identifier hs-var hs-var">l_infile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;infile&quot;</span></span><span>
</span><span id="line-709"></span><span>        </span><span id="local-6989586621679328139"><span class="annot"><span class="annottext">var_infile :: SVariable r
</span><a href="#local-6989586621679328139"><span class="hs-identifier hs-var hs-var">var_infile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UID -&gt; VSType r -&gt; SVariable r
forall (r :: * -&gt; *).
VariableSym r =&gt;
UID -&gt; VSType r -&gt; SVariable r
</span><span class="hs-identifier hs-var">var</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328072"><span class="hs-identifier hs-var">l_infile</span></a></span><span> </span><span class="annot"><span class="annottext">VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; VSType r
</span><span class="hs-identifier hs-var">infile</span></span><span>
</span><span id="line-710"></span><span>        </span><span id="local-6989586621679328129"><span class="annot"><span class="annottext">v_infile :: SValue r
</span><a href="#local-6989586621679328129"><span class="hs-identifier hs-var hs-var">v_infile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SVariable r -&gt; SValue r
forall (r :: * -&gt; *). VariableValue r =&gt; SVariable r -&gt; SValue r
</span><span class="hs-identifier hs-var">valueOf</span></span><span> </span><span class="annot"><span class="annottext">SVariable r
forall (r :: * -&gt; *). OOProg r =&gt; SVariable r
</span><a href="#local-6989586621679328139"><span class="hs-identifier hs-var">var_infile</span></a></span><span>
</span><span id="line-711"></span><span>        </span><span id="local-6989586621679328071"><span class="annot"><span class="annottext">l_i :: UID
</span><a href="#local-6989586621679328071"><span class="hs-identifier hs-var hs-var">l_i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;i&quot;</span></span><span>
</span><span id="line-712"></span><span>        </span><span id="local-6989586621679328107"><span class="annot"><span class="annottext">var_i :: SVariable r
</span><a href="#local-6989586621679328107"><span class="hs-identifier hs-var hs-var">var_i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UID -&gt; VSType r -&gt; SVariable r
forall (r :: * -&gt; *).
VariableSym r =&gt;
UID -&gt; VSType r -&gt; SVariable r
</span><span class="hs-identifier hs-var">var</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328071"><span class="hs-identifier hs-var">l_i</span></a></span><span> </span><span class="annot"><span class="annottext">VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; VSType r
</span><span class="hs-identifier hs-var">int</span></span><span>
</span><span id="line-713"></span><span>        </span><span id="local-6989586621679328105"><span class="annot"><span class="annottext">v_i :: SValue r
</span><a href="#local-6989586621679328105"><span class="hs-identifier hs-var hs-var">v_i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SVariable r -&gt; SValue r
forall (r :: * -&gt; *). VariableValue r =&gt; SVariable r -&gt; SValue r
</span><span class="hs-identifier hs-var">valueOf</span></span><span> </span><span class="annot"><span class="annottext">SVariable r
forall (r :: * -&gt; *). OOProg r =&gt; SVariable r
</span><a href="#local-6989586621679328107"><span class="hs-identifier hs-var">var_i</span></a></span><span>
</span><span id="line-714"></span><span>
</span><span id="line-715"></span><span class="hs-comment">-- | Get entry variables.</span><span>
</span><span id="line-716"></span><span id="local-6989586621679328883"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#getEntryVars"><span class="hs-identifier hs-type">getEntryVars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679328883"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#LinePattern"><span class="hs-identifier hs-type">LinePattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span>
</span><span id="line-717"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">SVariable</span></span><span> </span><span class="annot"><a href="#local-6989586621679328883"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-718"></span><span id="getEntryVars"><span class="annot"><span class="annottext">getEntryVars :: Maybe UID -&gt; LinePattern -&gt; GenState [SVariable r]
</span><a href="Language.Drasil.Code.Imperative.Import.html#getEntryVars"><span class="hs-identifier hs-var hs-var">getEntryVars</span></a></span></span><span> </span><span id="local-6989586621679328066"><span class="annot"><span class="annottext">s :: Maybe UID
</span><a href="#local-6989586621679328066"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679328065"><span class="annot"><span class="annottext">lp :: LinePattern
</span><a href="#local-6989586621679328065"><span class="hs-identifier hs-var">lp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Input -&gt; StateT DrasilState Identity (SVariable r))
-&gt; [Input] -&gt; GenState [SVariable r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Input -&gt; StateT DrasilState Identity (SVariable r))
-&gt; (UID -&gt; Input -&gt; StateT DrasilState Identity (SVariable r))
-&gt; Maybe UID
-&gt; Input
-&gt; StateT DrasilState Identity (SVariable r)
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Input -&gt; StateT DrasilState Identity (SVariable r)
forall (r :: * -&gt; *). OOProg r =&gt; Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679328064"><span class="annot"><span class="annottext">st :: UID
</span><a href="#local-6989586621679328064"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span id="local-6989586621679328063"><span class="annot"><span class="annottext">v :: Input
</span><a href="#local-6989586621679328063"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Input -&gt; GenState CodeType
forall c. HasSpace c =&gt; c -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#codeType"><span class="hs-identifier hs-var">codeType</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679328063"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">GenState CodeType
-&gt; (CodeType -&gt; StateT DrasilState Identity (SVariable r))
-&gt; StateT DrasilState Identity (SVariable r)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UID -&gt; VSType r -&gt; StateT DrasilState Identity (SVariable r)
forall (r :: * -&gt; *).
OOProg r =&gt;
UID -&gt; VSType r -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#variable"><span class="hs-identifier hs-var">variable</span></a></span><span> </span><span>
</span><span id="line-719"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input -&gt; UID
forall c. CodeIdea c =&gt; c -&gt; UID
</span><span class="hs-identifier hs-var">codeName</span></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679328063"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">UID -&gt; UID -&gt; UID
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679328064"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(VSType r -&gt; StateT DrasilState Identity (SVariable r))
-&gt; (CodeType -&gt; VSType r)
-&gt; CodeType
-&gt; StateT DrasilState Identity (SVariable r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">VSType r -&gt; VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; VSType r -&gt; VSType r
</span><span class="hs-identifier hs-var">listInnerType</span></span><span> </span><span class="annot"><span class="annottext">(VSType r -&gt; VSType r)
-&gt; (CodeType -&gt; VSType r) -&gt; CodeType -&gt; VSType r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CodeType -&gt; VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; CodeType -&gt; VSType r
</span><span class="hs-identifier hs-var">convType</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe UID
</span><a href="#local-6989586621679328066"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LinePattern -&gt; [Input]
</span><a href="Language.Drasil.Code.DataDesc.html#getPatternInputs"><span class="hs-identifier hs-var">getPatternInputs</span></a></span><span> </span><span class="annot"><span class="annottext">LinePattern
</span><a href="#local-6989586621679328065"><span class="hs-identifier hs-var">lp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-720"></span><span>
</span><span id="line-721"></span><span class="hs-comment">-- | Get entry variable logs.</span><span>
</span><span id="line-722"></span><span id="local-6989586621679328887"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#getEntryVarLogs"><span class="hs-identifier hs-type">getEntryVarLogs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679328887"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#LinePattern"><span class="hs-identifier hs-type">LinePattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span>
</span><span id="line-723"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSStatement</span></span><span> </span><span class="annot"><a href="#local-6989586621679328887"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-724"></span><span id="getEntryVarLogs"><span class="annot"><span class="annottext">getEntryVarLogs :: LinePattern -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Import.html#getEntryVarLogs"><span class="hs-identifier hs-var hs-var">getEntryVarLogs</span></a></span></span><span> </span><span id="local-6989586621679328062"><span class="annot"><span class="annottext">lp :: LinePattern
</span><a href="#local-6989586621679328062"><span class="hs-identifier hs-var">lp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-725"></span><span>  </span><span id="local-6989586621679328061"><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679328061"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe UID -&gt; LinePattern -&gt; GenState [VS (r (Variable r))]
forall (r :: * -&gt; *).
OOProg r =&gt;
Maybe UID -&gt; LinePattern -&gt; GenState [SVariable r]
</span><a href="Language.Drasil.Code.Imperative.Import.html#getEntryVars"><span class="hs-identifier hs-var">getEntryVars</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe UID
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">LinePattern
</span><a href="#local-6989586621679328062"><span class="hs-identifier hs-var">lp</span></a></span><span>
</span><span id="line-726"></span><span>  </span><span id="local-6989586621679328060"><span class="annot"><span class="annottext">[[MSStatement r]]
</span><a href="#local-6989586621679328060"><span class="hs-identifier hs-var">logs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(VS (r (Variable r)) -&gt; GenState [MSStatement r])
-&gt; [VS (r (Variable r))]
-&gt; StateT DrasilState Identity [[MSStatement r]]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r)) -&gt; GenState [MSStatement r]
forall (r :: * -&gt; *).
OOProg r =&gt;
SVariable r -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Logging.html#maybeLog"><span class="hs-identifier hs-var">maybeLog</span></a></span><span> </span><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679328061"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-727"></span><span>  </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; GenState [MSStatement r]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([MSStatement r] -&gt; GenState [MSStatement r])
-&gt; [MSStatement r] -&gt; GenState [MSStatement r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[MSStatement r]] -&gt; [MSStatement r]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">[[MSStatement r]]
</span><a href="#local-6989586621679328060"><span class="hs-identifier hs-var">logs</span></a></span><span>
</span><span id="line-728"></span></pre></body></html>