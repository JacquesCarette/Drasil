<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE PostfixOperators, Rank2Types #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-redundant-constraints #-}</span><span>
</span><span id="line-3"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Language.Drasil.Code.Imperative.Import</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#codeType"><span class="hs-identifier">codeType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#spaceCodeType"><span class="hs-identifier">spaceCodeType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-4"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#publicFunc"><span class="hs-identifier">publicFunc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#publicFuncProc"><span class="hs-identifier">publicFuncProc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#privateMethod"><span class="hs-identifier">privateMethod</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#privateFuncProc"><span class="hs-identifier">privateFuncProc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#publicInOutFunc"><span class="hs-identifier">publicInOutFunc</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-5"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#publicInOutFuncProc"><span class="hs-identifier">publicInOutFuncProc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#privateInOutMethod"><span class="hs-identifier">privateInOutMethod</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#privateInOutFuncProc"><span class="hs-identifier">privateInOutFuncProc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#genConstructor"><span class="hs-identifier">genConstructor</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-6"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier">mkVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#mkVarProc"><span class="hs-identifier">mkVarProc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#mkVal"><span class="hs-identifier">mkVal</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#mkValProc"><span class="hs-identifier">mkValProc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier">convExpr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier">convExprProc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier">convStmt</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-7"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmtProc"><span class="hs-identifier">convStmtProc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#genModDef"><span class="hs-identifier">genModDef</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#genModDefProc"><span class="hs-identifier">genModDefProc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#genModFuncs"><span class="hs-identifier">genModFuncs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#genModFuncsProc"><span class="hs-identifier">genModFuncsProc</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-8"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#genModClasses"><span class="hs-identifier">genModClasses</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#readData"><span class="hs-identifier">readData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#readDataProc"><span class="hs-identifier">readDataProc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#renderC"><span class="hs-identifier">renderC</span></a></span><span>
</span><span id="line-9"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Drasil.Code.CodeExpr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">sy</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">($&lt;)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">($&gt;)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">($&lt;=)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">($&gt;=)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">($&amp;&amp;)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">in'</span></span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Drasil.Code.CodeExpr.Development</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">CodeExpr</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Drasil.Code.CodeExpr.Development</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">CodeExpr</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ArithBinOp</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>  </span><span class="annot"><span class="hs-identifier">AssocArithOper</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">AssocBoolOper</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">AssocConcatOper</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">BoolBinOp</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">EqBinOp</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>  </span><span class="annot"><span class="hs-identifier">LABinOp</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">OrdBinOp</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">UFunc</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">UFuncB</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">UFuncVV</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">UFuncVN</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>  </span><span class="annot"><span class="hs-identifier">VVNBinOp</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">VVVBinOp</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">NVVBinOp</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ESSBinOp</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ESBBinOp</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Language.Drasil</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">HasSymbol</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">HasUID</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">HasSpace</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>  </span><span class="annot"><span class="hs-identifier">Space</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Rational</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Real</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">RealInterval</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">UID</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Constraint</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Inclusive</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Database.Drasil</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">symbResolve</span></span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Comments.html"><span class="hs-identifier">Language.Drasil.Code.Imperative.Comments</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Code.Imperative.Comments.html#getCommentBrief"><span class="hs-identifier">getCommentBrief</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.ConceptMatch.html"><span class="hs-identifier">Language.Drasil.Code.Imperative.ConceptMatch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Code.Imperative.ConceptMatch.html#conceptToGOOL"><span class="hs-identifier">conceptToGOOL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html"><span class="hs-identifier">Language.Drasil.Code.Imperative.GenerateGOOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html#auxClass"><span class="hs-identifier">auxClass</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html#fApp"><span class="hs-identifier">fApp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html#fAppProc"><span class="hs-identifier">fAppProc</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html#ctorCall"><span class="hs-identifier">ctorCall</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html#genModuleWithImports"><span class="hs-identifier">genModuleWithImports</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html#genModuleWithImportsProc"><span class="hs-identifier">genModuleWithImportsProc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html#primaryClass"><span class="hs-identifier">primaryClass</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Helpers.html"><span class="hs-identifier">Language.Drasil.Code.Imperative.Helpers</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Code.Imperative.Helpers.html#lookupC"><span class="hs-identifier">lookupC</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Helpers.html#convScope"><span class="hs-identifier">convScope</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Logging.html"><span class="hs-identifier">Language.Drasil.Code.Imperative.Logging</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Code.Imperative.Logging.html#maybeLog"><span class="hs-identifier">maybeLog</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Logging.html#logBody"><span class="hs-identifier">logBody</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html"><span class="hs-identifier">Language.Drasil.Code.Imperative.DrasilState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier">GenState</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#DrasilState"><span class="hs-identifier">DrasilState</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#ScopeType"><span class="hs-identifier">ScopeType</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#genICName"><span class="hs-identifier">genICName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.Chunk.Code.html"><span class="hs-identifier">Language.Drasil.Chunk.Code</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">CodeIdea</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">codeName</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">CodeVarChunk</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">obv</span></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>  </span><span class="annot"><a href="Language.Drasil.Chunk.CodeBase.html#quantvar"><span class="hs-identifier">quantvar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Chunk.CodeBase.html#quantfunc"><span class="hs-identifier">quantfunc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Chunk.Code.html#ccObjVar"><span class="hs-identifier">ccObjVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">DefiningCodeExpr</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.Chunk.Parameter.html"><span class="hs-identifier">Language.Drasil.Chunk.Parameter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Chunk.Parameter.html#ParameterChunk"><span class="hs-identifier">ParameterChunk</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Chunk.Parameter.html#PassBy"><span class="hs-identifier">PassBy</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Chunk.Parameter.html#pcAuto"><span class="hs-identifier">pcAuto</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.Code.CodeQuantityDicts.html"><span class="hs-identifier">Language.Drasil.Code.CodeQuantityDicts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Code.CodeQuantityDicts.html#inFileName"><span class="hs-identifier">inFileName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.CodeQuantityDicts.html#inParams"><span class="hs-identifier">inParams</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.CodeQuantityDicts.html#consts"><span class="hs-identifier">consts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html"><span class="hs-identifier">Language.Drasil.Choices</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Choices.html#Comments"><span class="hs-identifier">Comments</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#ConstantRepr"><span class="hs-identifier">ConstantRepr</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>  </span><span class="annot"><a href="Language.Drasil.Choices.html#ConstantStructure"><span class="hs-identifier">ConstantStructure</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#Structure"><span class="hs-identifier">Structure</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#InternalConcept"><span class="hs-identifier">InternalConcept</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.CodeSpec.html"><span class="hs-identifier">Language.Drasil.CodeSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.CodeSpec.html#HasOldCodeSpec"><span class="hs-identifier">HasOldCodeSpec</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html"><span class="hs-identifier">Language.Drasil.Code.DataDesc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#DataItem"><span class="hs-identifier">DataItem</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#LinePattern"><span class="hs-identifier">LinePattern</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#Repeat"><span class="hs-identifier">Repeat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#Straight"><span class="hs-identifier">Straight</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#Data"><span class="hs-identifier">Data</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#Line"><span class="hs-identifier">Line</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#Lines"><span class="hs-identifier">Lines</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#JunkData"><span class="hs-identifier">JunkData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#Singleton"><span class="hs-identifier">Singleton</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#DataDesc"><span class="hs-identifier">DataDesc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#isLine"><span class="hs-identifier">isLine</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#isLines"><span class="hs-identifier">isLines</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#getInputs"><span class="hs-identifier">getInputs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#getPatternInputs"><span class="hs-identifier">getPatternInputs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Language.Drasil.Literal.Development</span></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html"><span class="hs-identifier">Language.Drasil.Mod</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#Func"><span class="hs-identifier">Func</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#FuncData"><span class="hs-identifier">FuncData</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#FuncDef"><span class="hs-identifier">FuncDef</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#FuncStmt"><span class="hs-identifier">FuncStmt</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>  </span><span class="annot"><a href="Language.Drasil.Mod.html#Mod"><span class="hs-identifier">Mod</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Name"><span class="hs-identifier">Name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Description"><span class="hs-identifier">Description</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#StateVariable"><span class="hs-identifier">StateVariable</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#fstdecl"><span class="hs-identifier">fstdecl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html"><span class="hs-identifier">Language.Drasil.Mod</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#Class"><span class="hs-identifier">Class</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Language.Drasil.Printers</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">showHasSymbImpl</span></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Drasil.GOOL</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Label</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">MSBody</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">MSBlock</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">VSType</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">SVariable</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">SValue</span></span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>  </span><span class="annot"><span class="hs-identifier">MSStatement</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">MSParameter</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">SMethod</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">CSStateVar</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">SClass</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">NamedArgs</span></span><span class="hs-special">,</span><span>
</span><span id="line-46"></span><span>  </span><span class="annot"><span class="hs-identifier">Initializers</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">SharedProg</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">OOProg</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">PermanenceSym</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">bodyStatements</span></span><span class="hs-special">,</span><span>
</span><span id="line-47"></span><span>  </span><span class="annot"><span class="hs-identifier">BlockSym</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">TypeSym</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">VariableSym</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ScopeSym</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">OOVariableSym</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-48"></span><span>  </span><span class="annot"><span class="hs-identifier">staticConst</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">VariableElim</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">($-&gt;)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ValueSym</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Literal</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-49"></span><span>  </span><span class="annot"><span class="hs-identifier">VariableValue</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">NumericExpression</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">BooleanExpression</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-50"></span><span>  </span><span class="annot"><span class="hs-identifier">Comparison</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ValueExpression</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">OOValueExpression</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-51"></span><span>  </span><span class="annot"><span class="hs-identifier">objMethodCallMixedArgs</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">List</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">StatementSym</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">AssignStatement</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-52"></span><span>  </span><span class="annot"><span class="hs-identifier">DeclStatement</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">IOStatement</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">StringStatement</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ControlStatement</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-53"></span><span>  </span><span class="annot"><span class="hs-identifier">ifNoElse</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">VisibilitySym</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ParameterSym</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">MethodSym</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">OOMethodSym</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-54"></span><span>  </span><span class="annot"><span class="hs-identifier">pubDVar</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">privDVar</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">nonInitConstructor</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">convType</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">convTypeOO</span></span><span class="hs-special">,</span><span>
</span><span id="line-55"></span><span>  </span><span class="annot"><span class="hs-identifier">VisibilityTag</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">CodeType</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">onStateValue</span></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Drasil.GOOL</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Set</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Drasil.GOOL</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">OO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">SFile</span></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Drasil.GOOL</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">C</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">CodeType</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">List</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Array</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Drasil.GProc</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ProcProg</span></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Drasil.GProc</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Proc</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">SFile</span></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">sin</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">cos</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">tan</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">log</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">exp</span></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(\\)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">intersect</span></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">lookup</span></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">liftM2</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">liftM3</span></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.State</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">get</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">modify</span></span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(^.)</span></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="hs-comment">-- | Gets a chunk's 'CodeType', by checking which 'CodeType' the user has chosen to</span><span>
</span><span id="line-70"></span><span class="hs-comment">-- match the chunk's 'Space' to.</span><span>
</span><span id="line-71"></span><span id="local-6989586621679353508"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#codeType"><span class="hs-identifier hs-type">codeType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">HasSpace</span></span><span> </span><span class="annot"><a href="#local-6989586621679353508"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679353508"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CodeType</span></span></span><span>
</span><span id="line-72"></span><span id="codeType"><span class="annot"><span class="annottext">codeType :: forall c. HasSpace c =&gt; c -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#codeType"><span class="hs-identifier hs-var hs-var">codeType</span></a></span></span><span> </span><span id="local-6989586621679354154"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679354154"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Space -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#spaceCodeType"><span class="hs-identifier hs-var">spaceCodeType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679354154"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">c -&gt; Getting Space c Space -&gt; Space
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting Space c Space
forall c. HasSpace c =&gt; Getter c Space
Getter c Space
</span><span class="hs-identifier hs-var">typ</span></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="annot"><span class="hs-comment">-- | Gets the 'CodeType' for a 'Space', based on the user's choice.</span></span><span>
</span><span id="line-75"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#spaceCodeType"><span class="hs-identifier hs-type">spaceCodeType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Space</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CodeType</span></span><span>
</span><span id="line-76"></span><span id="spaceCodeType"><span class="annot"><span class="annottext">spaceCodeType :: Space -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#spaceCodeType"><span class="hs-identifier hs-var hs-var">spaceCodeType</span></a></span></span><span> </span><span id="local-6989586621679354156"><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621679354156"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-77"></span><span>  </span><span id="local-6989586621679354157"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679354157"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-78"></span><span>  </span><span class="annot"><span class="annottext">DrasilState -&gt; Space -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#spaceMatches"><span class="hs-identifier hs-var">spaceMatches</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679354157"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621679354156"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span class="hs-comment">-- | If 'UID' for the variable is matched to a concept, call 'conceptToGOOL' to get</span><span>
</span><span id="line-81"></span><span class="hs-comment">-- the GOOL code for the concept, and return.</span><span>
</span><span id="line-82"></span><span class="hs-comment">-- If 'UID' is for a constant and user has chosen 'Inline', convert the constant's</span><span>
</span><span id="line-83"></span><span class="hs-comment">-- defining 'Expr' to a value with 'convExpr'.</span><span>
</span><span id="line-84"></span><span class="hs-comment">-- Otherwise, just a regular variable: construct it by calling the variable, then</span><span>
</span><span id="line-85"></span><span class="hs-comment">-- call 'valueOf' to reference its value.</span><span>
</span><span id="line-86"></span><span id="local-6989586621679353525"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#value"><span class="hs-identifier hs-type">value</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353525"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VSType</span></span><span> </span><span class="annot"><a href="#local-6989586621679353525"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679353525"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-87"></span><span id="value"><span class="annot"><span class="annottext">value :: forall (r :: * -&gt; *).
OOProg r =&gt;
UID -&gt; Name -&gt; VSType r -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#value"><span class="hs-identifier hs-var hs-var">value</span></a></span></span><span> </span><span id="local-6989586621679354182"><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679354182"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621679354183"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679354183"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679354184"><span class="annot"><span class="annottext">VSType r
</span><a href="#local-6989586621679354184"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-88"></span><span>  </span><span id="local-6989586621679354185"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679354185"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679354186"><span class="annot"><span class="annottext">cs :: CodeSpec
</span><a href="#local-6989586621679354186"><span class="hs-identifier hs-var hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; CodeSpec
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#codeSpec"><span class="hs-identifier hs-var">codeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679354185"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-90"></span><span>      </span><span id="local-6989586621679354191"><span class="annot"><span class="annottext">mm :: ConstantMap
</span><a href="#local-6989586621679354191"><span class="hs-identifier hs-var hs-var">mm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CodeSpec
</span><a href="#local-6989586621679354186"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">CodeSpec -&gt; Getting ConstantMap CodeSpec ConstantMap -&gt; ConstantMap
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting ConstantMap CodeSpec ConstantMap
forall c. HasOldCodeSpec c =&gt; Lens' c ConstantMap
Lens' CodeSpec ConstantMap
</span><a href="Language.Drasil.CodeSpec.html#constMapO"><span class="hs-identifier hs-var">constMapO</span></a></span><span>
</span><span id="line-91"></span><span>      </span><span id="local-6989586621679354197"><span class="annot"><span class="annottext">constDef :: Maybe CodeDefinition
</span><a href="#local-6989586621679354197"><span class="hs-identifier hs-var hs-var">constDef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-92"></span><span>        </span><span id="local-6989586621679354198"><span class="annot"><span class="annottext">CodeDefinition
</span><a href="#local-6989586621679354198"><span class="hs-identifier hs-var">cd</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UID -&gt; ConstantMap -&gt; Maybe CodeDefinition
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679354182"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">ConstantMap
</span><a href="#local-6989586621679354191"><span class="hs-identifier hs-var">mm</span></a></span><span>
</span><span id="line-93"></span><span>        </span><span class="annot"><span class="annottext">ConstantStructure -&gt; CodeDefinition -&gt; Maybe CodeDefinition
forall {a}. ConstantStructure -&gt; a -&gt; Maybe a
</span><a href="#local-6989586621679354199"><span class="hs-identifier hs-var">maybeInline</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; ConstantStructure
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#conStruct"><span class="hs-identifier hs-var">conStruct</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679354185"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CodeDefinition
</span><a href="#local-6989586621679354198"><span class="hs-identifier hs-var">cd</span></a></span><span>
</span><span id="line-94"></span><span>      </span><span id="local-6989586621679354199"><span class="annot"><span class="annottext">maybeInline :: ConstantStructure -&gt; a -&gt; Maybe a
</span><a href="#local-6989586621679354199"><span class="hs-identifier hs-var hs-var">maybeInline</span></a></span></span><span> </span><span class="annot"><span class="annottext">ConstantStructure
</span><a href="Language.Drasil.Choices.html#Inline"><span class="hs-identifier hs-var">Inline</span></a></span><span> </span><span id="local-6989586621679354201"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679354201"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679354201"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-95"></span><span>      </span><span class="annot"><a href="#local-6989586621679354199"><span class="hs-identifier hs-var">maybeInline</span></a></span><span> </span><span class="annot"><span class="annottext">ConstantStructure
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-96"></span><span>      </span><span id="local-6989586621679354202"><span class="annot"><span class="annottext">cm :: MatchedConceptMap
</span><a href="#local-6989586621679354202"><span class="hs-identifier hs-var hs-var">cm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; MatchedConceptMap
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#concMatches"><span class="hs-identifier hs-var">concMatches</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679354185"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-97"></span><span>      </span><span id="local-6989586621679354205"><span class="annot"><span class="annottext">cdCncpt :: Maybe CodeConcept
</span><a href="#local-6989586621679354205"><span class="hs-identifier hs-var hs-var">cdCncpt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UID -&gt; MatchedConceptMap -&gt; Maybe CodeConcept
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679354182"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">MatchedConceptMap
</span><a href="#local-6989586621679354202"><span class="hs-identifier hs-var">cm</span></a></span><span>
</span><span id="line-98"></span><span>  </span><span id="local-6989586621679354206"><span class="annot"><span class="annottext">SValue r
</span><a href="#local-6989586621679354206"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenState (SValue r)
-&gt; (CodeDefinition -&gt; GenState (SValue r))
-&gt; Maybe CodeDefinition
-&gt; GenState (SValue r)
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SVariable r -&gt; SValue r
forall (r :: * -&gt; *). VariableValue r =&gt; SVariable r -&gt; SValue r
</span><span class="hs-identifier hs-var">valueOf</span></span><span> </span><span class="annot"><span class="annottext">(SVariable r -&gt; SValue r)
-&gt; StateT DrasilState Identity (SVariable r) -&gt; GenState (SValue r)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; VSType r -&gt; StateT DrasilState Identity (SVariable r)
forall (r :: * -&gt; *).
OOProg r =&gt;
Name -&gt; VSType r -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#variable"><span class="hs-identifier hs-var">variable</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679354183"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">VSType r
</span><a href="#local-6989586621679354184"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">(CodeExpr -&gt; GenState (SValue r))
-&gt; (CodeDefinition -&gt; CodeExpr)
-&gt; CodeDefinition
-&gt; GenState (SValue r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeDefinition
-&gt; Getting CodeExpr CodeDefinition CodeExpr -&gt; CodeExpr
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting CodeExpr CodeDefinition CodeExpr
forall c. DefiningCodeExpr c =&gt; Lens' c CodeExpr
Lens' CodeDefinition CodeExpr
</span><span class="hs-identifier hs-var">codeExpr</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe CodeDefinition
</span><a href="#local-6989586621679354197"><span class="hs-identifier hs-var">constDef</span></a></span><span>
</span><span id="line-99"></span><span>  </span><span class="annot"><span class="annottext">SValue r -&gt; GenState (SValue r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; GenState (SValue r))
-&gt; SValue r -&gt; GenState (SValue r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SValue r
-&gt; (CodeConcept -&gt; SValue r) -&gt; Maybe CodeConcept -&gt; SValue r
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">SValue r
</span><a href="#local-6989586621679354206"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">CodeConcept -&gt; SValue r
forall (r :: * -&gt; *). SharedProg r =&gt; CodeConcept -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.ConceptMatch.html#conceptToGOOL"><span class="hs-identifier hs-var">conceptToGOOL</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe CodeConcept
</span><a href="#local-6989586621679354205"><span class="hs-identifier hs-var">cdCncpt</span></a></span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span class="hs-comment">-- | If variable is an input, construct it with 'var' and pass to inputVariable.</span><span>
</span><span id="line-102"></span><span class="hs-comment">-- If variable is a constant and 'Var' constant representation is chosen,</span><span>
</span><span id="line-103"></span><span class="hs-comment">-- construct it with 'var' and pass to 'constVariable'.</span><span>
</span><span id="line-104"></span><span class="hs-comment">-- If variable is a constant and 'Const' constant representation is chosen,</span><span>
</span><span id="line-105"></span><span class="hs-comment">-- construct it with 'staticVar' and pass to 'constVariable'.</span><span>
</span><span id="line-106"></span><span class="hs-comment">-- If variable is neither, just construct it with 'var' and return it.</span><span>
</span><span id="line-107"></span><span id="local-6989586621679353561"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#variable"><span class="hs-identifier hs-type">variable</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353561"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VSType</span></span><span> </span><span class="annot"><a href="#local-6989586621679353561"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SVariable</span></span><span> </span><span class="annot"><a href="#local-6989586621679353561"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-108"></span><span id="variable"><span class="annot"><span class="annottext">variable :: forall (r :: * -&gt; *).
OOProg r =&gt;
Name -&gt; VSType r -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#variable"><span class="hs-identifier hs-var hs-var">variable</span></a></span></span><span> </span><span id="local-6989586621679354249"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679354249"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679354250"><span class="annot"><span class="annottext">VSType r
</span><a href="#local-6989586621679354250"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-109"></span><span>  </span><span id="local-6989586621679354251"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679354251"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-110"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679354252"><span class="annot"><span class="annottext">cs :: CodeSpec
</span><a href="#local-6989586621679354252"><span class="hs-identifier hs-var hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; CodeSpec
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#codeSpec"><span class="hs-identifier hs-var">codeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679354251"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-111"></span><span>      </span><span id="local-6989586621679354267"><span class="annot"><span class="annottext">defFunc :: ConstantRepr -&gt; Name -&gt; VSType r -&gt; SVariable r
</span><a href="#local-6989586621679354267"><span class="hs-identifier hs-var hs-var">defFunc</span></a></span></span><span> </span><span class="annot"><span class="annottext">ConstantRepr
</span><a href="Language.Drasil.Choices.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; VSType r -&gt; SVariable r
forall (r :: * -&gt; *).
VariableSym r =&gt;
Name -&gt; VSType r -&gt; SVariable r
</span><span class="hs-identifier hs-var">var</span></span><span>
</span><span id="line-112"></span><span>      </span><span class="annot"><a href="#local-6989586621679354267"><span class="hs-identifier hs-var">defFunc</span></a></span><span> </span><span class="annot"><span class="annottext">ConstantRepr
</span><a href="Language.Drasil.Choices.html#Const"><span class="hs-identifier hs-var">Const</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; VSType r -&gt; SVariable r
forall (r :: * -&gt; *).
OOVariableSym r =&gt;
Name -&gt; VSType r -&gt; SVariable r
</span><span class="hs-identifier hs-var">staticConst</span></span><span>
</span><span id="line-113"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679354249"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Name] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">(Input -&gt; Name) -&gt; [Input] -&gt; [Name]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Input -&gt; Name
forall c. CodeIdea c =&gt; c -&gt; Name
</span><span class="hs-identifier hs-var">codeName</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeSpec
</span><a href="#local-6989586621679354252"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">CodeSpec -&gt; Getting [Input] CodeSpec [Input] -&gt; [Input]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting [Input] CodeSpec [Input]
forall c. HasOldCodeSpec c =&gt; Lens' c [Input]
Lens' CodeSpec [Input]
</span><a href="Language.Drasil.CodeSpec.html#inputsO"><span class="hs-identifier hs-var">inputsO</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Structure -&gt; ConstantRepr -&gt; SVariable r -&gt; GenState (SVariable r)
forall (r :: * -&gt; *).
OOProg r =&gt;
Structure -&gt; ConstantRepr -&gt; SVariable r -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#inputVariable"><span class="hs-identifier hs-var">inputVariable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; Structure
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#inStruct"><span class="hs-identifier hs-var">inStruct</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679354251"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ConstantRepr
</span><a href="Language.Drasil.Choices.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; VSType r -&gt; SVariable r
forall (r :: * -&gt; *).
VariableSym r =&gt;
Name -&gt; VSType r -&gt; SVariable r
</span><span class="hs-identifier hs-var">var</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679354249"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">VSType r
</span><a href="#local-6989586621679354250"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679354249"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Name] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">(CodeDefinition -&gt; Name) -&gt; [CodeDefinition] -&gt; [Name]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">CodeDefinition -&gt; Name
forall c. CodeIdea c =&gt; c -&gt; Name
</span><span class="hs-identifier hs-var">codeName</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeSpec
</span><a href="#local-6989586621679354252"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">CodeSpec
-&gt; Getting [CodeDefinition] CodeSpec [CodeDefinition]
-&gt; [CodeDefinition]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting [CodeDefinition] CodeSpec [CodeDefinition]
forall c. HasOldCodeSpec c =&gt; Lens' c [CodeDefinition]
Lens' CodeSpec [CodeDefinition]
</span><a href="Language.Drasil.CodeSpec.html#constantsO"><span class="hs-identifier hs-var">constantsO</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ConstantStructure
-&gt; ConstantRepr -&gt; SVariable r -&gt; GenState (SVariable r)
forall (r :: * -&gt; *).
OOProg r =&gt;
ConstantStructure
-&gt; ConstantRepr -&gt; SVariable r -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#constVariable"><span class="hs-identifier hs-var">constVariable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; ConstantStructure
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#conStruct"><span class="hs-identifier hs-var">conStruct</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679354251"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; ConstantRepr
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#conRepr"><span class="hs-identifier hs-var">conRepr</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679354251"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>              </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConstantRepr -&gt; Name -&gt; VSType r -&gt; SVariable r
forall {r :: * -&gt; *}.
OOVariableSym r =&gt;
ConstantRepr -&gt; Name -&gt; VSType r -&gt; SVariable r
</span><a href="#local-6989586621679354267"><span class="hs-identifier hs-var">defFunc</span></a></span><span> </span><span class="annot"><span class="annottext">(ConstantRepr -&gt; Name -&gt; VSType r -&gt; SVariable r)
-&gt; ConstantRepr -&gt; Name -&gt; VSType r -&gt; SVariable r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; ConstantRepr
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#conRepr"><span class="hs-identifier hs-var">conRepr</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679354251"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679354249"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">VSType r
</span><a href="#local-6989586621679354250"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">SVariable r -&gt; GenState (SVariable r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SVariable r -&gt; GenState (SVariable r))
-&gt; SVariable r -&gt; GenState (SVariable r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; VSType r -&gt; SVariable r
forall (r :: * -&gt; *).
VariableSym r =&gt;
Name -&gt; VSType r -&gt; SVariable r
</span><span class="hs-identifier hs-var">var</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679354249"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">VSType r
</span><a href="#local-6989586621679354250"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span class="hs-comment">-- | If 'Unbundled' inputs, just return variable as-is.</span><span>
</span><span id="line-121"></span><span class="hs-comment">-- If 'Bundled' inputs, access variable through object, where the object is self</span><span>
</span><span id="line-122"></span><span class="hs-comment">-- if current module is InputParameters, 'inParams' otherwise.</span><span>
</span><span id="line-123"></span><span class="hs-comment">-- Final case is for when 'constVariable' calls inputVariable, when user chooses</span><span>
</span><span id="line-124"></span><span class="hs-comment">-- WithInputs for constant structure, inputs are 'Bundled', and constant</span><span>
</span><span id="line-125"></span><span class="hs-comment">-- representation is 'Const'. Variable should be accessed through class, so</span><span>
</span><span id="line-126"></span><span class="hs-comment">-- 'classVariable' is called.</span><span>
</span><span id="line-127"></span><span id="local-6989586621679353596"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#inputVariable"><span class="hs-identifier hs-type">inputVariable</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353596"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#Structure"><span class="hs-identifier hs-type">Structure</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#ConstantRepr"><span class="hs-identifier hs-type">ConstantRepr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SVariable</span></span><span> </span><span class="annot"><a href="#local-6989586621679353596"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-128"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SVariable</span></span><span> </span><span class="annot"><a href="#local-6989586621679353596"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-129"></span><span id="inputVariable"><span class="annot"><span class="annottext">inputVariable :: forall (r :: * -&gt; *).
OOProg r =&gt;
Structure -&gt; ConstantRepr -&gt; SVariable r -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#inputVariable"><span class="hs-identifier hs-var hs-var">inputVariable</span></a></span></span><span> </span><span class="annot"><span class="annottext">Structure
</span><a href="Language.Drasil.Choices.html#Unbundled"><span class="hs-identifier hs-var">Unbundled</span></a></span><span> </span><span class="annot"><span class="annottext">ConstantRepr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679354308"><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679354308"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SVariable r -&gt; StateT DrasilState Identity (SVariable r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679354308"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-130"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#inputVariable"><span class="hs-identifier hs-var">inputVariable</span></a></span><span> </span><span class="annot"><span class="annottext">Structure
</span><a href="Language.Drasil.Choices.html#Bundled"><span class="hs-identifier hs-var">Bundled</span></a></span><span> </span><span class="annot"><span class="annottext">ConstantRepr
</span><a href="Language.Drasil.Choices.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span id="local-6989586621679354309"><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679354309"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-131"></span><span>  </span><span id="local-6989586621679354310"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679354310"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-132"></span><span>  </span><span id="local-6989586621679354311"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679354311"><span class="hs-identifier hs-var">inClsName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">InternalConcept -&gt; GenState Name
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#genICName"><span class="hs-identifier hs-var">genICName</span></a></span><span> </span><span class="annot"><span class="annottext">InternalConcept
</span><a href="Language.Drasil.Choices.html#InputParameters"><span class="hs-identifier hs-var">InputParameters</span></a></span><span>
</span><span id="line-133"></span><span>  </span><span id="local-6989586621679354313"><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679354313"><span class="hs-identifier hs-var">ip</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input -&gt; StateT DrasilState Identity (SVariable r)
forall (r :: * -&gt; *). OOProg r =&gt; Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DefinedQuantityDict -&gt; Input
forall c. (Quantity c, MayHaveUnit c, Concept c) =&gt; c -&gt; Input
</span><a href="Language.Drasil.Chunk.CodeBase.html#quantvar"><span class="hs-identifier hs-var">quantvar</span></a></span><span> </span><span class="annot"><span class="annottext">DefinedQuantityDict
</span><a href="Language.Drasil.Code.CodeQuantityDicts.html#inParams"><span class="hs-identifier hs-var">inParams</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>  </span><span class="annot"><span class="annottext">SVariable r -&gt; StateT DrasilState Identity (SVariable r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SVariable r -&gt; StateT DrasilState Identity (SVariable r))
-&gt; SVariable r -&gt; StateT DrasilState Identity (SVariable r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; Name
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#currentClass"><span class="hs-identifier hs-var">currentClass</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679354310"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679354311"><span class="hs-identifier hs-var">inClsName</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">SVariable r -&gt; SVariable r
forall (r :: * -&gt; *). OOVariableSym r =&gt; SVariable r -&gt; SVariable r
</span><span class="hs-identifier hs-var">objVarSelf</span></span><span> </span><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679354309"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679354313"><span class="hs-identifier hs-var">ip</span></a></span><span> </span><span class="annot"><span class="annottext">SVariable r -&gt; SVariable r -&gt; SVariable r
forall (r :: * -&gt; *).
OOVariableSym r =&gt;
SVariable r -&gt; SVariable r -&gt; SVariable r
</span><span class="hs-operator hs-var">$-&gt;</span></span><span> </span><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679354309"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-135"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#inputVariable"><span class="hs-identifier hs-var">inputVariable</span></a></span><span> </span><span class="annot"><span class="annottext">Structure
</span><a href="Language.Drasil.Choices.html#Bundled"><span class="hs-identifier hs-var">Bundled</span></a></span><span> </span><span class="annot"><span class="annottext">ConstantRepr
</span><a href="Language.Drasil.Choices.html#Const"><span class="hs-identifier hs-var">Const</span></a></span><span> </span><span id="local-6989586621679354316"><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679354316"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-136"></span><span>  </span><span id="local-6989586621679354317"><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679354317"><span class="hs-identifier hs-var">ip</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input -&gt; StateT DrasilState Identity (SVariable r)
forall (r :: * -&gt; *). OOProg r =&gt; Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DefinedQuantityDict -&gt; Input
forall c. (Quantity c, MayHaveUnit c, Concept c) =&gt; c -&gt; Input
</span><a href="Language.Drasil.Chunk.CodeBase.html#quantvar"><span class="hs-identifier hs-var">quantvar</span></a></span><span> </span><span class="annot"><span class="annottext">DefinedQuantityDict
</span><a href="Language.Drasil.Code.CodeQuantityDicts.html#inParams"><span class="hs-identifier hs-var">inParams</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>  </span><span class="annot"><span class="annottext">SVariable r
-&gt; SVariable r -&gt; StateT DrasilState Identity (SVariable r)
forall (r :: * -&gt; *).
OOProg r =&gt;
SVariable r -&gt; SVariable r -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#classVariable"><span class="hs-identifier hs-var">classVariable</span></a></span><span> </span><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679354317"><span class="hs-identifier hs-var">ip</span></a></span><span> </span><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679354316"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span class="hs-comment">-- | If 'Unbundled' constants, just return variable as-is.</span><span>
</span><span id="line-140"></span><span class="hs-comment">-- If 'Bundled' constants and 'Var' constant representation, access variable</span><span>
</span><span id="line-141"></span><span class="hs-comment">-- through 'consts' object.</span><span>
</span><span id="line-142"></span><span class="hs-comment">-- If 'Bundled' constants and 'Const' constant representation, access variable</span><span>
</span><span id="line-143"></span><span class="hs-comment">-- through class, so call 'classVariable'.</span><span>
</span><span id="line-144"></span><span class="hs-comment">-- If constants stored 'WithInputs', call 'inputVariable'.</span><span>
</span><span id="line-145"></span><span class="hs-comment">-- If constants are 'Inline'd, the generator should not be attempting to make a</span><span>
</span><span id="line-146"></span><span class="hs-comment">-- variable for one of the constants.</span><span>
</span><span id="line-147"></span><span id="local-6989586621679353597"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#constVariable"><span class="hs-identifier hs-type">constVariable</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353597"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#ConstantStructure"><span class="hs-identifier hs-type">ConstantStructure</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#ConstantRepr"><span class="hs-identifier hs-type">ConstantRepr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-148"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">SVariable</span></span><span> </span><span class="annot"><a href="#local-6989586621679353597"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SVariable</span></span><span> </span><span class="annot"><a href="#local-6989586621679353597"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-149"></span><span id="constVariable"><span class="annot"><span class="annottext">constVariable :: forall (r :: * -&gt; *).
OOProg r =&gt;
ConstantStructure
-&gt; ConstantRepr -&gt; SVariable r -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#constVariable"><span class="hs-identifier hs-var hs-var">constVariable</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Choices.html#Store"><span class="hs-identifier hs-type">Store</span></a></span><span> </span><span class="annot"><span class="annottext">Structure
</span><a href="Language.Drasil.Choices.html#Unbundled"><span class="hs-identifier hs-var">Unbundled</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ConstantRepr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679354345"><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679354345"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SVariable r -&gt; StateT DrasilState Identity (SVariable r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679354345"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-150"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#constVariable"><span class="hs-identifier hs-var">constVariable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Choices.html#Store"><span class="hs-identifier hs-type">Store</span></a></span><span> </span><span class="annot"><span class="annottext">Structure
</span><a href="Language.Drasil.Choices.html#Bundled"><span class="hs-identifier hs-var">Bundled</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ConstantRepr
</span><a href="Language.Drasil.Choices.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span id="local-6989586621679354346"><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679354346"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-151"></span><span>  </span><span id="local-6989586621679354347"><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679354347"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input -&gt; StateT DrasilState Identity (SVariable r)
forall (r :: * -&gt; *). OOProg r =&gt; Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DefinedQuantityDict -&gt; Input
forall c. (Quantity c, MayHaveUnit c, Concept c) =&gt; c -&gt; Input
</span><a href="Language.Drasil.Chunk.CodeBase.html#quantvar"><span class="hs-identifier hs-var">quantvar</span></a></span><span> </span><span class="annot"><span class="annottext">DefinedQuantityDict
</span><a href="Language.Drasil.Code.CodeQuantityDicts.html#consts"><span class="hs-identifier hs-var">consts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span>  </span><span class="annot"><span class="annottext">SVariable r -&gt; StateT DrasilState Identity (SVariable r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SVariable r -&gt; StateT DrasilState Identity (SVariable r))
-&gt; SVariable r -&gt; StateT DrasilState Identity (SVariable r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679354347"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">SVariable r -&gt; SVariable r -&gt; SVariable r
forall (r :: * -&gt; *).
OOVariableSym r =&gt;
SVariable r -&gt; SVariable r -&gt; SVariable r
</span><span class="hs-operator hs-var">$-&gt;</span></span><span> </span><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679354346"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-153"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#constVariable"><span class="hs-identifier hs-var">constVariable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Choices.html#Store"><span class="hs-identifier hs-type">Store</span></a></span><span> </span><span class="annot"><span class="annottext">Structure
</span><a href="Language.Drasil.Choices.html#Bundled"><span class="hs-identifier hs-var">Bundled</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ConstantRepr
</span><a href="Language.Drasil.Choices.html#Const"><span class="hs-identifier hs-var">Const</span></a></span><span> </span><span id="local-6989586621679354348"><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679354348"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-154"></span><span>  </span><span id="local-6989586621679354349"><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679354349"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input -&gt; StateT DrasilState Identity (SVariable r)
forall (r :: * -&gt; *). OOProg r =&gt; Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DefinedQuantityDict -&gt; Input
forall c. (Quantity c, MayHaveUnit c, Concept c) =&gt; c -&gt; Input
</span><a href="Language.Drasil.Chunk.CodeBase.html#quantvar"><span class="hs-identifier hs-var">quantvar</span></a></span><span> </span><span class="annot"><span class="annottext">DefinedQuantityDict
</span><a href="Language.Drasil.Code.CodeQuantityDicts.html#consts"><span class="hs-identifier hs-var">consts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>  </span><span class="annot"><span class="annottext">SVariable r
-&gt; SVariable r -&gt; StateT DrasilState Identity (SVariable r)
forall (r :: * -&gt; *).
OOProg r =&gt;
SVariable r -&gt; SVariable r -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#classVariable"><span class="hs-identifier hs-var">classVariable</span></a></span><span> </span><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679354349"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679354348"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-156"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#constVariable"><span class="hs-identifier hs-var">constVariable</span></a></span><span> </span><span class="annot"><span class="annottext">ConstantStructure
</span><a href="Language.Drasil.Choices.html#WithInputs"><span class="hs-identifier hs-var">WithInputs</span></a></span><span> </span><span id="local-6989586621679354350"><span class="annot"><span class="annottext">ConstantRepr
</span><a href="#local-6989586621679354350"><span class="hs-identifier hs-var">cr</span></a></span></span><span> </span><span id="local-6989586621679354351"><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679354351"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-157"></span><span>  </span><span id="local-6989586621679354352"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679354352"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-158"></span><span>  </span><span class="annot"><span class="annottext">Structure
-&gt; ConstantRepr
-&gt; SVariable r
-&gt; StateT DrasilState Identity (SVariable r)
forall (r :: * -&gt; *).
OOProg r =&gt;
Structure -&gt; ConstantRepr -&gt; SVariable r -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#inputVariable"><span class="hs-identifier hs-var">inputVariable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; Structure
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#inStruct"><span class="hs-identifier hs-var">inStruct</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679354352"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ConstantRepr
</span><a href="#local-6989586621679354350"><span class="hs-identifier hs-var">cr</span></a></span><span> </span><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679354351"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-159"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#constVariable"><span class="hs-identifier hs-var">constVariable</span></a></span><span> </span><span class="annot"><span class="annottext">ConstantStructure
</span><a href="Language.Drasil.Choices.html#Inline"><span class="hs-identifier hs-var">Inline</span></a></span><span> </span><span class="annot"><span class="annottext">ConstantRepr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SVariable r
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; StateT DrasilState Identity (SVariable r)
forall a. HasCallStack =&gt; Name -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; StateT DrasilState Identity (SVariable r))
-&gt; Name -&gt; StateT DrasilState Identity (SVariable r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;mkVar called on a constant, but user &quot;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-160"></span><span>  </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;chose to Inline constants. Generator has a bug.&quot;</span></span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="hs-comment">-- | For generating GOOL for a variable that is accessed through a class.</span><span>
</span><span id="line-163"></span><span class="hs-comment">-- If the variable is not in the export map, then it is not a public class variable</span><span>
</span><span id="line-164"></span><span class="hs-comment">-- and cannot be accessed, so throw an error.</span><span>
</span><span id="line-165"></span><span class="hs-comment">-- If the variable is exported by the current module, use 'classVar'.</span><span>
</span><span id="line-166"></span><span class="hs-comment">-- If the variable is exported by a different module, use 'extClassVar'.</span><span>
</span><span id="line-167"></span><span id="local-6989586621679353613"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#classVariable"><span class="hs-identifier hs-type">classVariable</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353613"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SVariable</span></span><span> </span><span class="annot"><a href="#local-6989586621679353613"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SVariable</span></span><span> </span><span class="annot"><a href="#local-6989586621679353613"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-168"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SVariable</span></span><span> </span><span class="annot"><a href="#local-6989586621679353613"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-169"></span><span id="classVariable"><span class="annot"><span class="annottext">classVariable :: forall (r :: * -&gt; *).
OOProg r =&gt;
SVariable r -&gt; SVariable r -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#classVariable"><span class="hs-identifier hs-var hs-var">classVariable</span></a></span></span><span> </span><span id="local-6989586621679354380"><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679354380"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679354381"><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679354381"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-170"></span><span>  </span><span id="local-6989586621679354382"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679354382"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-171"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679354395"><span class="annot"><span class="annottext">checkCurrent :: Name -&gt; VSType r -&gt; SVariable r -&gt; SVariable r
</span><a href="#local-6989586621679354395"><span class="hs-identifier hs-var hs-var">checkCurrent</span></a></span></span><span> </span><span id="local-6989586621679354396"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679354396"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; Name
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#currentModule"><span class="hs-identifier hs-var">currentModule</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679354382"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679354396"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">VSType r -&gt; SVariable r -&gt; SVariable r
forall (r :: * -&gt; *).
OOVariableSym r =&gt;
VSType r -&gt; SVariable r -&gt; SVariable r
</span><span class="hs-identifier hs-var">classVar</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">VSType r -&gt; SVariable r -&gt; SVariable r
forall (r :: * -&gt; *).
OOVariableSym r =&gt;
VSType r -&gt; SVariable r -&gt; SVariable r
</span><span class="hs-identifier hs-var">extClassVar</span></span><span>
</span><span id="line-172"></span><span>  </span><span class="annot"><span class="annottext">SVariable r -&gt; GenState (SVariable r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SVariable r -&gt; GenState (SVariable r))
-&gt; SVariable r -&gt; GenState (SVariable r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-173"></span><span>    </span><span id="local-6989586621679354398"><span class="annot"><span class="annottext">r (Variable r)
</span><a href="#local-6989586621679354398"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679354381"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-174"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679354402"><span class="annot"><span class="annottext">nm :: Name
</span><a href="#local-6989586621679354402"><span class="hs-identifier hs-var hs-var">nm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r (Variable r) -&gt; Name
forall (r :: * -&gt; *). VariableElim r =&gt; r (Variable r) -&gt; Name
</span><span class="hs-identifier hs-var">variableName</span></span><span> </span><span class="annot"><span class="annottext">r (Variable r)
</span><a href="#local-6989586621679354398"><span class="hs-identifier hs-var">v'</span></a></span><span>
</span><span id="line-175"></span><span>    </span><span class="annot"><span class="annottext">(State ValueState (r (Type r)) -&gt; SVariable r -&gt; SVariable r)
-&gt; (Name
    -&gt; State ValueState (r (Type r)) -&gt; SVariable r -&gt; SVariable r)
-&gt; Maybe Name
-&gt; State ValueState (r (Type r))
-&gt; SVariable r
-&gt; SVariable r
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; State ValueState (r (Type r)) -&gt; SVariable r -&gt; SVariable r
forall a. HasCallStack =&gt; Name -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(Name
 -&gt; State ValueState (r (Type r)) -&gt; SVariable r -&gt; SVariable r)
-&gt; Name
-&gt; State ValueState (r (Type r))
-&gt; SVariable r
-&gt; SVariable r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Variable &quot;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679354402"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot; missing from export map&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-176"></span><span>      </span><span class="annot"><span class="annottext">Name -&gt; State ValueState (r (Type r)) -&gt; SVariable r -&gt; SVariable r
forall {r :: * -&gt; *}.
OOVariableSym r =&gt;
Name -&gt; VSType r -&gt; SVariable r -&gt; SVariable r
</span><a href="#local-6989586621679354395"><span class="hs-identifier hs-var">checkCurrent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Map Name Name -&gt; Maybe Name
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679354402"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; Map Name Name
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#eMap"><span class="hs-identifier hs-var">eMap</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679354382"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(r (Variable r) -&gt; r (Type r))
-&gt; SVariable r -&gt; State ValueState (r (Type r))
forall a b s. (a -&gt; b) -&gt; State s a -&gt; State s b
</span><span class="hs-identifier hs-var">onStateValue</span></span><span> </span><span class="annot"><span class="annottext">r (Variable r) -&gt; r (Type r)
forall (r :: * -&gt; *).
VariableElim r =&gt;
r (Variable r) -&gt; r (Type r)
</span><span class="hs-identifier hs-var">variableType</span></span><span> </span><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679354380"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679354381"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span class="annot"><span class="hs-comment">-- | Generates a GOOL Value for a variable represented by a 'CodeVarChunk'.</span></span><span>
</span><span id="line-179"></span><span id="local-6989586621679353633"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#mkVal"><span class="hs-identifier hs-type">mkVal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353633"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CodeVarChunk</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679353633"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-180"></span><span id="mkVal"><span class="annot"><span class="annottext">mkVal :: forall (r :: * -&gt; *). OOProg r =&gt; Input -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVal"><span class="hs-identifier hs-var hs-var">mkVal</span></a></span></span><span> </span><span id="local-6989586621679354416"><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679354416"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-181"></span><span>  </span><span id="local-6989586621679354417"><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679354417"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input -&gt; GenState CodeType
forall c. HasSpace c =&gt; c -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#codeType"><span class="hs-identifier hs-var">codeType</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679354416"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-182"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679354781"><span class="annot"><span class="annottext">toGOOLVal :: Maybe c -&gt; GenState (SValue r)
</span><a href="#local-6989586621679354781"><span class="hs-identifier hs-var hs-var">toGOOLVal</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe c
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UID -&gt; Name -&gt; VSType r -&gt; GenState (SValue r)
forall (r :: * -&gt; *).
OOProg r =&gt;
UID -&gt; Name -&gt; VSType r -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#value"><span class="hs-identifier hs-var">value</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679354416"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Input -&gt; Getting UID Input UID -&gt; UID
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting UID Input UID
forall c. HasUID c =&gt; Getter c UID
Getter Input UID
</span><span class="hs-identifier hs-var">uid</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input -&gt; Name
forall c. CodeIdea c =&gt; c -&gt; Name
</span><span class="hs-identifier hs-var">codeName</span></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679354416"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeType -&gt; VSType r
forall (r :: * -&gt; *). OOTypeSym r =&gt; CodeType -&gt; VSType r
</span><span class="hs-identifier hs-var">convTypeOO</span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679354417"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>      </span><span class="annot"><a href="#local-6989586621679354781"><span class="hs-identifier hs-var">toGOOLVal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679354783"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679354783"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-184"></span><span>        </span><span id="local-6989586621679354784"><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679354784"><span class="hs-identifier hs-var">ot</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">c -&gt; GenState CodeType
forall c. HasSpace c =&gt; c -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#codeType"><span class="hs-identifier hs-var">codeType</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679354783"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-185"></span><span>        </span><span class="annot"><span class="annottext">SValue r -&gt; GenState (SValue r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; GenState (SValue r))
-&gt; SValue r -&gt; GenState (SValue r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SVariable r -&gt; SValue r
forall (r :: * -&gt; *). VariableValue r =&gt; SVariable r -&gt; SValue r
</span><span class="hs-identifier hs-var">valueOf</span></span><span> </span><span class="annot"><span class="annottext">(SVariable r -&gt; SValue r) -&gt; SVariable r -&gt; SValue r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SVariable r -&gt; SVariable r -&gt; SVariable r
forall (r :: * -&gt; *).
OOVariableSym r =&gt;
SVariable r -&gt; SVariable r -&gt; SVariable r
</span><span class="hs-identifier hs-var">objVar</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; VSType r -&gt; SVariable r
forall (r :: * -&gt; *).
VariableSym r =&gt;
Name -&gt; VSType r -&gt; SVariable r
</span><span class="hs-identifier hs-var">var</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">c -&gt; Name
forall c. CodeIdea c =&gt; c -&gt; Name
</span><span class="hs-identifier hs-var">codeName</span></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679354783"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeType -&gt; VSType r
forall (r :: * -&gt; *). OOTypeSym r =&gt; CodeType -&gt; VSType r
</span><span class="hs-identifier hs-var">convTypeOO</span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679354784"><span class="hs-identifier hs-var">ot</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; VSType r -&gt; SVariable r
forall (r :: * -&gt; *).
VariableSym r =&gt;
Name -&gt; VSType r -&gt; SVariable r
</span><span class="hs-identifier hs-var">var</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input -&gt; Name
forall c. CodeIdea c =&gt; c -&gt; Name
</span><span class="hs-identifier hs-var">codeName</span></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679354416"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeType -&gt; VSType r
forall (r :: * -&gt; *). OOTypeSym r =&gt; CodeType -&gt; VSType r
</span><span class="hs-identifier hs-var">convTypeOO</span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679354417"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span>  </span><span class="annot"><span class="annottext">Maybe CodeChunk -&gt; GenState (SValue r)
forall {r :: * -&gt; *} {c}.
(OOProg r, HasSpace c, CodeIdea c) =&gt;
Maybe c -&gt; GenState (SValue r)
</span><a href="#local-6989586621679354781"><span class="hs-identifier hs-var">toGOOLVal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679354416"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Input
-&gt; Getting (Maybe CodeChunk) Input (Maybe CodeChunk)
-&gt; Maybe CodeChunk
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting (Maybe CodeChunk) Input (Maybe CodeChunk)
Lens' Input (Maybe CodeChunk)
</span><span class="hs-identifier hs-var">obv</span></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span class="annot"><span class="hs-comment">-- | Generates a GOOL Variable for a variable represented by a 'CodeVarChunk'.</span></span><span>
</span><span id="line-190"></span><span id="local-6989586621679353608"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-type">mkVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353608"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CodeVarChunk</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SVariable</span></span><span> </span><span class="annot"><a href="#local-6989586621679353608"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-191"></span><span id="mkVar"><span class="annot"><span class="annottext">mkVar :: forall (r :: * -&gt; *). OOProg r =&gt; Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var hs-var">mkVar</span></a></span></span><span> </span><span id="local-6989586621679354793"><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679354793"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-192"></span><span>  </span><span id="local-6989586621679354794"><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679354794"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input -&gt; GenState CodeType
forall c. HasSpace c =&gt; c -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#codeType"><span class="hs-identifier hs-var">codeType</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679354793"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-193"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679355101"><span class="annot"><span class="annottext">toGOOLVar :: Maybe c -&gt; GenState (SVariable r)
</span><a href="#local-6989586621679355101"><span class="hs-identifier hs-var hs-var">toGOOLVar</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe c
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; VSType r -&gt; GenState (SVariable r)
forall (r :: * -&gt; *).
OOProg r =&gt;
Name -&gt; VSType r -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#variable"><span class="hs-identifier hs-var">variable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input -&gt; Name
forall c. CodeIdea c =&gt; c -&gt; Name
</span><span class="hs-identifier hs-var">codeName</span></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679354793"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeType -&gt; VSType r
forall (r :: * -&gt; *). OOTypeSym r =&gt; CodeType -&gt; VSType r
</span><span class="hs-identifier hs-var">convTypeOO</span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679354794"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span>      </span><span class="annot"><a href="#local-6989586621679355101"><span class="hs-identifier hs-var">toGOOLVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679355102"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679355102"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-195"></span><span>        </span><span id="local-6989586621679355103"><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679355103"><span class="hs-identifier hs-var">ot</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">c -&gt; GenState CodeType
forall c. HasSpace c =&gt; c -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#codeType"><span class="hs-identifier hs-var">codeType</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679355102"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-196"></span><span>        </span><span class="annot"><span class="annottext">SVariable r -&gt; GenState (SVariable r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SVariable r -&gt; GenState (SVariable r))
-&gt; SVariable r -&gt; GenState (SVariable r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SVariable r -&gt; SVariable r -&gt; SVariable r
forall (r :: * -&gt; *).
OOVariableSym r =&gt;
SVariable r -&gt; SVariable r -&gt; SVariable r
</span><span class="hs-identifier hs-var">objVar</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; VSType r -&gt; SVariable r
forall (r :: * -&gt; *).
VariableSym r =&gt;
Name -&gt; VSType r -&gt; SVariable r
</span><span class="hs-identifier hs-var">var</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">c -&gt; Name
forall c. CodeIdea c =&gt; c -&gt; Name
</span><span class="hs-identifier hs-var">codeName</span></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679355102"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeType -&gt; VSType r
forall (r :: * -&gt; *). OOTypeSym r =&gt; CodeType -&gt; VSType r
</span><span class="hs-identifier hs-var">convTypeOO</span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679355103"><span class="hs-identifier hs-var">ot</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; VSType r -&gt; SVariable r
forall (r :: * -&gt; *).
VariableSym r =&gt;
Name -&gt; VSType r -&gt; SVariable r
</span><span class="hs-identifier hs-var">var</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input -&gt; Name
forall c. CodeIdea c =&gt; c -&gt; Name
</span><span class="hs-identifier hs-var">codeName</span></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679354793"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeType -&gt; VSType r
forall (r :: * -&gt; *). OOTypeSym r =&gt; CodeType -&gt; VSType r
</span><span class="hs-identifier hs-var">convTypeOO</span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679354794"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span>  </span><span class="annot"><span class="annottext">Maybe CodeChunk -&gt; GenState (SVariable r)
forall {r :: * -&gt; *} {c}.
(OOProg r, HasSpace c, CodeIdea c) =&gt;
Maybe c -&gt; GenState (SVariable r)
</span><a href="#local-6989586621679355101"><span class="hs-identifier hs-var">toGOOLVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679354793"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Input
-&gt; Getting (Maybe CodeChunk) Input (Maybe CodeChunk)
-&gt; Maybe CodeChunk
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting (Maybe CodeChunk) Input (Maybe CodeChunk)
Lens' Input (Maybe CodeChunk)
</span><span class="hs-identifier hs-var">obv</span></span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span class="annot"><span class="hs-comment">-- | Generates a GOOL Parameter for a parameter represented by a 'ParameterChunk'.</span></span><span>
</span><span id="line-201"></span><span id="local-6989586621679353704"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#mkParam"><span class="hs-identifier hs-type">mkParam</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353704"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Chunk.Parameter.html#ParameterChunk"><span class="hs-identifier hs-type">ParameterChunk</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MSParameter</span></span><span> </span><span class="annot"><a href="#local-6989586621679353704"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-202"></span><span id="mkParam"><span class="annot"><span class="annottext">mkParam :: forall (r :: * -&gt; *).
OOProg r =&gt;
ParameterChunk -&gt; GenState (MSParameter r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkParam"><span class="hs-identifier hs-var hs-var">mkParam</span></a></span></span><span> </span><span id="local-6989586621679355124"><span class="annot"><span class="annottext">ParameterChunk
</span><a href="#local-6989586621679355124"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-203"></span><span>  </span><span id="local-6989586621679355125"><span class="annot"><span class="annottext">VS (r (Variable r))
</span><a href="#local-6989586621679355125"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input -&gt; StateT DrasilState Identity (VS (r (Variable r)))
forall (r :: * -&gt; *). OOProg r =&gt; Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParameterChunk -&gt; Input
forall c. (Quantity c, MayHaveUnit c, Concept c) =&gt; c -&gt; Input
</span><a href="Language.Drasil.Chunk.CodeBase.html#quantvar"><span class="hs-identifier hs-var">quantvar</span></a></span><span> </span><span class="annot"><span class="annottext">ParameterChunk
</span><a href="#local-6989586621679355124"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span>  </span><span class="annot"><span class="annottext">MSParameter r -&gt; GenState (MSParameter r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSParameter r -&gt; GenState (MSParameter r))
-&gt; MSParameter r -&gt; GenState (MSParameter r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PassBy -&gt; VS (r (Variable r)) -&gt; MSParameter r
forall {r :: * -&gt; *}.
ParameterSym r =&gt;
PassBy -&gt; VS (r (Variable r)) -&gt; MS (r (Parameter r))
</span><a href="#local-6989586621679355126"><span class="hs-identifier hs-var">paramFunc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParameterChunk -&gt; PassBy
</span><a href="Language.Drasil.Chunk.Parameter.html#passBy"><span class="hs-identifier hs-var">passBy</span></a></span><span> </span><span class="annot"><span class="annottext">ParameterChunk
</span><a href="#local-6989586621679355124"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
</span><a href="#local-6989586621679355125"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-205"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679355126"><span class="annot"><span class="annottext">paramFunc :: PassBy -&gt; VS (r (Variable r)) -&gt; MS (r (Parameter r))
</span><a href="#local-6989586621679355126"><span class="hs-identifier hs-var hs-var">paramFunc</span></a></span></span><span> </span><span class="annot"><span class="annottext">PassBy
</span><a href="Language.Drasil.Chunk.Parameter.html#Ref"><span class="hs-identifier hs-var">Ref</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r)) -&gt; MS (r (Parameter r))
forall (r :: * -&gt; *).
ParameterSym r =&gt;
SVariable r -&gt; MSParameter r
</span><span class="hs-identifier hs-var">pointerParam</span></span><span>
</span><span id="line-206"></span><span>        </span><span class="annot"><a href="#local-6989586621679355126"><span class="hs-identifier hs-var">paramFunc</span></a></span><span> </span><span class="annot"><span class="annottext">PassBy
</span><a href="Language.Drasil.Chunk.Parameter.html#Val"><span class="hs-identifier hs-var">Val</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r)) -&gt; MS (r (Parameter r))
forall (r :: * -&gt; *).
ParameterSym r =&gt;
SVariable r -&gt; MSParameter r
</span><span class="hs-identifier hs-var">param</span></span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span class="annot"><span class="hs-comment">-- | Generates a public function.</span></span><span>
</span><span id="line-209"></span><span id="local-6989586621679353714"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#publicFunc"><span class="hs-identifier hs-type">publicFunc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353714"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Label</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VSType</span></span><span> </span><span class="annot"><a href="#local-6989586621679353714"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Description"><span class="hs-identifier hs-type">Description</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-210"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Chunk.Parameter.html#ParameterChunk"><span class="hs-identifier hs-type">ParameterChunk</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Description"><span class="hs-identifier hs-type">Description</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSBlock</span></span><span> </span><span class="annot"><a href="#local-6989586621679353714"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-211"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679353714"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-212"></span><span id="publicFunc"><span class="annot"><span class="annottext">publicFunc :: forall (r :: * -&gt; *).
OOProg r =&gt;
Name
-&gt; VSType r
-&gt; Name
-&gt; [ParameterChunk]
-&gt; Maybe Name
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#publicFunc"><span class="hs-identifier hs-var hs-var">publicFunc</span></a></span></span><span> </span><span id="local-6989586621679355149"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679355149"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679355150"><span class="annot"><span class="annottext">VSType r
</span><a href="#local-6989586621679355150"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679355151"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679355151"><span class="hs-identifier hs-var">desc</span></a></span></span><span> </span><span id="local-6989586621679355152"><span class="annot"><span class="annottext">[ParameterChunk]
</span><a href="#local-6989586621679355152"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621679355153"><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621679355153"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679355154"><span class="annot"><span class="annottext">[MSBlock r]
</span><a href="#local-6989586621679355154"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-213"></span><span>  </span><span class="annot"><span class="annottext">(DrasilState -&gt; DrasilState) -&gt; StateT DrasilState Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679355155"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679355155"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679355155"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#currentScope"><span class="hs-identifier hs-var">currentScope</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#Local"><span class="hs-identifier hs-type">Local</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-214"></span><span>  </span><span class="annot"><span class="annottext">([MSParameter r] -&gt; MSBody r -&gt; SMethod r)
-&gt; Name
-&gt; Name
-&gt; [ParameterChunk]
-&gt; Maybe Name
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
forall (r :: * -&gt; *).
OOProg r =&gt;
([MSParameter r] -&gt; MSBody r -&gt; SMethod r)
-&gt; Name
-&gt; Name
-&gt; [ParameterChunk]
-&gt; Maybe Name
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genMethod"><span class="hs-identifier hs-var">genMethod</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
-&gt; r (Visibility r)
-&gt; VSType r
-&gt; [MSParameter r]
-&gt; MSBody r
-&gt; SMethod r
forall (r :: * -&gt; *).
MethodSym r =&gt;
Name
-&gt; r (Visibility r)
-&gt; VSType r
-&gt; [MSParameter r]
-&gt; MSBody r
-&gt; SMethod r
</span><span class="hs-identifier hs-var">function</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679355149"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">r (Visibility r)
forall (r :: * -&gt; *). VisibilitySym r =&gt; r (Visibility r)
</span><span class="hs-identifier hs-var">public</span></span><span> </span><span class="annot"><span class="annottext">VSType r
</span><a href="#local-6989586621679355150"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679355149"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679355151"><span class="hs-identifier hs-var">desc</span></a></span><span> </span><span class="annot"><span class="annottext">[ParameterChunk]
</span><a href="#local-6989586621679355152"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621679355153"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">[MSBlock r]
</span><a href="#local-6989586621679355154"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span class="annot"><span class="hs-comment">-- | Generates a public method.</span></span><span>
</span><span id="line-217"></span><span id="local-6989586621679355161"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#publicMethod"><span class="hs-identifier hs-type">publicMethod</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679355161"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Label</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VSType</span></span><span> </span><span class="annot"><a href="#local-6989586621679355161"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Description"><span class="hs-identifier hs-type">Description</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-218"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Chunk.Parameter.html#ParameterChunk"><span class="hs-identifier hs-type">ParameterChunk</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Description"><span class="hs-identifier hs-type">Description</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSBlock</span></span><span> </span><span class="annot"><a href="#local-6989586621679355161"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-219"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679355161"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-220"></span><span id="publicMethod"><span class="annot"><span class="annottext">publicMethod :: forall (r :: * -&gt; *).
OOProg r =&gt;
Name
-&gt; VSType r
-&gt; Name
-&gt; [ParameterChunk]
-&gt; Maybe Name
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#publicMethod"><span class="hs-identifier hs-var hs-var">publicMethod</span></a></span></span><span> </span><span id="local-6989586621679355177"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679355177"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679355178"><span class="annot"><span class="annottext">VSType r
</span><a href="#local-6989586621679355178"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-221"></span><span>  </span><span class="annot"><span class="annottext">([MSParameter r] -&gt; MSBody r -&gt; SMethod r)
-&gt; Name
-&gt; Name
-&gt; [ParameterChunk]
-&gt; Maybe Name
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
forall (r :: * -&gt; *).
OOProg r =&gt;
([MSParameter r] -&gt; MSBody r -&gt; SMethod r)
-&gt; Name
-&gt; Name
-&gt; [ParameterChunk]
-&gt; Maybe Name
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genMethod"><span class="hs-identifier hs-var">genMethod</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
-&gt; r (Visibility r)
-&gt; r (Permanence r)
-&gt; VSType r
-&gt; [MSParameter r]
-&gt; MSBody r
-&gt; SMethod r
forall (r :: * -&gt; *).
OOMethodSym r =&gt;
Name
-&gt; r (Visibility r)
-&gt; r (Permanence r)
-&gt; VSType r
-&gt; [MSParameter r]
-&gt; MSBody r
-&gt; SMethod r
</span><span class="hs-identifier hs-var">method</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679355177"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">r (Visibility r)
forall (r :: * -&gt; *). VisibilitySym r =&gt; r (Visibility r)
</span><span class="hs-identifier hs-var">public</span></span><span> </span><span class="annot"><span class="annottext">r (Permanence r)
forall (r :: * -&gt; *). PermanenceSym r =&gt; r (Permanence r)
</span><span class="hs-keyword hs-var">dynamic</span></span><span> </span><span class="annot"><span class="annottext">VSType r
</span><a href="#local-6989586621679355178"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679355177"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span class="annot"><span class="hs-comment">-- | Generates a private method.</span></span><span>
</span><span id="line-224"></span><span id="local-6989586621679355181"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#privateMethod"><span class="hs-identifier hs-type">privateMethod</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679355181"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Label</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VSType</span></span><span> </span><span class="annot"><a href="#local-6989586621679355181"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Description"><span class="hs-identifier hs-type">Description</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-225"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Chunk.Parameter.html#ParameterChunk"><span class="hs-identifier hs-type">ParameterChunk</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Description"><span class="hs-identifier hs-type">Description</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSBlock</span></span><span> </span><span class="annot"><a href="#local-6989586621679355181"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-226"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679355181"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-227"></span><span id="privateMethod"><span class="annot"><span class="annottext">privateMethod :: forall (r :: * -&gt; *).
OOProg r =&gt;
Name
-&gt; VSType r
-&gt; Name
-&gt; [ParameterChunk]
-&gt; Maybe Name
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#privateMethod"><span class="hs-identifier hs-var hs-var">privateMethod</span></a></span></span><span> </span><span id="local-6989586621679355196"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679355196"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679355197"><span class="annot"><span class="annottext">VSType r
</span><a href="#local-6989586621679355197"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-228"></span><span>  </span><span class="annot"><span class="annottext">([MSParameter r] -&gt; MSBody r -&gt; SMethod r)
-&gt; Name
-&gt; Name
-&gt; [ParameterChunk]
-&gt; Maybe Name
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
forall (r :: * -&gt; *).
OOProg r =&gt;
([MSParameter r] -&gt; MSBody r -&gt; SMethod r)
-&gt; Name
-&gt; Name
-&gt; [ParameterChunk]
-&gt; Maybe Name
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genMethod"><span class="hs-identifier hs-var">genMethod</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
-&gt; r (Visibility r)
-&gt; r (Permanence r)
-&gt; VSType r
-&gt; [MSParameter r]
-&gt; MSBody r
-&gt; SMethod r
forall (r :: * -&gt; *).
OOMethodSym r =&gt;
Name
-&gt; r (Visibility r)
-&gt; r (Permanence r)
-&gt; VSType r
-&gt; [MSParameter r]
-&gt; MSBody r
-&gt; SMethod r
</span><span class="hs-identifier hs-var">method</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679355196"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">r (Visibility r)
forall (r :: * -&gt; *). VisibilitySym r =&gt; r (Visibility r)
</span><span class="hs-identifier hs-var">private</span></span><span> </span><span class="annot"><span class="annottext">r (Permanence r)
forall (r :: * -&gt; *). PermanenceSym r =&gt; r (Permanence r)
</span><span class="hs-keyword hs-var">dynamic</span></span><span> </span><span class="annot"><span class="annottext">VSType r
</span><a href="#local-6989586621679355197"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679355196"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span class="annot"><span class="hs-comment">-- | Generates a public function, defined by its inputs and outputs.</span></span><span>
</span><span id="line-231"></span><span id="local-6989586621679353729"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#publicInOutFunc"><span class="hs-identifier hs-type">publicInOutFunc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353729"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Label</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Description"><span class="hs-identifier hs-type">Description</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">CodeVarChunk</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-232"></span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">CodeVarChunk</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSBlock</span></span><span> </span><span class="annot"><a href="#local-6989586621679353729"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679353729"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-233"></span><span id="publicInOutFunc"><span class="annot"><span class="annottext">publicInOutFunc :: forall (r :: * -&gt; *).
OOProg r =&gt;
Name
-&gt; Name
-&gt; [Input]
-&gt; [Input]
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#publicInOutFunc"><span class="hs-identifier hs-var hs-var">publicInOutFunc</span></a></span></span><span> </span><span id="local-6989586621679355208"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679355208"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([SVariable r]
 -&gt; [SVariable r]
 -&gt; [SVariable r]
 -&gt; MSBody r
 -&gt; StateT MethodState Identity (r (Method r)))
-&gt; (Name
    -&gt; [(Name, SVariable r)]
    -&gt; [(Name, SVariable r)]
    -&gt; [(Name, SVariable r)]
    -&gt; MSBody r
    -&gt; StateT MethodState Identity (r (Method r)))
-&gt; Name
-&gt; Name
-&gt; [Input]
-&gt; [Input]
-&gt; [StateT MethodState Identity (r (Block r))]
-&gt; StateT
     DrasilState Identity (StateT MethodState Identity (r (Method r)))
forall (r :: * -&gt; *).
OOProg r =&gt;
([SVariable r]
 -&gt; [SVariable r] -&gt; [SVariable r] -&gt; MSBody r -&gt; SMethod r)
-&gt; (Name
    -&gt; [(Name, SVariable r)]
    -&gt; [(Name, SVariable r)]
    -&gt; [(Name, SVariable r)]
    -&gt; MSBody r
    -&gt; SMethod r)
-&gt; Name
-&gt; Name
-&gt; [Input]
-&gt; [Input]
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genInOutFunc"><span class="hs-identifier hs-var">genInOutFunc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
-&gt; r (Visibility r)
-&gt; [SVariable r]
-&gt; [SVariable r]
-&gt; [SVariable r]
-&gt; MSBody r
-&gt; StateT MethodState Identity (r (Method r))
forall (r :: * -&gt; *).
MethodSym r =&gt;
Name -&gt; r (Visibility r) -&gt; InOutFunc r
</span><span class="hs-identifier hs-var">inOutFunc</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679355208"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">r (Visibility r)
forall (r :: * -&gt; *). VisibilitySym r =&gt; r (Visibility r)
</span><span class="hs-identifier hs-var">public</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
-&gt; r (Visibility r)
-&gt; Name
-&gt; [(Name, SVariable r)]
-&gt; [(Name, SVariable r)]
-&gt; [(Name, SVariable r)]
-&gt; MSBody r
-&gt; StateT MethodState Identity (r (Method r))
forall (r :: * -&gt; *).
MethodSym r =&gt;
Name -&gt; r (Visibility r) -&gt; DocInOutFunc r
</span><span class="hs-identifier hs-var">docInOutFunc</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679355208"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">r (Visibility r)
forall (r :: * -&gt; *). VisibilitySym r =&gt; r (Visibility r)
</span><span class="hs-identifier hs-var">public</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679355208"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-234"></span><span>
</span><span id="line-235"></span><span class="annot"><span class="hs-comment">-- | Generates a private method, defined by its inputs and outputs.</span></span><span>
</span><span id="line-236"></span><span id="local-6989586621679355212"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#privateInOutMethod"><span class="hs-identifier hs-type">privateInOutMethod</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679355212"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Label</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Description"><span class="hs-identifier hs-type">Description</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">CodeVarChunk</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-237"></span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">CodeVarChunk</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSBlock</span></span><span> </span><span class="annot"><a href="#local-6989586621679355212"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679355212"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-238"></span><span id="privateInOutMethod"><span class="annot"><span class="annottext">privateInOutMethod :: forall (r :: * -&gt; *).
OOProg r =&gt;
Name
-&gt; Name
-&gt; [Input]
-&gt; [Input]
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#privateInOutMethod"><span class="hs-identifier hs-var hs-var">privateInOutMethod</span></a></span></span><span> </span><span id="local-6989586621679355230"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679355230"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([SVariable r]
 -&gt; [SVariable r]
 -&gt; [SVariable r]
 -&gt; MSBody r
 -&gt; StateT MethodState Identity (r (Method r)))
-&gt; (Name
    -&gt; [(Name, SVariable r)]
    -&gt; [(Name, SVariable r)]
    -&gt; [(Name, SVariable r)]
    -&gt; MSBody r
    -&gt; StateT MethodState Identity (r (Method r)))
-&gt; Name
-&gt; Name
-&gt; [Input]
-&gt; [Input]
-&gt; [StateT MethodState Identity (r (Block r))]
-&gt; StateT
     DrasilState Identity (StateT MethodState Identity (r (Method r)))
forall (r :: * -&gt; *).
OOProg r =&gt;
([SVariable r]
 -&gt; [SVariable r] -&gt; [SVariable r] -&gt; MSBody r -&gt; SMethod r)
-&gt; (Name
    -&gt; [(Name, SVariable r)]
    -&gt; [(Name, SVariable r)]
    -&gt; [(Name, SVariable r)]
    -&gt; MSBody r
    -&gt; SMethod r)
-&gt; Name
-&gt; Name
-&gt; [Input]
-&gt; [Input]
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genInOutFunc"><span class="hs-identifier hs-var">genInOutFunc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
-&gt; r (Visibility r)
-&gt; r (Permanence r)
-&gt; [SVariable r]
-&gt; [SVariable r]
-&gt; [SVariable r]
-&gt; MSBody r
-&gt; StateT MethodState Identity (r (Method r))
forall (r :: * -&gt; *).
OOMethodSym r =&gt;
Name -&gt; r (Visibility r) -&gt; r (Permanence r) -&gt; InOutFunc r
</span><span class="hs-identifier hs-var">inOutMethod</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679355230"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">r (Visibility r)
forall (r :: * -&gt; *). VisibilitySym r =&gt; r (Visibility r)
</span><span class="hs-identifier hs-var">private</span></span><span> </span><span class="annot"><span class="annottext">r (Permanence r)
forall (r :: * -&gt; *). PermanenceSym r =&gt; r (Permanence r)
</span><span class="hs-keyword hs-var">dynamic</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
-&gt; r (Visibility r)
-&gt; r (Permanence r)
-&gt; Name
-&gt; [(Name, SVariable r)]
-&gt; [(Name, SVariable r)]
-&gt; [(Name, SVariable r)]
-&gt; MSBody r
-&gt; StateT MethodState Identity (r (Method r))
forall (r :: * -&gt; *).
OOMethodSym r =&gt;
Name -&gt; r (Visibility r) -&gt; r (Permanence r) -&gt; DocInOutFunc r
</span><span class="hs-identifier hs-var">docInOutMethod</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679355230"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">r (Visibility r)
forall (r :: * -&gt; *). VisibilitySym r =&gt; r (Visibility r)
</span><span class="hs-identifier hs-var">private</span></span><span> </span><span class="annot"><span class="annottext">r (Permanence r)
forall (r :: * -&gt; *). PermanenceSym r =&gt; r (Permanence r)
</span><span class="hs-keyword hs-var">dynamic</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679355230"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span class="annot"><span class="hs-comment">-- | Generates a constructor.</span></span><span>
</span><span id="line-241"></span><span id="local-6989586621679353738"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#genConstructor"><span class="hs-identifier hs-type">genConstructor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353738"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Label</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Description"><span class="hs-identifier hs-type">Description</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Chunk.Parameter.html#ParameterChunk"><span class="hs-identifier hs-type">ParameterChunk</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-242"></span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSBlock</span></span><span> </span><span class="annot"><a href="#local-6989586621679353738"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679353738"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-243"></span><span id="genConstructor"><span class="annot"><span class="annottext">genConstructor :: forall (r :: * -&gt; *).
OOProg r =&gt;
Name
-&gt; Name -&gt; [ParameterChunk] -&gt; [MSBlock r] -&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genConstructor"><span class="hs-identifier hs-var hs-var">genConstructor</span></a></span></span><span> </span><span id="local-6989586621679355241"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679355241"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679355242"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679355242"><span class="hs-identifier hs-var">desc</span></a></span></span><span> </span><span id="local-6989586621679355243"><span class="annot"><span class="annottext">[ParameterChunk]
</span><a href="#local-6989586621679355243"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-244"></span><span>  </span><span class="annot"><span class="annottext">([MSParameter r] -&gt; MSBody r -&gt; SMethod r)
-&gt; Name
-&gt; Name
-&gt; [ParameterChunk]
-&gt; Maybe Name
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
forall (r :: * -&gt; *).
OOProg r =&gt;
([MSParameter r] -&gt; MSBody r -&gt; SMethod r)
-&gt; Name
-&gt; Name
-&gt; [ParameterChunk]
-&gt; Maybe Name
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genMethod"><span class="hs-identifier hs-var">genMethod</span></a></span><span> </span><span class="annot"><span class="annottext">[MSParameter r] -&gt; MSBody r -&gt; SMethod r
forall (r :: * -&gt; *).
OOMethodSym r =&gt;
[MSParameter r] -&gt; MSBody r -&gt; SMethod r
</span><span class="hs-identifier hs-var">nonInitConstructor</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679355241"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679355242"><span class="hs-identifier hs-var">desc</span></a></span><span> </span><span class="annot"><span class="annottext">[ParameterChunk]
</span><a href="#local-6989586621679355243"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Name
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span class="annot"><span class="hs-comment">-- | Generates a constructor that includes initialization of variables.</span></span><span>
</span><span id="line-247"></span><span id="local-6989586621679353741"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#genInitConstructor"><span class="hs-identifier hs-type">genInitConstructor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353741"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Label</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Description"><span class="hs-identifier hs-type">Description</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Chunk.Parameter.html#ParameterChunk"><span class="hs-identifier hs-type">ParameterChunk</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-248"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Initializers</span></span><span> </span><span class="annot"><a href="#local-6989586621679353741"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSBlock</span></span><span> </span><span class="annot"><a href="#local-6989586621679353741"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679353741"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-249"></span><span id="genInitConstructor"><span class="annot"><span class="annottext">genInitConstructor :: forall (r :: * -&gt; *).
OOProg r =&gt;
Name
-&gt; Name
-&gt; [ParameterChunk]
-&gt; Initializers r
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genInitConstructor"><span class="hs-identifier hs-var hs-var">genInitConstructor</span></a></span></span><span> </span><span id="local-6989586621679355253"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679355253"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679355254"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679355254"><span class="hs-identifier hs-var">desc</span></a></span></span><span> </span><span id="local-6989586621679355255"><span class="annot"><span class="annottext">[ParameterChunk]
</span><a href="#local-6989586621679355255"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679355256"><span class="annot"><span class="annottext">Initializers r
</span><a href="#local-6989586621679355256"><span class="hs-identifier hs-var">is</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([MSParameter r]
 -&gt; MSBody r -&gt; StateT MethodState Identity (r (Method r)))
-&gt; Name
-&gt; Name
-&gt; [ParameterChunk]
-&gt; Maybe Name
-&gt; [StateT MethodState Identity (r (Block r))]
-&gt; StateT
     DrasilState Identity (StateT MethodState Identity (r (Method r)))
forall (r :: * -&gt; *).
OOProg r =&gt;
([MSParameter r] -&gt; MSBody r -&gt; SMethod r)
-&gt; Name
-&gt; Name
-&gt; [ParameterChunk]
-&gt; Maybe Name
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genMethod"><span class="hs-identifier hs-var">genMethod</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MSParameter r]
-&gt; Initializers r
-&gt; MSBody r
-&gt; StateT MethodState Identity (r (Method r))
forall (r :: * -&gt; *).
OOMethodSym r =&gt;
[MSParameter r] -&gt; Initializers r -&gt; MSBody r -&gt; SMethod r
</span><span class="hs-operator hs-var">`constructor`</span></span><span> </span><span class="annot"><span class="annottext">Initializers r
</span><a href="#local-6989586621679355256"><span class="hs-identifier hs-var">is</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679355253"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679355254"><span class="hs-identifier hs-var">desc</span></a></span><span> </span><span class="annot"><span class="annottext">[ParameterChunk]
</span><a href="#local-6989586621679355255"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-250"></span><span>  </span><span class="annot"><span class="annottext">Maybe Name
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span class="hs-comment">-- | Generates a function or method using the passed GOOL constructor. Other</span><span>
</span><span id="line-253"></span><span class="hs-comment">-- parameters are the method's name, description, list of parameters,</span><span>
</span><span id="line-254"></span><span class="hs-comment">-- description of what is returned (if applicable), and body.</span><span>
</span><span id="line-255"></span><span id="local-6989586621679353722"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#genMethod"><span class="hs-identifier hs-type">genMethod</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353722"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSParameter</span></span><span> </span><span class="annot"><a href="#local-6989586621679353722"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MSBody</span></span><span> </span><span class="annot"><a href="#local-6989586621679353722"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679353722"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-256"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Label</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Description"><span class="hs-identifier hs-type">Description</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Chunk.Parameter.html#ParameterChunk"><span class="hs-identifier hs-type">ParameterChunk</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Description"><span class="hs-identifier hs-type">Description</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSBlock</span></span><span> </span><span class="annot"><a href="#local-6989586621679353722"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-257"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679353722"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-258"></span><span id="genMethod"><span class="annot"><span class="annottext">genMethod :: forall (r :: * -&gt; *).
OOProg r =&gt;
([MSParameter r] -&gt; MSBody r -&gt; SMethod r)
-&gt; Name
-&gt; Name
-&gt; [ParameterChunk]
-&gt; Maybe Name
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genMethod"><span class="hs-identifier hs-var hs-var">genMethod</span></a></span></span><span> </span><span id="local-6989586621679355290"><span class="annot"><span class="annottext">[MSParameter r] -&gt; MSBody r -&gt; SMethod r
</span><a href="#local-6989586621679355290"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679355291"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679355291"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679355292"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679355292"><span class="hs-identifier hs-var">desc</span></a></span></span><span> </span><span id="local-6989586621679355293"><span class="annot"><span class="annottext">[ParameterChunk]
</span><a href="#local-6989586621679355293"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679355294"><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621679355294"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679355295"><span class="annot"><span class="annottext">[MSBlock r]
</span><a href="#local-6989586621679355295"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-259"></span><span>  </span><span id="local-6989586621679355296"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679355296"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-260"></span><span>  </span><span id="local-6989586621679355297"><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679355297"><span class="hs-identifier hs-var">vars</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ParameterChunk
 -&gt; StateT DrasilState Identity (VS (r (Variable r))))
-&gt; [ParameterChunk]
-&gt; StateT DrasilState Identity [VS (r (Variable r))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input -&gt; StateT DrasilState Identity (VS (r (Variable r)))
forall (r :: * -&gt; *). OOProg r =&gt; Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="annot"><span class="annottext">(Input -&gt; StateT DrasilState Identity (VS (r (Variable r))))
-&gt; (ParameterChunk -&gt; Input)
-&gt; ParameterChunk
-&gt; StateT DrasilState Identity (VS (r (Variable r)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ParameterChunk -&gt; Input
forall c. (Quantity c, MayHaveUnit c, Concept c) =&gt; c -&gt; Input
</span><a href="Language.Drasil.Chunk.CodeBase.html#quantvar"><span class="hs-identifier hs-var">quantvar</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ParameterChunk]
</span><a href="#local-6989586621679355293"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-261"></span><span>  </span><span id="local-6989586621679355299"><span class="annot"><span class="annottext">[MSParameter r]
</span><a href="#local-6989586621679355299"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ParameterChunk -&gt; StateT DrasilState Identity (MSParameter r))
-&gt; [ParameterChunk] -&gt; StateT DrasilState Identity [MSParameter r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">ParameterChunk -&gt; StateT DrasilState Identity (MSParameter r)
forall (r :: * -&gt; *).
OOProg r =&gt;
ParameterChunk -&gt; GenState (MSParameter r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkParam"><span class="hs-identifier hs-var">mkParam</span></a></span><span> </span><span class="annot"><span class="annottext">[ParameterChunk]
</span><a href="#local-6989586621679355293"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-262"></span><span>  </span><span id="local-6989586621679355300"><span class="annot"><span class="annottext">MSBody r
</span><a href="#local-6989586621679355300"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; [VS (r (Variable r))]
-&gt; [MSBlock r]
-&gt; StateT DrasilState Identity (MSBody r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
Name -&gt; [SVariable r] -&gt; [MSBlock r] -&gt; GenState (MSBody r)
</span><a href="Language.Drasil.Code.Imperative.Logging.html#logBody"><span class="hs-identifier hs-var">logBody</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679355291"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679355297"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="annot"><span class="annottext">[MSBlock r]
</span><a href="#local-6989586621679355295"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-263"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679355301"><span class="annot"><span class="annottext">fn :: SMethod r
</span><a href="#local-6989586621679355301"><span class="hs-identifier hs-var hs-var">fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[MSParameter r] -&gt; MSBody r -&gt; SMethod r
</span><a href="#local-6989586621679355290"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[MSParameter r]
</span><a href="#local-6989586621679355299"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">MSBody r
</span><a href="#local-6989586621679355300"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-264"></span><span>  </span><span id="local-6989586621679355302"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679355302"><span class="hs-identifier hs-var">pComms</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ParameterChunk -&gt; GenState Name)
-&gt; [ParameterChunk] -&gt; StateT DrasilState Identity [Name]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">ParameterChunk -&gt; GenState Name
forall c. CodeIdea c =&gt; c -&gt; GenState Name
</span><a href="Language.Drasil.Code.Imperative.Comments.html#getCommentBrief"><span class="hs-identifier hs-var">getCommentBrief</span></a></span><span> </span><span class="annot"><span class="annottext">[ParameterChunk]
</span><a href="#local-6989586621679355293"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-265"></span><span>  </span><span class="annot"><span class="annottext">SMethod r -&gt; GenState (SMethod r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SMethod r -&gt; GenState (SMethod r))
-&gt; SMethod r -&gt; GenState (SMethod r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Comments
</span><a href="Language.Drasil.Choices.html#CommentFunc"><span class="hs-identifier hs-var">CommentFunc</span></a></span><span> </span><span class="annot"><span class="annottext">Comments -&gt; [Comments] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; [Comments]
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#commented"><span class="hs-identifier hs-var">commented</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679355296"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-266"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Name] -&gt; Maybe Name -&gt; SMethod r -&gt; SMethod r
forall (r :: * -&gt; *).
MethodSym r =&gt;
Name -&gt; [Name] -&gt; Maybe Name -&gt; SMethod r -&gt; SMethod r
</span><span class="hs-identifier hs-var">docFunc</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679355292"><span class="hs-identifier hs-var">desc</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679355302"><span class="hs-identifier hs-var">pComms</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621679355294"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">SMethod r
</span><a href="#local-6989586621679355301"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">SMethod r
</span><a href="#local-6989586621679355301"><span class="hs-identifier hs-var">fn</span></a></span><span>
</span><span id="line-267"></span><span>
</span><span id="line-268"></span><span class="hs-comment">-- | Generates a function or method defined by its inputs and outputs.</span><span>
</span><span id="line-269"></span><span class="hs-comment">-- Parameters are: the GOOL constructor to use, the equivalent GOOL constructor</span><span>
</span><span id="line-270"></span><span class="hs-comment">-- for a documented function/method, the visibility, permanence, name, description,</span><span>
</span><span id="line-271"></span><span class="hs-comment">-- list of inputs, list of outputs, and body.</span><span>
</span><span id="line-272"></span><span id="local-6989586621679353734"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#genInOutFunc"><span class="hs-identifier hs-type">genInOutFunc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353734"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">SVariable</span></span><span> </span><span class="annot"><a href="#local-6989586621679353734"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">SVariable</span></span><span> </span><span class="annot"><a href="#local-6989586621679353734"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-273"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">SVariable</span></span><span> </span><span class="annot"><a href="#local-6989586621679353734"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MSBody</span></span><span> </span><span class="annot"><a href="#local-6989586621679353734"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679353734"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-274"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SVariable</span></span><span> </span><span class="annot"><a href="#local-6989586621679353734"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SVariable</span></span><span> </span><span class="annot"><a href="#local-6989586621679353734"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-275"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SVariable</span></span><span> </span><span class="annot"><a href="#local-6989586621679353734"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MSBody</span></span><span> </span><span class="annot"><a href="#local-6989586621679353734"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679353734"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-276"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Label</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Description"><span class="hs-identifier hs-type">Description</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">CodeVarChunk</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">CodeVarChunk</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-277"></span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSBlock</span></span><span> </span><span class="annot"><a href="#local-6989586621679353734"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679353734"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-278"></span><span id="genInOutFunc"><span class="annot"><span class="annottext">genInOutFunc :: forall (r :: * -&gt; *).
OOProg r =&gt;
([SVariable r]
 -&gt; [SVariable r] -&gt; [SVariable r] -&gt; MSBody r -&gt; SMethod r)
-&gt; (Name
    -&gt; [(Name, SVariable r)]
    -&gt; [(Name, SVariable r)]
    -&gt; [(Name, SVariable r)]
    -&gt; MSBody r
    -&gt; SMethod r)
-&gt; Name
-&gt; Name
-&gt; [Input]
-&gt; [Input]
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genInOutFunc"><span class="hs-identifier hs-var hs-var">genInOutFunc</span></a></span></span><span> </span><span id="local-6989586621679355341"><span class="annot"><span class="annottext">[SVariable r]
-&gt; [SVariable r] -&gt; [SVariable r] -&gt; MSBody r -&gt; SMethod r
</span><a href="#local-6989586621679355341"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679355342"><span class="annot"><span class="annottext">Name
-&gt; [(Name, SVariable r)]
-&gt; [(Name, SVariable r)]
-&gt; [(Name, SVariable r)]
-&gt; MSBody r
-&gt; SMethod r
</span><a href="#local-6989586621679355342"><span class="hs-identifier hs-var">docf</span></a></span></span><span> </span><span id="local-6989586621679355343"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679355343"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679355344"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679355344"><span class="hs-identifier hs-var">desc</span></a></span></span><span> </span><span id="local-6989586621679355345"><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679355345"><span class="hs-identifier hs-var">ins'</span></a></span></span><span> </span><span id="local-6989586621679355346"><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679355346"><span class="hs-identifier hs-var">outs'</span></a></span></span><span> </span><span id="local-6989586621679355347"><span class="annot"><span class="annottext">[MSBlock r]
</span><a href="#local-6989586621679355347"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-279"></span><span>  </span><span id="local-6989586621679355348"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679355348"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-280"></span><span>  </span><span class="annot"><span class="annottext">(DrasilState -&gt; DrasilState) -&gt; StateT DrasilState Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679355349"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679355349"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679355349"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#currentScope"><span class="hs-identifier hs-var">currentScope</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#Local"><span class="hs-identifier hs-type">Local</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-281"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679355352"><span class="annot"><span class="annottext">ins :: [Input]
</span><a href="#local-6989586621679355352"><span class="hs-identifier hs-var hs-var">ins</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679355345"><span class="hs-identifier hs-var">ins'</span></a></span><span> </span><span class="annot"><span class="annottext">[Input] -&gt; [Input] -&gt; [Input]
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">\\</span></span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679355346"><span class="hs-identifier hs-var">outs'</span></a></span><span>
</span><span id="line-282"></span><span>      </span><span id="local-6989586621679355354"><span class="annot"><span class="annottext">outs :: [Input]
</span><a href="#local-6989586621679355354"><span class="hs-identifier hs-var hs-var">outs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679355346"><span class="hs-identifier hs-var">outs'</span></a></span><span> </span><span class="annot"><span class="annottext">[Input] -&gt; [Input] -&gt; [Input]
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">\\</span></span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679355345"><span class="hs-identifier hs-var">ins'</span></a></span><span>
</span><span id="line-283"></span><span>      </span><span id="local-6989586621679355356"><span class="annot"><span class="annottext">both :: [Input]
</span><a href="#local-6989586621679355356"><span class="hs-identifier hs-var hs-var">both</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679355345"><span class="hs-identifier hs-var">ins'</span></a></span><span> </span><span class="annot"><span class="annottext">[Input] -&gt; [Input] -&gt; [Input]
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">`intersect`</span></span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679355346"><span class="hs-identifier hs-var">outs'</span></a></span><span>
</span><span id="line-284"></span><span>  </span><span id="local-6989586621679355357"><span class="annot"><span class="annottext">[SVariable r]
</span><a href="#local-6989586621679355357"><span class="hs-identifier hs-var">inVs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Input -&gt; StateT DrasilState Identity (SVariable r))
-&gt; [Input] -&gt; StateT DrasilState Identity [SVariable r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Input -&gt; StateT DrasilState Identity (SVariable r)
forall (r :: * -&gt; *). OOProg r =&gt; Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679355352"><span class="hs-identifier hs-var">ins</span></a></span><span>
</span><span id="line-285"></span><span>  </span><span id="local-6989586621679355358"><span class="annot"><span class="annottext">[SVariable r]
</span><a href="#local-6989586621679355358"><span class="hs-identifier hs-var">outVs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Input -&gt; StateT DrasilState Identity (SVariable r))
-&gt; [Input] -&gt; StateT DrasilState Identity [SVariable r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Input -&gt; StateT DrasilState Identity (SVariable r)
forall (r :: * -&gt; *). OOProg r =&gt; Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679355354"><span class="hs-identifier hs-var">outs</span></a></span><span>
</span><span id="line-286"></span><span>  </span><span id="local-6989586621679355359"><span class="annot"><span class="annottext">[SVariable r]
</span><a href="#local-6989586621679355359"><span class="hs-identifier hs-var">bothVs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Input -&gt; StateT DrasilState Identity (SVariable r))
-&gt; [Input] -&gt; StateT DrasilState Identity [SVariable r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Input -&gt; StateT DrasilState Identity (SVariable r)
forall (r :: * -&gt; *). OOProg r =&gt; Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679355356"><span class="hs-identifier hs-var">both</span></a></span><span>
</span><span id="line-287"></span><span>  </span><span id="local-6989586621679355360"><span class="annot"><span class="annottext">MSBody r
</span><a href="#local-6989586621679355360"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; [SVariable r]
-&gt; [MSBlock r]
-&gt; StateT DrasilState Identity (MSBody r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
Name -&gt; [SVariable r] -&gt; [MSBlock r] -&gt; GenState (MSBody r)
</span><a href="Language.Drasil.Code.Imperative.Logging.html#logBody"><span class="hs-identifier hs-var">logBody</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679355343"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SVariable r]
</span><a href="#local-6989586621679355359"><span class="hs-identifier hs-var">bothVs</span></a></span><span> </span><span class="annot"><span class="annottext">[SVariable r] -&gt; [SVariable r] -&gt; [SVariable r]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[SVariable r]
</span><a href="#local-6989586621679355357"><span class="hs-identifier hs-var">inVs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[MSBlock r]
</span><a href="#local-6989586621679355347"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-288"></span><span>  </span><span id="local-6989586621679355361"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679355361"><span class="hs-identifier hs-var">pComms</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Input -&gt; GenState Name)
-&gt; [Input] -&gt; StateT DrasilState Identity [Name]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Input -&gt; GenState Name
forall c. CodeIdea c =&gt; c -&gt; GenState Name
</span><a href="Language.Drasil.Code.Imperative.Comments.html#getCommentBrief"><span class="hs-identifier hs-var">getCommentBrief</span></a></span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679355352"><span class="hs-identifier hs-var">ins</span></a></span><span>
</span><span id="line-289"></span><span>  </span><span id="local-6989586621679355362"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679355362"><span class="hs-identifier hs-var">oComms</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Input -&gt; GenState Name)
-&gt; [Input] -&gt; StateT DrasilState Identity [Name]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Input -&gt; GenState Name
forall c. CodeIdea c =&gt; c -&gt; GenState Name
</span><a href="Language.Drasil.Code.Imperative.Comments.html#getCommentBrief"><span class="hs-identifier hs-var">getCommentBrief</span></a></span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679355354"><span class="hs-identifier hs-var">outs</span></a></span><span>
</span><span id="line-290"></span><span>  </span><span id="local-6989586621679355363"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679355363"><span class="hs-identifier hs-var">bComms</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Input -&gt; GenState Name)
-&gt; [Input] -&gt; StateT DrasilState Identity [Name]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Input -&gt; GenState Name
forall c. CodeIdea c =&gt; c -&gt; GenState Name
</span><a href="Language.Drasil.Code.Imperative.Comments.html#getCommentBrief"><span class="hs-identifier hs-var">getCommentBrief</span></a></span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679355356"><span class="hs-identifier hs-var">both</span></a></span><span>
</span><span id="line-291"></span><span>  </span><span class="annot"><span class="annottext">SMethod r -&gt; GenState (SMethod r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SMethod r -&gt; GenState (SMethod r))
-&gt; SMethod r -&gt; GenState (SMethod r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Comments
</span><a href="Language.Drasil.Choices.html#CommentFunc"><span class="hs-identifier hs-var">CommentFunc</span></a></span><span> </span><span class="annot"><span class="annottext">Comments -&gt; [Comments] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; [Comments]
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#commented"><span class="hs-identifier hs-var">commented</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679355348"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-292"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; [(Name, SVariable r)]
-&gt; [(Name, SVariable r)]
-&gt; [(Name, SVariable r)]
-&gt; MSBody r
-&gt; SMethod r
</span><a href="#local-6989586621679355342"><span class="hs-identifier hs-var">docf</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679355344"><span class="hs-identifier hs-var">desc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Name] -&gt; [SVariable r] -&gt; [(Name, SVariable r)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679355361"><span class="hs-identifier hs-var">pComms</span></a></span><span> </span><span class="annot"><span class="annottext">[SVariable r]
</span><a href="#local-6989586621679355357"><span class="hs-identifier hs-var">inVs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Name] -&gt; [SVariable r] -&gt; [(Name, SVariable r)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679355362"><span class="hs-identifier hs-var">oComms</span></a></span><span> </span><span class="annot"><span class="annottext">[SVariable r]
</span><a href="#local-6989586621679355358"><span class="hs-identifier hs-var">outVs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Name] -&gt; [SVariable r] -&gt; [(Name, SVariable r)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span>
</span><span id="line-293"></span><span>    </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679355363"><span class="hs-identifier hs-var">bComms</span></a></span><span> </span><span class="annot"><span class="annottext">[SVariable r]
</span><a href="#local-6989586621679355359"><span class="hs-identifier hs-var">bothVs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MSBody r
</span><a href="#local-6989586621679355360"><span class="hs-identifier hs-var">bod</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[SVariable r]
-&gt; [SVariable r] -&gt; [SVariable r] -&gt; MSBody r -&gt; SMethod r
</span><a href="#local-6989586621679355341"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[SVariable r]
</span><a href="#local-6989586621679355357"><span class="hs-identifier hs-var">inVs</span></a></span><span> </span><span class="annot"><span class="annottext">[SVariable r]
</span><a href="#local-6989586621679355358"><span class="hs-identifier hs-var">outVs</span></a></span><span> </span><span class="annot"><span class="annottext">[SVariable r]
</span><a href="#local-6989586621679355359"><span class="hs-identifier hs-var">bothVs</span></a></span><span> </span><span class="annot"><span class="annottext">MSBody r
</span><a href="#local-6989586621679355360"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span class="annot"><span class="hs-comment">-- | Converts an 'Expr' to a GOOL Value.</span></span><span>
</span><span id="line-296"></span><span id="local-6989586621679353562"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-type">convExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353562"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CodeExpr</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679353562"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-297"></span><span id="convExpr"><span class="annot"><span class="annottext">convExpr :: forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var hs-var">convExpr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Lit</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dbl</span></span><span> </span><span id="local-6989586621679355547"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679355547"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-298"></span><span>  </span><span id="local-6989586621679355548"><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679355548"><span class="hs-identifier hs-var">sm</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Space -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#spaceCodeType"><span class="hs-identifier hs-var">spaceCodeType</span></a></span><span> </span><span class="annot"><span class="annottext">Space
</span><span class="hs-identifier hs-var">Real</span></span><span>
</span><span id="line-299"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679355564"><span class="annot"><span class="annottext">getLiteral :: CodeType -&gt; SValue r
</span><a href="#local-6989586621679355564"><span class="hs-identifier hs-var hs-var">getLiteral</span></a></span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><span class="hs-identifier hs-var">Double</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; SValue r
forall (r :: * -&gt; *). Literal r =&gt; Double -&gt; SValue r
</span><span class="hs-identifier hs-var">litDouble</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679355547"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-300"></span><span>      </span><span class="annot"><a href="#local-6989586621679355564"><span class="hs-identifier hs-var">getLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><span class="hs-identifier hs-var">Float</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; SValue r
forall (r :: * -&gt; *). Literal r =&gt; Float -&gt; SValue r
</span><span class="hs-identifier hs-var">litFloat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Float
forall a b. (Real a, Fractional b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">realToFrac</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679355547"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span>      </span><span class="annot"><a href="#local-6989586621679355564"><span class="hs-identifier hs-var">getLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; SValue r
forall a. HasCallStack =&gt; Name -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;convExpr: Real space matched to invalid CodeType; should be Double or Float&quot;</span></span><span>
</span><span id="line-302"></span><span>  </span><span class="annot"><span class="annottext">SValue r -&gt; GenState (SValue r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; GenState (SValue r))
-&gt; SValue r -&gt; GenState (SValue r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CodeType -&gt; SValue r
forall {r :: * -&gt; *}. Literal r =&gt; CodeType -&gt; SValue r
</span><a href="#local-6989586621679355564"><span class="hs-identifier hs-var">getLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679355548"><span class="hs-identifier hs-var">sm</span></a></span><span>
</span><span id="line-303"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Lit</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ExactDbl</span></span><span> </span><span id="local-6989586621679355570"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679355570"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">(CodeExpr -&gt; GenState (SValue r))
-&gt; CodeExpr -&gt; GenState (SValue r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CodeExpr
</span><span class="hs-identifier hs-var">Lit</span></span><span> </span><span class="annot"><span class="annottext">(Literal -&gt; CodeExpr) -&gt; (Double -&gt; Literal) -&gt; Double -&gt; CodeExpr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Literal
</span><span class="hs-identifier hs-var">Dbl</span></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; CodeExpr) -&gt; Double -&gt; CodeExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Double
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679355570"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-304"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Lit</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span id="local-6989586621679355572"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679355572"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; GenState (SValue r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; GenState (SValue r))
-&gt; SValue r -&gt; GenState (SValue r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; SValue r
forall (r :: * -&gt; *). Literal r =&gt; Integer -&gt; SValue r
</span><span class="hs-identifier hs-var">litInt</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679355572"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-305"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Lit</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Str</span></span><span> </span><span id="local-6989586621679355575"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679355575"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; GenState (SValue r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; GenState (SValue r))
-&gt; SValue r -&gt; GenState (SValue r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; SValue r
forall (r :: * -&gt; *). Literal r =&gt; Name -&gt; SValue r
</span><span class="hs-identifier hs-var">litString</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679355575"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-306"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Lit</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Perc</span></span><span> </span><span id="local-6989586621679355578"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679355578"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679355579"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679355579"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-307"></span><span>  </span><span id="local-6989586621679355580"><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679355580"><span class="hs-identifier hs-var">sm</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Space -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#spaceCodeType"><span class="hs-identifier hs-var">spaceCodeType</span></a></span><span> </span><span class="annot"><span class="annottext">Space
</span><span class="hs-identifier hs-var">Rational</span></span><span>
</span><span id="line-308"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679355592"><span class="annot"><span class="annottext">getLiteral :: CodeType -&gt; Double -&gt; SValue r
</span><a href="#local-6989586621679355592"><span class="hs-identifier hs-var hs-var">getLiteral</span></a></span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><span class="hs-identifier hs-var">Double</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; SValue r
forall (r :: * -&gt; *). Literal r =&gt; Double -&gt; SValue r
</span><span class="hs-identifier hs-var">litDouble</span></span><span>
</span><span id="line-309"></span><span>      </span><span class="annot"><a href="#local-6989586621679355592"><span class="hs-identifier hs-var">getLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><span class="hs-identifier hs-var">Float</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; SValue r
forall (r :: * -&gt; *). Literal r =&gt; Float -&gt; SValue r
</span><span class="hs-identifier hs-var">litFloat</span></span><span> </span><span class="annot"><span class="annottext">(Float -&gt; SValue r) -&gt; (Double -&gt; Float) -&gt; Double -&gt; SValue r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Float
forall a b. (Real a, Fractional b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">realToFrac</span></span><span>
</span><span id="line-310"></span><span>      </span><span class="annot"><a href="#local-6989586621679355592"><span class="hs-identifier hs-var">getLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Double -&gt; SValue r
forall a. HasCallStack =&gt; Name -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;convExpr: Rational space matched to invalid CodeType; should be Double or Float&quot;</span></span><span>
</span><span id="line-311"></span><span>  </span><span class="annot"><span class="annottext">SValue r -&gt; GenState (SValue r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; GenState (SValue r))
-&gt; SValue r -&gt; GenState (SValue r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CodeType -&gt; Double -&gt; SValue r
forall {r :: * -&gt; *}. Literal r =&gt; CodeType -&gt; Double -&gt; SValue r
</span><a href="#local-6989586621679355592"><span class="hs-identifier hs-var">getLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679355580"><span class="hs-identifier hs-var">sm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679355578"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">**</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679355579"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-312"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AssocA</span></span><span> </span><span class="annot"><span class="annottext">AssocArithOper
</span><span class="hs-identifier hs-var">Add</span></span><span> </span><span id="local-6989586621679355597"><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679355597"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r -&gt; SValue r) -&gt; [SValue r] -&gt; SValue r
forall a. (a -&gt; a -&gt; a) -&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; a -&gt; a) -&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">foldl1</span></span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
NumericExpression r =&gt;
SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-operator hs-var">(#+)</span></span><span>  </span><span class="annot"><span class="annottext">([SValue r] -&gt; SValue r)
-&gt; StateT DrasilState Identity [SValue r] -&gt; GenState (SValue r)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(CodeExpr -&gt; GenState (SValue r))
-&gt; [CodeExpr] -&gt; StateT DrasilState Identity [SValue r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679355597"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-313"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AssocA</span></span><span> </span><span class="annot"><span class="annottext">AssocArithOper
</span><span class="hs-identifier hs-var">Mul</span></span><span> </span><span id="local-6989586621679355601"><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679355601"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r -&gt; SValue r) -&gt; [SValue r] -&gt; SValue r
forall a. (a -&gt; a -&gt; a) -&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; a -&gt; a) -&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">foldl1</span></span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
NumericExpression r =&gt;
SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-operator hs-var">(#*)</span></span><span>  </span><span class="annot"><span class="annottext">([SValue r] -&gt; SValue r)
-&gt; StateT DrasilState Identity [SValue r] -&gt; GenState (SValue r)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(CodeExpr -&gt; GenState (SValue r))
-&gt; [CodeExpr] -&gt; StateT DrasilState Identity [SValue r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679355601"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-314"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AssocB</span></span><span> </span><span class="annot"><span class="annottext">AssocBoolOper
</span><span class="hs-identifier hs-var">And</span></span><span> </span><span id="local-6989586621679355605"><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679355605"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r -&gt; SValue r) -&gt; [SValue r] -&gt; SValue r
forall a. (a -&gt; a -&gt; a) -&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; a -&gt; a) -&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">foldl1</span></span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
BooleanExpression r =&gt;
SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-operator hs-var">(?&amp;&amp;)</span></span><span> </span><span class="annot"><span class="annottext">([SValue r] -&gt; SValue r)
-&gt; StateT DrasilState Identity [SValue r] -&gt; GenState (SValue r)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(CodeExpr -&gt; GenState (SValue r))
-&gt; [CodeExpr] -&gt; StateT DrasilState Identity [SValue r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679355605"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-315"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AssocB</span></span><span> </span><span class="annot"><span class="annottext">AssocBoolOper
</span><span class="hs-identifier hs-var">Or</span></span><span> </span><span id="local-6989586621679355608"><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679355608"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r -&gt; SValue r) -&gt; [SValue r] -&gt; SValue r
forall a. (a -&gt; a -&gt; a) -&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; a -&gt; a) -&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">foldl1</span></span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
BooleanExpression r =&gt;
SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-operator hs-var">(?||)</span></span><span> </span><span class="annot"><span class="annottext">([SValue r] -&gt; SValue r)
-&gt; StateT DrasilState Identity [SValue r] -&gt; GenState (SValue r)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(CodeExpr -&gt; GenState (SValue r))
-&gt; [CodeExpr] -&gt; StateT DrasilState Identity [SValue r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679355608"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-316"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AssocC</span></span><span> </span><span class="annot"><span class="annottext">AssocConcatOper
</span><span class="hs-identifier hs-var">SUnion</span></span><span> </span><span id="local-6989586621679355612"><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679355612"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r -&gt; SValue r) -&gt; [SValue r] -&gt; SValue r
forall a. (a -&gt; a -&gt; a) -&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; a -&gt; a) -&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">foldl1</span></span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
NumericExpression r =&gt;
SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-operator hs-var">(#+)</span></span><span> </span><span class="annot"><span class="annottext">([SValue r] -&gt; SValue r)
-&gt; StateT DrasilState Identity [SValue r] -&gt; GenState (SValue r)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(CodeExpr -&gt; GenState (SValue r))
-&gt; [CodeExpr] -&gt; StateT DrasilState Identity [SValue r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679355612"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-317"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">C</span></span><span> </span><span id="local-6989586621679355614"><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679355614"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-318"></span><span>  </span><span id="local-6989586621679355615"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679355615"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-319"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679355622"><span class="annot"><span class="annottext">v :: Input
</span><a href="#local-6989586621679355622"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DefinedQuantityDict -&gt; Input
forall c. (Quantity c, MayHaveUnit c, Concept c) =&gt; c -&gt; Input
</span><a href="Language.Drasil.Chunk.CodeBase.html#quantvar"><span class="hs-identifier hs-var">quantvar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; UID -&gt; DefinedQuantityDict
</span><a href="Language.Drasil.Code.Imperative.Helpers.html#lookupC"><span class="hs-identifier hs-var">lookupC</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679355615"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679355614"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-320"></span><span>  </span><span class="annot"><span class="annottext">Input -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; Input -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVal"><span class="hs-identifier hs-var">mkVal</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679355622"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-321"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FCall</span></span><span> </span><span id="local-6989586621679355624"><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679355624"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679355625"><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679355625"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679355626"><span class="annot"><span class="annottext">[(UID, CodeExpr)]
</span><a href="#local-6989586621679355626"><span class="hs-identifier hs-var">ns</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UID
-&gt; [CodeExpr]
-&gt; [(UID, CodeExpr)]
-&gt; (Name
    -&gt; Name
    -&gt; VSType r
    -&gt; [SValue r]
    -&gt; NamedArgs r
    -&gt; GenState (SValue r))
-&gt; (Name
    -&gt; Name -&gt; VSType r -&gt; [SValue r] -&gt; NamedArgs r -&gt; SValue r)
-&gt; GenState (SValue r)
forall (r :: * -&gt; *).
OOProg r =&gt;
UID
-&gt; [CodeExpr]
-&gt; [(UID, CodeExpr)]
-&gt; (Name
    -&gt; Name
    -&gt; VSType r
    -&gt; [SValue r]
    -&gt; NamedArgs r
    -&gt; GenState (SValue r))
-&gt; (Name
    -&gt; Name -&gt; VSType r -&gt; [SValue r] -&gt; NamedArgs r -&gt; SValue r)
-&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convCall"><span class="hs-identifier hs-var">convCall</span></a></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679355624"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679355625"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">[(UID, CodeExpr)]
</span><a href="#local-6989586621679355626"><span class="hs-identifier hs-var">ns</span></a></span><span> </span><span class="annot"><span class="annottext">Name
-&gt; Name
-&gt; VSType r
-&gt; [SValue r]
-&gt; NamedArgs r
-&gt; GenState (SValue r)
forall (r :: * -&gt; *).
OOProg r =&gt;
Name
-&gt; Name
-&gt; VSType r
-&gt; [SValue r]
-&gt; NamedArgs r
-&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html#fApp"><span class="hs-identifier hs-var">fApp</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; VSType r -&gt; [SValue r] -&gt; NamedArgs r -&gt; SValue r
forall (r :: * -&gt; *). ValueExpression r =&gt; Name -&gt; MixedCall r
</span><span class="hs-identifier hs-var">libFuncAppMixedArgs</span></span><span>
</span><span id="line-322"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">New</span></span><span> </span><span id="local-6989586621679355630"><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679355630"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679355631"><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679355631"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679355632"><span class="annot"><span class="annottext">[(UID, CodeExpr)]
</span><a href="#local-6989586621679355632"><span class="hs-identifier hs-var">ns</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UID
-&gt; [CodeExpr]
-&gt; [(UID, CodeExpr)]
-&gt; (Name
    -&gt; Name
    -&gt; VSType r
    -&gt; [SValue r]
    -&gt; NamedArgs r
    -&gt; GenState (SValue r))
-&gt; (Name
    -&gt; Name -&gt; VSType r -&gt; [SValue r] -&gt; NamedArgs r -&gt; SValue r)
-&gt; GenState (SValue r)
forall (r :: * -&gt; *).
OOProg r =&gt;
UID
-&gt; [CodeExpr]
-&gt; [(UID, CodeExpr)]
-&gt; (Name
    -&gt; Name
    -&gt; VSType r
    -&gt; [SValue r]
    -&gt; NamedArgs r
    -&gt; GenState (SValue r))
-&gt; (Name
    -&gt; Name -&gt; VSType r -&gt; [SValue r] -&gt; NamedArgs r -&gt; SValue r)
-&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convCall"><span class="hs-identifier hs-var">convCall</span></a></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679355630"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679355631"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">[(UID, CodeExpr)]
</span><a href="#local-6989586621679355632"><span class="hs-identifier hs-var">ns</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679355633"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679355633"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; VSType r -&gt; [SValue r] -&gt; NamedArgs r -&gt; GenState (SValue r)
forall (r :: * -&gt; *).
OOProg r =&gt;
Name
-&gt; VSType r -&gt; [SValue r] -&gt; NamedArgs r -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html#ctorCall"><span class="hs-identifier hs-var">ctorCall</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679355633"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-323"></span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679355634"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679355634"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; VSType r -&gt; [SValue r] -&gt; NamedArgs r -&gt; SValue r
forall (r :: * -&gt; *).
OOValueExpression r =&gt;
Name -&gt; MixedCtorCall r
</span><span class="hs-identifier hs-var">libNewObjMixedArgs</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679355634"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-324"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Message</span></span><span> </span><span id="local-6989586621679355637"><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679355637"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679355638"><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679355638"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679355639"><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679355639"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679355640"><span class="annot"><span class="annottext">[(UID, CodeExpr)]
</span><a href="#local-6989586621679355640"><span class="hs-identifier hs-var">ns</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-325"></span><span>  </span><span id="local-6989586621679355641"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679355641"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-326"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679355644"><span class="annot"><span class="annottext">info :: ChunkDB
</span><a href="#local-6989586621679355644"><span class="hs-identifier hs-var hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; CodeSpec
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#codeSpec"><span class="hs-identifier hs-var">codeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679355641"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">CodeSpec -&gt; Getting ChunkDB CodeSpec ChunkDB -&gt; ChunkDB
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting ChunkDB CodeSpec ChunkDB
forall c. HasOldCodeSpec c =&gt; Lens' c ChunkDB
Lens' CodeSpec ChunkDB
</span><a href="Language.Drasil.CodeSpec.html#systemdbO"><span class="hs-identifier hs-var">systemdbO</span></a></span><span>
</span><span id="line-327"></span><span>      </span><span id="local-6989586621679355652"><span class="annot"><span class="annottext">objCd :: Input
</span><a href="#local-6989586621679355652"><span class="hs-identifier hs-var hs-var">objCd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DefinedQuantityDict -&gt; Input
forall c. (Quantity c, MayHaveUnit c, Concept c) =&gt; c -&gt; Input
</span><a href="Language.Drasil.Chunk.CodeBase.html#quantvar"><span class="hs-identifier hs-var">quantvar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB -&gt; UID -&gt; DefinedQuantityDict
</span><span class="hs-identifier hs-var">symbResolve</span></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679355644"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679355637"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-328"></span><span>  </span><span id="local-6989586621679355653"><span class="annot"><span class="annottext">SValue r
</span><a href="#local-6989586621679355653"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; Input -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVal"><span class="hs-identifier hs-var">mkVal</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679355652"><span class="hs-identifier hs-var">objCd</span></a></span><span>
</span><span id="line-329"></span><span>  </span><span class="annot"><span class="annottext">UID
-&gt; [CodeExpr]
-&gt; [(UID, CodeExpr)]
-&gt; (Name
    -&gt; Name
    -&gt; VSType r
    -&gt; [SValue r]
    -&gt; NamedArgs r
    -&gt; GenState (SValue r))
-&gt; (Name
    -&gt; Name -&gt; VSType r -&gt; [SValue r] -&gt; NamedArgs r -&gt; SValue r)
-&gt; GenState (SValue r)
forall (r :: * -&gt; *).
OOProg r =&gt;
UID
-&gt; [CodeExpr]
-&gt; [(UID, CodeExpr)]
-&gt; (Name
    -&gt; Name
    -&gt; VSType r
    -&gt; [SValue r]
    -&gt; NamedArgs r
    -&gt; GenState (SValue r))
-&gt; (Name
    -&gt; Name -&gt; VSType r -&gt; [SValue r] -&gt; NamedArgs r -&gt; SValue r)
-&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convCall"><span class="hs-identifier hs-var">convCall</span></a></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679355638"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679355639"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">[(UID, CodeExpr)]
</span><a href="#local-6989586621679355640"><span class="hs-identifier hs-var">ns</span></a></span><span>
</span><span id="line-330"></span><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679355654"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679355654"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679355655"><span class="annot"><span class="annottext">VSType r
</span><a href="#local-6989586621679355655"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679355656"><span class="annot"><span class="annottext">[SValue r]
</span><a href="#local-6989586621679355656"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621679355657"><span class="annot"><span class="annottext">NamedArgs r
</span><a href="#local-6989586621679355657"><span class="hs-identifier hs-var">nas</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; GenState (SValue r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VSType r
-&gt; SValue r -&gt; Name -&gt; [SValue r] -&gt; NamedArgs r -&gt; SValue r
forall (r :: * -&gt; *).
InternalValueExp r =&gt;
VSType r
-&gt; SValue r -&gt; Name -&gt; [SValue r] -&gt; NamedArgs r -&gt; SValue r
</span><span class="hs-identifier hs-var">objMethodCallMixedArgs</span></span><span> </span><span class="annot"><span class="annottext">VSType r
</span><a href="#local-6989586621679355655"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">SValue r
</span><a href="#local-6989586621679355653"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679355654"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[SValue r]
</span><a href="#local-6989586621679355656"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">NamedArgs r
</span><a href="#local-6989586621679355657"><span class="hs-identifier hs-var">nas</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-331"></span><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679355658"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679355658"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679355659"><span class="annot"><span class="annottext">VSType r
</span><a href="#local-6989586621679355659"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">VSType r
-&gt; SValue r -&gt; Name -&gt; [SValue r] -&gt; NamedArgs r -&gt; SValue r
forall (r :: * -&gt; *).
InternalValueExp r =&gt;
VSType r
-&gt; SValue r -&gt; Name -&gt; [SValue r] -&gt; NamedArgs r -&gt; SValue r
</span><span class="hs-identifier hs-var">objMethodCallMixedArgs</span></span><span> </span><span class="annot"><span class="annottext">VSType r
</span><a href="#local-6989586621679355659"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">SValue r
</span><a href="#local-6989586621679355653"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679355658"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-332"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Field</span></span><span> </span><span id="local-6989586621679355661"><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679355661"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679355662"><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679355662"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-333"></span><span>  </span><span id="local-6989586621679355663"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679355663"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-334"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679355670"><span class="annot"><span class="annottext">ob :: Input
</span><a href="#local-6989586621679355670"><span class="hs-identifier hs-var hs-var">ob</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DefinedQuantityDict -&gt; Input
forall c. (Quantity c, MayHaveUnit c, Concept c) =&gt; c -&gt; Input
</span><a href="Language.Drasil.Chunk.CodeBase.html#quantvar"><span class="hs-identifier hs-var">quantvar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; UID -&gt; DefinedQuantityDict
</span><a href="Language.Drasil.Code.Imperative.Helpers.html#lookupC"><span class="hs-identifier hs-var">lookupC</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679355663"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679355661"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-335"></span><span>      </span><span id="local-6989586621679355677"><span class="annot"><span class="annottext">fld :: Input
</span><a href="#local-6989586621679355677"><span class="hs-identifier hs-var hs-var">fld</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DefinedQuantityDict -&gt; Input
forall c. (Quantity c, MayHaveUnit c, Concept c) =&gt; c -&gt; Input
</span><a href="Language.Drasil.Chunk.CodeBase.html#quantvar"><span class="hs-identifier hs-var">quantvar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; UID -&gt; DefinedQuantityDict
</span><a href="Language.Drasil.Code.Imperative.Helpers.html#lookupC"><span class="hs-identifier hs-var">lookupC</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679355663"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679355662"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-336"></span><span>  </span><span id="local-6989586621679355678"><span class="annot"><span class="annottext">VS (r (Variable r))
</span><a href="#local-6989586621679355678"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input -&gt; StateT DrasilState Identity (VS (r (Variable r)))
forall (r :: * -&gt; *). OOProg r =&gt; Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input -&gt; Input -&gt; Input
</span><a href="Language.Drasil.Chunk.Code.html#ccObjVar"><span class="hs-identifier hs-var">ccObjVar</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679355670"><span class="hs-identifier hs-var">ob</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679355677"><span class="hs-identifier hs-var">fld</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-337"></span><span>  </span><span class="annot"><span class="annottext">SValue r -&gt; GenState (SValue r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; GenState (SValue r))
-&gt; SValue r -&gt; GenState (SValue r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r)) -&gt; SValue r
forall (r :: * -&gt; *). VariableValue r =&gt; SVariable r -&gt; SValue r
</span><span class="hs-identifier hs-var">valueOf</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
</span><a href="#local-6989586621679355678"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-338"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UnaryOp</span></span><span> </span><span id="local-6989586621679355680"><span class="annot"><span class="annottext">UFunc
</span><a href="#local-6989586621679355680"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679355681"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679355681"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r)
-&gt; GenState (SValue r) -&gt; GenState (SValue r)
forall a b.
(a -&gt; b)
-&gt; StateT DrasilState Identity a -&gt; StateT DrasilState Identity b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UFunc -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *). SharedProg r =&gt; UFunc -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#unop"><span class="hs-identifier hs-var">unop</span></a></span><span> </span><span class="annot"><span class="annottext">UFunc
</span><a href="#local-6989586621679355680"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679355681"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-339"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UnaryOpB</span></span><span> </span><span id="local-6989586621679355684"><span class="annot"><span class="annottext">UFuncB
</span><a href="#local-6989586621679355684"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679355685"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679355685"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r)
-&gt; GenState (SValue r) -&gt; GenState (SValue r)
forall a b.
(a -&gt; b)
-&gt; StateT DrasilState Identity a -&gt; StateT DrasilState Identity b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UFuncB -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
SharedProg r =&gt;
UFuncB -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#unopB"><span class="hs-identifier hs-var">unopB</span></a></span><span> </span><span class="annot"><span class="annottext">UFuncB
</span><a href="#local-6989586621679355684"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679355685"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-340"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UnaryOpVV</span></span><span> </span><span id="local-6989586621679355688"><span class="annot"><span class="annottext">UFuncVV
</span><a href="#local-6989586621679355688"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679355689"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679355689"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r)
-&gt; GenState (SValue r) -&gt; GenState (SValue r)
forall a b.
(a -&gt; b)
-&gt; StateT DrasilState Identity a -&gt; StateT DrasilState Identity b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UFuncVV -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
SharedProg r =&gt;
UFuncVV -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#unopVV"><span class="hs-identifier hs-var">unopVV</span></a></span><span> </span><span class="annot"><span class="annottext">UFuncVV
</span><a href="#local-6989586621679355688"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679355689"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-341"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UnaryOpVN</span></span><span> </span><span id="local-6989586621679355692"><span class="annot"><span class="annottext">UFuncVN
</span><a href="#local-6989586621679355692"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679355693"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679355693"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r)
-&gt; GenState (SValue r) -&gt; GenState (SValue r)
forall a b.
(a -&gt; b)
-&gt; StateT DrasilState Identity a -&gt; StateT DrasilState Identity b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UFuncVN -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
SharedProg r =&gt;
UFuncVN -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#unopVN"><span class="hs-identifier hs-var">unopVN</span></a></span><span> </span><span class="annot"><span class="annottext">UFuncVN
</span><a href="#local-6989586621679355692"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679355693"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-342"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ArithBinaryOp</span></span><span> </span><span class="annot"><span class="annottext">ArithBinOp
</span><span class="hs-identifier hs-var">Frac</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Lit</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span id="local-6989586621679355697"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679355697"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Lit</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span id="local-6989586621679355698"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679355698"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-comment">-- hack to deal with integer division</span><span>
</span><span id="line-343"></span><span>  </span><span id="local-6989586621679355699"><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679355699"><span class="hs-identifier hs-var">sm</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Space -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#spaceCodeType"><span class="hs-identifier hs-var">spaceCodeType</span></a></span><span> </span><span class="annot"><span class="annottext">Space
</span><span class="hs-identifier hs-var">Rational</span></span><span>
</span><span id="line-344"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679355726"><span class="annot"><span class="annottext">getLiteral :: CodeType -&gt; SValue r
</span><a href="#local-6989586621679355726"><span class="hs-identifier hs-var hs-var">getLiteral</span></a></span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><span class="hs-identifier hs-var">Double</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; SValue r
forall (r :: * -&gt; *). Literal r =&gt; Double -&gt; SValue r
</span><span class="hs-identifier hs-var">litDouble</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679355697"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
NumericExpression r =&gt;
SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-operator hs-var">#/</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; SValue r
forall (r :: * -&gt; *). Literal r =&gt; Double -&gt; SValue r
</span><span class="hs-identifier hs-var">litDouble</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679355698"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-345"></span><span>      </span><span class="annot"><a href="#local-6989586621679355726"><span class="hs-identifier hs-var">getLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><span class="hs-identifier hs-var">Float</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; SValue r
forall (r :: * -&gt; *). Literal r =&gt; Float -&gt; SValue r
</span><span class="hs-identifier hs-var">litFloat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Float
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679355697"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
NumericExpression r =&gt;
SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-operator hs-var">#/</span></span><span> </span><span class="annot"><span class="annottext">Float -&gt; SValue r
forall (r :: * -&gt; *). Literal r =&gt; Float -&gt; SValue r
</span><span class="hs-identifier hs-var">litFloat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Float
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679355698"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-346"></span><span>      </span><span class="annot"><a href="#local-6989586621679355726"><span class="hs-identifier hs-var">getLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; SValue r
forall a. HasCallStack =&gt; Name -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;convExpr: Rational space matched to invalid CodeType; should be Double or Float&quot;</span></span><span>
</span><span id="line-347"></span><span>  </span><span class="annot"><span class="annottext">SValue r -&gt; GenState (SValue r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; GenState (SValue r))
-&gt; SValue r -&gt; GenState (SValue r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CodeType -&gt; SValue r
forall {r :: * -&gt; *}.
(NumericExpression r, Literal r) =&gt;
CodeType -&gt; SValue r
</span><a href="#local-6989586621679355726"><span class="hs-identifier hs-var">getLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679355699"><span class="hs-identifier hs-var">sm</span></a></span><span>
</span><span id="line-348"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ArithBinaryOp</span></span><span> </span><span id="local-6989586621679355728"><span class="annot"><span class="annottext">ArithBinOp
</span><a href="#local-6989586621679355728"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679355729"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679355729"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679355730"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679355730"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r -&gt; SValue r)
-&gt; GenState (SValue r)
-&gt; GenState (SValue r)
-&gt; GenState (SValue r)
forall (m :: * -&gt; *) a1 a2 r.
Monad m =&gt;
(a1 -&gt; a2 -&gt; r) -&gt; m a1 -&gt; m a2 -&gt; m r
</span><span class="hs-identifier hs-var">liftM2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArithBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
SharedProg r =&gt;
ArithBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#arithBfunc"><span class="hs-identifier hs-var">arithBfunc</span></a></span><span> </span><span class="annot"><span class="annottext">ArithBinOp
</span><a href="#local-6989586621679355728"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679355729"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679355730"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-349"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">BoolBinaryOp</span></span><span> </span><span id="local-6989586621679355733"><span class="annot"><span class="annottext">BoolBinOp
</span><a href="#local-6989586621679355733"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679355734"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679355734"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679355735"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679355735"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r -&gt; SValue r)
-&gt; GenState (SValue r)
-&gt; GenState (SValue r)
-&gt; GenState (SValue r)
forall (m :: * -&gt; *) a1 a2 r.
Monad m =&gt;
(a1 -&gt; a2 -&gt; r) -&gt; m a1 -&gt; m a2 -&gt; m r
</span><span class="hs-identifier hs-var">liftM2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BoolBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *). BoolBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#boolBfunc"><span class="hs-identifier hs-var">boolBfunc</span></a></span><span> </span><span class="annot"><span class="annottext">BoolBinOp
</span><a href="#local-6989586621679355733"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679355734"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679355735"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-350"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LABinaryOp</span></span><span> </span><span id="local-6989586621679355738"><span class="annot"><span class="annottext">LABinOp
</span><a href="#local-6989586621679355738"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679355739"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679355739"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679355740"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679355740"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r -&gt; SValue r)
-&gt; GenState (SValue r)
-&gt; GenState (SValue r)
-&gt; GenState (SValue r)
forall (m :: * -&gt; *) a1 a2 r.
Monad m =&gt;
(a1 -&gt; a2 -&gt; r) -&gt; m a1 -&gt; m a2 -&gt; m r
</span><span class="hs-identifier hs-var">liftM2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LABinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
SharedProg r =&gt;
LABinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#laBfunc"><span class="hs-identifier hs-var">laBfunc</span></a></span><span> </span><span class="annot"><span class="annottext">LABinOp
</span><a href="#local-6989586621679355738"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679355739"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679355740"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-351"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">EqBinaryOp</span></span><span> </span><span id="local-6989586621679355743"><span class="annot"><span class="annottext">EqBinOp
</span><a href="#local-6989586621679355743"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679355744"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679355744"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679355745"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679355745"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r -&gt; SValue r)
-&gt; GenState (SValue r)
-&gt; GenState (SValue r)
-&gt; GenState (SValue r)
forall (m :: * -&gt; *) a1 a2 r.
Monad m =&gt;
(a1 -&gt; a2 -&gt; r) -&gt; m a1 -&gt; m a2 -&gt; m r
</span><span class="hs-identifier hs-var">liftM2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EqBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
SharedProg r =&gt;
EqBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#eqBfunc"><span class="hs-identifier hs-var">eqBfunc</span></a></span><span> </span><span class="annot"><span class="annottext">EqBinOp
</span><a href="#local-6989586621679355743"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679355744"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679355745"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-352"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OrdBinaryOp</span></span><span> </span><span id="local-6989586621679355748"><span class="annot"><span class="annottext">OrdBinOp
</span><a href="#local-6989586621679355748"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679355749"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679355749"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679355750"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679355750"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r -&gt; SValue r)
-&gt; GenState (SValue r)
-&gt; GenState (SValue r)
-&gt; GenState (SValue r)
forall (m :: * -&gt; *) a1 a2 r.
Monad m =&gt;
(a1 -&gt; a2 -&gt; r) -&gt; m a1 -&gt; m a2 -&gt; m r
</span><span class="hs-identifier hs-var">liftM2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OrdBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
SharedProg r =&gt;
OrdBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#ordBfunc"><span class="hs-identifier hs-var">ordBfunc</span></a></span><span> </span><span class="annot"><span class="annottext">OrdBinOp
</span><a href="#local-6989586621679355748"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679355749"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679355750"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-353"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VVVBinaryOp</span></span><span> </span><span id="local-6989586621679355753"><span class="annot"><span class="annottext">VVVBinOp
</span><a href="#local-6989586621679355753"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679355754"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679355754"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679355755"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679355755"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r -&gt; SValue r)
-&gt; GenState (SValue r)
-&gt; GenState (SValue r)
-&gt; GenState (SValue r)
forall (m :: * -&gt; *) a1 a2 r.
Monad m =&gt;
(a1 -&gt; a2 -&gt; r) -&gt; m a1 -&gt; m a2 -&gt; m r
</span><span class="hs-identifier hs-var">liftM2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VVVBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *). VVVBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#vecVecVecBfunc"><span class="hs-identifier hs-var">vecVecVecBfunc</span></a></span><span> </span><span class="annot"><span class="annottext">VVVBinOp
</span><a href="#local-6989586621679355753"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679355754"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679355755"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-354"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VVNBinaryOp</span></span><span> </span><span id="local-6989586621679355758"><span class="annot"><span class="annottext">VVNBinOp
</span><a href="#local-6989586621679355758"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679355759"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679355759"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679355760"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679355760"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r -&gt; SValue r)
-&gt; GenState (SValue r)
-&gt; GenState (SValue r)
-&gt; GenState (SValue r)
forall (m :: * -&gt; *) a1 a2 r.
Monad m =&gt;
(a1 -&gt; a2 -&gt; r) -&gt; m a1 -&gt; m a2 -&gt; m r
</span><span class="hs-identifier hs-var">liftM2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VVNBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *). VVNBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#vecVecNumBfunc"><span class="hs-identifier hs-var">vecVecNumBfunc</span></a></span><span> </span><span class="annot"><span class="annottext">VVNBinOp
</span><a href="#local-6989586621679355758"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679355759"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679355760"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-355"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NVVBinaryOp</span></span><span> </span><span id="local-6989586621679355763"><span class="annot"><span class="annottext">NVVBinOp
</span><a href="#local-6989586621679355763"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679355764"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679355764"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679355765"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679355765"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r -&gt; SValue r)
-&gt; GenState (SValue r)
-&gt; GenState (SValue r)
-&gt; GenState (SValue r)
forall (m :: * -&gt; *) a1 a2 r.
Monad m =&gt;
(a1 -&gt; a2 -&gt; r) -&gt; m a1 -&gt; m a2 -&gt; m r
</span><span class="hs-identifier hs-var">liftM2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NVVBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *). NVVBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#numVecVecBfunc"><span class="hs-identifier hs-var">numVecVecBfunc</span></a></span><span> </span><span class="annot"><span class="annottext">NVVBinOp
</span><a href="#local-6989586621679355763"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679355764"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679355765"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-356"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ESSBinaryOp</span></span><span> </span><span id="local-6989586621679355768"><span class="annot"><span class="annottext">ESSBinOp
</span><a href="#local-6989586621679355768"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679355769"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679355769"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679355770"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679355770"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r -&gt; SValue r)
-&gt; GenState (SValue r)
-&gt; GenState (SValue r)
-&gt; GenState (SValue r)
forall (m :: * -&gt; *) a1 a2 r.
Monad m =&gt;
(a1 -&gt; a2 -&gt; r) -&gt; m a1 -&gt; m a2 -&gt; m r
</span><span class="hs-identifier hs-var">liftM2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ESSBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
SharedProg r =&gt;
ESSBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#elementSetSetBfunc"><span class="hs-identifier hs-var">elementSetSetBfunc</span></a></span><span> </span><span class="annot"><span class="annottext">ESSBinOp
</span><a href="#local-6989586621679355768"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679355769"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679355770"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-357"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ESBBinaryOp</span></span><span> </span><span id="local-6989586621679355773"><span class="annot"><span class="annottext">ESBBinOp
</span><a href="#local-6989586621679355773"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679355774"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679355774"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679355775"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679355775"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r -&gt; SValue r)
-&gt; GenState (SValue r)
-&gt; GenState (SValue r)
-&gt; GenState (SValue r)
forall (m :: * -&gt; *) a1 a2 r.
Monad m =&gt;
(a1 -&gt; a2 -&gt; r) -&gt; m a1 -&gt; m a2 -&gt; m r
</span><span class="hs-identifier hs-var">liftM2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ESBBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
SharedProg r =&gt;
ESBBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#elementSetBoolBfunc"><span class="hs-identifier hs-var">elementSetBoolBfunc</span></a></span><span> </span><span class="annot"><span class="annottext">ESBBinOp
</span><a href="#local-6989586621679355773"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679355774"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679355775"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-358"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Case</span></span><span> </span><span id="local-6989586621679355778"><span class="annot"><span class="annottext">Completeness
</span><a href="#local-6989586621679355778"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679355779"><span class="annot"><span class="annottext">[(CodeExpr, CodeExpr)]
</span><a href="#local-6989586621679355779"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(CodeExpr, CodeExpr)] -&gt; GenState (SValue r)
forall {r :: * -&gt; *}.
OOProg r =&gt;
[(CodeExpr, CodeExpr)]
-&gt; StateT DrasilState Identity (VS (r (Value r)))
</span><a href="#local-6989586621679355780"><span class="hs-identifier hs-var">doit</span></a></span><span> </span><span class="annot"><span class="annottext">[(CodeExpr, CodeExpr)]
</span><a href="#local-6989586621679355779"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-comment">-- FIXME this is sub-optimal</span><span>
</span><span id="line-359"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-360"></span><span>    </span><span id="local-6989586621679355780"><span class="annot"><span class="annottext">doit :: [(CodeExpr, CodeExpr)]
-&gt; StateT DrasilState Identity (VS (r (Value r)))
</span><a href="#local-6989586621679355780"><span class="hs-identifier hs-var hs-var">doit</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall a. HasCallStack =&gt; Name -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;should never happen&quot;</span></span><span> </span><span class="hs-comment">-- TODO: change error message?</span><span>
</span><span id="line-361"></span><span>    </span><span class="annot"><a href="#local-6989586621679355780"><span class="hs-identifier hs-var">doit</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621679356078"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679356078"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">CodeExpr
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679356078"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-comment">-- should always be the else clause</span><span>
</span><span id="line-362"></span><span>    </span><span class="annot"><a href="#local-6989586621679355780"><span class="hs-identifier hs-var">doit</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679356079"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679356079"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679356080"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679356080"><span class="hs-identifier hs-var">cond</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679356081"><span class="annot"><span class="annottext">[(CodeExpr, CodeExpr)]
</span><a href="#local-6989586621679356081"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(VS (r (Value r))
 -&gt; VS (r (Value r)) -&gt; VS (r (Value r)) -&gt; VS (r (Value r)))
-&gt; StateT DrasilState Identity (VS (r (Value r)))
-&gt; StateT DrasilState Identity (VS (r (Value r)))
-&gt; StateT DrasilState Identity (VS (r (Value r)))
-&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (m :: * -&gt; *) a1 a2 a3 r.
Monad m =&gt;
(a1 -&gt; a2 -&gt; a3 -&gt; r) -&gt; m a1 -&gt; m a2 -&gt; m a3 -&gt; m r
</span><span class="hs-identifier hs-var">liftM3</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
-&gt; VS (r (Value r)) -&gt; VS (r (Value r)) -&gt; VS (r (Value r))
forall (r :: * -&gt; *).
ValueExpression r =&gt;
SValue r -&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-identifier hs-var">inlineIf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679356080"><span class="hs-identifier hs-var">cond</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679356079"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-363"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Completeness -&gt; [(CodeExpr, CodeExpr)] -&gt; CodeExpr
</span><span class="hs-identifier hs-var">Case</span></span><span> </span><span class="annot"><span class="annottext">Completeness
</span><a href="#local-6989586621679355778"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">[(CodeExpr, CodeExpr)]
</span><a href="#local-6989586621679356081"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-364"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Matrix</span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679356084"><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679356084"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-365"></span><span>  </span><span id="local-6989586621679356085"><span class="annot"><span class="annottext">[SValue r]
</span><a href="#local-6989586621679356085"><span class="hs-identifier hs-var">ar</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(CodeExpr -&gt; GenState (SValue r))
-&gt; [CodeExpr] -&gt; StateT DrasilState Identity [SValue r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679356084"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-366"></span><span>                                    </span><span class="hs-comment">-- hd will never fail here</span><span>
</span><span id="line-367"></span><span>  </span><span class="annot"><span class="annottext">SValue r -&gt; GenState (SValue r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; GenState (SValue r))
-&gt; SValue r -&gt; GenState (SValue r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VSType r -&gt; [SValue r] -&gt; SValue r
forall (r :: * -&gt; *).
Literal r =&gt;
VSType r -&gt; [SValue r] -&gt; SValue r
</span><span class="hs-identifier hs-var">litArray</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(r (Value r) -&gt; r (Type r)) -&gt; SValue r -&gt; VSType r
forall a b.
(a -&gt; b)
-&gt; StateT ValueState Identity a -&gt; StateT ValueState Identity b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">r (Value r) -&gt; r (Type r)
forall (r :: * -&gt; *). ValueSym r =&gt; r (Value r) -&gt; r (Type r)
</span><span class="hs-identifier hs-var">valueType</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SValue r] -&gt; SValue r
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[SValue r]
</span><a href="#local-6989586621679356085"><span class="hs-identifier hs-var">ar</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[SValue r]
</span><a href="#local-6989586621679356085"><span class="hs-identifier hs-var">ar</span></a></span><span>
</span><span id="line-368"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Matrix</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; GenState (SValue r)
forall a. HasCallStack =&gt; Name -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;convExpr: Matrix&quot;</span></span><span>
</span><span id="line-369"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">S.Set</span></span><span> </span><span id="local-6989586621679356090"><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621679356090"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679356091"><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679356091"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span>
</span><span id="line-370"></span><span>  </span><span id="local-6989586621679356092"><span class="annot"><span class="annottext">[SValue r]
</span><a href="#local-6989586621679356092"><span class="hs-identifier hs-var">ar</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(CodeExpr -&gt; GenState (SValue r))
-&gt; [CodeExpr] -&gt; StateT DrasilState Identity [SValue r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679356091"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-371"></span><span>  </span><span id="local-6989586621679356093"><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679356093"><span class="hs-identifier hs-var">sm</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Space -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#spaceCodeType"><span class="hs-identifier hs-var">spaceCodeType</span></a></span><span> </span><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621679356090"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-372"></span><span>  </span><span class="annot"><span class="annottext">SValue r -&gt; GenState (SValue r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; GenState (SValue r))
-&gt; SValue r -&gt; GenState (SValue r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VSType r -&gt; [SValue r] -&gt; SValue r
forall (r :: * -&gt; *).
Literal r =&gt;
VSType r -&gt; [SValue r] -&gt; SValue r
</span><span class="hs-identifier hs-var">litSet</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeType -&gt; VSType r
forall (r :: * -&gt; *). OOTypeSym r =&gt; CodeType -&gt; VSType r
</span><span class="hs-identifier hs-var">convTypeOO</span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679356093"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[SValue r]
</span><a href="#local-6989586621679356092"><span class="hs-identifier hs-var">ar</span></a></span><span>
</span><span id="line-373"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Variable</span></span><span> </span><span id="local-6989586621679356096"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679356096"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">S.Set</span></span><span> </span><span id="local-6989586621679356097"><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621679356097"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><span class="annottext">[CodeExpr]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-374"></span><span>  </span><span id="local-6989586621679356098"><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679356098"><span class="hs-identifier hs-var">sm</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Space -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#spaceCodeType"><span class="hs-identifier hs-var">spaceCodeType</span></a></span><span> </span><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621679356097"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-375"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679356104"><span class="annot"><span class="annottext">varSet :: VS (r (Variable r))
</span><a href="#local-6989586621679356104"><span class="hs-identifier hs-var hs-var">varSet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; VSType r -&gt; VS (r (Variable r))
forall (r :: * -&gt; *).
VariableSym r =&gt;
Name -&gt; VSType r -&gt; SVariable r
</span><span class="hs-identifier hs-var">var</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679356096"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VSType r -&gt; VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; VSType r -&gt; VSType r
</span><span class="hs-identifier hs-var">setType</span></span><span> </span><span class="annot"><span class="annottext">(VSType r -&gt; VSType r) -&gt; VSType r -&gt; VSType r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CodeType -&gt; VSType r
forall (r :: * -&gt; *). OOTypeSym r =&gt; CodeType -&gt; VSType r
</span><span class="hs-identifier hs-var">convTypeOO</span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679356098"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-376"></span><span>  </span><span class="annot"><span class="annottext">SValue r -&gt; GenState (SValue r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; GenState (SValue r))
-&gt; SValue r -&gt; GenState (SValue r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r)) -&gt; SValue r
forall (r :: * -&gt; *). VariableValue r =&gt; SVariable r -&gt; SValue r
</span><span class="hs-identifier hs-var">valueOf</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
</span><a href="#local-6989586621679356104"><span class="hs-identifier hs-var">varSet</span></a></span><span>
</span><span id="line-377"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Variable</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; GenState (SValue r)
forall a. HasCallStack =&gt; Name -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;convExpr: Variable&quot;</span></span><span>
</span><span id="line-378"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Operator</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; GenState (SValue r)
forall a. HasCallStack =&gt; Name -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;convExpr: Operator&quot;</span></span><span>
</span><span id="line-379"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RealI</span></span><span> </span><span id="local-6989586621679356108"><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679356108"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679356109"><span class="annot"><span class="annottext">RealInterval CodeExpr CodeExpr
</span><a href="#local-6989586621679356109"><span class="hs-identifier hs-var">ri</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-380"></span><span>  </span><span id="local-6989586621679356110"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679356110"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-381"></span><span>  </span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">(CodeExpr -&gt; GenState (SValue r))
-&gt; CodeExpr -&gt; GenState (SValue r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DefinedQuantityDict -&gt; RealInterval CodeExpr CodeExpr -&gt; CodeExpr
forall c.
(HasUID c, HasSymbol c) =&gt;
c -&gt; RealInterval CodeExpr CodeExpr -&gt; CodeExpr
</span><a href="Language.Drasil.Code.Imperative.Import.html#renderRealInt"><span class="hs-identifier hs-var">renderRealInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; UID -&gt; DefinedQuantityDict
</span><a href="Language.Drasil.Code.Imperative.Helpers.html#lookupC"><span class="hs-identifier hs-var">lookupC</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679356110"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679356108"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">RealInterval CodeExpr CodeExpr
</span><a href="#local-6989586621679356109"><span class="hs-identifier hs-var">ri</span></a></span><span>
</span><span id="line-382"></span><span>
</span><span id="line-383"></span><span class="hs-comment">-- | Generates a function/method call, based on the 'UID' of the chunk representing</span><span>
</span><span id="line-384"></span><span class="hs-comment">-- the function, the list of argument 'Expr's, the list of named argument 'Expr's,</span><span>
</span><span id="line-385"></span><span class="hs-comment">-- the function call generator to use, and the library version of the function</span><span>
</span><span id="line-386"></span><span class="hs-comment">-- call generator (used if the function is in the library export map).</span><span>
</span><span id="line-387"></span><span id="local-6989586621679353777"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convCall"><span class="hs-identifier hs-type">convCall</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353777"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">CodeExpr</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CodeExpr</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-388"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VSType</span></span><span> </span><span class="annot"><a href="#local-6989586621679353777"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679353777"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NamedArgs</span></span><span> </span><span class="annot"><a href="#local-6989586621679353777"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-389"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679353777"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VSType</span></span><span> </span><span class="annot"><a href="#local-6989586621679353777"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679353777"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-390"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NamedArgs</span></span><span> </span><span class="annot"><a href="#local-6989586621679353777"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679353777"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679353777"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-391"></span><span id="convCall"><span class="annot"><span class="annottext">convCall :: forall (r :: * -&gt; *).
OOProg r =&gt;
UID
-&gt; [CodeExpr]
-&gt; [(UID, CodeExpr)]
-&gt; (Name
    -&gt; Name
    -&gt; VSType r
    -&gt; [SValue r]
    -&gt; NamedArgs r
    -&gt; GenState (SValue r))
-&gt; (Name
    -&gt; Name -&gt; VSType r -&gt; [SValue r] -&gt; NamedArgs r -&gt; SValue r)
-&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convCall"><span class="hs-identifier hs-var hs-var">convCall</span></a></span></span><span> </span><span id="local-6989586621679356147"><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679356147"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679356148"><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679356148"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679356149"><span class="annot"><span class="annottext">[(UID, CodeExpr)]
</span><a href="#local-6989586621679356149"><span class="hs-identifier hs-var">ns</span></a></span></span><span> </span><span id="local-6989586621679356150"><span class="annot"><span class="annottext">Name
-&gt; Name
-&gt; VSType r
-&gt; [SValue r]
-&gt; NamedArgs r
-&gt; GenState (SValue r)
</span><a href="#local-6989586621679356150"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679356151"><span class="annot"><span class="annottext">Name -&gt; Name -&gt; VSType r -&gt; [SValue r] -&gt; NamedArgs r -&gt; SValue r
</span><a href="#local-6989586621679356151"><span class="hs-identifier hs-var">libf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-392"></span><span>  </span><span id="local-6989586621679356152"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679356152"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-393"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679356155"><span class="annot"><span class="annottext">info :: ChunkDB
</span><a href="#local-6989586621679356155"><span class="hs-identifier hs-var hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; CodeSpec
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#codeSpec"><span class="hs-identifier hs-var">codeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679356152"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">CodeSpec -&gt; Getting ChunkDB CodeSpec ChunkDB -&gt; ChunkDB
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting ChunkDB CodeSpec ChunkDB
forall c. HasOldCodeSpec c =&gt; Lens' c ChunkDB
Lens' CodeSpec ChunkDB
</span><a href="Language.Drasil.CodeSpec.html#systemdbO"><span class="hs-identifier hs-var">systemdbO</span></a></span><span>
</span><span id="line-394"></span><span>      </span><span id="local-6989586621679356156"><span class="annot"><span class="annottext">mem :: Map Name Name
</span><a href="#local-6989586621679356156"><span class="hs-identifier hs-var hs-var">mem</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; Map Name Name
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#eMap"><span class="hs-identifier hs-var">eMap</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679356152"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-395"></span><span>      </span><span id="local-6989586621679356157"><span class="annot"><span class="annottext">lem :: Map Name Name
</span><a href="#local-6989586621679356157"><span class="hs-identifier hs-var hs-var">lem</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; Map Name Name
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#libEMap"><span class="hs-identifier hs-var">libEMap</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679356152"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-396"></span><span>      </span><span id="local-6989586621679356165"><span class="annot"><span class="annottext">funcCd :: CodeFuncChunk
</span><a href="#local-6989586621679356165"><span class="hs-identifier hs-var hs-var">funcCd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DefinedQuantityDict -&gt; CodeFuncChunk
forall c.
(Quantity c, MayHaveUnit c, Concept c) =&gt;
c -&gt; CodeFuncChunk
</span><a href="Language.Drasil.Chunk.CodeBase.html#quantfunc"><span class="hs-identifier hs-var">quantfunc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB -&gt; UID -&gt; DefinedQuantityDict
</span><span class="hs-identifier hs-var">symbResolve</span></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679356155"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679356147"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-397"></span><span>      </span><span id="local-6989586621679356168"><span class="annot"><span class="annottext">funcNm :: Name
</span><a href="#local-6989586621679356168"><span class="hs-identifier hs-var hs-var">funcNm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CodeFuncChunk -&gt; Name
forall c. CodeIdea c =&gt; c -&gt; Name
</span><span class="hs-identifier hs-var">codeName</span></span><span> </span><span class="annot"><span class="annottext">CodeFuncChunk
</span><a href="#local-6989586621679356165"><span class="hs-identifier hs-var">funcCd</span></a></span><span>
</span><span id="line-398"></span><span>  </span><span id="local-6989586621679356169"><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679356169"><span class="hs-identifier hs-var">funcTp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeFuncChunk -&gt; GenState CodeType
forall c. HasSpace c =&gt; c -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#codeType"><span class="hs-identifier hs-var">codeType</span></a></span><span> </span><span class="annot"><span class="annottext">CodeFuncChunk
</span><a href="#local-6989586621679356165"><span class="hs-identifier hs-var">funcCd</span></a></span><span>
</span><span id="line-399"></span><span>  </span><span id="local-6989586621679356170"><span class="annot"><span class="annottext">[SValue r]
</span><a href="#local-6989586621679356170"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(CodeExpr -&gt; GenState (SValue r))
-&gt; [CodeExpr] -&gt; StateT DrasilState Identity [SValue r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679356148"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-400"></span><span>  </span><span id="local-6989586621679356171"><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679356171"><span class="hs-identifier hs-var">nms</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((UID, CodeExpr)
 -&gt; StateT DrasilState Identity (VS (r (Variable r))))
-&gt; [(UID, CodeExpr)]
-&gt; StateT DrasilState Identity [VS (r (Variable r))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input -&gt; StateT DrasilState Identity (VS (r (Variable r)))
forall (r :: * -&gt; *). OOProg r =&gt; Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="annot"><span class="annottext">(Input -&gt; StateT DrasilState Identity (VS (r (Variable r))))
-&gt; ((UID, CodeExpr) -&gt; Input)
-&gt; (UID, CodeExpr)
-&gt; StateT DrasilState Identity (VS (r (Variable r)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DefinedQuantityDict -&gt; Input
forall c. (Quantity c, MayHaveUnit c, Concept c) =&gt; c -&gt; Input
</span><a href="Language.Drasil.Chunk.CodeBase.html#quantvar"><span class="hs-identifier hs-var">quantvar</span></a></span><span> </span><span class="annot"><span class="annottext">(DefinedQuantityDict -&gt; Input)
-&gt; ((UID, CodeExpr) -&gt; DefinedQuantityDict)
-&gt; (UID, CodeExpr)
-&gt; Input
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ChunkDB -&gt; UID -&gt; DefinedQuantityDict
</span><span class="hs-identifier hs-var">symbResolve</span></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679356155"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">(UID -&gt; DefinedQuantityDict)
-&gt; ((UID, CodeExpr) -&gt; UID)
-&gt; (UID, CodeExpr)
-&gt; DefinedQuantityDict
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(UID, CodeExpr) -&gt; UID
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(UID, CodeExpr)]
</span><a href="#local-6989586621679356149"><span class="hs-identifier hs-var">ns</span></a></span><span>
</span><span id="line-401"></span><span>  </span><span id="local-6989586621679356173"><span class="annot"><span class="annottext">[SValue r]
</span><a href="#local-6989586621679356173"><span class="hs-identifier hs-var">nargs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((UID, CodeExpr) -&gt; GenState (SValue r))
-&gt; [(UID, CodeExpr)] -&gt; StateT DrasilState Identity [SValue r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">(CodeExpr -&gt; GenState (SValue r))
-&gt; ((UID, CodeExpr) -&gt; CodeExpr)
-&gt; (UID, CodeExpr)
-&gt; GenState (SValue r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(UID, CodeExpr) -&gt; CodeExpr
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(UID, CodeExpr)]
</span><a href="#local-6989586621679356149"><span class="hs-identifier hs-var">ns</span></a></span><span>
</span><span id="line-402"></span><span>  </span><span class="annot"><span class="annottext">GenState (SValue r)
-&gt; (Name -&gt; GenState (SValue r))
-&gt; Maybe Name
-&gt; GenState (SValue r)
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenState (SValue r)
-&gt; (Name -&gt; GenState (SValue r))
-&gt; Maybe Name
-&gt; GenState (SValue r)
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; GenState (SValue r)
forall a. HasCallStack =&gt; Name -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; GenState (SValue r)) -&gt; Name -&gt; GenState (SValue r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Call to non-existent function &quot;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679356168"><span class="hs-identifier hs-var">funcNm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-403"></span><span>      </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679356175"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679356175"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; GenState (SValue r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; GenState (SValue r))
-&gt; SValue r -&gt; GenState (SValue r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; VSType r -&gt; [SValue r] -&gt; NamedArgs r -&gt; SValue r
</span><a href="#local-6989586621679356151"><span class="hs-identifier hs-var">libf</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679356175"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679356168"><span class="hs-identifier hs-var">funcNm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeType -&gt; VSType r
forall (r :: * -&gt; *). OOTypeSym r =&gt; CodeType -&gt; VSType r
</span><span class="hs-identifier hs-var">convTypeOO</span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679356169"><span class="hs-identifier hs-var">funcTp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[SValue r]
</span><a href="#local-6989586621679356170"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[VS (r (Variable r))] -&gt; [SValue r] -&gt; NamedArgs r
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679356171"><span class="hs-identifier hs-var">nms</span></a></span><span> </span><span class="annot"><span class="annottext">[SValue r]
</span><a href="#local-6989586621679356173"><span class="hs-identifier hs-var">nargs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-404"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Map Name Name -&gt; Maybe Name
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679356168"><span class="hs-identifier hs-var">funcNm</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name Name
</span><a href="#local-6989586621679356157"><span class="hs-identifier hs-var">lem</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-405"></span><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679356176"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679356176"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; Name
-&gt; VSType r
-&gt; [SValue r]
-&gt; NamedArgs r
-&gt; GenState (SValue r)
</span><a href="#local-6989586621679356150"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679356176"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679356168"><span class="hs-identifier hs-var">funcNm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeType -&gt; VSType r
forall (r :: * -&gt; *). OOTypeSym r =&gt; CodeType -&gt; VSType r
</span><span class="hs-identifier hs-var">convTypeOO</span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679356169"><span class="hs-identifier hs-var">funcTp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[SValue r]
</span><a href="#local-6989586621679356170"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[VS (r (Variable r))] -&gt; [SValue r] -&gt; NamedArgs r
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679356171"><span class="hs-identifier hs-var">nms</span></a></span><span> </span><span class="annot"><span class="annottext">[SValue r]
</span><a href="#local-6989586621679356173"><span class="hs-identifier hs-var">nargs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-406"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Map Name Name -&gt; Maybe Name
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679356168"><span class="hs-identifier hs-var">funcNm</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name Name
</span><a href="#local-6989586621679356156"><span class="hs-identifier hs-var">mem</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-407"></span><span>
</span><span id="line-408"></span><span class="annot"><span class="hs-comment">-- | Converts a 'Constraint' to a 'CodeExpr'.</span></span><span>
</span><span id="line-409"></span><span id="local-6989586621679353840"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#renderC"><span class="hs-identifier hs-type">renderC</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">HasUID</span></span><span> </span><span class="annot"><a href="#local-6989586621679353840"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasSymbol</span></span><span> </span><span class="annot"><a href="#local-6989586621679353840"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679353840"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Constraint</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CodeExpr</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CodeExpr</span></span></span><span>
</span><span id="line-410"></span><span id="renderC"><span class="annot"><span class="annottext">renderC :: forall c.
(HasUID c, HasSymbol c) =&gt;
c -&gt; Constraint CodeExpr -&gt; CodeExpr
</span><a href="Language.Drasil.Code.Imperative.Import.html#renderC"><span class="hs-identifier hs-var hs-var">renderC</span></a></span></span><span> </span><span id="local-6989586621679356183"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679356183"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Range</span></span><span> </span><span class="annot"><span class="annottext">ConstraintReason
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679356185"><span class="annot"><span class="annottext">RealInterval CodeExpr CodeExpr
</span><a href="#local-6989586621679356185"><span class="hs-identifier hs-var">rr</span></a></span></span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">c -&gt; RealInterval CodeExpr CodeExpr -&gt; CodeExpr
forall c.
(HasUID c, HasSymbol c) =&gt;
c -&gt; RealInterval CodeExpr CodeExpr -&gt; CodeExpr
</span><a href="Language.Drasil.Code.Imperative.Import.html#renderRealInt"><span class="hs-identifier hs-var">renderRealInt</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679356183"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">RealInterval CodeExpr CodeExpr
</span><a href="#local-6989586621679356185"><span class="hs-identifier hs-var">rr</span></a></span><span>
</span><span id="line-411"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#renderC"><span class="hs-identifier hs-var">renderC</span></a></span><span> </span><span id="local-6989586621679356186"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679356186"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Elem</span></span><span> </span><span class="annot"><span class="annottext">ConstraintReason
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679356188"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679356188"><span class="hs-identifier hs-var">rr</span></a></span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">c -&gt; CodeExpr -&gt; CodeExpr
forall c. (HasUID c, HasSymbol c) =&gt; c -&gt; CodeExpr -&gt; CodeExpr
</span><a href="Language.Drasil.Code.Imperative.Import.html#renderSet"><span class="hs-identifier hs-var">renderSet</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679356186"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679356188"><span class="hs-identifier hs-var">rr</span></a></span><span>
</span><span id="line-412"></span><span>
</span><span id="line-413"></span><span class="annot"><span class="hs-comment">-- | Converts an interval ('RealInterval') to a 'CodeExpr'.</span></span><span>
</span><span id="line-414"></span><span id="local-6989586621679353832"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#renderRealInt"><span class="hs-identifier hs-type">renderRealInt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">HasUID</span></span><span> </span><span class="annot"><a href="#local-6989586621679353832"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasSymbol</span></span><span> </span><span class="annot"><a href="#local-6989586621679353832"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679353832"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RealInterval</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CodeExpr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CodeExpr</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CodeExpr</span></span></span><span>
</span><span id="line-415"></span><span id="renderRealInt"><span class="annot"><span class="annottext">renderRealInt :: forall c.
(HasUID c, HasSymbol c) =&gt;
c -&gt; RealInterval CodeExpr CodeExpr -&gt; CodeExpr
</span><a href="Language.Drasil.Code.Imperative.Import.html#renderRealInt"><span class="hs-identifier hs-var hs-var">renderRealInt</span></a></span></span><span> </span><span id="local-6989586621679356245"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679356245"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bounded</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Inclusive
</span><span class="hs-identifier hs-var">Inc</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679356248"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679356248"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Inclusive
</span><span class="hs-identifier hs-var">Inc</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679356249"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679356249"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679356248"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; CodeExpr -&gt; CodeExpr
forall r. ExprC r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">$&lt;=</span></span><span> </span><span class="annot"><span class="annottext">c -&gt; CodeExpr
forall c. (HasUID c, HasSymbol c) =&gt; c -&gt; CodeExpr
forall r c. (ExprC r, HasUID c, HasSymbol c) =&gt; c -&gt; r
</span><span class="hs-identifier hs-var">sy</span></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679356245"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; CodeExpr -&gt; CodeExpr
forall r. ExprC r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">$&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">c -&gt; CodeExpr
forall c. (HasUID c, HasSymbol c) =&gt; c -&gt; CodeExpr
forall r c. (ExprC r, HasUID c, HasSymbol c) =&gt; c -&gt; r
</span><span class="hs-identifier hs-var">sy</span></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679356245"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; CodeExpr -&gt; CodeExpr
forall r. ExprC r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">$&lt;=</span></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679356249"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-416"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#renderRealInt"><span class="hs-identifier hs-var">renderRealInt</span></a></span><span> </span><span id="local-6989586621679356250"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679356250"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bounded</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Inclusive
</span><span class="hs-identifier hs-var">Inc</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679356251"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679356251"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Inclusive
</span><span class="hs-identifier hs-var">Exc</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679356253"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679356253"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679356251"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; CodeExpr -&gt; CodeExpr
forall r. ExprC r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">$&lt;=</span></span><span> </span><span class="annot"><span class="annottext">c -&gt; CodeExpr
forall c. (HasUID c, HasSymbol c) =&gt; c -&gt; CodeExpr
forall r c. (ExprC r, HasUID c, HasSymbol c) =&gt; c -&gt; r
</span><span class="hs-identifier hs-var">sy</span></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679356250"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; CodeExpr -&gt; CodeExpr
forall r. ExprC r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">$&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">c -&gt; CodeExpr
forall c. (HasUID c, HasSymbol c) =&gt; c -&gt; CodeExpr
forall r c. (ExprC r, HasUID c, HasSymbol c) =&gt; c -&gt; r
</span><span class="hs-identifier hs-var">sy</span></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679356250"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; CodeExpr -&gt; CodeExpr
forall r. ExprC r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">$&lt;</span></span><span>  </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679356253"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-417"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#renderRealInt"><span class="hs-identifier hs-var">renderRealInt</span></a></span><span> </span><span id="local-6989586621679356254"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679356254"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bounded</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Inclusive
</span><span class="hs-identifier hs-var">Exc</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679356255"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679356255"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Inclusive
</span><span class="hs-identifier hs-var">Inc</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679356256"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679356256"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679356255"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; CodeExpr -&gt; CodeExpr
forall r. ExprC r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">$&lt;</span></span><span>  </span><span class="annot"><span class="annottext">c -&gt; CodeExpr
forall c. (HasUID c, HasSymbol c) =&gt; c -&gt; CodeExpr
forall r c. (ExprC r, HasUID c, HasSymbol c) =&gt; c -&gt; r
</span><span class="hs-identifier hs-var">sy</span></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679356254"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; CodeExpr -&gt; CodeExpr
forall r. ExprC r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">$&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">c -&gt; CodeExpr
forall c. (HasUID c, HasSymbol c) =&gt; c -&gt; CodeExpr
forall r c. (ExprC r, HasUID c, HasSymbol c) =&gt; c -&gt; r
</span><span class="hs-identifier hs-var">sy</span></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679356254"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; CodeExpr -&gt; CodeExpr
forall r. ExprC r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">$&lt;=</span></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679356256"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-418"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#renderRealInt"><span class="hs-identifier hs-var">renderRealInt</span></a></span><span> </span><span id="local-6989586621679356257"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679356257"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bounded</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Inclusive
</span><span class="hs-identifier hs-var">Exc</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679356258"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679356258"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Inclusive
</span><span class="hs-identifier hs-var">Exc</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679356259"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679356259"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679356258"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; CodeExpr -&gt; CodeExpr
forall r. ExprC r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">$&lt;</span></span><span>  </span><span class="annot"><span class="annottext">c -&gt; CodeExpr
forall c. (HasUID c, HasSymbol c) =&gt; c -&gt; CodeExpr
forall r c. (ExprC r, HasUID c, HasSymbol c) =&gt; c -&gt; r
</span><span class="hs-identifier hs-var">sy</span></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679356257"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; CodeExpr -&gt; CodeExpr
forall r. ExprC r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">$&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">c -&gt; CodeExpr
forall c. (HasUID c, HasSymbol c) =&gt; c -&gt; CodeExpr
forall r c. (ExprC r, HasUID c, HasSymbol c) =&gt; c -&gt; r
</span><span class="hs-identifier hs-var">sy</span></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679356257"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; CodeExpr -&gt; CodeExpr
forall r. ExprC r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">$&lt;</span></span><span>  </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679356259"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-419"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#renderRealInt"><span class="hs-identifier hs-var">renderRealInt</span></a></span><span> </span><span id="local-6989586621679356260"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679356260"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UpTo</span></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Inclusive
</span><span class="hs-identifier hs-var">Inc</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679356262"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679356262"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">c -&gt; CodeExpr
forall c. (HasUID c, HasSymbol c) =&gt; c -&gt; CodeExpr
forall r c. (ExprC r, HasUID c, HasSymbol c) =&gt; c -&gt; r
</span><span class="hs-identifier hs-var">sy</span></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679356260"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; CodeExpr -&gt; CodeExpr
forall r. ExprC r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">$&lt;=</span></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679356262"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-420"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#renderRealInt"><span class="hs-identifier hs-var">renderRealInt</span></a></span><span> </span><span id="local-6989586621679356263"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679356263"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UpTo</span></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Inclusive
</span><span class="hs-identifier hs-var">Exc</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679356264"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679356264"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">c -&gt; CodeExpr
forall c. (HasUID c, HasSymbol c) =&gt; c -&gt; CodeExpr
forall r c. (ExprC r, HasUID c, HasSymbol c) =&gt; c -&gt; r
</span><span class="hs-identifier hs-var">sy</span></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679356263"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; CodeExpr -&gt; CodeExpr
forall r. ExprC r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">$&lt;</span></span><span>  </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679356264"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-421"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#renderRealInt"><span class="hs-identifier hs-var">renderRealInt</span></a></span><span> </span><span id="local-6989586621679356265"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679356265"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UpFrom</span></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Inclusive
</span><span class="hs-identifier hs-var">Inc</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679356267"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679356267"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">c -&gt; CodeExpr
forall c. (HasUID c, HasSymbol c) =&gt; c -&gt; CodeExpr
forall r c. (ExprC r, HasUID c, HasSymbol c) =&gt; c -&gt; r
</span><span class="hs-identifier hs-var">sy</span></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679356265"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; CodeExpr -&gt; CodeExpr
forall r. ExprC r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">$&gt;=</span></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679356267"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-422"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#renderRealInt"><span class="hs-identifier hs-var">renderRealInt</span></a></span><span> </span><span id="local-6989586621679356268"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679356268"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UpFrom</span></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Inclusive
</span><span class="hs-identifier hs-var">Exc</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679356269"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679356269"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">c -&gt; CodeExpr
forall c. (HasUID c, HasSymbol c) =&gt; c -&gt; CodeExpr
forall r c. (ExprC r, HasUID c, HasSymbol c) =&gt; c -&gt; r
</span><span class="hs-identifier hs-var">sy</span></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679356268"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; CodeExpr -&gt; CodeExpr
forall r. ExprC r =&gt; r -&gt; r -&gt; r
</span><span class="hs-operator hs-var">$&gt;</span></span><span>  </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679356269"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-423"></span><span>
</span><span id="line-424"></span><span id="local-6989586621679353844"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#renderSet"><span class="hs-identifier hs-type">renderSet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">HasUID</span></span><span> </span><span class="annot"><a href="#local-6989586621679353844"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasSymbol</span></span><span> </span><span class="annot"><a href="#local-6989586621679353844"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679353844"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CodeExpr</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CodeExpr</span></span></span><span>
</span><span id="line-425"></span><span id="renderSet"><span class="annot"><span class="annottext">renderSet :: forall c. (HasUID c, HasSymbol c) =&gt; c -&gt; CodeExpr -&gt; CodeExpr
</span><a href="Language.Drasil.Code.Imperative.Import.html#renderSet"><span class="hs-identifier hs-var hs-var">renderSet</span></a></span></span><span> </span><span id="local-6989586621679356277"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679356277"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679356278"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679356278"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; CodeExpr -&gt; CodeExpr
forall r. ExprC r =&gt; r -&gt; r -&gt; r
</span><span class="hs-identifier hs-var">in'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; CodeExpr -&gt; CodeExpr
</span><span class="hs-identifier hs-var">Variable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;set_&quot;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">c -&gt; Name
forall x. HasSymbol x =&gt; x -&gt; Name
</span><span class="hs-identifier hs-var">showHasSymbImpl</span></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679356277"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679356278"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">c -&gt; CodeExpr
forall c. (HasUID c, HasSymbol c) =&gt; c -&gt; CodeExpr
forall r c. (ExprC r, HasUID c, HasSymbol c) =&gt; c -&gt; r
</span><span class="hs-identifier hs-var">sy</span></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679356277"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-426"></span><span>
</span><span id="line-427"></span><span class="annot"><span class="hs-comment">-- | Maps a 'UFunc' to the corresponding GOOL unary function.</span></span><span>
</span><span id="line-428"></span><span id="local-6989586621679353789"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#unop"><span class="hs-identifier hs-type">unop</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353789"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UFunc</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679353789"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679353789"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-429"></span><span id="unop"><span class="annot"><span class="annottext">unop :: forall (r :: * -&gt; *). SharedProg r =&gt; UFunc -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#unop"><span class="hs-identifier hs-var hs-var">unop</span></a></span></span><span> </span><span class="annot"><span class="annottext">UFunc
</span><span class="hs-identifier hs-var">Sqrt</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r
forall (r :: * -&gt; *). NumericExpression r =&gt; SValue r -&gt; SValue r
</span><span class="hs-operator hs-var">(#/^)</span></span><span>
</span><span id="line-430"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#unop"><span class="hs-identifier hs-var">unop</span></a></span><span> </span><span class="annot"><span class="annottext">UFunc
</span><span class="hs-identifier hs-var">Log</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r
forall (r :: * -&gt; *). NumericExpression r =&gt; SValue r -&gt; SValue r
</span><span class="hs-identifier hs-var">log</span></span><span>
</span><span id="line-431"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#unop"><span class="hs-identifier hs-var">unop</span></a></span><span> </span><span class="annot"><span class="annottext">UFunc
</span><span class="hs-identifier hs-var">Ln</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r
forall (r :: * -&gt; *). NumericExpression r =&gt; SValue r -&gt; SValue r
</span><span class="hs-identifier hs-var">ln</span></span><span>
</span><span id="line-432"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#unop"><span class="hs-identifier hs-var">unop</span></a></span><span> </span><span class="annot"><span class="annottext">UFunc
</span><span class="hs-identifier hs-var">Abs</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r
forall (r :: * -&gt; *). NumericExpression r =&gt; SValue r -&gt; SValue r
</span><span class="hs-operator hs-var">(#|)</span></span><span>
</span><span id="line-433"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#unop"><span class="hs-identifier hs-var">unop</span></a></span><span> </span><span class="annot"><span class="annottext">UFunc
</span><span class="hs-identifier hs-var">Exp</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r
forall (r :: * -&gt; *). NumericExpression r =&gt; SValue r -&gt; SValue r
</span><span class="hs-identifier hs-var">exp</span></span><span>
</span><span id="line-434"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#unop"><span class="hs-identifier hs-var">unop</span></a></span><span> </span><span class="annot"><span class="annottext">UFunc
</span><span class="hs-identifier hs-var">Sin</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r
forall (r :: * -&gt; *). NumericExpression r =&gt; SValue r -&gt; SValue r
</span><span class="hs-identifier hs-var">sin</span></span><span>
</span><span id="line-435"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#unop"><span class="hs-identifier hs-var">unop</span></a></span><span> </span><span class="annot"><span class="annottext">UFunc
</span><span class="hs-identifier hs-var">Cos</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r
forall (r :: * -&gt; *). NumericExpression r =&gt; SValue r -&gt; SValue r
</span><span class="hs-identifier hs-var">cos</span></span><span>
</span><span id="line-436"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#unop"><span class="hs-identifier hs-var">unop</span></a></span><span> </span><span class="annot"><span class="annottext">UFunc
</span><span class="hs-identifier hs-var">Tan</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r
forall (r :: * -&gt; *). NumericExpression r =&gt; SValue r -&gt; SValue r
</span><span class="hs-identifier hs-var">tan</span></span><span>
</span><span id="line-437"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#unop"><span class="hs-identifier hs-var">unop</span></a></span><span> </span><span class="annot"><span class="annottext">UFunc
</span><span class="hs-identifier hs-var">Csc</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r
forall (r :: * -&gt; *). NumericExpression r =&gt; SValue r -&gt; SValue r
</span><span class="hs-identifier hs-var">csc</span></span><span>
</span><span id="line-438"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#unop"><span class="hs-identifier hs-var">unop</span></a></span><span> </span><span class="annot"><span class="annottext">UFunc
</span><span class="hs-identifier hs-var">Sec</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r
forall (r :: * -&gt; *). NumericExpression r =&gt; SValue r -&gt; SValue r
</span><span class="hs-identifier hs-var">sec</span></span><span>
</span><span id="line-439"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#unop"><span class="hs-identifier hs-var">unop</span></a></span><span> </span><span class="annot"><span class="annottext">UFunc
</span><span class="hs-identifier hs-var">Cot</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r
forall (r :: * -&gt; *). NumericExpression r =&gt; SValue r -&gt; SValue r
</span><span class="hs-identifier hs-var">cot</span></span><span>
</span><span id="line-440"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#unop"><span class="hs-identifier hs-var">unop</span></a></span><span> </span><span class="annot"><span class="annottext">UFunc
</span><span class="hs-identifier hs-var">Arcsin</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r
forall (r :: * -&gt; *). NumericExpression r =&gt; SValue r -&gt; SValue r
</span><span class="hs-identifier hs-var">arcsin</span></span><span>
</span><span id="line-441"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#unop"><span class="hs-identifier hs-var">unop</span></a></span><span> </span><span class="annot"><span class="annottext">UFunc
</span><span class="hs-identifier hs-var">Arccos</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r
forall (r :: * -&gt; *). NumericExpression r =&gt; SValue r -&gt; SValue r
</span><span class="hs-identifier hs-var">arccos</span></span><span>
</span><span id="line-442"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#unop"><span class="hs-identifier hs-var">unop</span></a></span><span> </span><span class="annot"><span class="annottext">UFunc
</span><span class="hs-identifier hs-var">Arctan</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r
forall (r :: * -&gt; *). NumericExpression r =&gt; SValue r -&gt; SValue r
</span><span class="hs-identifier hs-var">arctan</span></span><span>
</span><span id="line-443"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#unop"><span class="hs-identifier hs-var">unop</span></a></span><span> </span><span class="annot"><span class="annottext">UFunc
</span><span class="hs-identifier hs-var">Neg</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r
forall (r :: * -&gt; *). NumericExpression r =&gt; SValue r -&gt; SValue r
</span><span class="hs-operator hs-var">(#~)</span></span><span>
</span><span id="line-444"></span><span>
</span><span id="line-445"></span><span class="annot"><span class="hs-comment">-- | Similar to 'unop', but for the 'Not' constructor.</span></span><span>
</span><span id="line-446"></span><span id="local-6989586621679353791"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#unopB"><span class="hs-identifier hs-type">unopB</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353791"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UFuncB</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679353791"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679353791"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-447"></span><span id="unopB"><span class="annot"><span class="annottext">unopB :: forall (r :: * -&gt; *).
SharedProg r =&gt;
UFuncB -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#unopB"><span class="hs-identifier hs-var hs-var">unopB</span></a></span></span><span> </span><span class="annot"><span class="annottext">UFuncB
</span><span class="hs-identifier hs-var">Not</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r
forall (r :: * -&gt; *). BooleanExpression r =&gt; SValue r -&gt; SValue r
</span><span class="hs-operator hs-var">(?!)</span></span><span>
</span><span id="line-448"></span><span>
</span><span id="line-449"></span><span class="annot"><span class="hs-comment">-- | Similar to 'unop', but for vectors.</span></span><span>
</span><span id="line-450"></span><span id="local-6989586621679353795"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#unopVN"><span class="hs-identifier hs-type">unopVN</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353795"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UFuncVN</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679353795"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679353795"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-451"></span><span id="unopVN"><span class="annot"><span class="annottext">unopVN :: forall (r :: * -&gt; *).
SharedProg r =&gt;
UFuncVN -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#unopVN"><span class="hs-identifier hs-var hs-var">unopVN</span></a></span></span><span> </span><span class="annot"><span class="annottext">UFuncVN
</span><span class="hs-identifier hs-var">Dim</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r
forall (r :: * -&gt; *). List r =&gt; SValue r -&gt; SValue r
</span><span class="hs-identifier hs-var">listSize</span></span><span>
</span><span id="line-452"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#unopVN"><span class="hs-identifier hs-var">unopVN</span></a></span><span> </span><span class="annot"><span class="annottext">UFuncVN
</span><span class="hs-identifier hs-var">Norm</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; SValue r -&gt; SValue r
forall a. HasCallStack =&gt; Name -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;unop: Norm not implemented&quot;</span></span><span> </span><span class="hs-comment">-- TODO</span><span>
</span><span id="line-453"></span><span>
</span><span id="line-454"></span><span class="annot"><span class="hs-comment">-- | Similar to 'unop', but for vectors.</span></span><span>
</span><span id="line-455"></span><span id="local-6989586621679353793"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#unopVV"><span class="hs-identifier hs-type">unopVV</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353793"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UFuncVV</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679353793"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679353793"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-456"></span><span id="unopVV"><span class="annot"><span class="annottext">unopVV :: forall (r :: * -&gt; *).
SharedProg r =&gt;
UFuncVV -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#unopVV"><span class="hs-identifier hs-var hs-var">unopVV</span></a></span></span><span> </span><span class="annot"><span class="annottext">UFuncVV
</span><span class="hs-identifier hs-var">NegV</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; VS (r (Value r)) -&gt; VS (r (Value r))
forall a. HasCallStack =&gt; Name -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;unop: Negation on Vectors not implemented&quot;</span></span><span> </span><span class="hs-comment">-- TODO</span><span>
</span><span id="line-457"></span><span>
</span><span id="line-458"></span><span class="hs-comment">-- Maps an 'ArithBinOp' to it's corresponding GOOL binary function.</span><span>
</span><span id="line-459"></span><span id="local-6989586621679353802"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#arithBfunc"><span class="hs-identifier hs-type">arithBfunc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353802"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ArithBinOp</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679353802"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679353802"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679353802"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-460"></span><span id="arithBfunc"><span class="annot"><span class="annottext">arithBfunc :: forall (r :: * -&gt; *).
SharedProg r =&gt;
ArithBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#arithBfunc"><span class="hs-identifier hs-var hs-var">arithBfunc</span></a></span></span><span> </span><span class="annot"><span class="annottext">ArithBinOp
</span><span class="hs-identifier hs-var">Pow</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
NumericExpression r =&gt;
SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-operator hs-var">(#^)</span></span><span>
</span><span id="line-461"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#arithBfunc"><span class="hs-identifier hs-var">arithBfunc</span></a></span><span> </span><span class="annot"><span class="annottext">ArithBinOp
</span><span class="hs-identifier hs-var">Subt</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
NumericExpression r =&gt;
SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-operator hs-var">(#-)</span></span><span>
</span><span id="line-462"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#arithBfunc"><span class="hs-identifier hs-var">arithBfunc</span></a></span><span> </span><span class="annot"><span class="annottext">ArithBinOp
</span><span class="hs-identifier hs-var">Frac</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
NumericExpression r =&gt;
SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-operator hs-var">(#/)</span></span><span>
</span><span id="line-463"></span><span>
</span><span id="line-464"></span><span class="hs-comment">-- Maps a 'BoolBinOp' to it's corresponding GOOL binary function.</span><span>
</span><span id="line-465"></span><span id="local-6989586621679353804"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#boolBfunc"><span class="hs-identifier hs-type">boolBfunc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BoolBinOp</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679353804"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679353804"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679353804"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-466"></span><span id="boolBfunc"><span class="annot"><span class="annottext">boolBfunc :: forall (r :: * -&gt; *). BoolBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#boolBfunc"><span class="hs-identifier hs-var hs-var">boolBfunc</span></a></span></span><span> </span><span class="annot"><span class="annottext">BoolBinOp
</span><span class="hs-identifier hs-var">Impl</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; VS (r (Value r)) -&gt; VS (r (Value r)) -&gt; VS (r (Value r))
forall a. HasCallStack =&gt; Name -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;convExpr :=&gt;&quot;</span></span><span>
</span><span id="line-467"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#boolBfunc"><span class="hs-identifier hs-var">boolBfunc</span></a></span><span> </span><span class="annot"><span class="annottext">BoolBinOp
</span><span class="hs-identifier hs-var">Iff</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; VS (r (Value r)) -&gt; VS (r (Value r)) -&gt; VS (r (Value r))
forall a. HasCallStack =&gt; Name -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;convExpr :&lt;=&gt;&quot;</span></span><span>
</span><span id="line-468"></span><span>
</span><span id="line-469"></span><span class="hs-comment">-- Maps an 'EqBinOp' to it's corresponding GOOL binary function.</span><span>
</span><span id="line-470"></span><span id="local-6989586621679353808"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#eqBfunc"><span class="hs-identifier hs-type">eqBfunc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353808"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EqBinOp</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679353808"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679353808"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679353808"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-471"></span><span id="eqBfunc"><span class="annot"><span class="annottext">eqBfunc :: forall (r :: * -&gt; *).
SharedProg r =&gt;
EqBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#eqBfunc"><span class="hs-identifier hs-var hs-var">eqBfunc</span></a></span></span><span> </span><span class="annot"><span class="annottext">EqBinOp
</span><span class="hs-identifier hs-var">Eq</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
Comparison r =&gt;
SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-operator hs-var">(?==)</span></span><span>
</span><span id="line-472"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#eqBfunc"><span class="hs-identifier hs-var">eqBfunc</span></a></span><span> </span><span class="annot"><span class="annottext">EqBinOp
</span><span class="hs-identifier hs-var">NEq</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
Comparison r =&gt;
SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-operator hs-var">(?!=)</span></span><span>
</span><span id="line-473"></span><span>
</span><span id="line-474"></span><span class="hs-comment">-- Maps an 'LABinOp' to it's corresponding GOOL binary function.</span><span>
</span><span id="line-475"></span><span id="local-6989586621679353806"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#laBfunc"><span class="hs-identifier hs-type">laBfunc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353806"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LABinOp</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679353806"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679353806"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679353806"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-476"></span><span id="laBfunc"><span class="annot"><span class="annottext">laBfunc :: forall (r :: * -&gt; *).
SharedProg r =&gt;
LABinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#laBfunc"><span class="hs-identifier hs-var hs-var">laBfunc</span></a></span></span><span> </span><span class="annot"><span class="annottext">LABinOp
</span><span class="hs-identifier hs-var">Index</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *). List r =&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-identifier hs-var">listAccess</span></span><span>
</span><span id="line-477"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#laBfunc"><span class="hs-identifier hs-var">laBfunc</span></a></span><span> </span><span class="annot"><span class="annottext">LABinOp
</span><span class="hs-identifier hs-var">IndexOf</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *). List r =&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-identifier hs-var">indexOf</span></span><span>
</span><span id="line-478"></span><span>
</span><span id="line-479"></span><span class="hs-comment">-- Maps an 'OrdBinOp' to it's corresponding GOOL binary function.</span><span>
</span><span id="line-480"></span><span id="local-6989586621679353810"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#ordBfunc"><span class="hs-identifier hs-type">ordBfunc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353810"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">OrdBinOp</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679353810"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679353810"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679353810"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-481"></span><span id="ordBfunc"><span class="annot"><span class="annottext">ordBfunc :: forall (r :: * -&gt; *).
SharedProg r =&gt;
OrdBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#ordBfunc"><span class="hs-identifier hs-var hs-var">ordBfunc</span></a></span></span><span> </span><span class="annot"><span class="annottext">OrdBinOp
</span><span class="hs-identifier hs-var">Gt</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
Comparison r =&gt;
SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-operator hs-var">(?&gt;)</span></span><span>
</span><span id="line-482"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#ordBfunc"><span class="hs-identifier hs-var">ordBfunc</span></a></span><span> </span><span class="annot"><span class="annottext">OrdBinOp
</span><span class="hs-identifier hs-var">Lt</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
Comparison r =&gt;
SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-operator hs-var">(?&lt;)</span></span><span>
</span><span id="line-483"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#ordBfunc"><span class="hs-identifier hs-var">ordBfunc</span></a></span><span> </span><span class="annot"><span class="annottext">OrdBinOp
</span><span class="hs-identifier hs-var">LEq</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
Comparison r =&gt;
SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-operator hs-var">(?&lt;=)</span></span><span>
</span><span id="line-484"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#ordBfunc"><span class="hs-identifier hs-var">ordBfunc</span></a></span><span> </span><span class="annot"><span class="annottext">OrdBinOp
</span><span class="hs-identifier hs-var">GEq</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
Comparison r =&gt;
SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-operator hs-var">(?&gt;=)</span></span><span>
</span><span id="line-485"></span><span>
</span><span id="line-486"></span><span class="hs-comment">-- Maps a 'VVVBinOp' to it's corresponding GOOL binary function.</span><span>
</span><span id="line-487"></span><span id="local-6989586621679353812"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#vecVecVecBfunc"><span class="hs-identifier hs-type">vecVecVecBfunc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VVVBinOp</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679353812"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679353812"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679353812"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-488"></span><span id="vecVecVecBfunc"><span class="annot"><span class="annottext">vecVecVecBfunc :: forall (r :: * -&gt; *). VVVBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#vecVecVecBfunc"><span class="hs-identifier hs-var hs-var">vecVecVecBfunc</span></a></span></span><span> </span><span class="annot"><span class="annottext">VVVBinOp
</span><span class="hs-identifier hs-var">Cross</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; VS (r (Value r)) -&gt; VS (r (Value r)) -&gt; VS (r (Value r))
forall a. HasCallStack =&gt; Name -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;bfunc: Cross not implemented&quot;</span></span><span>
</span><span id="line-489"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#vecVecVecBfunc"><span class="hs-identifier hs-var">vecVecVecBfunc</span></a></span><span> </span><span class="annot"><span class="annottext">VVVBinOp
</span><span class="hs-identifier hs-var">VAdd</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; VS (r (Value r)) -&gt; VS (r (Value r)) -&gt; VS (r (Value r))
forall a. HasCallStack =&gt; Name -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;bfunc: Vector addition not implemented&quot;</span></span><span>
</span><span id="line-490"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#vecVecVecBfunc"><span class="hs-identifier hs-var">vecVecVecBfunc</span></a></span><span> </span><span class="annot"><span class="annottext">VVVBinOp
</span><span class="hs-identifier hs-var">VSub</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; VS (r (Value r)) -&gt; VS (r (Value r)) -&gt; VS (r (Value r))
forall a. HasCallStack =&gt; Name -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;bfunc: Vector subtraction not implemented&quot;</span></span><span>
</span><span id="line-491"></span><span>
</span><span id="line-492"></span><span class="hs-comment">-- Maps a 'VVNBinOp' to it's corresponding GOOL binary function.</span><span>
</span><span id="line-493"></span><span id="local-6989586621679353814"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#vecVecNumBfunc"><span class="hs-identifier hs-type">vecVecNumBfunc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VVNBinOp</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679353814"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679353814"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679353814"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-494"></span><span id="vecVecNumBfunc"><span class="annot"><span class="annottext">vecVecNumBfunc :: forall (r :: * -&gt; *). VVNBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#vecVecNumBfunc"><span class="hs-identifier hs-var hs-var">vecVecNumBfunc</span></a></span></span><span> </span><span class="annot"><span class="annottext">VVNBinOp
</span><span class="hs-identifier hs-var">Dot</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; VS (r (Value r)) -&gt; VS (r (Value r)) -&gt; VS (r (Value r))
forall a. HasCallStack =&gt; Name -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;convExpr DotProduct&quot;</span></span><span>
</span><span id="line-495"></span><span>
</span><span id="line-496"></span><span class="hs-comment">-- Maps a 'NVVBinOp' to it's corresponding GOOL binary function.</span><span>
</span><span id="line-497"></span><span id="local-6989586621679353816"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#numVecVecBfunc"><span class="hs-identifier hs-type">numVecVecBfunc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NVVBinOp</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679353816"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679353816"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679353816"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-498"></span><span id="numVecVecBfunc"><span class="annot"><span class="annottext">numVecVecBfunc :: forall (r :: * -&gt; *). NVVBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#numVecVecBfunc"><span class="hs-identifier hs-var hs-var">numVecVecBfunc</span></a></span></span><span> </span><span class="annot"><span class="annottext">NVVBinOp
</span><span class="hs-identifier hs-var">Scale</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; VS (r (Value r)) -&gt; VS (r (Value r)) -&gt; VS (r (Value r))
forall a. HasCallStack =&gt; Name -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;convExpr Scaling of Vectors&quot;</span></span><span>
</span><span id="line-499"></span><span>
</span><span id="line-500"></span><span class="hs-comment">-- Maps a 'ESSBinOp' to its corresponding GOOL binary function.</span><span>
</span><span id="line-501"></span><span id="local-6989586621679353818"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#elementSetSetBfunc"><span class="hs-identifier hs-type">elementSetSetBfunc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353818"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ESSBinOp</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679353818"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679353818"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679353818"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-502"></span><span id="elementSetSetBfunc"><span class="annot"><span class="annottext">elementSetSetBfunc :: forall (r :: * -&gt; *).
SharedProg r =&gt;
ESSBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#elementSetSetBfunc"><span class="hs-identifier hs-var hs-var">elementSetSetBfunc</span></a></span></span><span> </span><span class="annot"><span class="annottext">ESSBinOp
</span><span class="hs-identifier hs-var">SAdd</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *). Set r =&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-identifier hs-var">S.setAdd</span></span><span>
</span><span id="line-503"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#elementSetSetBfunc"><span class="hs-identifier hs-var">elementSetSetBfunc</span></a></span><span> </span><span class="annot"><span class="annottext">ESSBinOp
</span><span class="hs-identifier hs-var">SRemove</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *). Set r =&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-identifier hs-var">S.setRemove</span></span><span>
</span><span id="line-504"></span><span>
</span><span id="line-505"></span><span class="hs-comment">-- Maps a 'ESSBinOp' to it's corresponding GOOL binary function.</span><span>
</span><span id="line-506"></span><span id="local-6989586621679353820"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#elementSetBoolBfunc"><span class="hs-identifier hs-type">elementSetBoolBfunc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353820"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ESBBinOp</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679353820"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679353820"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679353820"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-507"></span><span id="elementSetBoolBfunc"><span class="annot"><span class="annottext">elementSetBoolBfunc :: forall (r :: * -&gt; *).
SharedProg r =&gt;
ESBBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#elementSetBoolBfunc"><span class="hs-identifier hs-var hs-var">elementSetBoolBfunc</span></a></span></span><span> </span><span class="annot"><span class="annottext">ESBBinOp
</span><span class="hs-identifier hs-var">SContains</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *). Set r =&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-identifier hs-var">S.contains</span></span><span>
</span><span id="line-508"></span><span>
</span><span id="line-509"></span><span class="hs-comment">-- medium hacks --</span><span>
</span><span id="line-510"></span><span>
</span><span id="line-511"></span><span class="annot"><span class="hs-comment">-- | Converts a 'Mod' to GOOL.</span></span><span>
</span><span id="line-512"></span><span id="local-6989586621679353869"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#genModDef"><span class="hs-identifier hs-type">genModDef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353869"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Mod"><span class="hs-identifier hs-type">Mod</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OO.SFile</span></span><span> </span><span class="annot"><a href="#local-6989586621679353869"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-513"></span><span id="genModDef"><span class="annot"><span class="annottext">genModDef :: forall (r :: * -&gt; *). OOProg r =&gt; Mod -&gt; GenState (SFile r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genModDef"><span class="hs-identifier hs-var hs-var">genModDef</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#Mod"><span class="hs-identifier hs-type">Mod</span></a></span><span> </span><span id="local-6989586621679356429"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679356429"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679356430"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679356430"><span class="hs-identifier hs-var">desc</span></a></span></span><span> </span><span id="local-6989586621679356431"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679356431"><span class="hs-identifier hs-var">is</span></a></span></span><span> </span><span id="local-6989586621679356432"><span class="annot"><span class="annottext">[Class]
</span><a href="#local-6989586621679356432"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span id="local-6989586621679356433"><span class="annot"><span class="annottext">[Func]
</span><a href="#local-6989586621679356433"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; Name
-&gt; [Name]
-&gt; [GenState (Maybe (SMethod r))]
-&gt; [GenState (Maybe (SClass r))]
-&gt; StateT
     DrasilState Identity (StateT FileState Identity (r (File r)))
forall (r :: * -&gt; *).
OOProg r =&gt;
Name
-&gt; Name
-&gt; [Name]
-&gt; [GenState (Maybe (SMethod r))]
-&gt; [GenState (Maybe (SClass r))]
-&gt; GenState (SFile r)
</span><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html#genModuleWithImports"><span class="hs-identifier hs-var">genModuleWithImports</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679356429"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679356430"><span class="hs-identifier hs-var">desc</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679356431"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Func -&gt; GenState (Maybe (SMethod r)))
-&gt; [Func] -&gt; [GenState (Maybe (SMethod r))]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(SMethod r -&gt; Maybe (SMethod r))
-&gt; StateT DrasilState Identity (SMethod r)
-&gt; GenState (Maybe (SMethod r))
forall a b.
(a -&gt; b)
-&gt; StateT DrasilState Identity a -&gt; StateT DrasilState Identity b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span>
</span><span id="line-514"></span><span>  </span><span class="annot"><span class="annottext">SMethod r -&gt; Maybe (SMethod r)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(StateT DrasilState Identity (SMethod r)
 -&gt; GenState (Maybe (SMethod r)))
-&gt; (Func -&gt; StateT DrasilState Identity (SMethod r))
-&gt; Func
-&gt; GenState (Maybe (SMethod r))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Name
 -&gt; VSType r
 -&gt; Name
 -&gt; [ParameterChunk]
 -&gt; Maybe Name
 -&gt; [MSBlock r]
 -&gt; StateT DrasilState Identity (SMethod r))
-&gt; [StateVariable]
-&gt; Func
-&gt; StateT DrasilState Identity (SMethod r)
forall (r :: * -&gt; *).
OOProg r =&gt;
(Name
 -&gt; VSType r
 -&gt; Name
 -&gt; [ParameterChunk]
 -&gt; Maybe Name
 -&gt; [MSBlock r]
 -&gt; GenState (SMethod r))
-&gt; [StateVariable] -&gt; Func -&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genFunc"><span class="hs-identifier hs-var">genFunc</span></a></span><span> </span><span class="annot"><span class="annottext">Name
-&gt; VSType r
-&gt; Name
-&gt; [ParameterChunk]
-&gt; Maybe Name
-&gt; [MSBlock r]
-&gt; StateT DrasilState Identity (SMethod r)
forall (r :: * -&gt; *).
OOProg r =&gt;
Name
-&gt; VSType r
-&gt; Name
-&gt; [ParameterChunk]
-&gt; Maybe Name
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#publicFunc"><span class="hs-identifier hs-var">publicFunc</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Func]
</span><a href="#local-6989586621679356433"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-515"></span><span>  </span><span class="hs-special">(</span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Class]
</span><a href="#local-6989586621679356432"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-516"></span><span>              </span><span class="hs-special">(</span><span id="local-6989586621679356435"><span class="annot"><span class="annottext">Class
</span><a href="#local-6989586621679356435"><span class="hs-identifier hs-var">cl</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679356436"><span class="annot"><span class="annottext">[Class]
</span><a href="#local-6989586621679356436"><span class="hs-identifier hs-var">cls</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(SClass r -&gt; Maybe (SClass r))
-&gt; StateT DrasilState Identity (SClass r)
-&gt; GenState (Maybe (SClass r))
forall a b.
(a -&gt; b)
-&gt; StateT DrasilState Identity a -&gt; StateT DrasilState Identity b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">SClass r -&gt; Maybe (SClass r)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name
 -&gt; Maybe Name
 -&gt; Name
 -&gt; [CSStateVar r]
 -&gt; GenState [SMethod r]
 -&gt; GenState [SMethod r]
 -&gt; StateT DrasilState Identity (SClass r))
-&gt; Class -&gt; StateT DrasilState Identity (SClass r)
forall (r :: * -&gt; *).
OOProg r =&gt;
(Name
 -&gt; Maybe Name
 -&gt; Name
 -&gt; [CSStateVar r]
 -&gt; GenState [SMethod r]
 -&gt; GenState [SMethod r]
 -&gt; GenState (SClass r))
-&gt; Class -&gt; GenState (SClass r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genClass"><span class="hs-identifier hs-var">genClass</span></a></span><span> </span><span class="annot"><span class="annottext">Name
-&gt; Maybe Name
-&gt; Name
-&gt; [CSStateVar r]
-&gt; GenState [SMethod r]
-&gt; GenState [SMethod r]
-&gt; StateT DrasilState Identity (SClass r)
forall (r :: * -&gt; *).
OOProg r =&gt;
Name
-&gt; Maybe Name
-&gt; Name
-&gt; [CSStateVar r]
-&gt; GenState [SMethod r]
-&gt; GenState [SMethod r]
-&gt; GenState (SClass r)
</span><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html#primaryClass"><span class="hs-identifier hs-var">primaryClass</span></a></span><span> </span><span class="annot"><span class="annottext">Class
</span><a href="#local-6989586621679356435"><span class="hs-identifier hs-var">cl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">GenState (Maybe (SClass r))
-&gt; [GenState (Maybe (SClass r))] -&gt; [GenState (Maybe (SClass r))]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span>
</span><span id="line-517"></span><span>                </span><span class="annot"><span class="annottext">(Class -&gt; GenState (Maybe (SClass r)))
-&gt; [Class] -&gt; [GenState (Maybe (SClass r))]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(SClass r -&gt; Maybe (SClass r))
-&gt; StateT DrasilState Identity (SClass r)
-&gt; GenState (Maybe (SClass r))
forall a b.
(a -&gt; b)
-&gt; StateT DrasilState Identity a -&gt; StateT DrasilState Identity b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">SClass r -&gt; Maybe (SClass r)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(StateT DrasilState Identity (SClass r)
 -&gt; GenState (Maybe (SClass r)))
-&gt; (Class -&gt; StateT DrasilState Identity (SClass r))
-&gt; Class
-&gt; GenState (Maybe (SClass r))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Name
 -&gt; Maybe Name
 -&gt; Name
 -&gt; [CSStateVar r]
 -&gt; GenState [SMethod r]
 -&gt; GenState [SMethod r]
 -&gt; StateT DrasilState Identity (SClass r))
-&gt; Class -&gt; StateT DrasilState Identity (SClass r)
forall (r :: * -&gt; *).
OOProg r =&gt;
(Name
 -&gt; Maybe Name
 -&gt; Name
 -&gt; [CSStateVar r]
 -&gt; GenState [SMethod r]
 -&gt; GenState [SMethod r]
 -&gt; GenState (SClass r))
-&gt; Class -&gt; GenState (SClass r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genClass"><span class="hs-identifier hs-var">genClass</span></a></span><span> </span><span class="annot"><span class="annottext">Name
-&gt; Maybe Name
-&gt; Name
-&gt; [CSStateVar r]
-&gt; GenState [SMethod r]
-&gt; GenState [SMethod r]
-&gt; StateT DrasilState Identity (SClass r)
forall (r :: * -&gt; *).
OOProg r =&gt;
Name
-&gt; Maybe Name
-&gt; Name
-&gt; [CSStateVar r]
-&gt; GenState [SMethod r]
-&gt; GenState [SMethod r]
-&gt; GenState (SClass r)
</span><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html#auxClass"><span class="hs-identifier hs-var">auxClass</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Class]
</span><a href="#local-6989586621679356436"><span class="hs-identifier hs-var">cls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-518"></span><span>
</span><span id="line-519"></span><span class="annot"><span class="hs-comment">-- | Converts a 'Mod'\'s functions to GOOL.</span></span><span>
</span><span id="line-520"></span><span id="local-6989586621679353884"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#genModFuncs"><span class="hs-identifier hs-type">genModFuncs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353884"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Mod"><span class="hs-identifier hs-type">Mod</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679353884"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-521"></span><span id="genModFuncs"><span class="annot"><span class="annottext">genModFuncs :: forall (r :: * -&gt; *). OOProg r =&gt; Mod -&gt; [GenState (SMethod r)]
</span><a href="Language.Drasil.Code.Imperative.Import.html#genModFuncs"><span class="hs-identifier hs-var hs-var">genModFuncs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#Mod"><span class="hs-identifier hs-type">Mod</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Class]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679356441"><span class="annot"><span class="annottext">[Func]
</span><a href="#local-6989586621679356441"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Func -&gt; GenState (MS (r (Method r))))
-&gt; [Func] -&gt; [GenState (MS (r (Method r)))]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name
 -&gt; VSType r
 -&gt; Name
 -&gt; [ParameterChunk]
 -&gt; Maybe Name
 -&gt; [MSBlock r]
 -&gt; GenState (MS (r (Method r))))
-&gt; [StateVariable] -&gt; Func -&gt; GenState (MS (r (Method r)))
forall (r :: * -&gt; *).
OOProg r =&gt;
(Name
 -&gt; VSType r
 -&gt; Name
 -&gt; [ParameterChunk]
 -&gt; Maybe Name
 -&gt; [MSBlock r]
 -&gt; GenState (SMethod r))
-&gt; [StateVariable] -&gt; Func -&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genFunc"><span class="hs-identifier hs-var">genFunc</span></a></span><span> </span><span class="annot"><span class="annottext">Name
-&gt; VSType r
-&gt; Name
-&gt; [ParameterChunk]
-&gt; Maybe Name
-&gt; [MSBlock r]
-&gt; GenState (MS (r (Method r)))
forall (r :: * -&gt; *).
OOProg r =&gt;
Name
-&gt; VSType r
-&gt; Name
-&gt; [ParameterChunk]
-&gt; Maybe Name
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#publicFunc"><span class="hs-identifier hs-var">publicFunc</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Func]
</span><a href="#local-6989586621679356441"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-522"></span><span>
</span><span id="line-523"></span><span class="annot"><span class="hs-comment">-- | Converts a 'Mod'\'s classes to GOOL.</span></span><span>
</span><span id="line-524"></span><span id="local-6989586621679353886"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#genModClasses"><span class="hs-identifier hs-type">genModClasses</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353886"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Mod"><span class="hs-identifier hs-type">Mod</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SClass</span></span><span> </span><span class="annot"><a href="#local-6989586621679353886"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-525"></span><span id="genModClasses"><span class="annot"><span class="annottext">genModClasses :: forall (r :: * -&gt; *). OOProg r =&gt; Mod -&gt; [GenState (SClass r)]
</span><a href="Language.Drasil.Code.Imperative.Import.html#genModClasses"><span class="hs-identifier hs-var hs-var">genModClasses</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#Mod"><span class="hs-identifier hs-type">Mod</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679356445"><span class="annot"><span class="annottext">[Class]
</span><a href="#local-6989586621679356445"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Func]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Class -&gt; GenState (CS (r (Class r))))
-&gt; [Class] -&gt; [GenState (CS (r (Class r)))]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name
 -&gt; Maybe Name
 -&gt; Name
 -&gt; [CSStateVar r]
 -&gt; GenState [SMethod r]
 -&gt; GenState [SMethod r]
 -&gt; GenState (CS (r (Class r))))
-&gt; Class -&gt; GenState (CS (r (Class r)))
forall (r :: * -&gt; *).
OOProg r =&gt;
(Name
 -&gt; Maybe Name
 -&gt; Name
 -&gt; [CSStateVar r]
 -&gt; GenState [SMethod r]
 -&gt; GenState [SMethod r]
 -&gt; GenState (SClass r))
-&gt; Class -&gt; GenState (SClass r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genClass"><span class="hs-identifier hs-var">genClass</span></a></span><span> </span><span class="annot"><span class="annottext">Name
-&gt; Maybe Name
-&gt; Name
-&gt; [CSStateVar r]
-&gt; GenState [SMethod r]
-&gt; GenState [SMethod r]
-&gt; GenState (CS (r (Class r)))
forall (r :: * -&gt; *).
OOProg r =&gt;
Name
-&gt; Maybe Name
-&gt; Name
-&gt; [CSStateVar r]
-&gt; GenState [SMethod r]
-&gt; GenState [SMethod r]
-&gt; GenState (SClass r)
</span><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html#auxClass"><span class="hs-identifier hs-var">auxClass</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Class]
</span><a href="#local-6989586621679356445"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-526"></span><span>
</span><span id="line-527"></span><span class="hs-comment">-- | Converts a Class (from the Mod AST) to GOOL.</span><span>
</span><span id="line-528"></span><span class="hs-comment">-- The class generator to use is passed as a parameter.</span><span>
</span><span id="line-529"></span><span id="local-6989586621679353882"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#genClass"><span class="hs-identifier hs-type">genClass</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353882"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Description"><span class="hs-identifier hs-type">Description</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">CSStateVar</span></span><span> </span><span class="annot"><a href="#local-6989586621679353882"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-530"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679353882"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679353882"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SClass</span></span><span> </span><span class="annot"><a href="#local-6989586621679353882"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-531"></span><span>  </span><span class="annot"><a href="Language.Drasil.Mod.html#Class"><span class="hs-identifier hs-type">M.Class</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SClass</span></span><span> </span><span class="annot"><a href="#local-6989586621679353882"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-532"></span><span id="genClass"><span class="annot"><span class="annottext">genClass :: forall (r :: * -&gt; *).
OOProg r =&gt;
(Name
 -&gt; Maybe Name
 -&gt; Name
 -&gt; [CSStateVar r]
 -&gt; GenState [SMethod r]
 -&gt; GenState [SMethod r]
 -&gt; GenState (SClass r))
-&gt; Class -&gt; GenState (SClass r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genClass"><span class="hs-identifier hs-var hs-var">genClass</span></a></span></span><span> </span><span id="local-6989586621679356477"><span class="annot"><span class="annottext">Name
-&gt; Maybe Name
-&gt; Name
-&gt; [CSStateVar r]
-&gt; GenState [SMethod r]
-&gt; GenState [SMethod r]
-&gt; GenState (SClass r)
</span><a href="#local-6989586621679356477"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#ClassDef"><span class="hs-identifier hs-type">M.ClassDef</span></a></span><span> </span><span id="local-6989586621679356479"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679356479"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679356480"><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621679356480"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679356481"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679356481"><span class="hs-identifier hs-var">desc</span></a></span></span><span> </span><span id="local-6989586621679356482"><span class="annot"><span class="annottext">[StateVariable]
</span><a href="#local-6989586621679356482"><span class="hs-identifier hs-var">svs</span></a></span></span><span> </span><span id="local-6989586621679356483"><span class="annot"><span class="annottext">[Func]
</span><a href="#local-6989586621679356483"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span id="local-6989586621679356484"><span class="annot"><span class="annottext">[Func]
</span><a href="#local-6989586621679356484"><span class="hs-identifier hs-var">ms</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679356499"><span class="annot"><span class="annottext">svar :: VisibilityTag -&gt; SVariable r -&gt; CSStateVar r
</span><a href="#local-6989586621679356499"><span class="hs-identifier hs-var hs-var">svar</span></a></span></span><span> </span><span class="annot"><span class="annottext">VisibilityTag
</span><span class="hs-identifier hs-var">Pub</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SVariable r -&gt; CSStateVar r
forall (r :: * -&gt; *). StateVarSym r =&gt; SVariable r -&gt; CSStateVar r
</span><span class="hs-identifier hs-var">pubDVar</span></span><span>
</span><span id="line-533"></span><span>                                                 </span><span class="annot"><a href="#local-6989586621679356499"><span class="hs-identifier hs-var">svar</span></a></span><span> </span><span class="annot"><span class="annottext">VisibilityTag
</span><span class="hs-identifier hs-var">Priv</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SVariable r -&gt; CSStateVar r
forall (r :: * -&gt; *). StateVarSym r =&gt; SVariable r -&gt; CSStateVar r
</span><span class="hs-identifier hs-var">privDVar</span></span><span>
</span><span id="line-534"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-535"></span><span>  </span><span class="annot"><span class="annottext">(DrasilState -&gt; DrasilState) -&gt; StateT DrasilState Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679356502"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679356502"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679356502"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#currentScope"><span class="hs-identifier hs-var">currentScope</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#Local"><span class="hs-identifier hs-type">Local</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-536"></span><span>  </span><span id="local-6989586621679356503"><span class="annot"><span class="annottext">[CSStateVar r]
</span><a href="#local-6989586621679356503"><span class="hs-identifier hs-var">svrs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(StateVariable -&gt; StateT DrasilState Identity (CSStateVar r))
-&gt; [StateVariable] -&gt; StateT DrasilState Identity [CSStateVar r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#SV"><span class="hs-identifier hs-type">SV</span></a></span><span> </span><span id="local-6989586621679356505"><span class="annot"><span class="annottext">VisibilityTag
</span><a href="#local-6989586621679356505"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679356506"><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679356506"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(CodeType -&gt; CSStateVar r)
-&gt; GenState CodeType -&gt; StateT DrasilState Identity (CSStateVar r)
forall a b.
(a -&gt; b)
-&gt; StateT DrasilState Identity a -&gt; StateT DrasilState Identity b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VisibilityTag -&gt; VS (r (Variable r)) -&gt; CSStateVar r
forall {r :: * -&gt; *}.
StateVarSym r =&gt;
VisibilityTag -&gt; SVariable r -&gt; CSStateVar r
</span><a href="#local-6989586621679356499"><span class="hs-identifier hs-var">svar</span></a></span><span> </span><span class="annot"><span class="annottext">VisibilityTag
</span><a href="#local-6989586621679356505"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">(VS (r (Variable r)) -&gt; CSStateVar r)
-&gt; (CodeType -&gt; VS (r (Variable r))) -&gt; CodeType -&gt; CSStateVar r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; VS (r (Type r)) -&gt; VS (r (Variable r))
forall (r :: * -&gt; *).
VariableSym r =&gt;
Name -&gt; VSType r -&gt; SVariable r
</span><span class="hs-identifier hs-var">var</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input -&gt; Name
forall c. CodeIdea c =&gt; c -&gt; Name
</span><span class="hs-identifier hs-var">codeName</span></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679356506"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(VS (r (Type r)) -&gt; VS (r (Variable r)))
-&gt; (CodeType -&gt; VS (r (Type r))) -&gt; CodeType -&gt; VS (r (Variable r))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-537"></span><span>                </span><span class="annot"><span class="annottext">CodeType -&gt; VS (r (Type r))
forall (r :: * -&gt; *). OOTypeSym r =&gt; CodeType -&gt; VSType r
</span><span class="hs-identifier hs-var">convTypeOO</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input -&gt; GenState CodeType
forall c. HasSpace c =&gt; c -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#codeType"><span class="hs-identifier hs-var">codeType</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679356506"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[StateVariable]
</span><a href="#local-6989586621679356482"><span class="hs-identifier hs-var">svs</span></a></span><span>
</span><span id="line-538"></span><span>  </span><span class="annot"><span class="annottext">Name
-&gt; Maybe Name
-&gt; Name
-&gt; [CSStateVar r]
-&gt; GenState [SMethod r]
-&gt; GenState [SMethod r]
-&gt; GenState (SClass r)
</span><a href="#local-6989586621679356477"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679356479"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621679356480"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679356481"><span class="hs-identifier hs-var">desc</span></a></span><span> </span><span class="annot"><span class="annottext">[CSStateVar r]
</span><a href="#local-6989586621679356503"><span class="hs-identifier hs-var">svrs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Func -&gt; StateT DrasilState Identity (SMethod r))
-&gt; [Func] -&gt; GenState [SMethod r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name
 -&gt; VS (r (Type r))
 -&gt; Name
 -&gt; [ParameterChunk]
 -&gt; Maybe Name
 -&gt; [MSBlock r]
 -&gt; StateT DrasilState Identity (SMethod r))
-&gt; [StateVariable]
-&gt; Func
-&gt; StateT DrasilState Identity (SMethod r)
forall (r :: * -&gt; *).
OOProg r =&gt;
(Name
 -&gt; VSType r
 -&gt; Name
 -&gt; [ParameterChunk]
 -&gt; Maybe Name
 -&gt; [MSBlock r]
 -&gt; GenState (SMethod r))
-&gt; [StateVariable] -&gt; Func -&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genFunc"><span class="hs-identifier hs-var">genFunc</span></a></span><span> </span><span class="annot"><span class="annottext">Name
-&gt; VS (r (Type r))
-&gt; Name
-&gt; [ParameterChunk]
-&gt; Maybe Name
-&gt; [MSBlock r]
-&gt; StateT DrasilState Identity (SMethod r)
forall (r :: * -&gt; *).
OOProg r =&gt;
Name
-&gt; VSType r
-&gt; Name
-&gt; [ParameterChunk]
-&gt; Maybe Name
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#publicMethod"><span class="hs-identifier hs-var">publicMethod</span></a></span><span> </span><span class="annot"><span class="annottext">[StateVariable]
</span><a href="#local-6989586621679356482"><span class="hs-identifier hs-var">svs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Func]
</span><a href="#local-6989586621679356483"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-539"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Func -&gt; StateT DrasilState Identity (SMethod r))
-&gt; [Func] -&gt; GenState [SMethod r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name
 -&gt; VS (r (Type r))
 -&gt; Name
 -&gt; [ParameterChunk]
 -&gt; Maybe Name
 -&gt; [MSBlock r]
 -&gt; StateT DrasilState Identity (SMethod r))
-&gt; [StateVariable]
-&gt; Func
-&gt; StateT DrasilState Identity (SMethod r)
forall (r :: * -&gt; *).
OOProg r =&gt;
(Name
 -&gt; VSType r
 -&gt; Name
 -&gt; [ParameterChunk]
 -&gt; Maybe Name
 -&gt; [MSBlock r]
 -&gt; GenState (SMethod r))
-&gt; [StateVariable] -&gt; Func -&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genFunc"><span class="hs-identifier hs-var">genFunc</span></a></span><span> </span><span class="annot"><span class="annottext">Name
-&gt; VS (r (Type r))
-&gt; Name
-&gt; [ParameterChunk]
-&gt; Maybe Name
-&gt; [MSBlock r]
-&gt; StateT DrasilState Identity (SMethod r)
forall (r :: * -&gt; *).
OOProg r =&gt;
Name
-&gt; VSType r
-&gt; Name
-&gt; [ParameterChunk]
-&gt; Maybe Name
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#publicMethod"><span class="hs-identifier hs-var">publicMethod</span></a></span><span> </span><span class="annot"><span class="annottext">[StateVariable]
</span><a href="#local-6989586621679356482"><span class="hs-identifier hs-var">svs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Func]
</span><a href="#local-6989586621679356484"><span class="hs-identifier hs-var">ms</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-540"></span><span>
</span><span id="line-541"></span><span class="hs-comment">-- | Converts a 'Func' (from the Mod AST) to GOOL.</span><span>
</span><span id="line-542"></span><span class="hs-comment">-- The function generator to use is passed as a parameter. Automatically adds</span><span>
</span><span id="line-543"></span><span class="hs-comment">-- variable declaration statements for any undeclared variables. For methods,</span><span>
</span><span id="line-544"></span><span class="hs-comment">-- the list of StateVariables is needed so they can be included in the list of</span><span>
</span><span id="line-545"></span><span class="hs-comment">-- declared variables.</span><span>
</span><span id="line-546"></span><span id="local-6989586621679353880"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#genFunc"><span class="hs-identifier hs-type">genFunc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353880"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VSType</span></span><span> </span><span class="annot"><a href="#local-6989586621679353880"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Description"><span class="hs-identifier hs-type">Description</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Chunk.Parameter.html#ParameterChunk"><span class="hs-identifier hs-type">ParameterChunk</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-547"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Description"><span class="hs-identifier hs-type">Description</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSBlock</span></span><span> </span><span class="annot"><a href="#local-6989586621679353880"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679353880"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-548"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Mod.html#StateVariable"><span class="hs-identifier hs-type">StateVariable</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Func"><span class="hs-identifier hs-type">Func</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679353880"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-549"></span><span id="genFunc"><span class="annot"><span class="annottext">genFunc :: forall (r :: * -&gt; *).
OOProg r =&gt;
(Name
 -&gt; VSType r
 -&gt; Name
 -&gt; [ParameterChunk]
 -&gt; Maybe Name
 -&gt; [MSBlock r]
 -&gt; GenState (SMethod r))
-&gt; [StateVariable] -&gt; Func -&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genFunc"><span class="hs-identifier hs-var hs-var">genFunc</span></a></span></span><span> </span><span id="local-6989586621679356586"><span class="annot"><span class="annottext">Name
-&gt; VSType r
-&gt; Name
-&gt; [ParameterChunk]
-&gt; Maybe Name
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="#local-6989586621679356586"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679356587"><span class="annot"><span class="annottext">[StateVariable]
</span><a href="#local-6989586621679356587"><span class="hs-identifier hs-var">svs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FDef"><span class="hs-identifier hs-type">FDef</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FuncDef"><span class="hs-identifier hs-type">FuncDef</span></a></span><span> </span><span id="local-6989586621679356590"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679356590"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679356591"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679356591"><span class="hs-identifier hs-var">desc</span></a></span></span><span> </span><span id="local-6989586621679356592"><span class="annot"><span class="annottext">[ParameterChunk]
</span><a href="#local-6989586621679356592"><span class="hs-identifier hs-var">parms</span></a></span></span><span> </span><span id="local-6989586621679356593"><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621679356593"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679356594"><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621679356594"><span class="hs-identifier hs-var">rd</span></a></span></span><span> </span><span id="local-6989586621679356595"><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679356595"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-550"></span><span>  </span><span id="local-6989586621679356596"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679356596"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-551"></span><span>  </span><span class="annot"><span class="annottext">(DrasilState -&gt; DrasilState) -&gt; StateT DrasilState Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679356597"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679356597"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679356597"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#currentScope"><span class="hs-identifier hs-var">currentScope</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#Local"><span class="hs-identifier hs-type">Local</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-552"></span><span>  </span><span id="local-6989586621679356598"><span class="annot"><span class="annottext">[MS (r (Statement r))]
</span><a href="#local-6989586621679356598"><span class="hs-identifier hs-var">stmts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FuncStmt -&gt; StateT DrasilState Identity (MS (r (Statement r))))
-&gt; [FuncStmt] -&gt; StateT DrasilState Identity [MS (r (Statement r))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">FuncStmt -&gt; StateT DrasilState Identity (MS (r (Statement r)))
forall (r :: * -&gt; *).
OOProg r =&gt;
FuncStmt -&gt; GenState (MSStatement r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679356595"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-553"></span><span>  </span><span id="local-6989586621679356599"><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679356599"><span class="hs-identifier hs-var">vars</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Input -&gt; StateT DrasilState Identity (VS (r (Variable r))))
-&gt; [Input] -&gt; StateT DrasilState Identity [VS (r (Variable r))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Input -&gt; StateT DrasilState Identity (VS (r (Variable r)))
forall (r :: * -&gt; *). OOProg r =&gt; Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB -&gt; [FuncStmt] -&gt; [Input]
</span><a href="Language.Drasil.Mod.html#fstdecl"><span class="hs-identifier hs-var">fstdecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; CodeSpec
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#codeSpec"><span class="hs-identifier hs-var">codeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679356596"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">CodeSpec -&gt; Getting ChunkDB CodeSpec ChunkDB -&gt; ChunkDB
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting ChunkDB CodeSpec ChunkDB
forall c. HasOldCodeSpec c =&gt; Lens' c ChunkDB
Lens' CodeSpec ChunkDB
</span><a href="Language.Drasil.CodeSpec.html#systemdbO"><span class="hs-identifier hs-var">systemdbO</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679356595"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-554"></span><span>    </span><span class="annot"><span class="annottext">[Input] -&gt; [Input] -&gt; [Input]
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">\\</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ParameterChunk -&gt; Input) -&gt; [ParameterChunk] -&gt; [Input]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">ParameterChunk -&gt; Input
forall c. (Quantity c, MayHaveUnit c, Concept c) =&gt; c -&gt; Input
</span><a href="Language.Drasil.Chunk.CodeBase.html#quantvar"><span class="hs-identifier hs-var">quantvar</span></a></span><span> </span><span class="annot"><span class="annottext">[ParameterChunk]
</span><a href="#local-6989586621679356592"><span class="hs-identifier hs-var">parms</span></a></span><span> </span><span class="annot"><span class="annottext">[Input] -&gt; [Input] -&gt; [Input]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">(StateVariable -&gt; Input) -&gt; [StateVariable] -&gt; [Input]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">StateVariable -&gt; Input
</span><a href="Language.Drasil.Mod.html#stVar"><span class="hs-identifier hs-var">stVar</span></a></span><span> </span><span class="annot"><span class="annottext">[StateVariable]
</span><a href="#local-6989586621679356587"><span class="hs-identifier hs-var">svs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-555"></span><span>  </span><span id="local-6989586621679356601"><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679356601"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Space -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#spaceCodeType"><span class="hs-identifier hs-var">spaceCodeType</span></a></span><span> </span><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621679356593"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-556"></span><span>  </span><span class="annot"><span class="annottext">Name
-&gt; VSType r
-&gt; Name
-&gt; [ParameterChunk]
-&gt; Maybe Name
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="#local-6989586621679356586"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679356590"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeType -&gt; VSType r
forall (r :: * -&gt; *). OOTypeSym r =&gt; CodeType -&gt; VSType r
</span><span class="hs-identifier hs-var">convTypeOO</span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679356601"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679356591"><span class="hs-identifier hs-var">desc</span></a></span><span> </span><span class="annot"><span class="annottext">[ParameterChunk]
</span><a href="#local-6989586621679356592"><span class="hs-identifier hs-var">parms</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621679356594"><span class="hs-identifier hs-var">rd</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[MS (r (Statement r))] -&gt; MSBlock r
forall (r :: * -&gt; *). BlockSym r =&gt; [MSStatement r] -&gt; MSBlock r
</span><span class="hs-identifier hs-var">block</span></span><span> </span><span class="annot"><span class="annottext">([MS (r (Statement r))] -&gt; MSBlock r)
-&gt; [MS (r (Statement r))] -&gt; MSBlock r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(VS (r (Variable r)) -&gt; MS (r (Statement r)))
-&gt; [VS (r (Variable r))] -&gt; [MS (r (Statement r))]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VS (r (Variable r)) -&gt; r (Scope r) -&gt; MS (r (Statement r))
forall (r :: * -&gt; *).
DeclStatement r =&gt;
SVariable r -&gt; r (Scope r) -&gt; MSStatement r
</span><span class="hs-operator hs-var">`varDec`</span></span><span> </span><span class="annot"><span class="annottext">r (Scope r)
forall (r :: * -&gt; *). ScopeSym r =&gt; r (Scope r)
</span><span class="hs-identifier hs-var">local</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679356599"><span class="hs-identifier hs-var">vars</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[MS (r (Statement r))] -&gt; MSBlock r
forall (r :: * -&gt; *). BlockSym r =&gt; [MSStatement r] -&gt; MSBlock r
</span><span class="hs-identifier hs-var">block</span></span><span> </span><span class="annot"><span class="annottext">[MS (r (Statement r))]
</span><a href="#local-6989586621679356598"><span class="hs-identifier hs-var">stmts</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-557"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#genFunc"><span class="hs-identifier hs-var">genFunc</span></a></span><span> </span><span class="annot"><span class="annottext">Name
-&gt; VSType r
-&gt; Name
-&gt; [ParameterChunk]
-&gt; Maybe Name
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679356605"><span class="annot"><span class="annottext">[StateVariable]
</span><a href="#local-6989586621679356605"><span class="hs-identifier hs-var">svs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FDef"><span class="hs-identifier hs-type">FDef</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#CtorDef"><span class="hs-identifier hs-type">CtorDef</span></a></span><span> </span><span id="local-6989586621679356607"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679356607"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679356608"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679356608"><span class="hs-identifier hs-var">desc</span></a></span></span><span> </span><span id="local-6989586621679356609"><span class="annot"><span class="annottext">[ParameterChunk]
</span><a href="#local-6989586621679356609"><span class="hs-identifier hs-var">parms</span></a></span></span><span> </span><span id="local-6989586621679356610"><span class="annot"><span class="annottext">[Initializer]
</span><a href="#local-6989586621679356610"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679356611"><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679356611"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-558"></span><span>  </span><span id="local-6989586621679356612"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679356612"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-559"></span><span>  </span><span class="annot"><span class="annottext">(DrasilState -&gt; DrasilState) -&gt; StateT DrasilState Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679356613"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679356613"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679356613"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#currentScope"><span class="hs-identifier hs-var">currentScope</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#Local"><span class="hs-identifier hs-type">Local</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-560"></span><span>  </span><span id="local-6989586621679356614"><span class="annot"><span class="annottext">[VS (r (Value r))]
</span><a href="#local-6989586621679356614"><span class="hs-identifier hs-var">inits</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Initializer -&gt; StateT DrasilState Identity (VS (r (Value r))))
-&gt; [Initializer] -&gt; StateT DrasilState Identity [VS (r (Value r))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">(CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r))))
-&gt; (Initializer -&gt; CodeExpr)
-&gt; Initializer
-&gt; StateT DrasilState Identity (VS (r (Value r)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Initializer -&gt; CodeExpr
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Initializer]
</span><a href="#local-6989586621679356610"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-561"></span><span>  </span><span id="local-6989586621679356615"><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679356615"><span class="hs-identifier hs-var">initvars</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Initializer -&gt; StateT DrasilState Identity (VS (r (Variable r))))
-&gt; [Initializer]
-&gt; StateT DrasilState Identity [VS (r (Variable r))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679356616"><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679356616"><span class="hs-identifier hs-var">iv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(CodeType -&gt; VS (r (Variable r)))
-&gt; GenState CodeType
-&gt; StateT DrasilState Identity (VS (r (Variable r)))
forall a b.
(a -&gt; b)
-&gt; StateT DrasilState Identity a -&gt; StateT DrasilState Identity b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; VSType r -&gt; VS (r (Variable r))
forall (r :: * -&gt; *).
VariableSym r =&gt;
Name -&gt; VSType r -&gt; SVariable r
</span><span class="hs-identifier hs-var">var</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input -&gt; Name
forall c. CodeIdea c =&gt; c -&gt; Name
</span><span class="hs-identifier hs-var">codeName</span></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679356616"><span class="hs-identifier hs-var">iv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(VSType r -&gt; VS (r (Variable r)))
-&gt; (CodeType -&gt; VSType r) -&gt; CodeType -&gt; VS (r (Variable r))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CodeType -&gt; VSType r
forall (r :: * -&gt; *). OOTypeSym r =&gt; CodeType -&gt; VSType r
</span><span class="hs-identifier hs-var">convTypeOO</span></span><span class="hs-special">)</span><span>
</span><span id="line-562"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input -&gt; GenState CodeType
forall c. HasSpace c =&gt; c -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#codeType"><span class="hs-identifier hs-var">codeType</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679356616"><span class="hs-identifier hs-var">iv</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Input -&gt; StateT DrasilState Identity (VS (r (Variable r))))
-&gt; (Initializer -&gt; Input)
-&gt; Initializer
-&gt; StateT DrasilState Identity (VS (r (Variable r)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Initializer -&gt; Input
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Initializer]
</span><a href="#local-6989586621679356610"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-563"></span><span>  </span><span id="local-6989586621679356617"><span class="annot"><span class="annottext">[MS (r (Statement r))]
</span><a href="#local-6989586621679356617"><span class="hs-identifier hs-var">stmts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FuncStmt -&gt; StateT DrasilState Identity (MS (r (Statement r))))
-&gt; [FuncStmt] -&gt; StateT DrasilState Identity [MS (r (Statement r))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">FuncStmt -&gt; StateT DrasilState Identity (MS (r (Statement r)))
forall (r :: * -&gt; *).
OOProg r =&gt;
FuncStmt -&gt; GenState (MSStatement r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679356611"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-564"></span><span>  </span><span id="local-6989586621679356618"><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679356618"><span class="hs-identifier hs-var">vars</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Input -&gt; StateT DrasilState Identity (VS (r (Variable r))))
-&gt; [Input] -&gt; StateT DrasilState Identity [VS (r (Variable r))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Input -&gt; StateT DrasilState Identity (VS (r (Variable r)))
forall (r :: * -&gt; *). OOProg r =&gt; Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB -&gt; [FuncStmt] -&gt; [Input]
</span><a href="Language.Drasil.Mod.html#fstdecl"><span class="hs-identifier hs-var">fstdecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; CodeSpec
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#codeSpec"><span class="hs-identifier hs-var">codeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679356612"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">CodeSpec -&gt; Getting ChunkDB CodeSpec ChunkDB -&gt; ChunkDB
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting ChunkDB CodeSpec ChunkDB
forall c. HasOldCodeSpec c =&gt; Lens' c ChunkDB
Lens' CodeSpec ChunkDB
</span><a href="Language.Drasil.CodeSpec.html#systemdbO"><span class="hs-identifier hs-var">systemdbO</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679356611"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-565"></span><span>    </span><span class="annot"><span class="annottext">[Input] -&gt; [Input] -&gt; [Input]
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">\\</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ParameterChunk -&gt; Input) -&gt; [ParameterChunk] -&gt; [Input]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">ParameterChunk -&gt; Input
forall c. (Quantity c, MayHaveUnit c, Concept c) =&gt; c -&gt; Input
</span><a href="Language.Drasil.Chunk.CodeBase.html#quantvar"><span class="hs-identifier hs-var">quantvar</span></a></span><span> </span><span class="annot"><span class="annottext">[ParameterChunk]
</span><a href="#local-6989586621679356609"><span class="hs-identifier hs-var">parms</span></a></span><span> </span><span class="annot"><span class="annottext">[Input] -&gt; [Input] -&gt; [Input]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">(StateVariable -&gt; Input) -&gt; [StateVariable] -&gt; [Input]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">StateVariable -&gt; Input
</span><a href="Language.Drasil.Mod.html#stVar"><span class="hs-identifier hs-var">stVar</span></a></span><span> </span><span class="annot"><span class="annottext">[StateVariable]
</span><a href="#local-6989586621679356605"><span class="hs-identifier hs-var">svs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-566"></span><span>  </span><span class="annot"><span class="annottext">Name
-&gt; Name
-&gt; [ParameterChunk]
-&gt; Initializers r
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
forall (r :: * -&gt; *).
OOProg r =&gt;
Name
-&gt; Name
-&gt; [ParameterChunk]
-&gt; Initializers r
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genInitConstructor"><span class="hs-identifier hs-var">genInitConstructor</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679356607"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679356608"><span class="hs-identifier hs-var">desc</span></a></span><span> </span><span class="annot"><span class="annottext">[ParameterChunk]
</span><a href="#local-6989586621679356609"><span class="hs-identifier hs-var">parms</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[VS (r (Variable r))] -&gt; [VS (r (Value r))] -&gt; Initializers r
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679356615"><span class="hs-identifier hs-var">initvars</span></a></span><span> </span><span class="annot"><span class="annottext">[VS (r (Value r))]
</span><a href="#local-6989586621679356614"><span class="hs-identifier hs-var">inits</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-567"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[MS (r (Statement r))] -&gt; MSBlock r
forall (r :: * -&gt; *). BlockSym r =&gt; [MSStatement r] -&gt; MSBlock r
</span><span class="hs-identifier hs-var">block</span></span><span> </span><span class="annot"><span class="annottext">([MS (r (Statement r))] -&gt; MSBlock r)
-&gt; [MS (r (Statement r))] -&gt; MSBlock r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(VS (r (Variable r)) -&gt; MS (r (Statement r)))
-&gt; [VS (r (Variable r))] -&gt; [MS (r (Statement r))]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VS (r (Variable r)) -&gt; r (Scope r) -&gt; MS (r (Statement r))
forall (r :: * -&gt; *).
DeclStatement r =&gt;
SVariable r -&gt; r (Scope r) -&gt; MSStatement r
</span><span class="hs-operator hs-var">`varDec`</span></span><span> </span><span class="annot"><span class="annottext">r (Scope r)
forall (r :: * -&gt; *). ScopeSym r =&gt; r (Scope r)
</span><span class="hs-identifier hs-var">local</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679356618"><span class="hs-identifier hs-var">vars</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[MS (r (Statement r))] -&gt; MSBlock r
forall (r :: * -&gt; *). BlockSym r =&gt; [MSStatement r] -&gt; MSBlock r
</span><span class="hs-identifier hs-var">block</span></span><span> </span><span class="annot"><span class="annottext">[MS (r (Statement r))]
</span><a href="#local-6989586621679356617"><span class="hs-identifier hs-var">stmts</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-568"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#genFunc"><span class="hs-identifier hs-var">genFunc</span></a></span><span> </span><span class="annot"><span class="annottext">Name
-&gt; VSType r
-&gt; Name
-&gt; [ParameterChunk]
-&gt; Maybe Name
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[StateVariable]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FData"><span class="hs-identifier hs-type">FData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FuncData"><span class="hs-identifier hs-type">FuncData</span></a></span><span> </span><span id="local-6989586621679356621"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679356621"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679356622"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679356622"><span class="hs-identifier hs-var">desc</span></a></span></span><span> </span><span id="local-6989586621679356623"><span class="annot"><span class="annottext">DataDesc
</span><a href="#local-6989586621679356623"><span class="hs-identifier hs-var">ddef</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-569"></span><span>  </span><span class="annot"><span class="annottext">(DrasilState -&gt; DrasilState) -&gt; StateT DrasilState Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679356624"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679356624"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679356624"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#currentScope"><span class="hs-identifier hs-var">currentScope</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#Local"><span class="hs-identifier hs-type">Local</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-570"></span><span>  </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; DataDesc -&gt; GenState (SMethod r)
forall (r :: * -&gt; *).
OOProg r =&gt;
Name -&gt; Name -&gt; DataDesc -&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genDataFunc"><span class="hs-identifier hs-var">genDataFunc</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679356621"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679356622"><span class="hs-identifier hs-var">desc</span></a></span><span> </span><span class="annot"><span class="annottext">DataDesc
</span><a href="#local-6989586621679356623"><span class="hs-identifier hs-var">ddef</span></a></span><span>
</span><span id="line-571"></span><span>
</span><span id="line-572"></span><span class="annot"><span class="hs-comment">-- | Converts a 'FuncStmt' to a GOOL Statement.</span></span><span>
</span><span id="line-573"></span><span id="local-6989586621679353899"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-type">convStmt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353899"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#FuncStmt"><span class="hs-identifier hs-type">FuncStmt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MSStatement</span></span><span> </span><span class="annot"><a href="#local-6989586621679353899"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-574"></span><span id="convStmt"><span class="annot"><span class="annottext">convStmt :: forall (r :: * -&gt; *).
OOProg r =&gt;
FuncStmt -&gt; GenState (MSStatement r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var hs-var">convStmt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FAsg"><span class="hs-identifier hs-type">FAsg</span></a></span><span> </span><span id="local-6989586621679356867"><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679356867"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Matrix</span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679356868"><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679356868"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-575"></span><span>  </span><span id="local-6989586621679356869"><span class="annot"><span class="annottext">[VS (r (Value r))]
</span><a href="#local-6989586621679356869"><span class="hs-identifier hs-var">els</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r))))
-&gt; [CodeExpr] -&gt; StateT DrasilState Identity [VS (r (Value r))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679356868"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-576"></span><span>  </span><span id="local-6989586621679356870"><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679356870"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input
-&gt; StateT
     DrasilState Identity (StateT ValueState Identity (r (Variable r)))
forall (r :: * -&gt; *). OOProg r =&gt; Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679356867"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-577"></span><span>  </span><span id="local-6989586621679356871"><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679356871"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input -&gt; GenState CodeType
forall c. HasSpace c =&gt; c -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#codeType"><span class="hs-identifier hs-var">codeType</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679356867"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-578"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679356881"><span class="annot"><span class="annottext">listFunc :: CodeType -&gt; VSType r -&gt; [SValue r] -&gt; SValue r
</span><a href="#local-6989586621679356881"><span class="hs-identifier hs-var hs-var">listFunc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">C.List</span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VSType r -&gt; [SValue r] -&gt; SValue r
forall (r :: * -&gt; *).
Literal r =&gt;
VSType r -&gt; [SValue r] -&gt; SValue r
</span><span class="hs-identifier hs-var">litList</span></span><span>
</span><span id="line-579"></span><span>      </span><span class="annot"><a href="#local-6989586621679356881"><span class="hs-identifier hs-var">listFunc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">C.Array</span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VSType r -&gt; [SValue r] -&gt; SValue r
forall (r :: * -&gt; *).
Literal r =&gt;
VSType r -&gt; [SValue r] -&gt; SValue r
</span><span class="hs-identifier hs-var">litArray</span></span><span>
</span><span id="line-580"></span><span>      </span><span class="annot"><a href="#local-6989586621679356881"><span class="hs-identifier hs-var">listFunc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; VSType r -&gt; [SValue r] -&gt; SValue r
forall a. HasCallStack =&gt; Name -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Type mismatch between variable and value in assignment FuncStmt&quot;</span></span><span>
</span><span id="line-581"></span><span>  </span><span id="local-6989586621679356883"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679356883"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
-&gt; StateT DrasilState Identity [MSStatement r]
forall (r :: * -&gt; *).
SharedProg r =&gt;
SVariable r -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Logging.html#maybeLog"><span class="hs-identifier hs-var">maybeLog</span></a></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679356870"><span class="hs-identifier hs-var">v'</span></a></span><span>
</span><span id="line-582"></span><span>  </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; GenState (MSStatement r))
-&gt; MSStatement r -&gt; GenState (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSStatement r
forall (r :: * -&gt; *).
StatementSym r =&gt;
[MSStatement r] -&gt; MSStatement r
</span><span class="hs-identifier hs-var">multi</span></span><span> </span><span class="annot"><span class="annottext">([MSStatement r] -&gt; MSStatement r)
-&gt; [MSStatement r] -&gt; MSStatement r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
-&gt; VS (r (Value r)) -&gt; MSStatement r
forall (r :: * -&gt; *).
AssignStatement r =&gt;
SVariable r -&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">assign</span></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679356870"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeType
-&gt; VS (r (Type r)) -&gt; [VS (r (Value r))] -&gt; VS (r (Value r))
forall {r :: * -&gt; *}.
Literal r =&gt;
CodeType -&gt; VSType r -&gt; [SValue r] -&gt; SValue r
</span><a href="#local-6989586621679356881"><span class="hs-identifier hs-var">listFunc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679356871"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VS (r (Type r)) -&gt; VS (r (Type r))
forall (r :: * -&gt; *). TypeSym r =&gt; VSType r -&gt; VSType r
</span><span class="hs-identifier hs-var">listInnerType</span></span><span> </span><span class="annot"><span class="annottext">(VS (r (Type r)) -&gt; VS (r (Type r)))
-&gt; VS (r (Type r)) -&gt; VS (r (Type r))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(r (Variable r) -&gt; r (Type r))
-&gt; StateT ValueState Identity (r (Variable r)) -&gt; VS (r (Type r))
forall a b.
(a -&gt; b)
-&gt; StateT ValueState Identity a -&gt; StateT ValueState Identity b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">r (Variable r) -&gt; r (Type r)
forall (r :: * -&gt; *).
VariableElim r =&gt;
r (Variable r) -&gt; r (Type r)
</span><span class="hs-identifier hs-var">variableType</span></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679356870"><span class="hs-identifier hs-var">v'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-583"></span><span>    </span><span class="annot"><span class="annottext">[VS (r (Value r))]
</span><a href="#local-6989586621679356869"><span class="hs-identifier hs-var">els</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MSStatement r -&gt; [MSStatement r] -&gt; [MSStatement r]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679356883"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-584"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FAsg"><span class="hs-identifier hs-type">FAsg</span></a></span><span> </span><span id="local-6989586621679356887"><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679356887"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679356888"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679356888"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-585"></span><span>  </span><span id="local-6989586621679356889"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679356889"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679356888"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-586"></span><span>  </span><span id="local-6989586621679356890"><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679356890"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input
-&gt; StateT
     DrasilState Identity (StateT ValueState Identity (r (Variable r)))
forall (r :: * -&gt; *). OOProg r =&gt; Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679356887"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-587"></span><span>  </span><span id="local-6989586621679356891"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679356891"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
-&gt; StateT DrasilState Identity [MSStatement r]
forall (r :: * -&gt; *).
SharedProg r =&gt;
SVariable r -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Logging.html#maybeLog"><span class="hs-identifier hs-var">maybeLog</span></a></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679356890"><span class="hs-identifier hs-var">v'</span></a></span><span>
</span><span id="line-588"></span><span>  </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; GenState (MSStatement r))
-&gt; MSStatement r -&gt; GenState (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSStatement r
forall (r :: * -&gt; *).
StatementSym r =&gt;
[MSStatement r] -&gt; MSStatement r
</span><span class="hs-identifier hs-var">multi</span></span><span> </span><span class="annot"><span class="annottext">([MSStatement r] -&gt; MSStatement r)
-&gt; [MSStatement r] -&gt; MSStatement r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
-&gt; VS (r (Value r)) -&gt; MSStatement r
forall (r :: * -&gt; *).
AssignStatement r =&gt;
SVariable r -&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">assign</span></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679356890"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679356889"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="annot"><span class="annottext">MSStatement r -&gt; [MSStatement r] -&gt; [MSStatement r]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679356891"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-589"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FAsgIndex"><span class="hs-identifier hs-type">FAsgIndex</span></a></span><span> </span><span id="local-6989586621679356893"><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679356893"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679356894"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679356894"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679356895"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679356895"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-590"></span><span>  </span><span id="local-6989586621679356896"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679356896"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679356895"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-591"></span><span>  </span><span id="local-6989586621679356897"><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679356897"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input
-&gt; StateT
     DrasilState Identity (StateT ValueState Identity (r (Variable r)))
forall (r :: * -&gt; *). OOProg r =&gt; Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679356893"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-592"></span><span>  </span><span id="local-6989586621679356898"><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679356898"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input -&gt; GenState CodeType
forall c. HasSpace c =&gt; c -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#codeType"><span class="hs-identifier hs-var">codeType</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679356893"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-593"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679356923"><span class="annot"><span class="annottext">asgFunc :: CodeType -&gt; MSStatement r
</span><a href="#local-6989586621679356923"><span class="hs-identifier hs-var hs-var">asgFunc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">C.List</span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VS (r (Value r)) -&gt; MSStatement r
forall (r :: * -&gt; *). StatementSym r =&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">valStmt</span></span><span> </span><span class="annot"><span class="annottext">(VS (r (Value r)) -&gt; MSStatement r)
-&gt; VS (r (Value r)) -&gt; MSStatement r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
-&gt; VS (r (Value r)) -&gt; VS (r (Value r)) -&gt; VS (r (Value r))
forall (r :: * -&gt; *).
List r =&gt;
SValue r -&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-identifier hs-var">listSet</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r)) -&gt; VS (r (Value r))
forall (r :: * -&gt; *). VariableValue r =&gt; SVariable r -&gt; SValue r
</span><span class="hs-identifier hs-var">valueOf</span></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679356897"><span class="hs-identifier hs-var">v'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; VS (r (Value r))
forall (r :: * -&gt; *). Literal r =&gt; Integer -&gt; SValue r
</span><span class="hs-identifier hs-var">litInt</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679356894"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679356896"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-594"></span><span>      </span><span class="annot"><a href="#local-6989586621679356923"><span class="hs-identifier hs-var">asgFunc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">C.Array</span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
-&gt; VS (r (Value r)) -&gt; MSStatement r
forall (r :: * -&gt; *).
AssignStatement r =&gt;
SVariable r -&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">assign</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
-&gt; StateT ValueState Identity (r (Variable r))
-&gt; StateT ValueState Identity (r (Variable r))
forall (r :: * -&gt; *).
VariableSym r =&gt;
Integer -&gt; SVariable r -&gt; SVariable r
</span><span class="hs-identifier hs-var">arrayElem</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679356894"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679356897"><span class="hs-identifier hs-var">v'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679356896"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-595"></span><span>      </span><span class="annot"><a href="#local-6989586621679356923"><span class="hs-identifier hs-var">asgFunc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; MSStatement r
forall a. HasCallStack =&gt; Name -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;FAsgIndex used with non-indexed value&quot;</span></span><span>
</span><span id="line-596"></span><span>      </span><span id="local-6989586621679356929"><span class="annot"><span class="annottext">vi :: StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679356929"><span class="hs-identifier hs-var hs-var">vi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
-&gt; StateT ValueState Identity (r (Variable r))
-&gt; StateT ValueState Identity (r (Variable r))
forall (r :: * -&gt; *).
VariableSym r =&gt;
Integer -&gt; SVariable r -&gt; SVariable r
</span><span class="hs-identifier hs-var">arrayElem</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679356894"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679356897"><span class="hs-identifier hs-var">v'</span></a></span><span>
</span><span id="line-597"></span><span>  </span><span id="local-6989586621679356930"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679356930"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
-&gt; StateT DrasilState Identity [MSStatement r]
forall (r :: * -&gt; *).
SharedProg r =&gt;
SVariable r -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Logging.html#maybeLog"><span class="hs-identifier hs-var">maybeLog</span></a></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679356929"><span class="hs-identifier hs-var">vi</span></a></span><span>
</span><span id="line-598"></span><span>  </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; GenState (MSStatement r))
-&gt; MSStatement r -&gt; GenState (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSStatement r
forall (r :: * -&gt; *).
StatementSym r =&gt;
[MSStatement r] -&gt; MSStatement r
</span><span class="hs-identifier hs-var">multi</span></span><span> </span><span class="annot"><span class="annottext">([MSStatement r] -&gt; MSStatement r)
-&gt; [MSStatement r] -&gt; MSStatement r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CodeType -&gt; MSStatement r
</span><a href="#local-6989586621679356923"><span class="hs-identifier hs-var">asgFunc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679356898"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">MSStatement r -&gt; [MSStatement r] -&gt; [MSStatement r]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679356930"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-599"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FFor"><span class="hs-identifier hs-type">FFor</span></a></span><span> </span><span id="local-6989586621679356932"><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679356932"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679356933"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679356933"><span class="hs-identifier hs-var">start</span></a></span></span><span> </span><span id="local-6989586621679356934"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679356934"><span class="hs-identifier hs-var">end</span></a></span></span><span> </span><span id="local-6989586621679356935"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679356935"><span class="hs-identifier hs-var">step</span></a></span></span><span> </span><span id="local-6989586621679356936"><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679356936"><span class="hs-identifier hs-var">st</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-600"></span><span>  </span><span id="local-6989586621679356937"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679356937"><span class="hs-identifier hs-var">stmts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FuncStmt -&gt; GenState (MSStatement r))
-&gt; [FuncStmt] -&gt; StateT DrasilState Identity [MSStatement r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">FuncStmt -&gt; GenState (MSStatement r)
forall (r :: * -&gt; *).
OOProg r =&gt;
FuncStmt -&gt; GenState (MSStatement r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679356936"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-601"></span><span>  </span><span id="local-6989586621679356938"><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679356938"><span class="hs-identifier hs-var">vari</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input
-&gt; StateT
     DrasilState Identity (StateT ValueState Identity (r (Variable r)))
forall (r :: * -&gt; *). OOProg r =&gt; Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679356932"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-602"></span><span>  </span><span id="local-6989586621679356939"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679356939"><span class="hs-identifier hs-var">start'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679356933"><span class="hs-identifier hs-var">start</span></a></span><span>
</span><span id="line-603"></span><span>  </span><span id="local-6989586621679356940"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679356940"><span class="hs-identifier hs-var">end'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679356934"><span class="hs-identifier hs-var">end</span></a></span><span>
</span><span id="line-604"></span><span>  </span><span id="local-6989586621679356941"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679356941"><span class="hs-identifier hs-var">step'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679356935"><span class="hs-identifier hs-var">step</span></a></span><span>
</span><span id="line-605"></span><span>  </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; GenState (MSStatement r))
-&gt; MSStatement r -&gt; GenState (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
-&gt; VS (r (Value r))
-&gt; VS (r (Value r))
-&gt; VS (r (Value r))
-&gt; MSBody r
-&gt; MSStatement r
forall (r :: * -&gt; *).
ControlStatement r =&gt;
SVariable r
-&gt; SValue r -&gt; SValue r -&gt; SValue r -&gt; MSBody r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">forRange</span></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679356938"><span class="hs-identifier hs-var">vari</span></a></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679356939"><span class="hs-identifier hs-var">start'</span></a></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679356940"><span class="hs-identifier hs-var">end'</span></a></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679356941"><span class="hs-identifier hs-var">step'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSBody r
forall (r :: * -&gt; *). BodySym r =&gt; [MSStatement r] -&gt; MSBody r
</span><span class="hs-identifier hs-var">bodyStatements</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679356937"><span class="hs-identifier hs-var">stmts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-606"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FForEach"><span class="hs-identifier hs-type">FForEach</span></a></span><span> </span><span id="local-6989586621679356944"><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679356944"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679356945"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679356945"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679356946"><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679356946"><span class="hs-identifier hs-var">st</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-607"></span><span>  </span><span id="local-6989586621679356947"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679356947"><span class="hs-identifier hs-var">stmts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FuncStmt -&gt; GenState (MSStatement r))
-&gt; [FuncStmt] -&gt; StateT DrasilState Identity [MSStatement r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">FuncStmt -&gt; GenState (MSStatement r)
forall (r :: * -&gt; *).
OOProg r =&gt;
FuncStmt -&gt; GenState (MSStatement r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679356946"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-608"></span><span>  </span><span id="local-6989586621679356948"><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679356948"><span class="hs-identifier hs-var">vari</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input
-&gt; StateT
     DrasilState Identity (StateT ValueState Identity (r (Variable r)))
forall (r :: * -&gt; *). OOProg r =&gt; Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679356944"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-609"></span><span>  </span><span id="local-6989586621679356949"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679356949"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679356945"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-610"></span><span>  </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; GenState (MSStatement r))
-&gt; MSStatement r -&gt; GenState (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
-&gt; VS (r (Value r)) -&gt; MSBody r -&gt; MSStatement r
forall (r :: * -&gt; *).
ControlStatement r =&gt;
SVariable r -&gt; SValue r -&gt; MSBody r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">forEach</span></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679356948"><span class="hs-identifier hs-var">vari</span></a></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679356949"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSBody r
forall (r :: * -&gt; *). BodySym r =&gt; [MSStatement r] -&gt; MSBody r
</span><span class="hs-identifier hs-var">bodyStatements</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679356947"><span class="hs-identifier hs-var">stmts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-611"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FWhile"><span class="hs-identifier hs-type">FWhile</span></a></span><span> </span><span id="local-6989586621679356952"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679356952"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679356953"><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679356953"><span class="hs-identifier hs-var">st</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-612"></span><span>  </span><span id="local-6989586621679356954"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679356954"><span class="hs-identifier hs-var">stmts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FuncStmt -&gt; GenState (MSStatement r))
-&gt; [FuncStmt] -&gt; StateT DrasilState Identity [MSStatement r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">FuncStmt -&gt; GenState (MSStatement r)
forall (r :: * -&gt; *).
OOProg r =&gt;
FuncStmt -&gt; GenState (MSStatement r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679356953"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-613"></span><span>  </span><span id="local-6989586621679356955"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679356955"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679356952"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-614"></span><span>  </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; GenState (MSStatement r))
-&gt; MSStatement r -&gt; GenState (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r)) -&gt; MSBody r -&gt; MSStatement r
forall (r :: * -&gt; *).
ControlStatement r =&gt;
SValue r -&gt; MSBody r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">while</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679356955"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSBody r
forall (r :: * -&gt; *). BodySym r =&gt; [MSStatement r] -&gt; MSBody r
</span><span class="hs-identifier hs-var">bodyStatements</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679356954"><span class="hs-identifier hs-var">stmts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-615"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FCond"><span class="hs-identifier hs-type">FCond</span></a></span><span> </span><span id="local-6989586621679356958"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679356958"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679356959"><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679356959"><span class="hs-identifier hs-var">tSt</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-616"></span><span>  </span><span id="local-6989586621679356960"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679356960"><span class="hs-identifier hs-var">stmts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FuncStmt -&gt; GenState (MSStatement r))
-&gt; [FuncStmt] -&gt; StateT DrasilState Identity [MSStatement r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">FuncStmt -&gt; GenState (MSStatement r)
forall (r :: * -&gt; *).
OOProg r =&gt;
FuncStmt -&gt; GenState (MSStatement r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679356959"><span class="hs-identifier hs-var">tSt</span></a></span><span>
</span><span id="line-617"></span><span>  </span><span id="local-6989586621679356961"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679356961"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679356958"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-618"></span><span>  </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; GenState (MSStatement r))
-&gt; MSStatement r -&gt; GenState (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(VS (r (Value r)), MSBody r)] -&gt; MSStatement r
forall (r :: * -&gt; *).
ControlStatement r =&gt;
[(SValue r, MSBody r)] -&gt; MSStatement r
</span><span class="hs-identifier hs-var">ifNoElse</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679356961"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSBody r
forall (r :: * -&gt; *). BodySym r =&gt; [MSStatement r] -&gt; MSBody r
</span><span class="hs-identifier hs-var">bodyStatements</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679356960"><span class="hs-identifier hs-var">stmts</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-619"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FCond"><span class="hs-identifier hs-type">FCond</span></a></span><span> </span><span id="local-6989586621679356962"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679356962"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679356963"><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679356963"><span class="hs-identifier hs-var">tSt</span></a></span></span><span> </span><span id="local-6989586621679356964"><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679356964"><span class="hs-identifier hs-var">eSt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-620"></span><span>  </span><span id="local-6989586621679356965"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679356965"><span class="hs-identifier hs-var">stmt1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FuncStmt -&gt; GenState (MSStatement r))
-&gt; [FuncStmt] -&gt; StateT DrasilState Identity [MSStatement r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">FuncStmt -&gt; GenState (MSStatement r)
forall (r :: * -&gt; *).
OOProg r =&gt;
FuncStmt -&gt; GenState (MSStatement r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679356963"><span class="hs-identifier hs-var">tSt</span></a></span><span>
</span><span id="line-621"></span><span>  </span><span id="local-6989586621679356966"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679356966"><span class="hs-identifier hs-var">stmt2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FuncStmt -&gt; GenState (MSStatement r))
-&gt; [FuncStmt] -&gt; StateT DrasilState Identity [MSStatement r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">FuncStmt -&gt; GenState (MSStatement r)
forall (r :: * -&gt; *).
OOProg r =&gt;
FuncStmt -&gt; GenState (MSStatement r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679356964"><span class="hs-identifier hs-var">eSt</span></a></span><span>
</span><span id="line-622"></span><span>  </span><span id="local-6989586621679356967"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679356967"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679356962"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-623"></span><span>  </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; GenState (MSStatement r))
-&gt; MSStatement r -&gt; GenState (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(VS (r (Value r)), MSBody r)] -&gt; MSBody r -&gt; MSStatement r
forall (r :: * -&gt; *).
ControlStatement r =&gt;
[(SValue r, MSBody r)] -&gt; MSBody r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">ifCond</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679356967"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSBody r
forall (r :: * -&gt; *). BodySym r =&gt; [MSStatement r] -&gt; MSBody r
</span><span class="hs-identifier hs-var">bodyStatements</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679356965"><span class="hs-identifier hs-var">stmt1</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSBody r
forall (r :: * -&gt; *). BodySym r =&gt; [MSStatement r] -&gt; MSBody r
</span><span class="hs-identifier hs-var">bodyStatements</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679356966"><span class="hs-identifier hs-var">stmt2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-624"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FRet"><span class="hs-identifier hs-type">FRet</span></a></span><span> </span><span id="local-6989586621679356970"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679356970"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-625"></span><span>  </span><span id="local-6989586621679356971"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679356971"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679356970"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-626"></span><span>  </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; GenState (MSStatement r))
-&gt; MSStatement r -&gt; GenState (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r)) -&gt; MSStatement r
forall (r :: * -&gt; *).
ControlStatement r =&gt;
SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">returnStmt</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679356971"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-627"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FThrow"><span class="hs-identifier hs-type">FThrow</span></a></span><span> </span><span id="local-6989586621679356974"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679356974"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; GenState (MSStatement r))
-&gt; MSStatement r -&gt; GenState (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; MSStatement r
forall (r :: * -&gt; *). ControlStatement r =&gt; Name -&gt; MSStatement r
</span><span class="hs-identifier hs-var">throw</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679356974"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-628"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FTry"><span class="hs-identifier hs-type">FTry</span></a></span><span> </span><span id="local-6989586621679356977"><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679356977"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679356978"><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679356978"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-629"></span><span>  </span><span id="local-6989586621679356979"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679356979"><span class="hs-identifier hs-var">stmt1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FuncStmt -&gt; GenState (MSStatement r))
-&gt; [FuncStmt] -&gt; StateT DrasilState Identity [MSStatement r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">FuncStmt -&gt; GenState (MSStatement r)
forall (r :: * -&gt; *).
OOProg r =&gt;
FuncStmt -&gt; GenState (MSStatement r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679356977"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-630"></span><span>  </span><span id="local-6989586621679356980"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679356980"><span class="hs-identifier hs-var">stmt2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FuncStmt -&gt; GenState (MSStatement r))
-&gt; [FuncStmt] -&gt; StateT DrasilState Identity [MSStatement r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">FuncStmt -&gt; GenState (MSStatement r)
forall (r :: * -&gt; *).
OOProg r =&gt;
FuncStmt -&gt; GenState (MSStatement r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679356978"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-631"></span><span>  </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; GenState (MSStatement r))
-&gt; MSStatement r -&gt; GenState (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MSBody r -&gt; MSBody r -&gt; MSStatement r
forall (r :: * -&gt; *).
ControlStatement r =&gt;
MSBody r -&gt; MSBody r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">tryCatch</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSBody r
forall (r :: * -&gt; *). BodySym r =&gt; [MSStatement r] -&gt; MSBody r
</span><span class="hs-identifier hs-var">bodyStatements</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679356979"><span class="hs-identifier hs-var">stmt1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSBody r
forall (r :: * -&gt; *). BodySym r =&gt; [MSStatement r] -&gt; MSBody r
</span><span class="hs-identifier hs-var">bodyStatements</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679356980"><span class="hs-identifier hs-var">stmt2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-632"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="annot"><span class="annottext">FuncStmt
</span><a href="Language.Drasil.Mod.html#FContinue"><span class="hs-identifier hs-var">FContinue</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">MSStatement r
forall (r :: * -&gt; *). ControlStatement r =&gt; MSStatement r
</span><span class="hs-identifier hs-var">continue</span></span><span>
</span><span id="line-633"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FDecDef"><span class="hs-identifier hs-type">FDecDef</span></a></span><span> </span><span id="local-6989586621679356985"><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679356985"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Matrix</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-634"></span><span>  </span><span id="local-6989586621679356986"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679356986"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-635"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679357115"><span class="annot"><span class="annottext">scp :: r (Scope r)
</span><a href="#local-6989586621679357115"><span class="hs-identifier hs-var hs-var">scp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScopeType -&gt; r (Scope r)
forall (r :: * -&gt; *). SharedProg r =&gt; ScopeType -&gt; r (Scope r)
</span><a href="Language.Drasil.Code.Imperative.Helpers.html#convScope"><span class="hs-identifier hs-var">convScope</span></a></span><span> </span><span class="annot"><span class="annottext">(ScopeType -&gt; r (Scope r)) -&gt; ScopeType -&gt; r (Scope r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; ScopeType
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#currentScope"><span class="hs-identifier hs-var">currentScope</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679356986"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-636"></span><span>  </span><span id="local-6989586621679357116"><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679357116"><span class="hs-identifier hs-var">vari</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input
-&gt; StateT
     DrasilState Identity (StateT ValueState Identity (r (Variable r)))
forall (r :: * -&gt; *). OOProg r =&gt; Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679356985"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-637"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679357126"><span class="annot"><span class="annottext">convDec :: CodeType -&gt; r (Scope r) -&gt; MSStatement r
</span><a href="#local-6989586621679357126"><span class="hs-identifier hs-var hs-var">convDec</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">C.List</span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
-&gt; StateT ValueState Identity (r (Variable r))
-&gt; r (Scope r)
-&gt; MSStatement r
forall (r :: * -&gt; *).
DeclStatement r =&gt;
Integer -&gt; SVariable r -&gt; r (Scope r) -&gt; MSStatement r
</span><span class="hs-identifier hs-var">listDec</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679357116"><span class="hs-identifier hs-var">vari</span></a></span><span>
</span><span id="line-638"></span><span>      </span><span class="annot"><a href="#local-6989586621679357126"><span class="hs-identifier hs-var">convDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">C.Array</span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
-&gt; StateT ValueState Identity (r (Variable r))
-&gt; r (Scope r)
-&gt; MSStatement r
forall (r :: * -&gt; *).
DeclStatement r =&gt;
Integer -&gt; SVariable r -&gt; r (Scope r) -&gt; MSStatement r
</span><span class="hs-identifier hs-var">arrayDec</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679357116"><span class="hs-identifier hs-var">vari</span></a></span><span>
</span><span id="line-639"></span><span>      </span><span class="annot"><a href="#local-6989586621679357126"><span class="hs-identifier hs-var">convDec</span></a></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
-&gt; r (Scope r) -&gt; MSStatement r
forall (r :: * -&gt; *).
DeclStatement r =&gt;
SVariable r -&gt; r (Scope r) -&gt; MSStatement r
</span><span class="hs-identifier hs-var">varDec</span></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679357116"><span class="hs-identifier hs-var">vari</span></a></span><span>
</span><span id="line-640"></span><span>  </span><span class="annot"><span class="annottext">(CodeType -&gt; MSStatement r)
-&gt; GenState CodeType -&gt; GenState (MSStatement r)
forall a b.
(a -&gt; b)
-&gt; StateT DrasilState Identity a -&gt; StateT DrasilState Identity b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeType -&gt; r (Scope r) -&gt; MSStatement r
</span><a href="#local-6989586621679357126"><span class="hs-operator hs-var">`convDec`</span></a></span><span> </span><span class="annot"><span class="annottext">r (Scope r)
</span><a href="#local-6989586621679357115"><span class="hs-identifier hs-var">scp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input -&gt; GenState CodeType
forall c. HasSpace c =&gt; c -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#codeType"><span class="hs-identifier hs-var">codeType</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679356985"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-641"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FDecDef"><span class="hs-identifier hs-type">FDecDef</span></a></span><span> </span><span id="local-6989586621679357129"><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679357129"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679357130"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679357130"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-642"></span><span>  </span><span id="local-6989586621679357131"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679357131"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-643"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679357260"><span class="annot"><span class="annottext">scp :: r (Scope r)
</span><a href="#local-6989586621679357260"><span class="hs-identifier hs-var hs-var">scp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScopeType -&gt; r (Scope r)
forall (r :: * -&gt; *). SharedProg r =&gt; ScopeType -&gt; r (Scope r)
</span><a href="Language.Drasil.Code.Imperative.Helpers.html#convScope"><span class="hs-identifier hs-var">convScope</span></a></span><span> </span><span class="annot"><span class="annottext">(ScopeType -&gt; r (Scope r)) -&gt; ScopeType -&gt; r (Scope r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; ScopeType
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#currentScope"><span class="hs-identifier hs-var">currentScope</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679357131"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-644"></span><span>  </span><span id="local-6989586621679357261"><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679357261"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input
-&gt; StateT
     DrasilState Identity (StateT ValueState Identity (r (Variable r)))
forall (r :: * -&gt; *). OOProg r =&gt; Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679357129"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-645"></span><span>  </span><span id="local-6989586621679357262"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679357262"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
-&gt; StateT DrasilState Identity [MSStatement r]
forall (r :: * -&gt; *).
SharedProg r =&gt;
SVariable r -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Logging.html#maybeLog"><span class="hs-identifier hs-var">maybeLog</span></a></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679357261"><span class="hs-identifier hs-var">v'</span></a></span><span>
</span><span id="line-646"></span><span>  </span><span id="local-6989586621679357263"><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679357263"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input -&gt; GenState CodeType
forall c. HasSpace c =&gt; c -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#codeType"><span class="hs-identifier hs-var">codeType</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679357129"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-647"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679357506"><span class="annot"><span class="annottext">convDecDef :: CodeExpr -&gt; GenState (MSStatement r)
</span><a href="#local-6989586621679357506"><span class="hs-identifier hs-var hs-var">convDecDef</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Matrix</span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679357507"><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679357507"><span class="hs-identifier hs-var">lst</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-648"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679357528"><span class="annot"><span class="annottext">contDecDef :: CodeType
-&gt; SVariable r -&gt; r (Scope r) -&gt; [SValue r] -&gt; MSStatement r
</span><a href="#local-6989586621679357528"><span class="hs-identifier hs-var hs-var">contDecDef</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">C.List</span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SVariable r -&gt; r (Scope r) -&gt; [SValue r] -&gt; MSStatement r
forall (r :: * -&gt; *).
DeclStatement r =&gt;
SVariable r -&gt; r (Scope r) -&gt; [SValue r] -&gt; MSStatement r
</span><span class="hs-identifier hs-var">listDecDef</span></span><span>
</span><span id="line-649"></span><span>            </span><span class="annot"><a href="#local-6989586621679357528"><span class="hs-identifier hs-var">contDecDef</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">C.Array</span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SVariable r -&gt; r (Scope r) -&gt; [SValue r] -&gt; MSStatement r
forall (r :: * -&gt; *).
DeclStatement r =&gt;
SVariable r -&gt; r (Scope r) -&gt; [SValue r] -&gt; MSStatement r
</span><span class="hs-identifier hs-var">arrayDecDef</span></span><span>
</span><span id="line-650"></span><span>            </span><span class="annot"><a href="#local-6989586621679357528"><span class="hs-identifier hs-var">contDecDef</span></a></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; SVariable r -&gt; r (Scope r) -&gt; [SValue r] -&gt; MSStatement r
forall a. HasCallStack =&gt; Name -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Type mismatch between variable and value in declare-define FuncStmt&quot;</span></span><span>
</span><span id="line-651"></span><span>        </span><span id="local-6989586621679357531"><span class="annot"><span class="annottext">[VS (r (Value r))]
</span><a href="#local-6989586621679357531"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r))))
-&gt; [CodeExpr] -&gt; StateT DrasilState Identity [VS (r (Value r))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679357507"><span class="hs-identifier hs-var">lst</span></a></span><span>
</span><span id="line-652"></span><span>        </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; GenState (MSStatement r))
-&gt; MSStatement r -&gt; GenState (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CodeType
-&gt; StateT ValueState Identity (r (Variable r))
-&gt; r (Scope r)
-&gt; [VS (r (Value r))]
-&gt; MSStatement r
forall {r :: * -&gt; *}.
DeclStatement r =&gt;
CodeType
-&gt; SVariable r -&gt; r (Scope r) -&gt; [SValue r] -&gt; MSStatement r
</span><a href="#local-6989586621679357528"><span class="hs-identifier hs-var">contDecDef</span></a></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679357263"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679357261"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">r (Scope r)
</span><a href="#local-6989586621679357260"><span class="hs-identifier hs-var">scp</span></a></span><span> </span><span class="annot"><span class="annottext">[VS (r (Value r))]
</span><a href="#local-6989586621679357531"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-653"></span><span>      </span><span class="annot"><a href="#local-6989586621679357506"><span class="hs-identifier hs-var">convDecDef</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-654"></span><span>        </span><span id="local-6989586621679357532"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679357532"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679357130"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-655"></span><span>        </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; GenState (MSStatement r))
-&gt; MSStatement r -&gt; GenState (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
-&gt; r (Scope r) -&gt; VS (r (Value r)) -&gt; MSStatement r
forall (r :: * -&gt; *).
DeclStatement r =&gt;
SVariable r -&gt; r (Scope r) -&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">varDecDef</span></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679357261"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">r (Scope r)
</span><a href="#local-6989586621679357260"><span class="hs-identifier hs-var">scp</span></a></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679357532"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-656"></span><span>  </span><span id="local-6989586621679357534"><span class="annot"><span class="annottext">MSStatement r
</span><a href="#local-6989586621679357534"><span class="hs-identifier hs-var">dd</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (MSStatement r)
</span><a href="#local-6989586621679357506"><span class="hs-identifier hs-var">convDecDef</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679357130"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-657"></span><span>  </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; GenState (MSStatement r))
-&gt; MSStatement r -&gt; GenState (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSStatement r
forall (r :: * -&gt; *).
StatementSym r =&gt;
[MSStatement r] -&gt; MSStatement r
</span><span class="hs-identifier hs-var">multi</span></span><span> </span><span class="annot"><span class="annottext">([MSStatement r] -&gt; MSStatement r)
-&gt; [MSStatement r] -&gt; MSStatement r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MSStatement r
</span><a href="#local-6989586621679357534"><span class="hs-identifier hs-var">dd</span></a></span><span> </span><span class="annot"><span class="annottext">MSStatement r -&gt; [MSStatement r] -&gt; [MSStatement r]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679357262"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-658"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FFuncDef"><span class="hs-identifier hs-type">FFuncDef</span></a></span><span> </span><span id="local-6989586621679357536"><span class="annot"><span class="annottext">CodeFuncChunk
</span><a href="#local-6989586621679357536"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679357537"><span class="annot"><span class="annottext">[ParameterChunk]
</span><a href="#local-6989586621679357537"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621679357538"><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679357538"><span class="hs-identifier hs-var">sts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-659"></span><span>  </span><span id="local-6989586621679357539"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679357539"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-660"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679357668"><span class="annot"><span class="annottext">scp :: r (Scope r)
</span><a href="#local-6989586621679357668"><span class="hs-identifier hs-var hs-var">scp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScopeType -&gt; r (Scope r)
forall (r :: * -&gt; *). SharedProg r =&gt; ScopeType -&gt; r (Scope r)
</span><a href="Language.Drasil.Code.Imperative.Helpers.html#convScope"><span class="hs-identifier hs-var">convScope</span></a></span><span> </span><span class="annot"><span class="annottext">(ScopeType -&gt; r (Scope r)) -&gt; ScopeType -&gt; r (Scope r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; ScopeType
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#currentScope"><span class="hs-identifier hs-var">currentScope</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679357539"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-661"></span><span>  </span><span id="local-6989586621679357669"><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679357669"><span class="hs-identifier hs-var">f'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input
-&gt; StateT
     DrasilState Identity (StateT ValueState Identity (r (Variable r)))
forall (r :: * -&gt; *). OOProg r =&gt; Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeFuncChunk -&gt; Input
forall c. (Quantity c, MayHaveUnit c, Concept c) =&gt; c -&gt; Input
</span><a href="Language.Drasil.Chunk.CodeBase.html#quantvar"><span class="hs-identifier hs-var">quantvar</span></a></span><span> </span><span class="annot"><span class="annottext">CodeFuncChunk
</span><a href="#local-6989586621679357536"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-662"></span><span>  </span><span id="local-6989586621679357670"><span class="annot"><span class="annottext">[StateT ValueState Identity (r (Variable r))]
</span><a href="#local-6989586621679357670"><span class="hs-identifier hs-var">pms</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ParameterChunk
 -&gt; StateT
      DrasilState Identity (StateT ValueState Identity (r (Variable r))))
-&gt; [ParameterChunk]
-&gt; StateT
     DrasilState Identity [StateT ValueState Identity (r (Variable r))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input
-&gt; StateT
     DrasilState Identity (StateT ValueState Identity (r (Variable r)))
forall (r :: * -&gt; *). OOProg r =&gt; Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="annot"><span class="annottext">(Input
 -&gt; StateT
      DrasilState Identity (StateT ValueState Identity (r (Variable r))))
-&gt; (ParameterChunk -&gt; Input)
-&gt; ParameterChunk
-&gt; StateT
     DrasilState Identity (StateT ValueState Identity (r (Variable r)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ParameterChunk -&gt; Input
forall c. (Quantity c, MayHaveUnit c, Concept c) =&gt; c -&gt; Input
</span><a href="Language.Drasil.Chunk.CodeBase.html#quantvar"><span class="hs-identifier hs-var">quantvar</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ParameterChunk]
</span><a href="#local-6989586621679357537"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-663"></span><span>  </span><span id="local-6989586621679357671"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679357671"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FuncStmt -&gt; GenState (MSStatement r))
-&gt; [FuncStmt] -&gt; StateT DrasilState Identity [MSStatement r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">FuncStmt -&gt; GenState (MSStatement r)
forall (r :: * -&gt; *).
OOProg r =&gt;
FuncStmt -&gt; GenState (MSStatement r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679357538"><span class="hs-identifier hs-var">sts</span></a></span><span>
</span><span id="line-664"></span><span>  </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; GenState (MSStatement r))
-&gt; MSStatement r -&gt; GenState (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
-&gt; r (Scope r)
-&gt; [StateT ValueState Identity (r (Variable r))]
-&gt; MSBody r
-&gt; MSStatement r
forall (r :: * -&gt; *).
DeclStatement r =&gt;
SVariable r
-&gt; r (Scope r) -&gt; [SVariable r] -&gt; MSBody r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">funcDecDef</span></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679357669"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="annot"><span class="annottext">r (Scope r)
</span><a href="#local-6989586621679357668"><span class="hs-identifier hs-var">scp</span></a></span><span> </span><span class="annot"><span class="annottext">[StateT ValueState Identity (r (Variable r))]
</span><a href="#local-6989586621679357670"><span class="hs-identifier hs-var">pms</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSBody r
forall (r :: * -&gt; *). BodySym r =&gt; [MSStatement r] -&gt; MSBody r
</span><span class="hs-identifier hs-var">bodyStatements</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679357671"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-665"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FVal"><span class="hs-identifier hs-type">FVal</span></a></span><span> </span><span id="local-6989586621679357674"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679357674"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-666"></span><span>  </span><span id="local-6989586621679357675"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679357675"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679357674"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-667"></span><span>  </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; GenState (MSStatement r))
-&gt; MSStatement r -&gt; GenState (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r)) -&gt; MSStatement r
forall (r :: * -&gt; *). StatementSym r =&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">valStmt</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679357675"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-668"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FMulti"><span class="hs-identifier hs-type">FMulti</span></a></span><span> </span><span id="local-6989586621679357677"><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679357677"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-669"></span><span>  </span><span id="local-6989586621679357678"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679357678"><span class="hs-identifier hs-var">stmts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FuncStmt -&gt; GenState (MSStatement r))
-&gt; [FuncStmt] -&gt; StateT DrasilState Identity [MSStatement r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">FuncStmt -&gt; GenState (MSStatement r)
forall (r :: * -&gt; *).
OOProg r =&gt;
FuncStmt -&gt; GenState (MSStatement r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679357677"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-670"></span><span>  </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; GenState (MSStatement r))
-&gt; MSStatement r -&gt; GenState (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSStatement r
forall (r :: * -&gt; *).
StatementSym r =&gt;
[MSStatement r] -&gt; MSStatement r
</span><span class="hs-identifier hs-var">multi</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679357678"><span class="hs-identifier hs-var">stmts</span></a></span><span>
</span><span id="line-671"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmt"><span class="hs-identifier hs-var">convStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FAppend"><span class="hs-identifier hs-type">FAppend</span></a></span><span> </span><span id="local-6989586621679357680"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679357680"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679357681"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679357681"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-672"></span><span>  </span><span id="local-6989586621679357682"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679357682"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679357680"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-673"></span><span>  </span><span id="local-6989586621679357683"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679357683"><span class="hs-identifier hs-var">b'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExpr"><span class="hs-identifier hs-var">convExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679357681"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-674"></span><span>  </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; GenState (MSStatement r))
-&gt; MSStatement r -&gt; GenState (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r)) -&gt; MSStatement r
forall (r :: * -&gt; *). StatementSym r =&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">valStmt</span></span><span> </span><span class="annot"><span class="annottext">(VS (r (Value r)) -&gt; MSStatement r)
-&gt; VS (r (Value r)) -&gt; MSStatement r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r)) -&gt; VS (r (Value r)) -&gt; VS (r (Value r))
forall (r :: * -&gt; *). List r =&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-identifier hs-var">listAppend</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679357682"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679357683"><span class="hs-identifier hs-var">b'</span></a></span><span>
</span><span id="line-675"></span><span>
</span><span id="line-676"></span><span class="hs-comment">-- | Generates a function that reads a file whose format is based on the passed</span><span>
</span><span id="line-677"></span><span class="hs-comment">-- 'DataDesc'.</span><span>
</span><span id="line-678"></span><span id="local-6989586621679353908"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#genDataFunc"><span class="hs-identifier hs-type">genDataFunc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353908"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Description"><span class="hs-identifier hs-type">Description</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#DataDesc"><span class="hs-identifier hs-type">DataDesc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-679"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679353908"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-680"></span><span id="genDataFunc"><span class="annot"><span class="annottext">genDataFunc :: forall (r :: * -&gt; *).
OOProg r =&gt;
Name -&gt; Name -&gt; DataDesc -&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genDataFunc"><span class="hs-identifier hs-var hs-var">genDataFunc</span></a></span></span><span> </span><span id="local-6989586621679357700"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679357700"><span class="hs-identifier hs-var">nameTitle</span></a></span></span><span> </span><span id="local-6989586621679357701"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679357701"><span class="hs-identifier hs-var">desc</span></a></span></span><span> </span><span id="local-6989586621679357702"><span class="annot"><span class="annottext">DataDesc
</span><a href="#local-6989586621679357702"><span class="hs-identifier hs-var">ddef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-681"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679357703"><span class="annot"><span class="annottext">parms :: [Input]
</span><a href="#local-6989586621679357703"><span class="hs-identifier hs-var hs-var">parms</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataDesc -&gt; [Input]
</span><a href="Language.Drasil.Code.DataDesc.html#getInputs"><span class="hs-identifier hs-var">getInputs</span></a></span><span> </span><span class="annot"><span class="annottext">DataDesc
</span><a href="#local-6989586621679357702"><span class="hs-identifier hs-var">ddef</span></a></span><span>
</span><span id="line-682"></span><span>  </span><span id="local-6989586621679357704"><span class="annot"><span class="annottext">[MS (r (Block r))]
</span><a href="#local-6989586621679357704"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DataDesc -&gt; StateT DrasilState Identity [MS (r (Block r))]
forall (r :: * -&gt; *). OOProg r =&gt; DataDesc -&gt; GenState [MSBlock r]
</span><a href="Language.Drasil.Code.Imperative.Import.html#readData"><span class="hs-identifier hs-var">readData</span></a></span><span> </span><span class="annot"><span class="annottext">DataDesc
</span><a href="#local-6989586621679357702"><span class="hs-identifier hs-var">ddef</span></a></span><span>
</span><span id="line-683"></span><span>  </span><span class="annot"><span class="annottext">Name
-&gt; VSType r
-&gt; Name
-&gt; [ParameterChunk]
-&gt; Maybe Name
-&gt; [MS (r (Block r))]
-&gt; GenState (SMethod r)
forall (r :: * -&gt; *).
OOProg r =&gt;
Name
-&gt; VSType r
-&gt; Name
-&gt; [ParameterChunk]
-&gt; Maybe Name
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#publicFunc"><span class="hs-identifier hs-var">publicFunc</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679357700"><span class="hs-identifier hs-var">nameTitle</span></a></span><span> </span><span class="annot"><span class="annottext">VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; VSType r
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679357701"><span class="hs-identifier hs-var">desc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Input -&gt; ParameterChunk) -&gt; [Input] -&gt; [ParameterChunk]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Input -&gt; ParameterChunk
forall c. CodeIdea c =&gt; c -&gt; ParameterChunk
</span><a href="Language.Drasil.Chunk.Parameter.html#pcAuto"><span class="hs-identifier hs-var">pcAuto</span></a></span><span> </span><span class="annot"><span class="annottext">([Input] -&gt; [ParameterChunk]) -&gt; [Input] -&gt; [ParameterChunk]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DefinedQuantityDict -&gt; Input
forall c. (Quantity c, MayHaveUnit c, Concept c) =&gt; c -&gt; Input
</span><a href="Language.Drasil.Chunk.CodeBase.html#quantvar"><span class="hs-identifier hs-var">quantvar</span></a></span><span> </span><span class="annot"><span class="annottext">DefinedQuantityDict
</span><a href="Language.Drasil.Code.CodeQuantityDicts.html#inFileName"><span class="hs-identifier hs-var">inFileName</span></a></span><span> </span><span class="annot"><span class="annottext">Input -&gt; [Input] -&gt; [Input]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679357703"><span class="hs-identifier hs-var">parms</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-684"></span><span>    </span><span class="annot"><span class="annottext">Maybe Name
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">[MS (r (Block r))]
</span><a href="#local-6989586621679357704"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-685"></span><span>
</span><span id="line-686"></span><span class="hs-comment">-- this is really ugly!!</span><span>
</span><span id="line-687"></span><span class="annot"><span class="hs-comment">-- | Read from a data description into a 'MSBlock' of 'MSStatement's.</span></span><span>
</span><span id="line-688"></span><span id="local-6989586621679353920"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#readData"><span class="hs-identifier hs-type">readData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353920"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#DataDesc"><span class="hs-identifier hs-type">DataDesc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSBlock</span></span><span> </span><span class="annot"><a href="#local-6989586621679353920"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-689"></span><span id="readData"><span class="annot"><span class="annottext">readData :: forall (r :: * -&gt; *). OOProg r =&gt; DataDesc -&gt; GenState [MSBlock r]
</span><a href="Language.Drasil.Code.Imperative.Import.html#readData"><span class="hs-identifier hs-var hs-var">readData</span></a></span></span><span> </span><span id="local-6989586621679357781"><span class="annot"><span class="annottext">DataDesc
</span><a href="#local-6989586621679357781"><span class="hs-identifier hs-var">ddef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-690"></span><span>  </span><span id="local-6989586621679357782"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679357782"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-691"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679357911"><span class="annot"><span class="annottext">localScope :: r (Scope r)
</span><a href="#local-6989586621679357911"><span class="hs-identifier hs-var hs-var">localScope</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScopeType -&gt; r (Scope r)
forall (r :: * -&gt; *). SharedProg r =&gt; ScopeType -&gt; r (Scope r)
</span><a href="Language.Drasil.Code.Imperative.Helpers.html#convScope"><span class="hs-identifier hs-var">convScope</span></a></span><span> </span><span class="annot"><span class="annottext">(ScopeType -&gt; r (Scope r)) -&gt; ScopeType -&gt; r (Scope r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; ScopeType
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#currentScope"><span class="hs-identifier hs-var">currentScope</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679357782"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-692"></span><span>  </span><span id="local-6989586621679357912"><span class="annot"><span class="annottext">[[MS (r (Statement r))]]
</span><a href="#local-6989586621679357912"><span class="hs-identifier hs-var">inD</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Data -&gt; StateT DrasilState Identity [MS (r (Statement r))])
-&gt; DataDesc -&gt; StateT DrasilState Identity [[MS (r (Statement r))]]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Data
-&gt; r (Scope r)
-&gt; StateT DrasilState Identity [MS (r (Statement r))]
forall (r :: * -&gt; *).
OOProg r =&gt;
Data -&gt; r (Scope r) -&gt; GenState [MSStatement r]
</span><a href="#local-6989586621679357913"><span class="hs-operator hs-var">`inData`</span></a></span><span> </span><span class="annot"><span class="annottext">r (Scope r)
</span><a href="#local-6989586621679357911"><span class="hs-identifier hs-var">localScope</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DataDesc
</span><a href="#local-6989586621679357781"><span class="hs-identifier hs-var">ddef</span></a></span><span>
</span><span id="line-693"></span><span>  </span><span id="local-6989586621679357914"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679357914"><span class="hs-identifier hs-var">v_filename</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). OOProg r =&gt; Input -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVal"><span class="hs-identifier hs-var">mkVal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DefinedQuantityDict -&gt; Input
forall c. (Quantity c, MayHaveUnit c, Concept c) =&gt; c -&gt; Input
</span><a href="Language.Drasil.Chunk.CodeBase.html#quantvar"><span class="hs-identifier hs-var">quantvar</span></a></span><span> </span><span class="annot"><span class="annottext">DefinedQuantityDict
</span><a href="Language.Drasil.Code.CodeQuantityDicts.html#inFileName"><span class="hs-identifier hs-var">inFileName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-694"></span><span>  </span><span class="annot"><span class="annottext">[MSBlock r] -&gt; GenState [MSBlock r]
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[MS (r (Statement r))] -&gt; MSBlock r
forall (r :: * -&gt; *). BlockSym r =&gt; [MSStatement r] -&gt; MSBlock r
</span><span class="hs-identifier hs-var">block</span></span><span> </span><span class="annot"><span class="annottext">([MS (r (Statement r))] -&gt; MSBlock r)
-&gt; [MS (r (Statement r))] -&gt; MSBlock r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-695"></span><span>    </span><span class="annot"><span class="annottext">SVariable r -&gt; r (Scope r) -&gt; MS (r (Statement r))
forall (r :: * -&gt; *).
DeclStatement r =&gt;
SVariable r -&gt; r (Scope r) -&gt; MSStatement r
</span><span class="hs-identifier hs-var">varDec</span></span><span> </span><span class="annot"><span class="annottext">SVariable r
forall (r :: * -&gt; *). SharedProg r =&gt; SVariable r
</span><a href="Language.Drasil.Code.Imperative.Import.html#var_infile"><span class="hs-identifier hs-var">var_infile</span></a></span><span> </span><span class="annot"><span class="annottext">r (Scope r)
</span><a href="#local-6989586621679357911"><span class="hs-identifier hs-var">localScope</span></a></span><span> </span><span class="annot"><span class="annottext">MS (r (Statement r))
-&gt; [MS (r (Statement r))] -&gt; [MS (r (Statement r))]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span>
</span><span id="line-696"></span><span>    </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">(Data -&gt; Bool) -&gt; DataDesc -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679357917"><span class="annot"><span class="annottext">Data
</span><a href="#local-6989586621679357917"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Data -&gt; Bool
</span><a href="Language.Drasil.Code.DataDesc.html#isLine"><span class="hs-identifier hs-var">isLine</span></a></span><span> </span><span class="annot"><span class="annottext">Data
</span><a href="#local-6989586621679357917"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Data -&gt; Bool
</span><a href="Language.Drasil.Code.DataDesc.html#isLines"><span class="hs-identifier hs-var">isLines</span></a></span><span> </span><span class="annot"><span class="annottext">Data
</span><a href="#local-6989586621679357917"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DataDesc
</span><a href="#local-6989586621679357781"><span class="hs-identifier hs-var">ddef</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SVariable r -&gt; r (Scope r) -&gt; MS (r (Statement r))
forall (r :: * -&gt; *).
DeclStatement r =&gt;
SVariable r -&gt; r (Scope r) -&gt; MSStatement r
</span><span class="hs-identifier hs-var">varDec</span></span><span> </span><span class="annot"><span class="annottext">SVariable r
forall (r :: * -&gt; *). SharedProg r =&gt; SVariable r
</span><a href="Language.Drasil.Code.Imperative.Import.html#var_line"><span class="hs-identifier hs-var">var_line</span></a></span><span> </span><span class="annot"><span class="annottext">r (Scope r)
</span><a href="#local-6989586621679357911"><span class="hs-identifier hs-var">localScope</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-697"></span><span>    </span><span class="annot"><span class="annottext">Integer -&gt; SVariable r -&gt; r (Scope r) -&gt; MS (r (Statement r))
forall (r :: * -&gt; *).
DeclStatement r =&gt;
Integer -&gt; SVariable r -&gt; r (Scope r) -&gt; MSStatement r
</span><span class="hs-identifier hs-var">listDec</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">SVariable r
forall (r :: * -&gt; *). SharedProg r =&gt; SVariable r
</span><a href="Language.Drasil.Code.Imperative.Import.html#var_linetokens"><span class="hs-identifier hs-var">var_linetokens</span></a></span><span> </span><span class="annot"><span class="annottext">r (Scope r)
</span><a href="#local-6989586621679357911"><span class="hs-identifier hs-var">localScope</span></a></span><span> </span><span class="hs-special">]</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[MS (r (Statement r))]
-&gt; [MS (r (Statement r))] -&gt; [MS (r (Statement r))]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-698"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer -&gt; SVariable r -&gt; r (Scope r) -&gt; MS (r (Statement r))
forall (r :: * -&gt; *).
DeclStatement r =&gt;
Integer -&gt; SVariable r -&gt; r (Scope r) -&gt; MSStatement r
</span><span class="hs-identifier hs-var">listDec</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">SVariable r
forall (r :: * -&gt; *). SharedProg r =&gt; SVariable r
</span><a href="Language.Drasil.Code.Imperative.Import.html#var_lines"><span class="hs-identifier hs-var">var_lines</span></a></span><span> </span><span class="annot"><span class="annottext">r (Scope r)
</span><a href="#local-6989586621679357911"><span class="hs-identifier hs-var">localScope</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(Data -&gt; Bool) -&gt; DataDesc -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="annot"><span class="annottext">Data -&gt; Bool
</span><a href="Language.Drasil.Code.DataDesc.html#isLines"><span class="hs-identifier hs-var">isLines</span></a></span><span> </span><span class="annot"><span class="annottext">DataDesc
</span><a href="#local-6989586621679357781"><span class="hs-identifier hs-var">ddef</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[MS (r (Statement r))]
-&gt; [MS (r (Statement r))] -&gt; [MS (r (Statement r))]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">SVariable r -&gt; VS (r (Value r)) -&gt; MS (r (Statement r))
forall (r :: * -&gt; *).
IOStatement r =&gt;
SVariable r -&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">openFileR</span></span><span> </span><span class="annot"><span class="annottext">SVariable r
forall (r :: * -&gt; *). SharedProg r =&gt; SVariable r
</span><a href="Language.Drasil.Code.Imperative.Import.html#var_infile"><span class="hs-identifier hs-var">var_infile</span></a></span><span>
</span><span id="line-699"></span><span>    </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679357914"><span class="hs-identifier hs-var">v_filename</span></a></span><span> </span><span class="annot"><span class="annottext">MS (r (Statement r))
-&gt; [MS (r (Statement r))] -&gt; [MS (r (Statement r))]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[[MS (r (Statement r))]] -&gt; [MS (r (Statement r))]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">[[MS (r (Statement r))]]
</span><a href="#local-6989586621679357912"><span class="hs-identifier hs-var">inD</span></a></span><span> </span><span class="annot"><span class="annottext">[MS (r (Statement r))]
-&gt; [MS (r (Statement r))] -&gt; [MS (r (Statement r))]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">VS (r (Value r)) -&gt; MS (r (Statement r))
forall (r :: * -&gt; *). IOStatement r =&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">closeFile</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
forall (r :: * -&gt; *). SharedProg r =&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#v_infile"><span class="hs-identifier hs-var">v_infile</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-700"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679353924"><span class="annot"><a href="#local-6989586621679357913"><span class="hs-identifier hs-type">inData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353924"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#Data"><span class="hs-identifier hs-type">Data</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679353924"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Scope</span></span><span> </span><span class="annot"><a href="#local-6989586621679353924"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSStatement</span></span><span> </span><span class="annot"><a href="#local-6989586621679353924"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-701"></span><span>        </span><span id="local-6989586621679357913"><span class="annot"><span class="annottext">inData :: forall (r :: * -&gt; *).
OOProg r =&gt;
Data -&gt; r (Scope r) -&gt; GenState [MSStatement r]
</span><a href="#local-6989586621679357913"><span class="hs-identifier hs-var hs-var">inData</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span id="local-6989586621679357997"><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679357997"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">r (Scope r)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-702"></span><span>            </span><span id="local-6989586621679357998"><span class="annot"><span class="annottext">VS (r (Variable r))
</span><a href="#local-6989586621679357998"><span class="hs-identifier hs-var">vv</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input -&gt; StateT DrasilState Identity (VS (r (Variable r)))
forall (r :: * -&gt; *). OOProg r =&gt; Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679357997"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-703"></span><span>            </span><span id="local-6989586621679357999"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679357999"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r)) -&gt; GenState [MSStatement r]
forall (r :: * -&gt; *).
SharedProg r =&gt;
SVariable r -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Logging.html#maybeLog"><span class="hs-identifier hs-var">maybeLog</span></a></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
</span><a href="#local-6989586621679357998"><span class="hs-identifier hs-var">vv</span></a></span><span>
</span><span id="line-704"></span><span>            </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; GenState [MSStatement r]
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSStatement r
forall (r :: * -&gt; *).
StatementSym r =&gt;
[MSStatement r] -&gt; MSStatement r
</span><span class="hs-identifier hs-var">multi</span></span><span> </span><span class="annot"><span class="annottext">([MSStatement r] -&gt; MSStatement r)
-&gt; [MSStatement r] -&gt; MSStatement r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; VS (r (Variable r)) -&gt; MSStatement r
forall (r :: * -&gt; *).
IOStatement r =&gt;
SValue r -&gt; SVariable r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">getFileInput</span></span><span> </span><span class="annot"><span class="annottext">SValue r
forall (r :: * -&gt; *). SharedProg r =&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#v_infile"><span class="hs-identifier hs-var">v_infile</span></a></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
</span><a href="#local-6989586621679357998"><span class="hs-identifier hs-var">vv</span></a></span><span> </span><span class="annot"><span class="annottext">MSStatement r -&gt; [MSStatement r] -&gt; [MSStatement r]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679357999"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-705"></span><span>        </span><span class="annot"><a href="#local-6989586621679357913"><span class="hs-identifier hs-var">inData</span></a></span><span> </span><span class="annot"><span class="annottext">Data
</span><a href="Language.Drasil.Code.DataDesc.html#JunkData"><span class="hs-identifier hs-var">JunkData</span></a></span><span> </span><span class="annot"><span class="annottext">r (Scope r)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; GenState [MSStatement r]
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SValue r -&gt; MSStatement r
forall (r :: * -&gt; *). IOStatement r =&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">discardFileLine</span></span><span> </span><span class="annot"><span class="annottext">SValue r
forall (r :: * -&gt; *). SharedProg r =&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#v_infile"><span class="hs-identifier hs-var">v_infile</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-706"></span><span>        </span><span class="annot"><a href="#local-6989586621679357913"><span class="hs-identifier hs-var">inData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#Line"><span class="hs-identifier hs-type">Line</span></a></span><span> </span><span id="local-6989586621679358002"><span class="annot"><span class="annottext">LinePattern
</span><a href="#local-6989586621679358002"><span class="hs-identifier hs-var">lp</span></a></span></span><span> </span><span id="local-6989586621679358003"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679358003"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679358004"><span class="annot"><span class="annottext">r (Scope r)
</span><a href="#local-6989586621679358004"><span class="hs-identifier hs-var">scp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-707"></span><span>          </span><span id="local-6989586621679358005"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679358005"><span class="hs-identifier hs-var">lnI</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe Name
-&gt; LinePattern -&gt; r (Scope r) -&gt; GenState [MSStatement r]
forall (r :: * -&gt; *).
OOProg r =&gt;
Maybe Name
-&gt; LinePattern -&gt; r (Scope r) -&gt; GenState [MSStatement r]
</span><a href="#local-6989586621679358006"><span class="hs-identifier hs-var">lineData</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Name
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">LinePattern
</span><a href="#local-6989586621679358002"><span class="hs-identifier hs-var">lp</span></a></span><span> </span><span class="annot"><span class="annottext">r (Scope r)
</span><a href="#local-6989586621679358004"><span class="hs-identifier hs-var">scp</span></a></span><span>
</span><span id="line-708"></span><span>          </span><span id="local-6989586621679358007"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679358007"><span class="hs-identifier hs-var">logs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LinePattern -&gt; GenState [MSStatement r]
forall (r :: * -&gt; *).
OOProg r =&gt;
LinePattern -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Import.html#getEntryVarLogs"><span class="hs-identifier hs-var">getEntryVarLogs</span></a></span><span> </span><span class="annot"><span class="annottext">LinePattern
</span><a href="#local-6989586621679358002"><span class="hs-identifier hs-var">lp</span></a></span><span>
</span><span id="line-709"></span><span>          </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; GenState [MSStatement r]
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([MSStatement r] -&gt; GenState [MSStatement r])
-&gt; [MSStatement r] -&gt; GenState [MSStatement r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SValue r -&gt; VS (r (Variable r)) -&gt; MSStatement r
forall (r :: * -&gt; *).
IOStatement r =&gt;
SValue r -&gt; SVariable r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">getFileInputLine</span></span><span> </span><span class="annot"><span class="annottext">SValue r
forall (r :: * -&gt; *). SharedProg r =&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#v_infile"><span class="hs-identifier hs-var">v_infile</span></a></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
forall (r :: * -&gt; *). SharedProg r =&gt; SVariable r
</span><a href="Language.Drasil.Code.Imperative.Import.html#var_line"><span class="hs-identifier hs-var">var_line</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-710"></span><span>            </span><span class="annot"><span class="annottext">Char -&gt; VS (r (Variable r)) -&gt; SValue r -&gt; MSStatement r
forall (r :: * -&gt; *).
StringStatement r =&gt;
Char -&gt; SVariable r -&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">stringSplit</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679358003"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
forall (r :: * -&gt; *). SharedProg r =&gt; SVariable r
</span><a href="Language.Drasil.Code.Imperative.Import.html#var_linetokens"><span class="hs-identifier hs-var">var_linetokens</span></a></span><span> </span><span class="annot"><span class="annottext">SValue r
forall (r :: * -&gt; *). SharedProg r =&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#v_line"><span class="hs-identifier hs-var">v_line</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; [MSStatement r] -&gt; [MSStatement r]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679358005"><span class="hs-identifier hs-var">lnI</span></a></span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; [MSStatement r] -&gt; [MSStatement r]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679358007"><span class="hs-identifier hs-var">logs</span></a></span><span>
</span><span id="line-711"></span><span>        </span><span class="annot"><a href="#local-6989586621679357913"><span class="hs-identifier hs-var">inData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#Lines"><span class="hs-identifier hs-type">Lines</span></a></span><span> </span><span id="local-6989586621679358012"><span class="annot"><span class="annottext">LinePattern
</span><a href="#local-6989586621679358012"><span class="hs-identifier hs-var">lp</span></a></span></span><span> </span><span id="local-6989586621679358013"><span class="annot"><span class="annottext">Maybe Integer
</span><a href="#local-6989586621679358013"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span id="local-6989586621679358014"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679358014"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679358015"><span class="annot"><span class="annottext">r (Scope r)
</span><a href="#local-6989586621679358015"><span class="hs-identifier hs-var">scp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-712"></span><span>          </span><span id="local-6989586621679358016"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679358016"><span class="hs-identifier hs-var">lnV</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe Name
-&gt; LinePattern -&gt; r (Scope r) -&gt; GenState [MSStatement r]
forall (r :: * -&gt; *).
OOProg r =&gt;
Maybe Name
-&gt; LinePattern -&gt; r (Scope r) -&gt; GenState [MSStatement r]
</span><a href="#local-6989586621679358006"><span class="hs-identifier hs-var">lineData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Maybe Name
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;_temp&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LinePattern
</span><a href="#local-6989586621679358012"><span class="hs-identifier hs-var">lp</span></a></span><span> </span><span class="annot"><span class="annottext">r (Scope r)
</span><a href="#local-6989586621679358015"><span class="hs-identifier hs-var">scp</span></a></span><span>
</span><span id="line-713"></span><span>          </span><span id="local-6989586621679358017"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679358017"><span class="hs-identifier hs-var">logs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LinePattern -&gt; GenState [MSStatement r]
forall (r :: * -&gt; *).
OOProg r =&gt;
LinePattern -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Import.html#getEntryVarLogs"><span class="hs-identifier hs-var">getEntryVarLogs</span></a></span><span> </span><span class="annot"><span class="annottext">LinePattern
</span><a href="#local-6989586621679358012"><span class="hs-identifier hs-var">lp</span></a></span><span>
</span><span id="line-714"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679358197"><span class="annot"><span class="annottext">readLines :: Maybe Integer -&gt; [MSStatement r]
</span><a href="#local-6989586621679358197"><span class="hs-identifier hs-var hs-var">readLines</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe Integer
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SValue r -&gt; VS (r (Variable r)) -&gt; MSStatement r
forall (r :: * -&gt; *).
IOStatement r =&gt;
SValue r -&gt; SVariable r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">getFileInputAll</span></span><span> </span><span class="annot"><span class="annottext">SValue r
forall (r :: * -&gt; *). SharedProg r =&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#v_infile"><span class="hs-identifier hs-var">v_infile</span></a></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
forall (r :: * -&gt; *). SharedProg r =&gt; SVariable r
</span><a href="Language.Drasil.Code.Imperative.Import.html#var_lines"><span class="hs-identifier hs-var">var_lines</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-715"></span><span>                </span><span class="annot"><span class="annottext">VS (r (Variable r))
-&gt; SValue r -&gt; SValue r -&gt; SValue r -&gt; MSBody r -&gt; MSStatement r
forall (r :: * -&gt; *).
ControlStatement r =&gt;
SVariable r
-&gt; SValue r -&gt; SValue r -&gt; SValue r -&gt; MSBody r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">forRange</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
forall (r :: * -&gt; *). SharedProg r =&gt; SVariable r
</span><a href="Language.Drasil.Code.Imperative.Import.html#var_i"><span class="hs-identifier hs-var">var_i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; SValue r
forall (r :: * -&gt; *). Literal r =&gt; Integer -&gt; SValue r
</span><span class="hs-identifier hs-var">litInt</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SValue r -&gt; SValue r
forall (r :: * -&gt; *). List r =&gt; SValue r -&gt; SValue r
</span><span class="hs-identifier hs-var">listSize</span></span><span> </span><span class="annot"><span class="annottext">SValue r
forall (r :: * -&gt; *). SharedProg r =&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#v_lines"><span class="hs-identifier hs-var">v_lines</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; SValue r
forall (r :: * -&gt; *). Literal r =&gt; Integer -&gt; SValue r
</span><span class="hs-identifier hs-var">litInt</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-716"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSBody r
forall (r :: * -&gt; *). BodySym r =&gt; [MSStatement r] -&gt; MSBody r
</span><span class="hs-identifier hs-var">bodyStatements</span></span><span> </span><span class="annot"><span class="annottext">([MSStatement r] -&gt; MSBody r) -&gt; [MSStatement r] -&gt; MSBody r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; VS (r (Variable r)) -&gt; SValue r -&gt; MSStatement r
forall (r :: * -&gt; *).
StringStatement r =&gt;
Char -&gt; SVariable r -&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">stringSplit</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679358014"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
forall (r :: * -&gt; *). SharedProg r =&gt; SVariable r
</span><a href="Language.Drasil.Code.Imperative.Import.html#var_linetokens"><span class="hs-identifier hs-var">var_linetokens</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-717"></span><span>                  </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *). List r =&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-identifier hs-var">listAccess</span></span><span> </span><span class="annot"><span class="annottext">SValue r
forall (r :: * -&gt; *). SharedProg r =&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#v_lines"><span class="hs-identifier hs-var">v_lines</span></a></span><span> </span><span class="annot"><span class="annottext">SValue r
forall (r :: * -&gt; *). SharedProg r =&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#v_i"><span class="hs-identifier hs-var">v_i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MSStatement r -&gt; [MSStatement r] -&gt; [MSStatement r]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679358016"><span class="hs-identifier hs-var">lnV</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-718"></span><span>              </span><span class="annot"><a href="#local-6989586621679358197"><span class="hs-identifier hs-var">readLines</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679358202"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679358202"><span class="hs-identifier hs-var">numLines</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">VS (r (Variable r))
-&gt; SValue r -&gt; SValue r -&gt; SValue r -&gt; MSBody r -&gt; MSStatement r
forall (r :: * -&gt; *).
ControlStatement r =&gt;
SVariable r
-&gt; SValue r -&gt; SValue r -&gt; SValue r -&gt; MSBody r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">forRange</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
forall (r :: * -&gt; *). SharedProg r =&gt; SVariable r
</span><a href="Language.Drasil.Code.Imperative.Import.html#var_i"><span class="hs-identifier hs-var">var_i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; SValue r
forall (r :: * -&gt; *). Literal r =&gt; Integer -&gt; SValue r
</span><span class="hs-identifier hs-var">litInt</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-719"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; SValue r
forall (r :: * -&gt; *). Literal r =&gt; Integer -&gt; SValue r
</span><span class="hs-identifier hs-var">litInt</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679358202"><span class="hs-identifier hs-var">numLines</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; SValue r
forall (r :: * -&gt; *). Literal r =&gt; Integer -&gt; SValue r
</span><span class="hs-identifier hs-var">litInt</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-720"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSBody r
forall (r :: * -&gt; *). BodySym r =&gt; [MSStatement r] -&gt; MSBody r
</span><span class="hs-identifier hs-var">bodyStatements</span></span><span> </span><span class="annot"><span class="annottext">([MSStatement r] -&gt; MSBody r) -&gt; [MSStatement r] -&gt; MSBody r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-721"></span><span>                  </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SValue r -&gt; VS (r (Variable r)) -&gt; MSStatement r
forall (r :: * -&gt; *).
IOStatement r =&gt;
SValue r -&gt; SVariable r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">getFileInputLine</span></span><span> </span><span class="annot"><span class="annottext">SValue r
forall (r :: * -&gt; *). SharedProg r =&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#v_infile"><span class="hs-identifier hs-var">v_infile</span></a></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
forall (r :: * -&gt; *). SharedProg r =&gt; SVariable r
</span><a href="Language.Drasil.Code.Imperative.Import.html#var_line"><span class="hs-identifier hs-var">var_line</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-722"></span><span>                   </span><span class="annot"><span class="annottext">Char -&gt; VS (r (Variable r)) -&gt; SValue r -&gt; MSStatement r
forall (r :: * -&gt; *).
StringStatement r =&gt;
Char -&gt; SVariable r -&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">stringSplit</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679358014"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
forall (r :: * -&gt; *). SharedProg r =&gt; SVariable r
</span><a href="Language.Drasil.Code.Imperative.Import.html#var_linetokens"><span class="hs-identifier hs-var">var_linetokens</span></a></span><span> </span><span class="annot"><span class="annottext">SValue r
forall (r :: * -&gt; *). SharedProg r =&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#v_line"><span class="hs-identifier hs-var">v_line</span></a></span><span>
</span><span id="line-723"></span><span>                  </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; [MSStatement r] -&gt; [MSStatement r]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679358016"><span class="hs-identifier hs-var">lnV</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-724"></span><span>          </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; GenState [MSStatement r]
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([MSStatement r] -&gt; GenState [MSStatement r])
-&gt; [MSStatement r] -&gt; GenState [MSStatement r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe Integer -&gt; [MSStatement r]
</span><a href="#local-6989586621679358197"><span class="hs-identifier hs-var">readLines</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Integer
</span><a href="#local-6989586621679358013"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; [MSStatement r] -&gt; [MSStatement r]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679358017"><span class="hs-identifier hs-var">logs</span></a></span><span>
</span><span id="line-725"></span><span>        </span><span class="hs-comment">---------------</span><span>
</span><span id="line-726"></span><span>        </span><span id="local-6989586621679353934"><span class="annot"><a href="#local-6989586621679358006"><span class="hs-identifier hs-type">lineData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353934"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#LinePattern"><span class="hs-identifier hs-type">LinePattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679353934"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Scope</span></span><span> </span><span class="annot"><a href="#local-6989586621679353934"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-727"></span><span>          </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSStatement</span></span><span> </span><span class="annot"><a href="#local-6989586621679353934"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-728"></span><span>        </span><span id="local-6989586621679358006"><span class="annot"><span class="annottext">lineData :: forall (r :: * -&gt; *).
OOProg r =&gt;
Maybe Name
-&gt; LinePattern -&gt; r (Scope r) -&gt; GenState [MSStatement r]
</span><a href="#local-6989586621679358006"><span class="hs-identifier hs-var hs-var">lineData</span></a></span></span><span> </span><span id="local-6989586621679358220"><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621679358220"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679358221"><span class="annot"><span class="annottext">p :: LinePattern
</span><a href="#local-6989586621679358221"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#Straight"><span class="hs-identifier hs-type">Straight</span></a></span><span> </span><span class="annot"><span class="annottext">[Input]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">r (Scope r)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-729"></span><span>          </span><span id="local-6989586621679358222"><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679358222"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe Name
-&gt; LinePattern -&gt; StateT DrasilState Identity [VS (r (Variable r))]
forall (r :: * -&gt; *).
OOProg r =&gt;
Maybe Name -&gt; LinePattern -&gt; GenState [SVariable r]
</span><a href="Language.Drasil.Code.Imperative.Import.html#getEntryVars"><span class="hs-identifier hs-var">getEntryVars</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621679358220"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">LinePattern
</span><a href="#local-6989586621679358221"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-730"></span><span>          </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; GenState [MSStatement r]
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[VS (r (Variable r))] -&gt; SValue r -&gt; MSStatement r
forall (r :: * -&gt; *).
StringStatement r =&gt;
[SVariable r] -&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">stringListVals</span></span><span> </span><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679358222"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">SValue r
forall (r :: * -&gt; *). SharedProg r =&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#v_linetokens"><span class="hs-identifier hs-var">v_linetokens</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-731"></span><span>        </span><span class="annot"><a href="#local-6989586621679358006"><span class="hs-identifier hs-var">lineData</span></a></span><span> </span><span id="local-6989586621679358226"><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621679358226"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679358227"><span class="annot"><span class="annottext">p :: LinePattern
</span><a href="#local-6989586621679358227"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#Repeat"><span class="hs-identifier hs-type">Repeat</span></a></span><span> </span><span id="local-6989586621679358228"><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679358228"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679358229"><span class="annot"><span class="annottext">r (Scope r)
</span><a href="#local-6989586621679358229"><span class="hs-identifier hs-var">scp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-732"></span><span>          </span><span id="local-6989586621679358230"><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679358230"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe Name
-&gt; LinePattern -&gt; StateT DrasilState Identity [VS (r (Variable r))]
forall (r :: * -&gt; *).
OOProg r =&gt;
Maybe Name -&gt; LinePattern -&gt; GenState [SVariable r]
</span><a href="Language.Drasil.Code.Imperative.Import.html#getEntryVars"><span class="hs-identifier hs-var">getEntryVars</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621679358226"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">LinePattern
</span><a href="#local-6989586621679358227"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-733"></span><span>          </span><span class="annot"><span class="annottext">[StateT DrasilState Identity (MSStatement r)]
-&gt; GenState [MSStatement r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
forall (m :: * -&gt; *) a. Monad m =&gt; [m a] -&gt; m [a]
</span><span class="hs-identifier hs-var">sequence</span></span><span> </span><span class="annot"><span class="annottext">([StateT DrasilState Identity (MSStatement r)]
 -&gt; GenState [MSStatement r])
-&gt; [StateT DrasilState Identity (MSStatement r)]
-&gt; GenState [MSStatement r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe Name
-&gt; [Input]
-&gt; r (Scope r)
-&gt; [StateT DrasilState Identity (MSStatement r)]
forall (r :: * -&gt; *).
OOProg r =&gt;
Maybe Name -&gt; [Input] -&gt; r (Scope r) -&gt; [GenState (MSStatement r)]
</span><a href="#local-6989586621679358232"><span class="hs-identifier hs-var">clearTemps</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621679358226"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679358228"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="annot"><span class="annottext">r (Scope r)
</span><a href="#local-6989586621679358229"><span class="hs-identifier hs-var">scp</span></a></span><span> </span><span class="annot"><span class="annottext">[StateT DrasilState Identity (MSStatement r)]
-&gt; [StateT DrasilState Identity (MSStatement r)]
-&gt; [StateT DrasilState Identity (MSStatement r)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">MSStatement r -&gt; StateT DrasilState Identity (MSStatement r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-734"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[VS (r (Variable r))] -&gt; SValue r -&gt; MSStatement r
forall (r :: * -&gt; *).
StringStatement r =&gt;
[SVariable r] -&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">stringListLists</span></span><span> </span><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679358230"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">SValue r
forall (r :: * -&gt; *). SharedProg r =&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#v_linetokens"><span class="hs-identifier hs-var">v_linetokens</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity (MSStatement r)
-&gt; [StateT DrasilState Identity (MSStatement r)]
-&gt; [StateT DrasilState Identity (MSStatement r)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Maybe Name
-&gt; [Input] -&gt; [StateT DrasilState Identity (MSStatement r)]
forall (r :: * -&gt; *).
OOProg r =&gt;
Maybe Name -&gt; [Input] -&gt; [GenState (MSStatement r)]
</span><a href="#local-6989586621679358234"><span class="hs-identifier hs-var">appendTemps</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621679358226"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679358228"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-735"></span><span>        </span><span class="hs-comment">---------------</span><span>
</span><span id="line-736"></span><span>        </span><span id="local-6989586621679353941"><span class="annot"><a href="#local-6989586621679358232"><span class="hs-identifier hs-type">clearTemps</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353941"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#DataItem"><span class="hs-identifier hs-type">DataItem</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679353941"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Scope</span></span><span> </span><span class="annot"><a href="#local-6989586621679353941"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-737"></span><span>          </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MSStatement</span></span><span> </span><span class="annot"><a href="#local-6989586621679353941"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-738"></span><span>        </span><span id="local-6989586621679358232"><span class="annot"><span class="annottext">clearTemps :: forall (r :: * -&gt; *).
OOProg r =&gt;
Maybe Name -&gt; [Input] -&gt; r (Scope r) -&gt; [GenState (MSStatement r)]
</span><a href="#local-6989586621679358232"><span class="hs-identifier hs-var hs-var">clearTemps</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe Name
</span><span class="hs-identifier hs-var">Nothing</span></span><span>    </span><span class="annot"><span class="annottext">[Input]
</span><span class="hs-identifier">_</span></span><span>  </span><span class="annot"><span class="annottext">r (Scope r)
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-739"></span><span>        </span><span class="annot"><a href="#local-6989586621679358232"><span class="hs-identifier hs-var">clearTemps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679358237"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679358237"><span class="hs-identifier hs-var">sfx</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679358238"><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679358238"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span id="local-6989586621679358239"><span class="annot"><span class="annottext">r (Scope r)
</span><a href="#local-6989586621679358239"><span class="hs-identifier hs-var">scp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Input -&gt; GenState (MS (r (Statement r))))
-&gt; [Input] -&gt; [GenState (MS (r (Statement r)))]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679358240"><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679358240"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Input -&gt; r (Scope r) -&gt; GenState (MS (r (Statement r)))
forall (r :: * -&gt; *).
OOProg r =&gt;
Name -&gt; Input -&gt; r (Scope r) -&gt; GenState (MSStatement r)
</span><a href="#local-6989586621679358241"><span class="hs-identifier hs-var">clearTemp</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679358237"><span class="hs-identifier hs-var">sfx</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679358240"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">r (Scope r)
</span><a href="#local-6989586621679358239"><span class="hs-identifier hs-var">scp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679358238"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-740"></span><span>        </span><span class="hs-comment">---------------</span><span>
</span><span id="line-741"></span><span>        </span><span id="local-6989586621679353944"><span class="annot"><a href="#local-6989586621679358241"><span class="hs-identifier hs-type">clearTemp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353944"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#DataItem"><span class="hs-identifier hs-type">DataItem</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679353944"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Scope</span></span><span> </span><span class="annot"><a href="#local-6989586621679353944"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-742"></span><span>          </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MSStatement</span></span><span> </span><span class="annot"><a href="#local-6989586621679353944"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-743"></span><span>        </span><span id="local-6989586621679358241"><span class="annot"><span class="annottext">clearTemp :: forall (r :: * -&gt; *).
OOProg r =&gt;
Name -&gt; Input -&gt; r (Scope r) -&gt; GenState (MSStatement r)
</span><a href="#local-6989586621679358241"><span class="hs-identifier hs-var hs-var">clearTemp</span></a></span></span><span> </span><span id="local-6989586621679358260"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679358260"><span class="hs-identifier hs-var">sfx</span></a></span></span><span> </span><span id="local-6989586621679358261"><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679358261"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679358262"><span class="annot"><span class="annottext">r (Scope r)
</span><a href="#local-6989586621679358262"><span class="hs-identifier hs-var">scp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CodeType -&gt; MS (r (Statement r)))
-&gt; GenState CodeType
-&gt; StateT DrasilState Identity (MS (r (Statement r)))
forall a b.
(a -&gt; b)
-&gt; StateT DrasilState Identity a -&gt; StateT DrasilState Identity b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679358263"><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679358263"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SVariable r -&gt; r (Scope r) -&gt; [SValue r] -&gt; MS (r (Statement r))
forall (r :: * -&gt; *).
DeclStatement r =&gt;
SVariable r -&gt; r (Scope r) -&gt; [SValue r] -&gt; MSStatement r
</span><span class="hs-identifier hs-var">listDecDef</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; VSType r -&gt; SVariable r
forall (r :: * -&gt; *).
VariableSym r =&gt;
Name -&gt; VSType r -&gt; SVariable r
</span><span class="hs-identifier hs-var">var</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input -&gt; Name
forall c. CodeIdea c =&gt; c -&gt; Name
</span><span class="hs-identifier hs-var">codeName</span></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679358261"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679358260"><span class="hs-identifier hs-var">sfx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-744"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VSType r -&gt; VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; VSType r -&gt; VSType r
</span><span class="hs-identifier hs-var">listInnerType</span></span><span> </span><span class="annot"><span class="annottext">(VSType r -&gt; VSType r) -&gt; VSType r -&gt; VSType r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CodeType -&gt; VSType r
forall (r :: * -&gt; *). OOTypeSym r =&gt; CodeType -&gt; VSType r
</span><span class="hs-identifier hs-var">convTypeOO</span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679358263"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">r (Scope r)
</span><a href="#local-6989586621679358262"><span class="hs-identifier hs-var">scp</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input -&gt; GenState CodeType
forall c. HasSpace c =&gt; c -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#codeType"><span class="hs-identifier hs-var">codeType</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679358261"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-745"></span><span>        </span><span class="hs-comment">---------------</span><span>
</span><span id="line-746"></span><span>        </span><span id="local-6989586621679353942"><span class="annot"><a href="#local-6989586621679358234"><span class="hs-identifier hs-type">appendTemps</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353942"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#DataItem"><span class="hs-identifier hs-type">DataItem</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-747"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MSStatement</span></span><span> </span><span class="annot"><a href="#local-6989586621679353942"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-748"></span><span>        </span><span id="local-6989586621679358234"><span class="annot"><span class="annottext">appendTemps :: forall (r :: * -&gt; *).
OOProg r =&gt;
Maybe Name -&gt; [Input] -&gt; [GenState (MSStatement r)]
</span><a href="#local-6989586621679358234"><span class="hs-identifier hs-var hs-var">appendTemps</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe Name
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">[Input]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-749"></span><span>        </span><span class="annot"><a href="#local-6989586621679358234"><span class="hs-identifier hs-var">appendTemps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679358266"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679358266"><span class="hs-identifier hs-var">sfx</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679358267"><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679358267"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Input -&gt; GenState (MS (r (Statement r))))
-&gt; [Input] -&gt; [GenState (MS (r (Statement r)))]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Input -&gt; GenState (MS (r (Statement r)))
forall (r :: * -&gt; *).
OOProg r =&gt;
Name -&gt; Input -&gt; GenState (MSStatement r)
</span><a href="#local-6989586621679358268"><span class="hs-identifier hs-var">appendTemp</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679358266"><span class="hs-identifier hs-var">sfx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679358267"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-750"></span><span>        </span><span class="hs-comment">---------------</span><span>
</span><span id="line-751"></span><span>        </span><span id="local-6989586621679353947"><span class="annot"><a href="#local-6989586621679358268"><span class="hs-identifier hs-type">appendTemp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353947"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#DataItem"><span class="hs-identifier hs-type">DataItem</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-752"></span><span>          </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MSStatement</span></span><span> </span><span class="annot"><a href="#local-6989586621679353947"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-753"></span><span>        </span><span id="local-6989586621679358268"><span class="annot"><span class="annottext">appendTemp :: forall (r :: * -&gt; *).
OOProg r =&gt;
Name -&gt; Input -&gt; GenState (MSStatement r)
</span><a href="#local-6989586621679358268"><span class="hs-identifier hs-var hs-var">appendTemp</span></a></span></span><span> </span><span id="local-6989586621679358293"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679358293"><span class="hs-identifier hs-var">sfx</span></a></span></span><span> </span><span id="local-6989586621679358294"><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679358294"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CodeType -&gt; MS (r (Statement r)))
-&gt; GenState CodeType
-&gt; StateT DrasilState Identity (MS (r (Statement r)))
forall a b.
(a -&gt; b)
-&gt; StateT DrasilState Identity a -&gt; StateT DrasilState Identity b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679358295"><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679358295"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; MS (r (Statement r))
forall (r :: * -&gt; *). StatementSym r =&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">valStmt</span></span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; MS (r (Statement r)))
-&gt; SValue r -&gt; MS (r (Statement r))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *). List r =&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-identifier hs-var">listAppend</span></span><span>
</span><span id="line-754"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SVariable r -&gt; SValue r
forall (r :: * -&gt; *). VariableValue r =&gt; SVariable r -&gt; SValue r
</span><span class="hs-identifier hs-var">valueOf</span></span><span> </span><span class="annot"><span class="annottext">(SVariable r -&gt; SValue r) -&gt; SVariable r -&gt; SValue r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; VSType r -&gt; SVariable r
forall (r :: * -&gt; *).
VariableSym r =&gt;
Name -&gt; VSType r -&gt; SVariable r
</span><span class="hs-identifier hs-var">var</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input -&gt; Name
forall c. CodeIdea c =&gt; c -&gt; Name
</span><span class="hs-identifier hs-var">codeName</span></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679358294"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeType -&gt; VSType r
forall (r :: * -&gt; *). OOTypeSym r =&gt; CodeType -&gt; VSType r
</span><span class="hs-identifier hs-var">convTypeOO</span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679358295"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-755"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SVariable r -&gt; SValue r
forall (r :: * -&gt; *). VariableValue r =&gt; SVariable r -&gt; SValue r
</span><span class="hs-identifier hs-var">valueOf</span></span><span> </span><span class="annot"><span class="annottext">(SVariable r -&gt; SValue r) -&gt; SVariable r -&gt; SValue r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; VSType r -&gt; SVariable r
forall (r :: * -&gt; *).
VariableSym r =&gt;
Name -&gt; VSType r -&gt; SVariable r
</span><span class="hs-identifier hs-var">var</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input -&gt; Name
forall c. CodeIdea c =&gt; c -&gt; Name
</span><span class="hs-identifier hs-var">codeName</span></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679358294"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679358293"><span class="hs-identifier hs-var">sfx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeType -&gt; VSType r
forall (r :: * -&gt; *). OOTypeSym r =&gt; CodeType -&gt; VSType r
</span><span class="hs-identifier hs-var">convTypeOO</span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679358295"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input -&gt; GenState CodeType
forall c. HasSpace c =&gt; c -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#codeType"><span class="hs-identifier hs-var">codeType</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679358294"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-756"></span><span>
</span><span id="line-757"></span><span class="annot"><span class="hs-comment">-- | Get entry variables.</span></span><span>
</span><span id="line-758"></span><span id="local-6989586621679353938"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#getEntryVars"><span class="hs-identifier hs-type">getEntryVars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353938"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#LinePattern"><span class="hs-identifier hs-type">LinePattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-759"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">SVariable</span></span><span> </span><span class="annot"><a href="#local-6989586621679353938"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-760"></span><span id="getEntryVars"><span class="annot"><span class="annottext">getEntryVars :: forall (r :: * -&gt; *).
OOProg r =&gt;
Maybe Name -&gt; LinePattern -&gt; GenState [SVariable r]
</span><a href="Language.Drasil.Code.Imperative.Import.html#getEntryVars"><span class="hs-identifier hs-var hs-var">getEntryVars</span></a></span></span><span> </span><span id="local-6989586621679358312"><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621679358312"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679358313"><span class="annot"><span class="annottext">LinePattern
</span><a href="#local-6989586621679358313"><span class="hs-identifier hs-var">lp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Input -&gt; StateT DrasilState Identity (VS (r (Variable r))))
-&gt; [Input] -&gt; StateT DrasilState Identity [VS (r (Variable r))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Input -&gt; StateT DrasilState Identity (VS (r (Variable r))))
-&gt; (Name
    -&gt; Input -&gt; StateT DrasilState Identity (VS (r (Variable r))))
-&gt; Maybe Name
-&gt; Input
-&gt; StateT DrasilState Identity (VS (r (Variable r)))
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Input -&gt; StateT DrasilState Identity (VS (r (Variable r)))
forall (r :: * -&gt; *). OOProg r =&gt; Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679358314"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679358314"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span id="local-6989586621679358315"><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679358315"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Input -&gt; GenState CodeType
forall c. HasSpace c =&gt; c -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#codeType"><span class="hs-identifier hs-var">codeType</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679358315"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">GenState CodeType
-&gt; (CodeType -&gt; StateT DrasilState Identity (VS (r (Variable r))))
-&gt; StateT DrasilState Identity (VS (r (Variable r)))
forall a b.
StateT DrasilState Identity a
-&gt; (a -&gt; StateT DrasilState Identity b)
-&gt; StateT DrasilState Identity b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span>
</span><span id="line-761"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
-&gt; VS (r (Type r))
-&gt; StateT DrasilState Identity (VS (r (Variable r)))
forall (r :: * -&gt; *).
OOProg r =&gt;
Name -&gt; VSType r -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#variable"><span class="hs-identifier hs-var">variable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input -&gt; Name
forall c. CodeIdea c =&gt; c -&gt; Name
</span><span class="hs-identifier hs-var">codeName</span></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679358315"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679358314"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(VS (r (Type r))
 -&gt; StateT DrasilState Identity (VS (r (Variable r))))
-&gt; (CodeType -&gt; VS (r (Type r)))
-&gt; CodeType
-&gt; StateT DrasilState Identity (VS (r (Variable r)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Type r)) -&gt; VS (r (Type r))
forall (r :: * -&gt; *). TypeSym r =&gt; VSType r -&gt; VSType r
</span><span class="hs-identifier hs-var">listInnerType</span></span><span> </span><span class="annot"><span class="annottext">(VS (r (Type r)) -&gt; VS (r (Type r)))
-&gt; (CodeType -&gt; VS (r (Type r))) -&gt; CodeType -&gt; VS (r (Type r))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CodeType -&gt; VS (r (Type r))
forall (r :: * -&gt; *). OOTypeSym r =&gt; CodeType -&gt; VSType r
</span><span class="hs-identifier hs-var">convTypeOO</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-762"></span><span>    </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621679358312"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LinePattern -&gt; [Input]
</span><a href="Language.Drasil.Code.DataDesc.html#getPatternInputs"><span class="hs-identifier hs-var">getPatternInputs</span></a></span><span> </span><span class="annot"><span class="annottext">LinePattern
</span><a href="#local-6989586621679358313"><span class="hs-identifier hs-var">lp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-763"></span><span>
</span><span id="line-764"></span><span class="annot"><span class="hs-comment">-- | Get entry variable logs.</span></span><span>
</span><span id="line-765"></span><span id="local-6989586621679353935"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#getEntryVarLogs"><span class="hs-identifier hs-type">getEntryVarLogs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OOProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353935"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#LinePattern"><span class="hs-identifier hs-type">LinePattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSStatement</span></span><span> </span><span class="annot"><a href="#local-6989586621679353935"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-766"></span><span id="getEntryVarLogs"><span class="annot"><span class="annottext">getEntryVarLogs :: forall (r :: * -&gt; *).
OOProg r =&gt;
LinePattern -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Import.html#getEntryVarLogs"><span class="hs-identifier hs-var hs-var">getEntryVarLogs</span></a></span></span><span> </span><span id="local-6989586621679358326"><span class="annot"><span class="annottext">LinePattern
</span><a href="#local-6989586621679358326"><span class="hs-identifier hs-var">lp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-767"></span><span>  </span><span id="local-6989586621679358327"><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679358327"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe Name
-&gt; LinePattern -&gt; StateT DrasilState Identity [VS (r (Variable r))]
forall (r :: * -&gt; *).
OOProg r =&gt;
Maybe Name -&gt; LinePattern -&gt; GenState [SVariable r]
</span><a href="Language.Drasil.Code.Imperative.Import.html#getEntryVars"><span class="hs-identifier hs-var">getEntryVars</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Name
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">LinePattern
</span><a href="#local-6989586621679358326"><span class="hs-identifier hs-var">lp</span></a></span><span>
</span><span id="line-768"></span><span>  </span><span id="local-6989586621679358328"><span class="annot"><span class="annottext">[[MSStatement r]]
</span><a href="#local-6989586621679358328"><span class="hs-identifier hs-var">logs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(VS (r (Variable r)) -&gt; GenState [MSStatement r])
-&gt; [VS (r (Variable r))]
-&gt; StateT DrasilState Identity [[MSStatement r]]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r)) -&gt; GenState [MSStatement r]
forall (r :: * -&gt; *).
SharedProg r =&gt;
SVariable r -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Logging.html#maybeLog"><span class="hs-identifier hs-var">maybeLog</span></a></span><span> </span><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679358327"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-769"></span><span>  </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; GenState [MSStatement r]
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([MSStatement r] -&gt; GenState [MSStatement r])
-&gt; [MSStatement r] -&gt; GenState [MSStatement r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[MSStatement r]] -&gt; [MSStatement r]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">[[MSStatement r]]
</span><a href="#local-6989586621679358328"><span class="hs-identifier hs-var">logs</span></a></span><span>
</span><span id="line-770"></span><span>
</span><span id="line-771"></span><span class="hs-comment">-- Procedural Versions --</span><span>
</span><span id="line-772"></span><span>
</span><span id="line-773"></span><span class="hs-comment">-- | If 'UID' for the variable is matched to a concept, call 'conceptToGOOL' to get</span><span>
</span><span id="line-774"></span><span class="hs-comment">-- the GOOL code for the concept, and return.</span><span>
</span><span id="line-775"></span><span class="hs-comment">-- If 'UID' is for a constant and user has chosen 'Inline', convert the constant's</span><span>
</span><span id="line-776"></span><span class="hs-comment">-- defining 'Expr' to a value with 'convExpr'.</span><span>
</span><span id="line-777"></span><span class="hs-comment">-- Otherwise, just a regular variable: construct it by calling the variable, then</span><span>
</span><span id="line-778"></span><span class="hs-comment">-- call 'valueOf' to reference its value.</span><span>
</span><span id="line-779"></span><span id="local-6989586621679353953"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#valueProc"><span class="hs-identifier hs-type">valueProc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353953"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VSType</span></span><span> </span><span class="annot"><a href="#local-6989586621679353953"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679353953"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-780"></span><span id="valueProc"><span class="annot"><span class="annottext">valueProc :: forall (r :: * -&gt; *).
SharedProg r =&gt;
UID -&gt; Name -&gt; VSType r -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#valueProc"><span class="hs-identifier hs-var hs-var">valueProc</span></a></span></span><span> </span><span id="local-6989586621679358344"><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679358344"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621679358345"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679358345"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679358346"><span class="annot"><span class="annottext">VSType r
</span><a href="#local-6989586621679358346"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-781"></span><span>  </span><span id="local-6989586621679358347"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679358347"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-782"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679358348"><span class="annot"><span class="annottext">cs :: CodeSpec
</span><a href="#local-6989586621679358348"><span class="hs-identifier hs-var hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; CodeSpec
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#codeSpec"><span class="hs-identifier hs-var">codeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679358347"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-783"></span><span>      </span><span id="local-6989586621679358351"><span class="annot"><span class="annottext">mm :: ConstantMap
</span><a href="#local-6989586621679358351"><span class="hs-identifier hs-var hs-var">mm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CodeSpec
</span><a href="#local-6989586621679358348"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">CodeSpec -&gt; Getting ConstantMap CodeSpec ConstantMap -&gt; ConstantMap
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting ConstantMap CodeSpec ConstantMap
forall c. HasOldCodeSpec c =&gt; Lens' c ConstantMap
Lens' CodeSpec ConstantMap
</span><a href="Language.Drasil.CodeSpec.html#constMapO"><span class="hs-identifier hs-var">constMapO</span></a></span><span>
</span><span id="line-784"></span><span>      </span><span id="local-6989586621679358354"><span class="annot"><span class="annottext">constDef :: Maybe CodeDefinition
</span><a href="#local-6989586621679358354"><span class="hs-identifier hs-var hs-var">constDef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-785"></span><span>        </span><span id="local-6989586621679358355"><span class="annot"><span class="annottext">CodeDefinition
</span><a href="#local-6989586621679358355"><span class="hs-identifier hs-var">cd</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UID -&gt; ConstantMap -&gt; Maybe CodeDefinition
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679358344"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">ConstantMap
</span><a href="#local-6989586621679358351"><span class="hs-identifier hs-var">mm</span></a></span><span>
</span><span id="line-786"></span><span>        </span><span class="annot"><span class="annottext">ConstantStructure -&gt; CodeDefinition -&gt; Maybe CodeDefinition
forall {a}. ConstantStructure -&gt; a -&gt; Maybe a
</span><a href="#local-6989586621679358356"><span class="hs-identifier hs-var">maybeInline</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; ConstantStructure
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#conStruct"><span class="hs-identifier hs-var">conStruct</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679358347"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CodeDefinition
</span><a href="#local-6989586621679358355"><span class="hs-identifier hs-var">cd</span></a></span><span>
</span><span id="line-787"></span><span>      </span><span id="local-6989586621679358356"><span class="annot"><span class="annottext">maybeInline :: ConstantStructure -&gt; a -&gt; Maybe a
</span><a href="#local-6989586621679358356"><span class="hs-identifier hs-var hs-var">maybeInline</span></a></span></span><span> </span><span class="annot"><span class="annottext">ConstantStructure
</span><a href="Language.Drasil.Choices.html#Inline"><span class="hs-identifier hs-var">Inline</span></a></span><span> </span><span id="local-6989586621679358357"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679358357"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679358357"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-788"></span><span>      </span><span class="annot"><a href="#local-6989586621679358356"><span class="hs-identifier hs-var">maybeInline</span></a></span><span> </span><span class="annot"><span class="annottext">ConstantStructure
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-789"></span><span>      </span><span id="local-6989586621679358358"><span class="annot"><span class="annottext">cm :: MatchedConceptMap
</span><a href="#local-6989586621679358358"><span class="hs-identifier hs-var hs-var">cm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; MatchedConceptMap
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#concMatches"><span class="hs-identifier hs-var">concMatches</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679358347"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-790"></span><span>      </span><span id="local-6989586621679358360"><span class="annot"><span class="annottext">cdCncpt :: Maybe CodeConcept
</span><a href="#local-6989586621679358360"><span class="hs-identifier hs-var hs-var">cdCncpt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UID -&gt; MatchedConceptMap -&gt; Maybe CodeConcept
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679358344"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">MatchedConceptMap
</span><a href="#local-6989586621679358358"><span class="hs-identifier hs-var">cm</span></a></span><span>
</span><span id="line-791"></span><span>  </span><span id="local-6989586621679358361"><span class="annot"><span class="annottext">SValue r
</span><a href="#local-6989586621679358361"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenState (SValue r)
-&gt; (CodeDefinition -&gt; GenState (SValue r))
-&gt; Maybe CodeDefinition
-&gt; GenState (SValue r)
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SVariable r -&gt; SValue r
forall (r :: * -&gt; *). VariableValue r =&gt; SVariable r -&gt; SValue r
</span><span class="hs-identifier hs-var">valueOf</span></span><span> </span><span class="annot"><span class="annottext">(SVariable r -&gt; SValue r)
-&gt; StateT DrasilState Identity (SVariable r) -&gt; GenState (SValue r)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; VSType r -&gt; StateT DrasilState Identity (SVariable r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
Name -&gt; VSType r -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#variableProc"><span class="hs-identifier hs-var">variableProc</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679358345"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">VSType r
</span><a href="#local-6989586621679358346"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-792"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">(CodeExpr -&gt; GenState (SValue r))
-&gt; (CodeDefinition -&gt; CodeExpr)
-&gt; CodeDefinition
-&gt; GenState (SValue r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeDefinition
-&gt; Getting CodeExpr CodeDefinition CodeExpr -&gt; CodeExpr
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting CodeExpr CodeDefinition CodeExpr
forall c. DefiningCodeExpr c =&gt; Lens' c CodeExpr
Lens' CodeDefinition CodeExpr
</span><span class="hs-identifier hs-var">codeExpr</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe CodeDefinition
</span><a href="#local-6989586621679358354"><span class="hs-identifier hs-var">constDef</span></a></span><span>
</span><span id="line-793"></span><span>  </span><span class="annot"><span class="annottext">SValue r -&gt; GenState (SValue r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; GenState (SValue r))
-&gt; SValue r -&gt; GenState (SValue r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SValue r
-&gt; (CodeConcept -&gt; SValue r) -&gt; Maybe CodeConcept -&gt; SValue r
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">SValue r
</span><a href="#local-6989586621679358361"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">CodeConcept -&gt; SValue r
forall (r :: * -&gt; *). SharedProg r =&gt; CodeConcept -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.ConceptMatch.html#conceptToGOOL"><span class="hs-identifier hs-var">conceptToGOOL</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe CodeConcept
</span><a href="#local-6989586621679358360"><span class="hs-identifier hs-var">cdCncpt</span></a></span><span>
</span><span id="line-794"></span><span>
</span><span id="line-795"></span><span class="hs-comment">-- | If variable is an input, construct it with 'var' and pass to inputVariable.</span><span>
</span><span id="line-796"></span><span class="hs-comment">-- If variable is a constant and 'Var' constant representation is chosen,</span><span>
</span><span id="line-797"></span><span class="hs-comment">-- construct it with 'var' and pass to 'constVariable'.</span><span>
</span><span id="line-798"></span><span class="hs-comment">-- If variable is a constant and 'Const' constant representation is chosen,</span><span>
</span><span id="line-799"></span><span class="hs-comment">-- construct it with 'constant' and pass to 'constVariable'.</span><span>
</span><span id="line-800"></span><span class="hs-comment">-- If variable is neither, just construct it with 'var' and return it.</span><span>
</span><span id="line-801"></span><span id="local-6989586621679353956"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#variableProc"><span class="hs-identifier hs-type">variableProc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353956"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VSType</span></span><span> </span><span class="annot"><a href="#local-6989586621679353956"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SVariable</span></span><span> </span><span class="annot"><a href="#local-6989586621679353956"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-802"></span><span id="variableProc"><span class="annot"><span class="annottext">variableProc :: forall (r :: * -&gt; *).
SharedProg r =&gt;
Name -&gt; VSType r -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#variableProc"><span class="hs-identifier hs-var hs-var">variableProc</span></a></span></span><span> </span><span id="local-6989586621679358387"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679358387"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679358388"><span class="annot"><span class="annottext">VSType r
</span><a href="#local-6989586621679358388"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-803"></span><span>  </span><span id="local-6989586621679358389"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679358389"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-804"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679358390"><span class="annot"><span class="annottext">cs :: CodeSpec
</span><a href="#local-6989586621679358390"><span class="hs-identifier hs-var hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; CodeSpec
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#codeSpec"><span class="hs-identifier hs-var">codeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679358389"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-805"></span><span>      </span><span id="local-6989586621679358396"><span class="annot"><span class="annottext">defFunc :: ConstantRepr -&gt; Name -&gt; VSType r -&gt; SVariable r
</span><a href="#local-6989586621679358396"><span class="hs-identifier hs-var hs-var">defFunc</span></a></span></span><span> </span><span class="annot"><span class="annottext">ConstantRepr
</span><a href="Language.Drasil.Choices.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; VSType r -&gt; SVariable r
forall (r :: * -&gt; *).
VariableSym r =&gt;
Name -&gt; VSType r -&gt; SVariable r
</span><span class="hs-identifier hs-var">var</span></span><span>
</span><span id="line-806"></span><span>      </span><span class="annot"><a href="#local-6989586621679358396"><span class="hs-identifier hs-var">defFunc</span></a></span><span> </span><span class="annot"><span class="annottext">ConstantRepr
</span><a href="Language.Drasil.Choices.html#Const"><span class="hs-identifier hs-var">Const</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; VSType r -&gt; SVariable r
forall (r :: * -&gt; *).
VariableSym r =&gt;
Name -&gt; VSType r -&gt; SVariable r
</span><span class="hs-identifier hs-var">constant</span></span><span> </span><span class="hs-comment">-- This might be wrong</span><span>
</span><span id="line-807"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679358387"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Name] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">(Input -&gt; Name) -&gt; [Input] -&gt; [Name]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Input -&gt; Name
forall c. CodeIdea c =&gt; c -&gt; Name
</span><span class="hs-identifier hs-var">codeName</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeSpec
</span><a href="#local-6989586621679358390"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">CodeSpec -&gt; Getting [Input] CodeSpec [Input] -&gt; [Input]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting [Input] CodeSpec [Input]
forall c. HasOldCodeSpec c =&gt; Lens' c [Input]
Lens' CodeSpec [Input]
</span><a href="Language.Drasil.CodeSpec.html#inputsO"><span class="hs-identifier hs-var">inputsO</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-808"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Structure -&gt; ConstantRepr -&gt; SVariable r -&gt; GenState (SVariable r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
Structure -&gt; ConstantRepr -&gt; SVariable r -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#inputVariableProc"><span class="hs-identifier hs-var">inputVariableProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; Structure
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#inStruct"><span class="hs-identifier hs-var">inStruct</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679358389"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ConstantRepr
</span><a href="Language.Drasil.Choices.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; VSType r -&gt; SVariable r
forall (r :: * -&gt; *).
VariableSym r =&gt;
Name -&gt; VSType r -&gt; SVariable r
</span><span class="hs-identifier hs-var">var</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679358387"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">VSType r
</span><a href="#local-6989586621679358388"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-809"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679358387"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Name] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">(CodeDefinition -&gt; Name) -&gt; [CodeDefinition] -&gt; [Name]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">CodeDefinition -&gt; Name
forall c. CodeIdea c =&gt; c -&gt; Name
</span><span class="hs-identifier hs-var">codeName</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeSpec
</span><a href="#local-6989586621679358390"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">CodeSpec
-&gt; Getting [CodeDefinition] CodeSpec [CodeDefinition]
-&gt; [CodeDefinition]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting [CodeDefinition] CodeSpec [CodeDefinition]
forall c. HasOldCodeSpec c =&gt; Lens' c [CodeDefinition]
Lens' CodeSpec [CodeDefinition]
</span><a href="Language.Drasil.CodeSpec.html#constantsO"><span class="hs-identifier hs-var">constantsO</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-810"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ConstantStructure
-&gt; ConstantRepr -&gt; SVariable r -&gt; GenState (SVariable r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
ConstantStructure
-&gt; ConstantRepr -&gt; SVariable r -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#constVariableProc"><span class="hs-identifier hs-var">constVariableProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; ConstantStructure
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#conStruct"><span class="hs-identifier hs-var">conStruct</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679358389"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; ConstantRepr
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#conRepr"><span class="hs-identifier hs-var">conRepr</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679358389"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-811"></span><span>              </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConstantRepr -&gt; Name -&gt; VSType r -&gt; SVariable r
forall {r :: * -&gt; *}.
VariableSym r =&gt;
ConstantRepr -&gt; Name -&gt; VSType r -&gt; SVariable r
</span><a href="#local-6989586621679358396"><span class="hs-identifier hs-var">defFunc</span></a></span><span> </span><span class="annot"><span class="annottext">(ConstantRepr -&gt; Name -&gt; VSType r -&gt; SVariable r)
-&gt; ConstantRepr -&gt; Name -&gt; VSType r -&gt; SVariable r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; ConstantRepr
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#conRepr"><span class="hs-identifier hs-var">conRepr</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679358389"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679358387"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">VSType r
</span><a href="#local-6989586621679358388"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-812"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">SVariable r -&gt; GenState (SVariable r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SVariable r -&gt; GenState (SVariable r))
-&gt; SVariable r -&gt; GenState (SVariable r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; VSType r -&gt; SVariable r
forall (r :: * -&gt; *).
VariableSym r =&gt;
Name -&gt; VSType r -&gt; SVariable r
</span><span class="hs-identifier hs-var">var</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679358387"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">VSType r
</span><a href="#local-6989586621679358388"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-813"></span><span>
</span><span id="line-814"></span><span class="hs-comment">-- | If 'Unbundled' inputs, just return variable as-is.</span><span>
</span><span id="line-815"></span><span class="hs-comment">-- If 'Bundled' inputs, throw an error, since procedural renderers</span><span>
</span><span id="line-816"></span><span class="hs-comment">-- don't support 'Bundled' inputs yet.</span><span>
</span><span id="line-817"></span><span id="local-6989586621679353960"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#inputVariableProc"><span class="hs-identifier hs-type">inputVariableProc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353960"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#Structure"><span class="hs-identifier hs-type">Structure</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#ConstantRepr"><span class="hs-identifier hs-type">ConstantRepr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SVariable</span></span><span> </span><span class="annot"><a href="#local-6989586621679353960"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-818"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SVariable</span></span><span> </span><span class="annot"><a href="#local-6989586621679353960"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-819"></span><span id="inputVariableProc"><span class="annot"><span class="annottext">inputVariableProc :: forall (r :: * -&gt; *).
SharedProg r =&gt;
Structure -&gt; ConstantRepr -&gt; SVariable r -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#inputVariableProc"><span class="hs-identifier hs-var hs-var">inputVariableProc</span></a></span></span><span> </span><span class="annot"><span class="annottext">Structure
</span><a href="Language.Drasil.Choices.html#Unbundled"><span class="hs-identifier hs-var">Unbundled</span></a></span><span> </span><span class="annot"><span class="annottext">ConstantRepr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679358403"><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679358403"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SVariable r -&gt; StateT DrasilState Identity (SVariable r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679358403"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-820"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#inputVariableProc"><span class="hs-identifier hs-var">inputVariableProc</span></a></span><span> </span><span class="annot"><span class="annottext">Structure
</span><a href="Language.Drasil.Choices.html#Bundled"><span class="hs-identifier hs-var">Bundled</span></a></span><span> </span><span class="annot"><span class="annottext">ConstantRepr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SVariable r
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; StateT DrasilState Identity (SVariable r)
forall a. HasCallStack =&gt; Name -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;inputVariableProc: Procedural renderers do not support bundled inputs&quot;</span></span><span>
</span><span id="line-821"></span><span>
</span><span id="line-822"></span><span class="hs-comment">-- | If 'Unbundled' constants, just return variable as-is.</span><span>
</span><span id="line-823"></span><span class="hs-comment">-- If 'Bundled' constants, throw an error, since procedural renderers</span><span>
</span><span id="line-824"></span><span class="hs-comment">-- don't support 'Bundled' constants yet.</span><span>
</span><span id="line-825"></span><span class="hs-comment">-- If constants stored 'WithInputs', call 'inputVariable'.</span><span>
</span><span id="line-826"></span><span class="hs-comment">-- If constants are 'Inline'd, the generator should not be attempting to make a</span><span>
</span><span id="line-827"></span><span class="hs-comment">-- variable for one of the constants.</span><span>
</span><span id="line-828"></span><span id="local-6989586621679353961"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#constVariableProc"><span class="hs-identifier hs-type">constVariableProc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353961"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#ConstantStructure"><span class="hs-identifier hs-type">ConstantStructure</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Choices.html#ConstantRepr"><span class="hs-identifier hs-type">ConstantRepr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-829"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">SVariable</span></span><span> </span><span class="annot"><a href="#local-6989586621679353961"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SVariable</span></span><span> </span><span class="annot"><a href="#local-6989586621679353961"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-830"></span><span id="constVariableProc"><span class="annot"><span class="annottext">constVariableProc :: forall (r :: * -&gt; *).
SharedProg r =&gt;
ConstantStructure
-&gt; ConstantRepr -&gt; SVariable r -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#constVariableProc"><span class="hs-identifier hs-var hs-var">constVariableProc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Choices.html#Store"><span class="hs-identifier hs-type">Store</span></a></span><span> </span><span class="annot"><span class="annottext">Structure
</span><a href="Language.Drasil.Choices.html#Unbundled"><span class="hs-identifier hs-var">Unbundled</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ConstantRepr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679358413"><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679358413"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SVariable r -&gt; StateT DrasilState Identity (SVariable r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679358413"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-831"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#constVariableProc"><span class="hs-identifier hs-var">constVariableProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Choices.html#Store"><span class="hs-identifier hs-type">Store</span></a></span><span> </span><span class="annot"><span class="annottext">Structure
</span><a href="Language.Drasil.Choices.html#Bundled"><span class="hs-identifier hs-var">Bundled</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ConstantRepr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SVariable r
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; StateT DrasilState Identity (SVariable r)
forall a. HasCallStack =&gt; Name -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;constVariableProc: Procedural renderers do not support bundled constants&quot;</span></span><span>
</span><span id="line-832"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#constVariableProc"><span class="hs-identifier hs-var">constVariableProc</span></a></span><span> </span><span class="annot"><span class="annottext">ConstantStructure
</span><a href="Language.Drasil.Choices.html#WithInputs"><span class="hs-identifier hs-var">WithInputs</span></a></span><span> </span><span id="local-6989586621679358414"><span class="annot"><span class="annottext">ConstantRepr
</span><a href="#local-6989586621679358414"><span class="hs-identifier hs-var">cr</span></a></span></span><span> </span><span id="local-6989586621679358415"><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679358415"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-833"></span><span>  </span><span id="local-6989586621679358416"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679358416"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-834"></span><span>  </span><span class="annot"><span class="annottext">Structure
-&gt; ConstantRepr
-&gt; SVariable r
-&gt; StateT DrasilState Identity (SVariable r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
Structure -&gt; ConstantRepr -&gt; SVariable r -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#inputVariableProc"><span class="hs-identifier hs-var">inputVariableProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; Structure
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#inStruct"><span class="hs-identifier hs-var">inStruct</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679358416"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ConstantRepr
</span><a href="#local-6989586621679358414"><span class="hs-identifier hs-var">cr</span></a></span><span> </span><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679358415"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-835"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#constVariableProc"><span class="hs-identifier hs-var">constVariableProc</span></a></span><span> </span><span class="annot"><span class="annottext">ConstantStructure
</span><a href="Language.Drasil.Choices.html#Inline"><span class="hs-identifier hs-var">Inline</span></a></span><span> </span><span class="annot"><span class="annottext">ConstantRepr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SVariable r
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; StateT DrasilState Identity (SVariable r)
forall a. HasCallStack =&gt; Name -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; StateT DrasilState Identity (SVariable r))
-&gt; Name -&gt; StateT DrasilState Identity (SVariable r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;mkVar called on a constant, but user &quot;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-836"></span><span>  </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;chose to Inline constants. Generator has a bug.&quot;</span></span><span>
</span><span id="line-837"></span><span>
</span><span id="line-838"></span><span class="annot"><span class="hs-comment">-- | Generates a GOOL Value for a variable represented by a 'CodeVarChunk'.</span></span><span>
</span><span id="line-839"></span><span id="local-6989586621679353964"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#mkValProc"><span class="hs-identifier hs-type">mkValProc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353964"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CodeVarChunk</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679353964"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-840"></span><span id="mkValProc"><span class="annot"><span class="annottext">mkValProc :: forall (r :: * -&gt; *). SharedProg r =&gt; Input -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkValProc"><span class="hs-identifier hs-var hs-var">mkValProc</span></a></span></span><span> </span><span id="local-6989586621679358422"><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679358422"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-841"></span><span>  </span><span id="local-6989586621679358423"><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679358423"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input -&gt; GenState CodeType
forall c. HasSpace c =&gt; c -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#codeType"><span class="hs-identifier hs-var">codeType</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679358422"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-842"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679358601"><span class="annot"><span class="annottext">toGOOLVal :: Maybe a -&gt; GenState (SValue r)
</span><a href="#local-6989586621679358601"><span class="hs-identifier hs-var hs-var">toGOOLVal</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UID -&gt; Name -&gt; VSType r -&gt; GenState (SValue r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
UID -&gt; Name -&gt; VSType r -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#valueProc"><span class="hs-identifier hs-var">valueProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679358422"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Input -&gt; Getting UID Input UID -&gt; UID
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting UID Input UID
forall c. HasUID c =&gt; Getter c UID
Getter Input UID
</span><span class="hs-identifier hs-var">uid</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input -&gt; Name
forall c. CodeIdea c =&gt; c -&gt; Name
</span><span class="hs-identifier hs-var">codeName</span></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679358422"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeType -&gt; VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; CodeType -&gt; VSType r
</span><span class="hs-identifier hs-var">convType</span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679358423"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-843"></span><span>      </span><span class="annot"><a href="#local-6989586621679358601"><span class="hs-identifier hs-var">toGOOLVal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; GenState (SValue r)
forall a. HasCallStack =&gt; Name -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;mkValProc: Procedural renderers do not support objects&quot;</span></span><span>
</span><span id="line-844"></span><span>  </span><span class="annot"><span class="annottext">Maybe CodeChunk -&gt; GenState (SValue r)
forall {r :: * -&gt; *} {a}.
SharedProg r =&gt;
Maybe a -&gt; GenState (SValue r)
</span><a href="#local-6989586621679358601"><span class="hs-identifier hs-var">toGOOLVal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679358422"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Input
-&gt; Getting (Maybe CodeChunk) Input (Maybe CodeChunk)
-&gt; Maybe CodeChunk
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting (Maybe CodeChunk) Input (Maybe CodeChunk)
Lens' Input (Maybe CodeChunk)
</span><span class="hs-identifier hs-var">obv</span></span><span class="hs-special">)</span><span>
</span><span id="line-845"></span><span>
</span><span id="line-846"></span><span class="annot"><span class="hs-comment">-- | Generates a GOOL Variable for a variable represented by a 'CodeVarChunk'.</span></span><span>
</span><span id="line-847"></span><span id="local-6989586621679353971"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#mkVarProc"><span class="hs-identifier hs-type">mkVarProc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353971"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CodeVarChunk</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SVariable</span></span><span> </span><span class="annot"><a href="#local-6989586621679353971"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-848"></span><span id="mkVarProc"><span class="annot"><span class="annottext">mkVarProc :: forall (r :: * -&gt; *).
SharedProg r =&gt;
Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVarProc"><span class="hs-identifier hs-var hs-var">mkVarProc</span></a></span></span><span> </span><span id="local-6989586621679358607"><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679358607"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-849"></span><span>  </span><span id="local-6989586621679358608"><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679358608"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input -&gt; GenState CodeType
forall c. HasSpace c =&gt; c -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#codeType"><span class="hs-identifier hs-var">codeType</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679358607"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-850"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679358780"><span class="annot"><span class="annottext">toGOOLVar :: Maybe a -&gt; GenState (SVariable r)
</span><a href="#local-6989586621679358780"><span class="hs-identifier hs-var hs-var">toGOOLVar</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; VSType r -&gt; GenState (SVariable r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
Name -&gt; VSType r -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#variableProc"><span class="hs-identifier hs-var">variableProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input -&gt; Name
forall c. CodeIdea c =&gt; c -&gt; Name
</span><span class="hs-identifier hs-var">codeName</span></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679358607"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeType -&gt; VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; CodeType -&gt; VSType r
</span><span class="hs-identifier hs-var">convType</span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679358608"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-851"></span><span>      </span><span class="annot"><a href="#local-6989586621679358780"><span class="hs-identifier hs-var">toGOOLVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; GenState (SVariable r)
forall a. HasCallStack =&gt; Name -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;mkVarProc: Procedural renderers do not support objects&quot;</span></span><span>
</span><span id="line-852"></span><span>  </span><span class="annot"><span class="annottext">Maybe CodeChunk -&gt; GenState (SVariable r)
forall {r :: * -&gt; *} {a}.
SharedProg r =&gt;
Maybe a -&gt; GenState (SVariable r)
</span><a href="#local-6989586621679358780"><span class="hs-identifier hs-var">toGOOLVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679358607"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Input
-&gt; Getting (Maybe CodeChunk) Input (Maybe CodeChunk)
-&gt; Maybe CodeChunk
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting (Maybe CodeChunk) Input (Maybe CodeChunk)
Lens' Input (Maybe CodeChunk)
</span><span class="hs-identifier hs-var">obv</span></span><span class="hs-special">)</span><span>
</span><span id="line-853"></span><span>
</span><span id="line-854"></span><span class="annot"><span class="hs-comment">-- | Converts a 'Mod' to GOOL.</span></span><span>
</span><span id="line-855"></span><span id="local-6989586621679353975"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#genModDefProc"><span class="hs-identifier hs-type">genModDefProc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ProcProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353975"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Mod"><span class="hs-identifier hs-type">Mod</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Proc.SFile</span></span><span> </span><span class="annot"><a href="#local-6989586621679353975"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-856"></span><span id="genModDefProc"><span class="annot"><span class="annottext">genModDefProc :: forall (r :: * -&gt; *). ProcProg r =&gt; Mod -&gt; GenState (SFile r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genModDefProc"><span class="hs-identifier hs-var hs-var">genModDefProc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#Mod"><span class="hs-identifier hs-type">Mod</span></a></span><span> </span><span id="local-6989586621679358791"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679358791"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679358792"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679358792"><span class="hs-identifier hs-var">desc</span></a></span></span><span> </span><span id="local-6989586621679358793"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679358793"><span class="hs-identifier hs-var">is</span></a></span></span><span> </span><span id="local-6989586621679358794"><span class="annot"><span class="annottext">[Class]
</span><a href="#local-6989586621679358794"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span id="local-6989586621679358795"><span class="annot"><span class="annottext">[Func]
</span><a href="#local-6989586621679358795"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Class]
</span><a href="#local-6989586621679358794"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-857"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; Name
-&gt; [Name]
-&gt; [GenState (Maybe (SMethod r))]
-&gt; GenState (SFile r)
forall (r :: * -&gt; *).
ProcProg r =&gt;
Name
-&gt; Name
-&gt; [Name]
-&gt; [GenState (Maybe (SMethod r))]
-&gt; GenState (SFile r)
</span><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html#genModuleWithImportsProc"><span class="hs-identifier hs-var">genModuleWithImportsProc</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679358791"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679358792"><span class="hs-identifier hs-var">desc</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679358793"><span class="hs-identifier hs-var">is</span></a></span><span>
</span><span id="line-858"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Func -&gt; GenState (Maybe (SMethod r)))
-&gt; [Func] -&gt; [GenState (Maybe (SMethod r))]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(SMethod r -&gt; Maybe (SMethod r))
-&gt; StateT DrasilState Identity (SMethod r)
-&gt; GenState (Maybe (SMethod r))
forall a b.
(a -&gt; b)
-&gt; StateT DrasilState Identity a -&gt; StateT DrasilState Identity b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">SMethod r -&gt; Maybe (SMethod r)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(StateT DrasilState Identity (SMethod r)
 -&gt; GenState (Maybe (SMethod r)))
-&gt; (Func -&gt; StateT DrasilState Identity (SMethod r))
-&gt; Func
-&gt; GenState (Maybe (SMethod r))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Name
 -&gt; VSType r
 -&gt; Name
 -&gt; [ParameterChunk]
 -&gt; Maybe Name
 -&gt; [MSBlock r]
 -&gt; StateT DrasilState Identity (SMethod r))
-&gt; [StateVariable]
-&gt; Func
-&gt; StateT DrasilState Identity (SMethod r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
(Name
 -&gt; VSType r
 -&gt; Name
 -&gt; [ParameterChunk]
 -&gt; Maybe Name
 -&gt; [MSBlock r]
 -&gt; GenState (SMethod r))
-&gt; [StateVariable] -&gt; Func -&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genFuncProc"><span class="hs-identifier hs-var">genFuncProc</span></a></span><span> </span><span class="annot"><span class="annottext">Name
-&gt; VSType r
-&gt; Name
-&gt; [ParameterChunk]
-&gt; Maybe Name
-&gt; [MSBlock r]
-&gt; StateT DrasilState Identity (SMethod r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
Name
-&gt; VSType r
-&gt; Name
-&gt; [ParameterChunk]
-&gt; Maybe Name
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#publicFuncProc"><span class="hs-identifier hs-var">publicFuncProc</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Func]
</span><a href="#local-6989586621679358795"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-859"></span><span>  </span><span class="annot"><span class="annottext">[Class]
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; GenState (SFile r)
forall a. HasCallStack =&gt; Name -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;genModDefProc: Procedural renderers do not support classes&quot;</span></span><span>
</span><span id="line-860"></span><span>
</span><span id="line-861"></span><span class="annot"><span class="hs-comment">-- | Generates a GOOL Parameter for a parameter represented by a 'ParameterChunk'.</span></span><span>
</span><span id="line-862"></span><span id="local-6989586621679353983"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#mkParamProc"><span class="hs-identifier hs-type">mkParamProc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353983"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Chunk.Parameter.html#ParameterChunk"><span class="hs-identifier hs-type">ParameterChunk</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MSParameter</span></span><span> </span><span class="annot"><a href="#local-6989586621679353983"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-863"></span><span id="mkParamProc"><span class="annot"><span class="annottext">mkParamProc :: forall (r :: * -&gt; *).
SharedProg r =&gt;
ParameterChunk -&gt; GenState (MSParameter r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkParamProc"><span class="hs-identifier hs-var hs-var">mkParamProc</span></a></span></span><span> </span><span id="local-6989586621679358811"><span class="annot"><span class="annottext">ParameterChunk
</span><a href="#local-6989586621679358811"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-864"></span><span>  </span><span id="local-6989586621679358812"><span class="annot"><span class="annottext">VS (r (Variable r))
</span><a href="#local-6989586621679358812"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input -&gt; StateT DrasilState Identity (VS (r (Variable r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVarProc"><span class="hs-identifier hs-var">mkVarProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParameterChunk -&gt; Input
forall c. (Quantity c, MayHaveUnit c, Concept c) =&gt; c -&gt; Input
</span><a href="Language.Drasil.Chunk.CodeBase.html#quantvar"><span class="hs-identifier hs-var">quantvar</span></a></span><span> </span><span class="annot"><span class="annottext">ParameterChunk
</span><a href="#local-6989586621679358811"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-865"></span><span>  </span><span class="annot"><span class="annottext">MSParameter r -&gt; GenState (MSParameter r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSParameter r -&gt; GenState (MSParameter r))
-&gt; MSParameter r -&gt; GenState (MSParameter r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PassBy -&gt; VS (r (Variable r)) -&gt; MSParameter r
forall {r :: * -&gt; *}.
ParameterSym r =&gt;
PassBy -&gt; VS (r (Variable r)) -&gt; MS (r (Parameter r))
</span><a href="#local-6989586621679358813"><span class="hs-identifier hs-var">paramFunc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParameterChunk -&gt; PassBy
</span><a href="Language.Drasil.Chunk.Parameter.html#passBy"><span class="hs-identifier hs-var">passBy</span></a></span><span> </span><span class="annot"><span class="annottext">ParameterChunk
</span><a href="#local-6989586621679358811"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
</span><a href="#local-6989586621679358812"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-866"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679358813"><span class="annot"><span class="annottext">paramFunc :: PassBy -&gt; SVariable r -&gt; MSParameter r
</span><a href="#local-6989586621679358813"><span class="hs-identifier hs-var hs-var">paramFunc</span></a></span></span><span> </span><span class="annot"><span class="annottext">PassBy
</span><a href="Language.Drasil.Chunk.Parameter.html#Ref"><span class="hs-identifier hs-var">Ref</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SVariable r -&gt; MSParameter r
forall (r :: * -&gt; *).
ParameterSym r =&gt;
SVariable r -&gt; MSParameter r
</span><span class="hs-identifier hs-var">pointerParam</span></span><span>
</span><span id="line-867"></span><span>        </span><span class="annot"><a href="#local-6989586621679358813"><span class="hs-identifier hs-var">paramFunc</span></a></span><span> </span><span class="annot"><span class="annottext">PassBy
</span><a href="Language.Drasil.Chunk.Parameter.html#Val"><span class="hs-identifier hs-var">Val</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SVariable r -&gt; MSParameter r
forall (r :: * -&gt; *).
ParameterSym r =&gt;
SVariable r -&gt; MSParameter r
</span><span class="hs-identifier hs-var">param</span></span><span>
</span><span id="line-868"></span><span>
</span><span id="line-869"></span><span class="annot"><span class="hs-comment">-- | Generates a public function.</span></span><span>
</span><span id="line-870"></span><span id="local-6989586621679353982"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#publicFuncProc"><span class="hs-identifier hs-type">publicFuncProc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353982"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Label</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VSType</span></span><span> </span><span class="annot"><a href="#local-6989586621679353982"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Description"><span class="hs-identifier hs-type">Description</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-871"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Chunk.Parameter.html#ParameterChunk"><span class="hs-identifier hs-type">ParameterChunk</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Description"><span class="hs-identifier hs-type">Description</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSBlock</span></span><span> </span><span class="annot"><a href="#local-6989586621679353982"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-872"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679353982"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-873"></span><span id="publicFuncProc"><span class="annot"><span class="annottext">publicFuncProc :: forall (r :: * -&gt; *).
SharedProg r =&gt;
Name
-&gt; VSType r
-&gt; Name
-&gt; [ParameterChunk]
-&gt; Maybe Name
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#publicFuncProc"><span class="hs-identifier hs-var hs-var">publicFuncProc</span></a></span></span><span> </span><span id="local-6989586621679358829"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679358829"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679358830"><span class="annot"><span class="annottext">VSType r
</span><a href="#local-6989586621679358830"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679358831"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679358831"><span class="hs-identifier hs-var">desc</span></a></span></span><span> </span><span id="local-6989586621679358832"><span class="annot"><span class="annottext">[ParameterChunk]
</span><a href="#local-6989586621679358832"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621679358833"><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621679358833"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679358834"><span class="annot"><span class="annottext">[MSBlock r]
</span><a href="#local-6989586621679358834"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-874"></span><span>  </span><span class="annot"><span class="annottext">(DrasilState -&gt; DrasilState) -&gt; StateT DrasilState Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679358835"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679358835"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679358835"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#currentScope"><span class="hs-identifier hs-var">currentScope</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#Local"><span class="hs-identifier hs-type">Local</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-875"></span><span>  </span><span class="annot"><span class="annottext">([MSParameter r] -&gt; MSBody r -&gt; SMethod r)
-&gt; Name
-&gt; Name
-&gt; [ParameterChunk]
-&gt; Maybe Name
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
([MSParameter r] -&gt; MSBody r -&gt; SMethod r)
-&gt; Name
-&gt; Name
-&gt; [ParameterChunk]
-&gt; Maybe Name
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genMethodProc"><span class="hs-identifier hs-var">genMethodProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
-&gt; r (Visibility r)
-&gt; VSType r
-&gt; [MSParameter r]
-&gt; MSBody r
-&gt; SMethod r
forall (r :: * -&gt; *).
MethodSym r =&gt;
Name
-&gt; r (Visibility r)
-&gt; VSType r
-&gt; [MSParameter r]
-&gt; MSBody r
-&gt; SMethod r
</span><span class="hs-identifier hs-var">function</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679358829"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">r (Visibility r)
forall (r :: * -&gt; *). VisibilitySym r =&gt; r (Visibility r)
</span><span class="hs-identifier hs-var">public</span></span><span> </span><span class="annot"><span class="annottext">VSType r
</span><a href="#local-6989586621679358830"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679358829"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679358831"><span class="hs-identifier hs-var">desc</span></a></span><span> </span><span class="annot"><span class="annottext">[ParameterChunk]
</span><a href="#local-6989586621679358832"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621679358833"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">[MSBlock r]
</span><a href="#local-6989586621679358834"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-876"></span><span>
</span><span id="line-877"></span><span class="annot"><span class="hs-comment">-- | Generates a private function.</span></span><span>
</span><span id="line-878"></span><span id="local-6989586621679358837"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#privateFuncProc"><span class="hs-identifier hs-type">privateFuncProc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679358837"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Label</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VSType</span></span><span> </span><span class="annot"><a href="#local-6989586621679358837"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Description"><span class="hs-identifier hs-type">Description</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-879"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Chunk.Parameter.html#ParameterChunk"><span class="hs-identifier hs-type">ParameterChunk</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Description"><span class="hs-identifier hs-type">Description</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSBlock</span></span><span> </span><span class="annot"><a href="#local-6989586621679358837"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-880"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679358837"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-881"></span><span id="privateFuncProc"><span class="annot"><span class="annottext">privateFuncProc :: forall (r :: * -&gt; *).
SharedProg r =&gt;
Name
-&gt; VSType r
-&gt; Name
-&gt; [ParameterChunk]
-&gt; Maybe Name
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#privateFuncProc"><span class="hs-identifier hs-var hs-var">privateFuncProc</span></a></span></span><span> </span><span id="local-6989586621679358846"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679358846"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679358847"><span class="annot"><span class="annottext">VSType r
</span><a href="#local-6989586621679358847"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679358848"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679358848"><span class="hs-identifier hs-var">desc</span></a></span></span><span> </span><span id="local-6989586621679358849"><span class="annot"><span class="annottext">[ParameterChunk]
</span><a href="#local-6989586621679358849"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621679358850"><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621679358850"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679358851"><span class="annot"><span class="annottext">[MSBlock r]
</span><a href="#local-6989586621679358851"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-882"></span><span>  </span><span class="annot"><span class="annottext">(DrasilState -&gt; DrasilState) -&gt; StateT DrasilState Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679358852"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679358852"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679358852"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#currentScope"><span class="hs-identifier hs-var">currentScope</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#Local"><span class="hs-identifier hs-type">Local</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-883"></span><span>  </span><span class="annot"><span class="annottext">([MSParameter r] -&gt; MSBody r -&gt; SMethod r)
-&gt; Name
-&gt; Name
-&gt; [ParameterChunk]
-&gt; Maybe Name
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
([MSParameter r] -&gt; MSBody r -&gt; SMethod r)
-&gt; Name
-&gt; Name
-&gt; [ParameterChunk]
-&gt; Maybe Name
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genMethodProc"><span class="hs-identifier hs-var">genMethodProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
-&gt; r (Visibility r)
-&gt; VSType r
-&gt; [MSParameter r]
-&gt; MSBody r
-&gt; SMethod r
forall (r :: * -&gt; *).
MethodSym r =&gt;
Name
-&gt; r (Visibility r)
-&gt; VSType r
-&gt; [MSParameter r]
-&gt; MSBody r
-&gt; SMethod r
</span><span class="hs-identifier hs-var">function</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679358846"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">r (Visibility r)
forall (r :: * -&gt; *). VisibilitySym r =&gt; r (Visibility r)
</span><span class="hs-identifier hs-var">private</span></span><span> </span><span class="annot"><span class="annottext">VSType r
</span><a href="#local-6989586621679358847"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679358846"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679358848"><span class="hs-identifier hs-var">desc</span></a></span><span> </span><span class="annot"><span class="annottext">[ParameterChunk]
</span><a href="#local-6989586621679358849"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621679358850"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">[MSBlock r]
</span><a href="#local-6989586621679358851"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-884"></span><span>
</span><span id="line-885"></span><span class="hs-comment">-- | Generates a function or method using the passed GOOL constructor. Other</span><span>
</span><span id="line-886"></span><span class="hs-comment">-- parameters are the method's name, description, list of parameters,</span><span>
</span><span id="line-887"></span><span class="hs-comment">-- description of what is returned (if applicable), and body.</span><span>
</span><span id="line-888"></span><span id="local-6989586621679353987"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#genMethodProc"><span class="hs-identifier hs-type">genMethodProc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353987"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSParameter</span></span><span> </span><span class="annot"><a href="#local-6989586621679353987"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MSBody</span></span><span> </span><span class="annot"><a href="#local-6989586621679353987"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679353987"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-889"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Label</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Description"><span class="hs-identifier hs-type">Description</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Chunk.Parameter.html#ParameterChunk"><span class="hs-identifier hs-type">ParameterChunk</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Description"><span class="hs-identifier hs-type">Description</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSBlock</span></span><span> </span><span class="annot"><a href="#local-6989586621679353987"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-890"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679353987"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-891"></span><span id="genMethodProc"><span class="annot"><span class="annottext">genMethodProc :: forall (r :: * -&gt; *).
SharedProg r =&gt;
([MSParameter r] -&gt; MSBody r -&gt; SMethod r)
-&gt; Name
-&gt; Name
-&gt; [ParameterChunk]
-&gt; Maybe Name
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genMethodProc"><span class="hs-identifier hs-var hs-var">genMethodProc</span></a></span></span><span> </span><span id="local-6989586621679358881"><span class="annot"><span class="annottext">[MSParameter r] -&gt; MSBody r -&gt; SMethod r
</span><a href="#local-6989586621679358881"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679358882"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679358882"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679358883"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679358883"><span class="hs-identifier hs-var">desc</span></a></span></span><span> </span><span id="local-6989586621679358884"><span class="annot"><span class="annottext">[ParameterChunk]
</span><a href="#local-6989586621679358884"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679358885"><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621679358885"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679358886"><span class="annot"><span class="annottext">[MSBlock r]
</span><a href="#local-6989586621679358886"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-892"></span><span>  </span><span id="local-6989586621679358887"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679358887"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-893"></span><span>  </span><span id="local-6989586621679358888"><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679358888"><span class="hs-identifier hs-var">vars</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ParameterChunk
 -&gt; StateT DrasilState Identity (VS (r (Variable r))))
-&gt; [ParameterChunk]
-&gt; StateT DrasilState Identity [VS (r (Variable r))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input -&gt; StateT DrasilState Identity (VS (r (Variable r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVarProc"><span class="hs-identifier hs-var">mkVarProc</span></a></span><span> </span><span class="annot"><span class="annottext">(Input -&gt; StateT DrasilState Identity (VS (r (Variable r))))
-&gt; (ParameterChunk -&gt; Input)
-&gt; ParameterChunk
-&gt; StateT DrasilState Identity (VS (r (Variable r)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ParameterChunk -&gt; Input
forall c. (Quantity c, MayHaveUnit c, Concept c) =&gt; c -&gt; Input
</span><a href="Language.Drasil.Chunk.CodeBase.html#quantvar"><span class="hs-identifier hs-var">quantvar</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ParameterChunk]
</span><a href="#local-6989586621679358884"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-894"></span><span>  </span><span id="local-6989586621679358889"><span class="annot"><span class="annottext">[MSParameter r]
</span><a href="#local-6989586621679358889"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ParameterChunk -&gt; StateT DrasilState Identity (MSParameter r))
-&gt; [ParameterChunk] -&gt; StateT DrasilState Identity [MSParameter r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">ParameterChunk -&gt; StateT DrasilState Identity (MSParameter r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
ParameterChunk -&gt; GenState (MSParameter r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkParamProc"><span class="hs-identifier hs-var">mkParamProc</span></a></span><span> </span><span class="annot"><span class="annottext">[ParameterChunk]
</span><a href="#local-6989586621679358884"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-895"></span><span>  </span><span id="local-6989586621679358890"><span class="annot"><span class="annottext">MSBody r
</span><a href="#local-6989586621679358890"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; [VS (r (Variable r))]
-&gt; [MSBlock r]
-&gt; StateT DrasilState Identity (MSBody r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
Name -&gt; [SVariable r] -&gt; [MSBlock r] -&gt; GenState (MSBody r)
</span><a href="Language.Drasil.Code.Imperative.Logging.html#logBody"><span class="hs-identifier hs-var">logBody</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679358882"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679358888"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="annot"><span class="annottext">[MSBlock r]
</span><a href="#local-6989586621679358886"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-896"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679358891"><span class="annot"><span class="annottext">fn :: SMethod r
</span><a href="#local-6989586621679358891"><span class="hs-identifier hs-var hs-var">fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[MSParameter r] -&gt; MSBody r -&gt; SMethod r
</span><a href="#local-6989586621679358881"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[MSParameter r]
</span><a href="#local-6989586621679358889"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">MSBody r
</span><a href="#local-6989586621679358890"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-897"></span><span>  </span><span id="local-6989586621679358892"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679358892"><span class="hs-identifier hs-var">pComms</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ParameterChunk -&gt; GenState Name)
-&gt; [ParameterChunk] -&gt; StateT DrasilState Identity [Name]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">ParameterChunk -&gt; GenState Name
forall c. CodeIdea c =&gt; c -&gt; GenState Name
</span><a href="Language.Drasil.Code.Imperative.Comments.html#getCommentBrief"><span class="hs-identifier hs-var">getCommentBrief</span></a></span><span> </span><span class="annot"><span class="annottext">[ParameterChunk]
</span><a href="#local-6989586621679358884"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-898"></span><span>  </span><span class="annot"><span class="annottext">SMethod r -&gt; GenState (SMethod r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SMethod r -&gt; GenState (SMethod r))
-&gt; SMethod r -&gt; GenState (SMethod r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Comments
</span><a href="Language.Drasil.Choices.html#CommentFunc"><span class="hs-identifier hs-var">CommentFunc</span></a></span><span> </span><span class="annot"><span class="annottext">Comments -&gt; [Comments] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; [Comments]
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#commented"><span class="hs-identifier hs-var">commented</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679358887"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-899"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Name] -&gt; Maybe Name -&gt; SMethod r -&gt; SMethod r
forall (r :: * -&gt; *).
MethodSym r =&gt;
Name -&gt; [Name] -&gt; Maybe Name -&gt; SMethod r -&gt; SMethod r
</span><span class="hs-identifier hs-var">docFunc</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679358883"><span class="hs-identifier hs-var">desc</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679358892"><span class="hs-identifier hs-var">pComms</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621679358885"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">SMethod r
</span><a href="#local-6989586621679358891"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">SMethod r
</span><a href="#local-6989586621679358891"><span class="hs-identifier hs-var">fn</span></a></span><span>
</span><span id="line-900"></span><span>
</span><span id="line-901"></span><span class="hs-comment">-- | Converts a 'Func' (from the Mod AST) to GOOL.</span><span>
</span><span id="line-902"></span><span class="hs-comment">-- The function generator to use is passed as a parameter. Automatically adds</span><span>
</span><span id="line-903"></span><span class="hs-comment">-- variable declaration statements for any undeclared variables. For methods,</span><span>
</span><span id="line-904"></span><span class="hs-comment">-- the list of StateVariables is needed so they can be included in the list of</span><span>
</span><span id="line-905"></span><span class="hs-comment">-- declared variables.</span><span>
</span><span id="line-906"></span><span id="local-6989586621679353981"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#genFuncProc"><span class="hs-identifier hs-type">genFuncProc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353981"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VSType</span></span><span> </span><span class="annot"><a href="#local-6989586621679353981"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Description"><span class="hs-identifier hs-type">Description</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Chunk.Parameter.html#ParameterChunk"><span class="hs-identifier hs-type">ParameterChunk</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-907"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Description"><span class="hs-identifier hs-type">Description</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSBlock</span></span><span> </span><span class="annot"><a href="#local-6989586621679353981"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679353981"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-908"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Mod.html#StateVariable"><span class="hs-identifier hs-type">StateVariable</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Func"><span class="hs-identifier hs-type">Func</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679353981"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-909"></span><span id="genFuncProc"><span class="annot"><span class="annottext">genFuncProc :: forall (r :: * -&gt; *).
SharedProg r =&gt;
(Name
 -&gt; VSType r
 -&gt; Name
 -&gt; [ParameterChunk]
 -&gt; Maybe Name
 -&gt; [MSBlock r]
 -&gt; GenState (SMethod r))
-&gt; [StateVariable] -&gt; Func -&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genFuncProc"><span class="hs-identifier hs-var hs-var">genFuncProc</span></a></span></span><span> </span><span id="local-6989586621679358931"><span class="annot"><span class="annottext">Name
-&gt; VSType r
-&gt; Name
-&gt; [ParameterChunk]
-&gt; Maybe Name
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="#local-6989586621679358931"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679358932"><span class="annot"><span class="annottext">[StateVariable]
</span><a href="#local-6989586621679358932"><span class="hs-identifier hs-var">svs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FDef"><span class="hs-identifier hs-type">FDef</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FuncDef"><span class="hs-identifier hs-type">FuncDef</span></a></span><span> </span><span id="local-6989586621679358933"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679358933"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679358934"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679358934"><span class="hs-identifier hs-var">desc</span></a></span></span><span> </span><span id="local-6989586621679358935"><span class="annot"><span class="annottext">[ParameterChunk]
</span><a href="#local-6989586621679358935"><span class="hs-identifier hs-var">parms</span></a></span></span><span> </span><span id="local-6989586621679358936"><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621679358936"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679358937"><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621679358937"><span class="hs-identifier hs-var">rd</span></a></span></span><span> </span><span id="local-6989586621679358938"><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679358938"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-910"></span><span>  </span><span id="local-6989586621679358939"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679358939"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-911"></span><span>  </span><span class="annot"><span class="annottext">(DrasilState -&gt; DrasilState) -&gt; StateT DrasilState Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679358940"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679358940"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679358940"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#currentScope"><span class="hs-identifier hs-var">currentScope</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#Local"><span class="hs-identifier hs-type">Local</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-912"></span><span>  </span><span id="local-6989586621679358941"><span class="annot"><span class="annottext">[MS (r (Statement r))]
</span><a href="#local-6989586621679358941"><span class="hs-identifier hs-var">stmts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FuncStmt -&gt; StateT DrasilState Identity (MS (r (Statement r))))
-&gt; [FuncStmt] -&gt; StateT DrasilState Identity [MS (r (Statement r))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">FuncStmt -&gt; StateT DrasilState Identity (MS (r (Statement r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
FuncStmt -&gt; GenState (MSStatement r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convStmtProc"><span class="hs-identifier hs-var">convStmtProc</span></a></span><span> </span><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679358938"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-913"></span><span>  </span><span id="local-6989586621679358942"><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679358942"><span class="hs-identifier hs-var">vars</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Input -&gt; StateT DrasilState Identity (VS (r (Variable r))))
-&gt; [Input] -&gt; StateT DrasilState Identity [VS (r (Variable r))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Input -&gt; StateT DrasilState Identity (VS (r (Variable r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVarProc"><span class="hs-identifier hs-var">mkVarProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB -&gt; [FuncStmt] -&gt; [Input]
</span><a href="Language.Drasil.Mod.html#fstdecl"><span class="hs-identifier hs-var">fstdecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; CodeSpec
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#codeSpec"><span class="hs-identifier hs-var">codeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679358939"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">CodeSpec -&gt; Getting ChunkDB CodeSpec ChunkDB -&gt; ChunkDB
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting ChunkDB CodeSpec ChunkDB
forall c. HasOldCodeSpec c =&gt; Lens' c ChunkDB
Lens' CodeSpec ChunkDB
</span><a href="Language.Drasil.CodeSpec.html#systemdbO"><span class="hs-identifier hs-var">systemdbO</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679358938"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-914"></span><span>    </span><span class="annot"><span class="annottext">[Input] -&gt; [Input] -&gt; [Input]
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">\\</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ParameterChunk -&gt; Input) -&gt; [ParameterChunk] -&gt; [Input]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">ParameterChunk -&gt; Input
forall c. (Quantity c, MayHaveUnit c, Concept c) =&gt; c -&gt; Input
</span><a href="Language.Drasil.Chunk.CodeBase.html#quantvar"><span class="hs-identifier hs-var">quantvar</span></a></span><span> </span><span class="annot"><span class="annottext">[ParameterChunk]
</span><a href="#local-6989586621679358935"><span class="hs-identifier hs-var">parms</span></a></span><span> </span><span class="annot"><span class="annottext">[Input] -&gt; [Input] -&gt; [Input]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">(StateVariable -&gt; Input) -&gt; [StateVariable] -&gt; [Input]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">StateVariable -&gt; Input
</span><a href="Language.Drasil.Mod.html#stVar"><span class="hs-identifier hs-var">stVar</span></a></span><span> </span><span class="annot"><span class="annottext">[StateVariable]
</span><a href="#local-6989586621679358932"><span class="hs-identifier hs-var">svs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-915"></span><span>  </span><span id="local-6989586621679358943"><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679358943"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Space -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#spaceCodeType"><span class="hs-identifier hs-var">spaceCodeType</span></a></span><span> </span><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621679358936"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-916"></span><span>  </span><span class="annot"><span class="annottext">Name
-&gt; VSType r
-&gt; Name
-&gt; [ParameterChunk]
-&gt; Maybe Name
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="#local-6989586621679358931"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679358933"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeType -&gt; VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; CodeType -&gt; VSType r
</span><span class="hs-identifier hs-var">convType</span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679358943"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679358934"><span class="hs-identifier hs-var">desc</span></a></span><span> </span><span class="annot"><span class="annottext">[ParameterChunk]
</span><a href="#local-6989586621679358935"><span class="hs-identifier hs-var">parms</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621679358937"><span class="hs-identifier hs-var">rd</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[MS (r (Statement r))] -&gt; MSBlock r
forall (r :: * -&gt; *). BlockSym r =&gt; [MSStatement r] -&gt; MSBlock r
</span><span class="hs-identifier hs-var">block</span></span><span> </span><span class="annot"><span class="annottext">([MS (r (Statement r))] -&gt; MSBlock r)
-&gt; [MS (r (Statement r))] -&gt; MSBlock r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(VS (r (Variable r)) -&gt; MS (r (Statement r)))
-&gt; [VS (r (Variable r))] -&gt; [MS (r (Statement r))]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VS (r (Variable r)) -&gt; r (Scope r) -&gt; MS (r (Statement r))
forall (r :: * -&gt; *).
DeclStatement r =&gt;
SVariable r -&gt; r (Scope r) -&gt; MSStatement r
</span><span class="hs-operator hs-var">`varDec`</span></span><span> </span><span class="annot"><span class="annottext">r (Scope r)
forall (r :: * -&gt; *). ScopeSym r =&gt; r (Scope r)
</span><span class="hs-identifier hs-var">local</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679358942"><span class="hs-identifier hs-var">vars</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[MS (r (Statement r))] -&gt; MSBlock r
forall (r :: * -&gt; *). BlockSym r =&gt; [MSStatement r] -&gt; MSBlock r
</span><span class="hs-identifier hs-var">block</span></span><span> </span><span class="annot"><span class="annottext">[MS (r (Statement r))]
</span><a href="#local-6989586621679358941"><span class="hs-identifier hs-var">stmts</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-917"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#genFuncProc"><span class="hs-identifier hs-var">genFuncProc</span></a></span><span> </span><span class="annot"><span class="annottext">Name
-&gt; VSType r
-&gt; Name
-&gt; [ParameterChunk]
-&gt; Maybe Name
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[StateVariable]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FDef"><span class="hs-identifier hs-type">FDef</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#CtorDef"><span class="hs-identifier hs-type">CtorDef</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; GenState (SMethod r)
forall a. HasCallStack =&gt; Name -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;genFuncProc: Procedural renderers do not support constructors&quot;</span></span><span>
</span><span id="line-918"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#genFuncProc"><span class="hs-identifier hs-var">genFuncProc</span></a></span><span> </span><span class="annot"><span class="annottext">Name
-&gt; VSType r
-&gt; Name
-&gt; [ParameterChunk]
-&gt; Maybe Name
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[StateVariable]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FData"><span class="hs-identifier hs-type">FData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FuncData"><span class="hs-identifier hs-type">FuncData</span></a></span><span> </span><span id="local-6989586621679358944"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679358944"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679358945"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679358945"><span class="hs-identifier hs-var">desc</span></a></span></span><span> </span><span id="local-6989586621679358946"><span class="annot"><span class="annottext">DataDesc
</span><a href="#local-6989586621679358946"><span class="hs-identifier hs-var">ddef</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; DataDesc -&gt; GenState (SMethod r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
Name -&gt; Name -&gt; DataDesc -&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genDataFuncProc"><span class="hs-identifier hs-var">genDataFuncProc</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679358944"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679358945"><span class="hs-identifier hs-var">desc</span></a></span><span> </span><span class="annot"><span class="annottext">DataDesc
</span><a href="#local-6989586621679358946"><span class="hs-identifier hs-var">ddef</span></a></span><span>
</span><span id="line-919"></span><span>
</span><span id="line-920"></span><span class="annot"><span class="hs-comment">-- | Converts a 'Mod'\'s functions to GOOL.</span></span><span>
</span><span id="line-921"></span><span id="local-6989586621679353993"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#genModFuncsProc"><span class="hs-identifier hs-type">genModFuncsProc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353993"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Mod"><span class="hs-identifier hs-type">Mod</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679353993"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-922"></span><span id="genModFuncsProc"><span class="annot"><span class="annottext">genModFuncsProc :: forall (r :: * -&gt; *). SharedProg r =&gt; Mod -&gt; [GenState (SMethod r)]
</span><a href="Language.Drasil.Code.Imperative.Import.html#genModFuncsProc"><span class="hs-identifier hs-var hs-var">genModFuncsProc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#Mod"><span class="hs-identifier hs-type">Mod</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Class]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679358951"><span class="annot"><span class="annottext">[Func]
</span><a href="#local-6989586621679358951"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Func -&gt; GenState (MS (r (Method r))))
-&gt; [Func] -&gt; [GenState (MS (r (Method r)))]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name
 -&gt; VSType r
 -&gt; Name
 -&gt; [ParameterChunk]
 -&gt; Maybe Name
 -&gt; [MSBlock r]
 -&gt; GenState (MS (r (Method r))))
-&gt; [StateVariable] -&gt; Func -&gt; GenState (MS (r (Method r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
(Name
 -&gt; VSType r
 -&gt; Name
 -&gt; [ParameterChunk]
 -&gt; Maybe Name
 -&gt; [MSBlock r]
 -&gt; GenState (SMethod r))
-&gt; [StateVariable] -&gt; Func -&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genFuncProc"><span class="hs-identifier hs-var">genFuncProc</span></a></span><span> </span><span class="annot"><span class="annottext">Name
-&gt; VSType r
-&gt; Name
-&gt; [ParameterChunk]
-&gt; Maybe Name
-&gt; [MSBlock r]
-&gt; GenState (MS (r (Method r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
Name
-&gt; VSType r
-&gt; Name
-&gt; [ParameterChunk]
-&gt; Maybe Name
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#publicFuncProc"><span class="hs-identifier hs-var">publicFuncProc</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Func]
</span><a href="#local-6989586621679358951"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-923"></span><span>
</span><span id="line-924"></span><span class="hs-comment">-- this is really ugly!!</span><span>
</span><span id="line-925"></span><span class="annot"><span class="hs-comment">-- | Read from a data description into a 'MSBlock' of 'MSStatement's.</span></span><span>
</span><span id="line-926"></span><span id="local-6989586621679353995"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#readDataProc"><span class="hs-identifier hs-type">readDataProc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353995"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#DataDesc"><span class="hs-identifier hs-type">DataDesc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSBlock</span></span><span> </span><span class="annot"><a href="#local-6989586621679353995"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-927"></span><span id="readDataProc"><span class="annot"><span class="annottext">readDataProc :: forall (r :: * -&gt; *).
SharedProg r =&gt;
DataDesc -&gt; GenState [MSBlock r]
</span><a href="Language.Drasil.Code.Imperative.Import.html#readDataProc"><span class="hs-identifier hs-var hs-var">readDataProc</span></a></span></span><span> </span><span id="local-6989586621679359022"><span class="annot"><span class="annottext">DataDesc
</span><a href="#local-6989586621679359022"><span class="hs-identifier hs-var">ddef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-928"></span><span>  </span><span id="local-6989586621679359023"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679359023"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-929"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359152"><span class="annot"><span class="annottext">localScope :: r (Scope r)
</span><a href="#local-6989586621679359152"><span class="hs-identifier hs-var hs-var">localScope</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScopeType -&gt; r (Scope r)
forall (r :: * -&gt; *). SharedProg r =&gt; ScopeType -&gt; r (Scope r)
</span><a href="Language.Drasil.Code.Imperative.Helpers.html#convScope"><span class="hs-identifier hs-var">convScope</span></a></span><span> </span><span class="annot"><span class="annottext">(ScopeType -&gt; r (Scope r)) -&gt; ScopeType -&gt; r (Scope r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; ScopeType
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#currentScope"><span class="hs-identifier hs-var">currentScope</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679359023"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-930"></span><span>  </span><span id="local-6989586621679359153"><span class="annot"><span class="annottext">[[MS (r (Statement r))]]
</span><a href="#local-6989586621679359153"><span class="hs-identifier hs-var">inD</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Data -&gt; StateT DrasilState Identity [MS (r (Statement r))])
-&gt; DataDesc -&gt; StateT DrasilState Identity [[MS (r (Statement r))]]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Data
-&gt; r (Scope r)
-&gt; StateT DrasilState Identity [MS (r (Statement r))]
forall (r :: * -&gt; *).
SharedProg r =&gt;
Data -&gt; r (Scope r) -&gt; GenState [MSStatement r]
</span><a href="#local-6989586621679359154"><span class="hs-operator hs-var">`inData`</span></a></span><span> </span><span class="annot"><span class="annottext">r (Scope r)
</span><a href="#local-6989586621679359152"><span class="hs-identifier hs-var">localScope</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DataDesc
</span><a href="#local-6989586621679359022"><span class="hs-identifier hs-var">ddef</span></a></span><span>
</span><span id="line-931"></span><span>  </span><span id="local-6989586621679359155"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679359155"><span class="hs-identifier hs-var">v_filename</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *). SharedProg r =&gt; Input -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkValProc"><span class="hs-identifier hs-var">mkValProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DefinedQuantityDict -&gt; Input
forall c. (Quantity c, MayHaveUnit c, Concept c) =&gt; c -&gt; Input
</span><a href="Language.Drasil.Chunk.CodeBase.html#quantvar"><span class="hs-identifier hs-var">quantvar</span></a></span><span> </span><span class="annot"><span class="annottext">DefinedQuantityDict
</span><a href="Language.Drasil.Code.CodeQuantityDicts.html#inFileName"><span class="hs-identifier hs-var">inFileName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-932"></span><span>  </span><span class="annot"><span class="annottext">[MSBlock r] -&gt; GenState [MSBlock r]
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[MS (r (Statement r))] -&gt; MSBlock r
forall (r :: * -&gt; *). BlockSym r =&gt; [MSStatement r] -&gt; MSBlock r
</span><span class="hs-identifier hs-var">block</span></span><span> </span><span class="annot"><span class="annottext">([MS (r (Statement r))] -&gt; MSBlock r)
-&gt; [MS (r (Statement r))] -&gt; MSBlock r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-933"></span><span>    </span><span class="annot"><span class="annottext">SVariable r -&gt; r (Scope r) -&gt; MS (r (Statement r))
forall (r :: * -&gt; *).
DeclStatement r =&gt;
SVariable r -&gt; r (Scope r) -&gt; MSStatement r
</span><span class="hs-identifier hs-var">varDec</span></span><span> </span><span class="annot"><span class="annottext">SVariable r
forall (r :: * -&gt; *). SharedProg r =&gt; SVariable r
</span><a href="Language.Drasil.Code.Imperative.Import.html#var_infile"><span class="hs-identifier hs-var">var_infile</span></a></span><span> </span><span class="annot"><span class="annottext">r (Scope r)
</span><a href="#local-6989586621679359152"><span class="hs-identifier hs-var">localScope</span></a></span><span> </span><span class="annot"><span class="annottext">MS (r (Statement r))
-&gt; [MS (r (Statement r))] -&gt; [MS (r (Statement r))]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span>
</span><span id="line-934"></span><span>    </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">(Data -&gt; Bool) -&gt; DataDesc -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679359156"><span class="annot"><span class="annottext">Data
</span><a href="#local-6989586621679359156"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Data -&gt; Bool
</span><a href="Language.Drasil.Code.DataDesc.html#isLine"><span class="hs-identifier hs-var">isLine</span></a></span><span> </span><span class="annot"><span class="annottext">Data
</span><a href="#local-6989586621679359156"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Data -&gt; Bool
</span><a href="Language.Drasil.Code.DataDesc.html#isLines"><span class="hs-identifier hs-var">isLines</span></a></span><span> </span><span class="annot"><span class="annottext">Data
</span><a href="#local-6989586621679359156"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DataDesc
</span><a href="#local-6989586621679359022"><span class="hs-identifier hs-var">ddef</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SVariable r -&gt; r (Scope r) -&gt; MS (r (Statement r))
forall (r :: * -&gt; *).
DeclStatement r =&gt;
SVariable r -&gt; r (Scope r) -&gt; MSStatement r
</span><span class="hs-identifier hs-var">varDec</span></span><span> </span><span class="annot"><span class="annottext">SVariable r
forall (r :: * -&gt; *). SharedProg r =&gt; SVariable r
</span><a href="Language.Drasil.Code.Imperative.Import.html#var_line"><span class="hs-identifier hs-var">var_line</span></a></span><span> </span><span class="annot"><span class="annottext">r (Scope r)
</span><a href="#local-6989586621679359152"><span class="hs-identifier hs-var">localScope</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-935"></span><span>    </span><span class="annot"><span class="annottext">Integer -&gt; SVariable r -&gt; r (Scope r) -&gt; MS (r (Statement r))
forall (r :: * -&gt; *).
DeclStatement r =&gt;
Integer -&gt; SVariable r -&gt; r (Scope r) -&gt; MSStatement r
</span><span class="hs-identifier hs-var">listDec</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">SVariable r
forall (r :: * -&gt; *). SharedProg r =&gt; SVariable r
</span><a href="Language.Drasil.Code.Imperative.Import.html#var_linetokens"><span class="hs-identifier hs-var">var_linetokens</span></a></span><span> </span><span class="annot"><span class="annottext">r (Scope r)
</span><a href="#local-6989586621679359152"><span class="hs-identifier hs-var">localScope</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[MS (r (Statement r))]
-&gt; [MS (r (Statement r))] -&gt; [MS (r (Statement r))]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-936"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer -&gt; SVariable r -&gt; r (Scope r) -&gt; MS (r (Statement r))
forall (r :: * -&gt; *).
DeclStatement r =&gt;
Integer -&gt; SVariable r -&gt; r (Scope r) -&gt; MSStatement r
</span><span class="hs-identifier hs-var">listDec</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">SVariable r
forall (r :: * -&gt; *). SharedProg r =&gt; SVariable r
</span><a href="Language.Drasil.Code.Imperative.Import.html#var_lines"><span class="hs-identifier hs-var">var_lines</span></a></span><span> </span><span class="annot"><span class="annottext">r (Scope r)
</span><a href="#local-6989586621679359152"><span class="hs-identifier hs-var">localScope</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(Data -&gt; Bool) -&gt; DataDesc -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="annot"><span class="annottext">Data -&gt; Bool
</span><a href="Language.Drasil.Code.DataDesc.html#isLines"><span class="hs-identifier hs-var">isLines</span></a></span><span> </span><span class="annot"><span class="annottext">DataDesc
</span><a href="#local-6989586621679359022"><span class="hs-identifier hs-var">ddef</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[MS (r (Statement r))]
-&gt; [MS (r (Statement r))] -&gt; [MS (r (Statement r))]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">SVariable r -&gt; VS (r (Value r)) -&gt; MS (r (Statement r))
forall (r :: * -&gt; *).
IOStatement r =&gt;
SVariable r -&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">openFileR</span></span><span> </span><span class="annot"><span class="annottext">SVariable r
forall (r :: * -&gt; *). SharedProg r =&gt; SVariable r
</span><a href="Language.Drasil.Code.Imperative.Import.html#var_infile"><span class="hs-identifier hs-var">var_infile</span></a></span><span>
</span><span id="line-937"></span><span>    </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679359155"><span class="hs-identifier hs-var">v_filename</span></a></span><span> </span><span class="annot"><span class="annottext">MS (r (Statement r))
-&gt; [MS (r (Statement r))] -&gt; [MS (r (Statement r))]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[[MS (r (Statement r))]] -&gt; [MS (r (Statement r))]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">[[MS (r (Statement r))]]
</span><a href="#local-6989586621679359153"><span class="hs-identifier hs-var">inD</span></a></span><span> </span><span class="annot"><span class="annottext">[MS (r (Statement r))]
-&gt; [MS (r (Statement r))] -&gt; [MS (r (Statement r))]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">VS (r (Value r)) -&gt; MS (r (Statement r))
forall (r :: * -&gt; *). IOStatement r =&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">closeFile</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
forall (r :: * -&gt; *). SharedProg r =&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#v_infile"><span class="hs-identifier hs-var">v_infile</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-938"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679353997"><span class="annot"><a href="#local-6989586621679359154"><span class="hs-identifier hs-type">inData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353997"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#Data"><span class="hs-identifier hs-type">Data</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679353997"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Scope</span></span><span> </span><span class="annot"><a href="#local-6989586621679353997"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSStatement</span></span><span> </span><span class="annot"><a href="#local-6989586621679353997"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-939"></span><span>        </span><span id="local-6989586621679359154"><span class="annot"><span class="annottext">inData :: forall (r :: * -&gt; *).
SharedProg r =&gt;
Data -&gt; r (Scope r) -&gt; GenState [MSStatement r]
</span><a href="#local-6989586621679359154"><span class="hs-identifier hs-var hs-var">inData</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span id="local-6989586621679359223"><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679359223"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">r (Scope r)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-940"></span><span>            </span><span id="local-6989586621679359224"><span class="annot"><span class="annottext">VS (r (Variable r))
</span><a href="#local-6989586621679359224"><span class="hs-identifier hs-var">vv</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input -&gt; StateT DrasilState Identity (VS (r (Variable r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVarProc"><span class="hs-identifier hs-var">mkVarProc</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679359223"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-941"></span><span>            </span><span id="local-6989586621679359225"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679359225"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r)) -&gt; GenState [MSStatement r]
forall (r :: * -&gt; *).
SharedProg r =&gt;
SVariable r -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Logging.html#maybeLog"><span class="hs-identifier hs-var">maybeLog</span></a></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
</span><a href="#local-6989586621679359224"><span class="hs-identifier hs-var">vv</span></a></span><span>
</span><span id="line-942"></span><span>            </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; GenState [MSStatement r]
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSStatement r
forall (r :: * -&gt; *).
StatementSym r =&gt;
[MSStatement r] -&gt; MSStatement r
</span><span class="hs-identifier hs-var">multi</span></span><span> </span><span class="annot"><span class="annottext">([MSStatement r] -&gt; MSStatement r)
-&gt; [MSStatement r] -&gt; MSStatement r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; VS (r (Variable r)) -&gt; MSStatement r
forall (r :: * -&gt; *).
IOStatement r =&gt;
SValue r -&gt; SVariable r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">getFileInput</span></span><span> </span><span class="annot"><span class="annottext">SValue r
forall (r :: * -&gt; *). SharedProg r =&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#v_infile"><span class="hs-identifier hs-var">v_infile</span></a></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
</span><a href="#local-6989586621679359224"><span class="hs-identifier hs-var">vv</span></a></span><span> </span><span class="annot"><span class="annottext">MSStatement r -&gt; [MSStatement r] -&gt; [MSStatement r]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679359225"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-943"></span><span>        </span><span class="annot"><a href="#local-6989586621679359154"><span class="hs-identifier hs-var">inData</span></a></span><span> </span><span class="annot"><span class="annottext">Data
</span><a href="Language.Drasil.Code.DataDesc.html#JunkData"><span class="hs-identifier hs-var">JunkData</span></a></span><span> </span><span class="annot"><span class="annottext">r (Scope r)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; GenState [MSStatement r]
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SValue r -&gt; MSStatement r
forall (r :: * -&gt; *). IOStatement r =&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">discardFileLine</span></span><span> </span><span class="annot"><span class="annottext">SValue r
forall (r :: * -&gt; *). SharedProg r =&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#v_infile"><span class="hs-identifier hs-var">v_infile</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-944"></span><span>        </span><span class="annot"><a href="#local-6989586621679359154"><span class="hs-identifier hs-var">inData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#Line"><span class="hs-identifier hs-type">Line</span></a></span><span> </span><span id="local-6989586621679359226"><span class="annot"><span class="annottext">LinePattern
</span><a href="#local-6989586621679359226"><span class="hs-identifier hs-var">lp</span></a></span></span><span> </span><span id="local-6989586621679359227"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679359227"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679359228"><span class="annot"><span class="annottext">r (Scope r)
</span><a href="#local-6989586621679359228"><span class="hs-identifier hs-var">scp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-945"></span><span>          </span><span id="local-6989586621679359229"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679359229"><span class="hs-identifier hs-var">lnI</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe Name
-&gt; LinePattern -&gt; r (Scope r) -&gt; GenState [MSStatement r]
forall (r :: * -&gt; *).
SharedProg r =&gt;
Maybe Name
-&gt; LinePattern -&gt; r (Scope r) -&gt; GenState [MSStatement r]
</span><a href="#local-6989586621679359230"><span class="hs-identifier hs-var">lineData</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Name
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">LinePattern
</span><a href="#local-6989586621679359226"><span class="hs-identifier hs-var">lp</span></a></span><span> </span><span class="annot"><span class="annottext">r (Scope r)
</span><a href="#local-6989586621679359228"><span class="hs-identifier hs-var">scp</span></a></span><span>
</span><span id="line-946"></span><span>          </span><span id="local-6989586621679359231"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679359231"><span class="hs-identifier hs-var">logs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LinePattern -&gt; GenState [MSStatement r]
forall (r :: * -&gt; *).
SharedProg r =&gt;
LinePattern -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Import.html#getEntryVarLogsProc"><span class="hs-identifier hs-var">getEntryVarLogsProc</span></a></span><span> </span><span class="annot"><span class="annottext">LinePattern
</span><a href="#local-6989586621679359226"><span class="hs-identifier hs-var">lp</span></a></span><span>
</span><span id="line-947"></span><span>          </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; GenState [MSStatement r]
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([MSStatement r] -&gt; GenState [MSStatement r])
-&gt; [MSStatement r] -&gt; GenState [MSStatement r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SValue r -&gt; VS (r (Variable r)) -&gt; MSStatement r
forall (r :: * -&gt; *).
IOStatement r =&gt;
SValue r -&gt; SVariable r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">getFileInputLine</span></span><span> </span><span class="annot"><span class="annottext">SValue r
forall (r :: * -&gt; *). SharedProg r =&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#v_infile"><span class="hs-identifier hs-var">v_infile</span></a></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
forall (r :: * -&gt; *). SharedProg r =&gt; SVariable r
</span><a href="Language.Drasil.Code.Imperative.Import.html#var_line"><span class="hs-identifier hs-var">var_line</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-948"></span><span>            </span><span class="annot"><span class="annottext">Char -&gt; VS (r (Variable r)) -&gt; SValue r -&gt; MSStatement r
forall (r :: * -&gt; *).
StringStatement r =&gt;
Char -&gt; SVariable r -&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">stringSplit</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679359227"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
forall (r :: * -&gt; *). SharedProg r =&gt; SVariable r
</span><a href="Language.Drasil.Code.Imperative.Import.html#var_linetokens"><span class="hs-identifier hs-var">var_linetokens</span></a></span><span> </span><span class="annot"><span class="annottext">SValue r
forall (r :: * -&gt; *). SharedProg r =&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#v_line"><span class="hs-identifier hs-var">v_line</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; [MSStatement r] -&gt; [MSStatement r]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679359229"><span class="hs-identifier hs-var">lnI</span></a></span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; [MSStatement r] -&gt; [MSStatement r]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679359231"><span class="hs-identifier hs-var">logs</span></a></span><span>
</span><span id="line-949"></span><span>        </span><span class="annot"><a href="#local-6989586621679359154"><span class="hs-identifier hs-var">inData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#Lines"><span class="hs-identifier hs-type">Lines</span></a></span><span> </span><span id="local-6989586621679359233"><span class="annot"><span class="annottext">LinePattern
</span><a href="#local-6989586621679359233"><span class="hs-identifier hs-var">lp</span></a></span></span><span> </span><span id="local-6989586621679359234"><span class="annot"><span class="annottext">Maybe Integer
</span><a href="#local-6989586621679359234"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span id="local-6989586621679359235"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679359235"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679359236"><span class="annot"><span class="annottext">r (Scope r)
</span><a href="#local-6989586621679359236"><span class="hs-identifier hs-var">scp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-950"></span><span>          </span><span id="local-6989586621679359237"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679359237"><span class="hs-identifier hs-var">lnV</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe Name
-&gt; LinePattern -&gt; r (Scope r) -&gt; GenState [MSStatement r]
forall (r :: * -&gt; *).
SharedProg r =&gt;
Maybe Name
-&gt; LinePattern -&gt; r (Scope r) -&gt; GenState [MSStatement r]
</span><a href="#local-6989586621679359230"><span class="hs-identifier hs-var">lineData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Maybe Name
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;_temp&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LinePattern
</span><a href="#local-6989586621679359233"><span class="hs-identifier hs-var">lp</span></a></span><span> </span><span class="annot"><span class="annottext">r (Scope r)
</span><a href="#local-6989586621679359236"><span class="hs-identifier hs-var">scp</span></a></span><span>
</span><span id="line-951"></span><span>          </span><span id="local-6989586621679359238"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679359238"><span class="hs-identifier hs-var">logs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LinePattern -&gt; GenState [MSStatement r]
forall (r :: * -&gt; *).
SharedProg r =&gt;
LinePattern -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Import.html#getEntryVarLogsProc"><span class="hs-identifier hs-var">getEntryVarLogsProc</span></a></span><span> </span><span class="annot"><span class="annottext">LinePattern
</span><a href="#local-6989586621679359233"><span class="hs-identifier hs-var">lp</span></a></span><span>
</span><span id="line-952"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359418"><span class="annot"><span class="annottext">readLines :: Maybe Integer -&gt; [MSStatement r]
</span><a href="#local-6989586621679359418"><span class="hs-identifier hs-var hs-var">readLines</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe Integer
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SValue r -&gt; VS (r (Variable r)) -&gt; MSStatement r
forall (r :: * -&gt; *).
IOStatement r =&gt;
SValue r -&gt; SVariable r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">getFileInputAll</span></span><span> </span><span class="annot"><span class="annottext">SValue r
forall (r :: * -&gt; *). SharedProg r =&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#v_infile"><span class="hs-identifier hs-var">v_infile</span></a></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
forall (r :: * -&gt; *). SharedProg r =&gt; SVariable r
</span><a href="Language.Drasil.Code.Imperative.Import.html#var_lines"><span class="hs-identifier hs-var">var_lines</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-953"></span><span>                </span><span class="annot"><span class="annottext">VS (r (Variable r))
-&gt; SValue r -&gt; SValue r -&gt; SValue r -&gt; MSBody r -&gt; MSStatement r
forall (r :: * -&gt; *).
ControlStatement r =&gt;
SVariable r
-&gt; SValue r -&gt; SValue r -&gt; SValue r -&gt; MSBody r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">forRange</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
forall (r :: * -&gt; *). SharedProg r =&gt; SVariable r
</span><a href="Language.Drasil.Code.Imperative.Import.html#var_i"><span class="hs-identifier hs-var">var_i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; SValue r
forall (r :: * -&gt; *). Literal r =&gt; Integer -&gt; SValue r
</span><span class="hs-identifier hs-var">litInt</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SValue r -&gt; SValue r
forall (r :: * -&gt; *). List r =&gt; SValue r -&gt; SValue r
</span><span class="hs-identifier hs-var">listSize</span></span><span> </span><span class="annot"><span class="annottext">SValue r
forall (r :: * -&gt; *). SharedProg r =&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#v_lines"><span class="hs-identifier hs-var">v_lines</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; SValue r
forall (r :: * -&gt; *). Literal r =&gt; Integer -&gt; SValue r
</span><span class="hs-identifier hs-var">litInt</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-954"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSBody r
forall (r :: * -&gt; *). BodySym r =&gt; [MSStatement r] -&gt; MSBody r
</span><span class="hs-identifier hs-var">bodyStatements</span></span><span> </span><span class="annot"><span class="annottext">([MSStatement r] -&gt; MSBody r) -&gt; [MSStatement r] -&gt; MSBody r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; VS (r (Variable r)) -&gt; SValue r -&gt; MSStatement r
forall (r :: * -&gt; *).
StringStatement r =&gt;
Char -&gt; SVariable r -&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">stringSplit</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679359235"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
forall (r :: * -&gt; *). SharedProg r =&gt; SVariable r
</span><a href="Language.Drasil.Code.Imperative.Import.html#var_linetokens"><span class="hs-identifier hs-var">var_linetokens</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-955"></span><span>                  </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *). List r =&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-identifier hs-var">listAccess</span></span><span> </span><span class="annot"><span class="annottext">SValue r
forall (r :: * -&gt; *). SharedProg r =&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#v_lines"><span class="hs-identifier hs-var">v_lines</span></a></span><span> </span><span class="annot"><span class="annottext">SValue r
forall (r :: * -&gt; *). SharedProg r =&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#v_i"><span class="hs-identifier hs-var">v_i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MSStatement r -&gt; [MSStatement r] -&gt; [MSStatement r]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679359237"><span class="hs-identifier hs-var">lnV</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-956"></span><span>              </span><span class="annot"><a href="#local-6989586621679359418"><span class="hs-identifier hs-var">readLines</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679359419"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679359419"><span class="hs-identifier hs-var">numLines</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">VS (r (Variable r))
-&gt; SValue r -&gt; SValue r -&gt; SValue r -&gt; MSBody r -&gt; MSStatement r
forall (r :: * -&gt; *).
ControlStatement r =&gt;
SVariable r
-&gt; SValue r -&gt; SValue r -&gt; SValue r -&gt; MSBody r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">forRange</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
forall (r :: * -&gt; *). SharedProg r =&gt; SVariable r
</span><a href="Language.Drasil.Code.Imperative.Import.html#var_i"><span class="hs-identifier hs-var">var_i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; SValue r
forall (r :: * -&gt; *). Literal r =&gt; Integer -&gt; SValue r
</span><span class="hs-identifier hs-var">litInt</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-957"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; SValue r
forall (r :: * -&gt; *). Literal r =&gt; Integer -&gt; SValue r
</span><span class="hs-identifier hs-var">litInt</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679359419"><span class="hs-identifier hs-var">numLines</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; SValue r
forall (r :: * -&gt; *). Literal r =&gt; Integer -&gt; SValue r
</span><span class="hs-identifier hs-var">litInt</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-958"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSBody r
forall (r :: * -&gt; *). BodySym r =&gt; [MSStatement r] -&gt; MSBody r
</span><span class="hs-identifier hs-var">bodyStatements</span></span><span> </span><span class="annot"><span class="annottext">([MSStatement r] -&gt; MSBody r) -&gt; [MSStatement r] -&gt; MSBody r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-959"></span><span>                  </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SValue r -&gt; VS (r (Variable r)) -&gt; MSStatement r
forall (r :: * -&gt; *).
IOStatement r =&gt;
SValue r -&gt; SVariable r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">getFileInputLine</span></span><span> </span><span class="annot"><span class="annottext">SValue r
forall (r :: * -&gt; *). SharedProg r =&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#v_infile"><span class="hs-identifier hs-var">v_infile</span></a></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
forall (r :: * -&gt; *). SharedProg r =&gt; SVariable r
</span><a href="Language.Drasil.Code.Imperative.Import.html#var_line"><span class="hs-identifier hs-var">var_line</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-960"></span><span>                   </span><span class="annot"><span class="annottext">Char -&gt; VS (r (Variable r)) -&gt; SValue r -&gt; MSStatement r
forall (r :: * -&gt; *).
StringStatement r =&gt;
Char -&gt; SVariable r -&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">stringSplit</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679359235"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r))
forall (r :: * -&gt; *). SharedProg r =&gt; SVariable r
</span><a href="Language.Drasil.Code.Imperative.Import.html#var_linetokens"><span class="hs-identifier hs-var">var_linetokens</span></a></span><span> </span><span class="annot"><span class="annottext">SValue r
forall (r :: * -&gt; *). SharedProg r =&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#v_line"><span class="hs-identifier hs-var">v_line</span></a></span><span>
</span><span id="line-961"></span><span>                  </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; [MSStatement r] -&gt; [MSStatement r]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679359237"><span class="hs-identifier hs-var">lnV</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-962"></span><span>          </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; GenState [MSStatement r]
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([MSStatement r] -&gt; GenState [MSStatement r])
-&gt; [MSStatement r] -&gt; GenState [MSStatement r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe Integer -&gt; [MSStatement r]
</span><a href="#local-6989586621679359418"><span class="hs-identifier hs-var">readLines</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Integer
</span><a href="#local-6989586621679359234"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; [MSStatement r] -&gt; [MSStatement r]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679359238"><span class="hs-identifier hs-var">logs</span></a></span><span>
</span><span id="line-963"></span><span>        </span><span class="hs-comment">---------------</span><span>
</span><span id="line-964"></span><span>        </span><span id="local-6989586621679353999"><span class="annot"><a href="#local-6989586621679359230"><span class="hs-identifier hs-type">lineData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353999"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#LinePattern"><span class="hs-identifier hs-type">LinePattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679353999"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Scope</span></span><span> </span><span class="annot"><a href="#local-6989586621679353999"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-965"></span><span>          </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSStatement</span></span><span> </span><span class="annot"><a href="#local-6989586621679353999"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-966"></span><span>        </span><span id="local-6989586621679359230"><span class="annot"><span class="annottext">lineData :: forall (r :: * -&gt; *).
SharedProg r =&gt;
Maybe Name
-&gt; LinePattern -&gt; r (Scope r) -&gt; GenState [MSStatement r]
</span><a href="#local-6989586621679359230"><span class="hs-identifier hs-var hs-var">lineData</span></a></span></span><span> </span><span id="local-6989586621679359436"><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621679359436"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679359437"><span class="annot"><span class="annottext">p :: LinePattern
</span><a href="#local-6989586621679359437"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#Straight"><span class="hs-identifier hs-type">Straight</span></a></span><span> </span><span class="annot"><span class="annottext">[Input]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">r (Scope r)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-967"></span><span>          </span><span id="local-6989586621679359438"><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679359438"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe Name
-&gt; LinePattern -&gt; StateT DrasilState Identity [VS (r (Variable r))]
forall (r :: * -&gt; *).
SharedProg r =&gt;
Maybe Name -&gt; LinePattern -&gt; GenState [SVariable r]
</span><a href="Language.Drasil.Code.Imperative.Import.html#getEntryVarsProc"><span class="hs-identifier hs-var">getEntryVarsProc</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621679359436"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">LinePattern
</span><a href="#local-6989586621679359437"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-968"></span><span>          </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; GenState [MSStatement r]
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[VS (r (Variable r))] -&gt; SValue r -&gt; MSStatement r
forall (r :: * -&gt; *).
StringStatement r =&gt;
[SVariable r] -&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">stringListVals</span></span><span> </span><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679359438"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">SValue r
forall (r :: * -&gt; *). SharedProg r =&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#v_linetokens"><span class="hs-identifier hs-var">v_linetokens</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-969"></span><span>        </span><span class="annot"><a href="#local-6989586621679359230"><span class="hs-identifier hs-var">lineData</span></a></span><span> </span><span id="local-6989586621679359440"><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621679359440"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679359441"><span class="annot"><span class="annottext">p :: LinePattern
</span><a href="#local-6989586621679359441"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#Repeat"><span class="hs-identifier hs-type">Repeat</span></a></span><span> </span><span id="local-6989586621679359442"><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679359442"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679359443"><span class="annot"><span class="annottext">r (Scope r)
</span><a href="#local-6989586621679359443"><span class="hs-identifier hs-var">scp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-970"></span><span>          </span><span id="local-6989586621679359444"><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679359444"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe Name
-&gt; LinePattern -&gt; StateT DrasilState Identity [VS (r (Variable r))]
forall (r :: * -&gt; *).
SharedProg r =&gt;
Maybe Name -&gt; LinePattern -&gt; GenState [SVariable r]
</span><a href="Language.Drasil.Code.Imperative.Import.html#getEntryVarsProc"><span class="hs-identifier hs-var">getEntryVarsProc</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621679359440"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">LinePattern
</span><a href="#local-6989586621679359441"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-971"></span><span>          </span><span class="annot"><span class="annottext">[StateT DrasilState Identity (MSStatement r)]
-&gt; GenState [MSStatement r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
forall (m :: * -&gt; *) a. Monad m =&gt; [m a] -&gt; m [a]
</span><span class="hs-identifier hs-var">sequence</span></span><span> </span><span class="annot"><span class="annottext">([StateT DrasilState Identity (MSStatement r)]
 -&gt; GenState [MSStatement r])
-&gt; [StateT DrasilState Identity (MSStatement r)]
-&gt; GenState [MSStatement r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe Name
-&gt; [Input]
-&gt; r (Scope r)
-&gt; [StateT DrasilState Identity (MSStatement r)]
forall (r :: * -&gt; *).
SharedProg r =&gt;
Maybe Name -&gt; [Input] -&gt; r (Scope r) -&gt; [GenState (MSStatement r)]
</span><a href="#local-6989586621679359445"><span class="hs-identifier hs-var">clearTemps</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621679359440"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679359442"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="annot"><span class="annottext">r (Scope r)
</span><a href="#local-6989586621679359443"><span class="hs-identifier hs-var">scp</span></a></span><span> </span><span class="annot"><span class="annottext">[StateT DrasilState Identity (MSStatement r)]
-&gt; [StateT DrasilState Identity (MSStatement r)]
-&gt; [StateT DrasilState Identity (MSStatement r)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">MSStatement r -&gt; StateT DrasilState Identity (MSStatement r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-972"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[VS (r (Variable r))] -&gt; SValue r -&gt; MSStatement r
forall (r :: * -&gt; *).
StringStatement r =&gt;
[SVariable r] -&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">stringListLists</span></span><span> </span><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679359444"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">SValue r
forall (r :: * -&gt; *). SharedProg r =&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#v_linetokens"><span class="hs-identifier hs-var">v_linetokens</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity (MSStatement r)
-&gt; [StateT DrasilState Identity (MSStatement r)]
-&gt; [StateT DrasilState Identity (MSStatement r)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Maybe Name
-&gt; [Input] -&gt; [StateT DrasilState Identity (MSStatement r)]
forall (r :: * -&gt; *).
SharedProg r =&gt;
Maybe Name -&gt; [Input] -&gt; [GenState (MSStatement r)]
</span><a href="#local-6989586621679359446"><span class="hs-identifier hs-var">appendTemps</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621679359440"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679359442"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-973"></span><span>        </span><span class="hs-comment">---------------</span><span>
</span><span id="line-974"></span><span>        </span><span id="local-6989586621679354003"><span class="annot"><a href="#local-6989586621679359445"><span class="hs-identifier hs-type">clearTemps</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679354003"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#DataItem"><span class="hs-identifier hs-type">DataItem</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679354003"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Scope</span></span><span> </span><span class="annot"><a href="#local-6989586621679354003"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-975"></span><span>          </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MSStatement</span></span><span> </span><span class="annot"><a href="#local-6989586621679354003"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-976"></span><span>        </span><span id="local-6989586621679359445"><span class="annot"><span class="annottext">clearTemps :: forall (r :: * -&gt; *).
SharedProg r =&gt;
Maybe Name -&gt; [Input] -&gt; r (Scope r) -&gt; [GenState (MSStatement r)]
</span><a href="#local-6989586621679359445"><span class="hs-identifier hs-var hs-var">clearTemps</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe Name
</span><span class="hs-identifier hs-var">Nothing</span></span><span>    </span><span class="annot"><span class="annottext">[Input]
</span><span class="hs-identifier">_</span></span><span>  </span><span class="annot"><span class="annottext">r (Scope r)
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-977"></span><span>        </span><span class="annot"><a href="#local-6989586621679359445"><span class="hs-identifier hs-var">clearTemps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679359449"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679359449"><span class="hs-identifier hs-var">sfx</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679359450"><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679359450"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span id="local-6989586621679359451"><span class="annot"><span class="annottext">r (Scope r)
</span><a href="#local-6989586621679359451"><span class="hs-identifier hs-var">scp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Input -&gt; GenState (MS (r (Statement r))))
-&gt; [Input] -&gt; [GenState (MS (r (Statement r)))]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679359452"><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679359452"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Input -&gt; r (Scope r) -&gt; GenState (MS (r (Statement r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
Name -&gt; Input -&gt; r (Scope r) -&gt; GenState (MSStatement r)
</span><a href="#local-6989586621679359453"><span class="hs-identifier hs-var">clearTemp</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679359449"><span class="hs-identifier hs-var">sfx</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679359452"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">r (Scope r)
</span><a href="#local-6989586621679359451"><span class="hs-identifier hs-var">scp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679359450"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-978"></span><span>        </span><span class="hs-comment">---------------</span><span>
</span><span id="line-979"></span><span>        </span><span id="local-6989586621679354006"><span class="annot"><a href="#local-6989586621679359453"><span class="hs-identifier hs-type">clearTemp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679354006"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#DataItem"><span class="hs-identifier hs-type">DataItem</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679354006"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Scope</span></span><span> </span><span class="annot"><a href="#local-6989586621679354006"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-980"></span><span>          </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MSStatement</span></span><span> </span><span class="annot"><a href="#local-6989586621679354006"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-981"></span><span>        </span><span id="local-6989586621679359453"><span class="annot"><span class="annottext">clearTemp :: forall (r :: * -&gt; *).
SharedProg r =&gt;
Name -&gt; Input -&gt; r (Scope r) -&gt; GenState (MSStatement r)
</span><a href="#local-6989586621679359453"><span class="hs-identifier hs-var hs-var">clearTemp</span></a></span></span><span> </span><span id="local-6989586621679359468"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679359468"><span class="hs-identifier hs-var">sfx</span></a></span></span><span> </span><span id="local-6989586621679359469"><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679359469"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679359470"><span class="annot"><span class="annottext">r (Scope r)
</span><a href="#local-6989586621679359470"><span class="hs-identifier hs-var">scp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CodeType -&gt; MS (r (Statement r)))
-&gt; GenState CodeType
-&gt; StateT DrasilState Identity (MS (r (Statement r)))
forall a b.
(a -&gt; b)
-&gt; StateT DrasilState Identity a -&gt; StateT DrasilState Identity b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679359471"><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679359471"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SVariable r -&gt; r (Scope r) -&gt; [SValue r] -&gt; MS (r (Statement r))
forall (r :: * -&gt; *).
DeclStatement r =&gt;
SVariable r -&gt; r (Scope r) -&gt; [SValue r] -&gt; MSStatement r
</span><span class="hs-identifier hs-var">listDecDef</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; VSType r -&gt; SVariable r
forall (r :: * -&gt; *).
VariableSym r =&gt;
Name -&gt; VSType r -&gt; SVariable r
</span><span class="hs-identifier hs-var">var</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input -&gt; Name
forall c. CodeIdea c =&gt; c -&gt; Name
</span><span class="hs-identifier hs-var">codeName</span></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679359469"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679359468"><span class="hs-identifier hs-var">sfx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-982"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VSType r -&gt; VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; VSType r -&gt; VSType r
</span><span class="hs-identifier hs-var">listInnerType</span></span><span> </span><span class="annot"><span class="annottext">(VSType r -&gt; VSType r) -&gt; VSType r -&gt; VSType r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CodeType -&gt; VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; CodeType -&gt; VSType r
</span><span class="hs-identifier hs-var">convType</span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679359471"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">r (Scope r)
</span><a href="#local-6989586621679359470"><span class="hs-identifier hs-var">scp</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input -&gt; GenState CodeType
forall c. HasSpace c =&gt; c -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#codeType"><span class="hs-identifier hs-var">codeType</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679359469"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-983"></span><span>        </span><span class="hs-comment">---------------</span><span>
</span><span id="line-984"></span><span>        </span><span id="local-6989586621679354004"><span class="annot"><a href="#local-6989586621679359446"><span class="hs-identifier hs-type">appendTemps</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679354004"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#DataItem"><span class="hs-identifier hs-type">DataItem</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-985"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MSStatement</span></span><span> </span><span class="annot"><a href="#local-6989586621679354004"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-986"></span><span>        </span><span id="local-6989586621679359446"><span class="annot"><span class="annottext">appendTemps :: forall (r :: * -&gt; *).
SharedProg r =&gt;
Maybe Name -&gt; [Input] -&gt; [GenState (MSStatement r)]
</span><a href="#local-6989586621679359446"><span class="hs-identifier hs-var hs-var">appendTemps</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe Name
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">[Input]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-987"></span><span>        </span><span class="annot"><a href="#local-6989586621679359446"><span class="hs-identifier hs-var">appendTemps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679359474"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679359474"><span class="hs-identifier hs-var">sfx</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679359475"><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679359475"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Input -&gt; GenState (MS (r (Statement r))))
-&gt; [Input] -&gt; [GenState (MS (r (Statement r)))]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Input -&gt; GenState (MS (r (Statement r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
Name -&gt; Input -&gt; GenState (MSStatement r)
</span><a href="#local-6989586621679359476"><span class="hs-identifier hs-var">appendTemp</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679359474"><span class="hs-identifier hs-var">sfx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679359475"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-988"></span><span>        </span><span class="hs-comment">---------------</span><span>
</span><span id="line-989"></span><span>        </span><span id="local-6989586621679354009"><span class="annot"><a href="#local-6989586621679359476"><span class="hs-identifier hs-type">appendTemp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679354009"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#DataItem"><span class="hs-identifier hs-type">DataItem</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-990"></span><span>          </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MSStatement</span></span><span> </span><span class="annot"><a href="#local-6989586621679354009"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-991"></span><span>        </span><span id="local-6989586621679359476"><span class="annot"><span class="annottext">appendTemp :: forall (r :: * -&gt; *).
SharedProg r =&gt;
Name -&gt; Input -&gt; GenState (MSStatement r)
</span><a href="#local-6989586621679359476"><span class="hs-identifier hs-var hs-var">appendTemp</span></a></span></span><span> </span><span id="local-6989586621679359499"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679359499"><span class="hs-identifier hs-var">sfx</span></a></span></span><span> </span><span id="local-6989586621679359500"><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679359500"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CodeType -&gt; MS (r (Statement r)))
-&gt; GenState CodeType
-&gt; StateT DrasilState Identity (MS (r (Statement r)))
forall a b.
(a -&gt; b)
-&gt; StateT DrasilState Identity a -&gt; StateT DrasilState Identity b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679359501"><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679359501"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; MS (r (Statement r))
forall (r :: * -&gt; *). StatementSym r =&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">valStmt</span></span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; MS (r (Statement r)))
-&gt; SValue r -&gt; MS (r (Statement r))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *). List r =&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-identifier hs-var">listAppend</span></span><span>
</span><span id="line-992"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SVariable r -&gt; SValue r
forall (r :: * -&gt; *). VariableValue r =&gt; SVariable r -&gt; SValue r
</span><span class="hs-identifier hs-var">valueOf</span></span><span> </span><span class="annot"><span class="annottext">(SVariable r -&gt; SValue r) -&gt; SVariable r -&gt; SValue r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; VSType r -&gt; SVariable r
forall (r :: * -&gt; *).
VariableSym r =&gt;
Name -&gt; VSType r -&gt; SVariable r
</span><span class="hs-identifier hs-var">var</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input -&gt; Name
forall c. CodeIdea c =&gt; c -&gt; Name
</span><span class="hs-identifier hs-var">codeName</span></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679359500"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeType -&gt; VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; CodeType -&gt; VSType r
</span><span class="hs-identifier hs-var">convType</span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679359501"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-993"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SVariable r -&gt; SValue r
forall (r :: * -&gt; *). VariableValue r =&gt; SVariable r -&gt; SValue r
</span><span class="hs-identifier hs-var">valueOf</span></span><span> </span><span class="annot"><span class="annottext">(SVariable r -&gt; SValue r) -&gt; SVariable r -&gt; SValue r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; VSType r -&gt; SVariable r
forall (r :: * -&gt; *).
VariableSym r =&gt;
Name -&gt; VSType r -&gt; SVariable r
</span><span class="hs-identifier hs-var">var</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input -&gt; Name
forall c. CodeIdea c =&gt; c -&gt; Name
</span><span class="hs-identifier hs-var">codeName</span></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679359500"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679359499"><span class="hs-identifier hs-var">sfx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeType -&gt; VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; CodeType -&gt; VSType r
</span><span class="hs-identifier hs-var">convType</span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679359501"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input -&gt; GenState CodeType
forall c. HasSpace c =&gt; c -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#codeType"><span class="hs-identifier hs-var">codeType</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679359500"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-994"></span><span>
</span><span id="line-995"></span><span class="annot"><span class="hs-comment">-- | Get entry variables.</span></span><span>
</span><span id="line-996"></span><span id="local-6989586621679354002"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#getEntryVarsProc"><span class="hs-identifier hs-type">getEntryVarsProc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679354002"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#LinePattern"><span class="hs-identifier hs-type">LinePattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-997"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">SVariable</span></span><span> </span><span class="annot"><a href="#local-6989586621679354002"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-998"></span><span id="getEntryVarsProc"><span class="annot"><span class="annottext">getEntryVarsProc :: forall (r :: * -&gt; *).
SharedProg r =&gt;
Maybe Name -&gt; LinePattern -&gt; GenState [SVariable r]
</span><a href="Language.Drasil.Code.Imperative.Import.html#getEntryVarsProc"><span class="hs-identifier hs-var hs-var">getEntryVarsProc</span></a></span></span><span> </span><span id="local-6989586621679359514"><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621679359514"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679359515"><span class="annot"><span class="annottext">LinePattern
</span><a href="#local-6989586621679359515"><span class="hs-identifier hs-var">lp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Input -&gt; StateT DrasilState Identity (VS (r (Variable r))))
-&gt; [Input] -&gt; StateT DrasilState Identity [VS (r (Variable r))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Input -&gt; StateT DrasilState Identity (VS (r (Variable r))))
-&gt; (Name
    -&gt; Input -&gt; StateT DrasilState Identity (VS (r (Variable r))))
-&gt; Maybe Name
-&gt; Input
-&gt; StateT DrasilState Identity (VS (r (Variable r)))
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Input -&gt; StateT DrasilState Identity (VS (r (Variable r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVarProc"><span class="hs-identifier hs-var">mkVarProc</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679359516"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679359516"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span id="local-6989586621679359517"><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679359517"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Input -&gt; GenState CodeType
forall c. HasSpace c =&gt; c -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#codeType"><span class="hs-identifier hs-var">codeType</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679359517"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">GenState CodeType
-&gt; (CodeType -&gt; StateT DrasilState Identity (VS (r (Variable r))))
-&gt; StateT DrasilState Identity (VS (r (Variable r)))
forall a b.
StateT DrasilState Identity a
-&gt; (a -&gt; StateT DrasilState Identity b)
-&gt; StateT DrasilState Identity b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span>
</span><span id="line-999"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
-&gt; VS (r (Type r))
-&gt; StateT DrasilState Identity (VS (r (Variable r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
Name -&gt; VSType r -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#variableProc"><span class="hs-identifier hs-var">variableProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input -&gt; Name
forall c. CodeIdea c =&gt; c -&gt; Name
</span><span class="hs-identifier hs-var">codeName</span></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679359517"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679359516"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(VS (r (Type r))
 -&gt; StateT DrasilState Identity (VS (r (Variable r))))
-&gt; (CodeType -&gt; VS (r (Type r)))
-&gt; CodeType
-&gt; StateT DrasilState Identity (VS (r (Variable r)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Type r)) -&gt; VS (r (Type r))
forall (r :: * -&gt; *). TypeSym r =&gt; VSType r -&gt; VSType r
</span><span class="hs-identifier hs-var">listInnerType</span></span><span> </span><span class="annot"><span class="annottext">(VS (r (Type r)) -&gt; VS (r (Type r)))
-&gt; (CodeType -&gt; VS (r (Type r))) -&gt; CodeType -&gt; VS (r (Type r))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CodeType -&gt; VS (r (Type r))
forall (r :: * -&gt; *). TypeSym r =&gt; CodeType -&gt; VSType r
</span><span class="hs-identifier hs-var">convType</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1000"></span><span>    </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621679359514"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LinePattern -&gt; [Input]
</span><a href="Language.Drasil.Code.DataDesc.html#getPatternInputs"><span class="hs-identifier hs-var">getPatternInputs</span></a></span><span> </span><span class="annot"><span class="annottext">LinePattern
</span><a href="#local-6989586621679359515"><span class="hs-identifier hs-var">lp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1001"></span><span>
</span><span id="line-1002"></span><span class="annot"><span class="hs-comment">-- | Get entry variable logs.</span></span><span>
</span><span id="line-1003"></span><span id="local-6989586621679354000"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#getEntryVarLogsProc"><span class="hs-identifier hs-type">getEntryVarLogsProc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679354000"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#LinePattern"><span class="hs-identifier hs-type">LinePattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSStatement</span></span><span> </span><span class="annot"><a href="#local-6989586621679354000"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-1004"></span><span id="getEntryVarLogsProc"><span class="annot"><span class="annottext">getEntryVarLogsProc :: forall (r :: * -&gt; *).
SharedProg r =&gt;
LinePattern -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Import.html#getEntryVarLogsProc"><span class="hs-identifier hs-var hs-var">getEntryVarLogsProc</span></a></span></span><span> </span><span id="local-6989586621679359527"><span class="annot"><span class="annottext">LinePattern
</span><a href="#local-6989586621679359527"><span class="hs-identifier hs-var">lp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1005"></span><span>  </span><span id="local-6989586621679359528"><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679359528"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe Name
-&gt; LinePattern -&gt; StateT DrasilState Identity [VS (r (Variable r))]
forall (r :: * -&gt; *).
SharedProg r =&gt;
Maybe Name -&gt; LinePattern -&gt; GenState [SVariable r]
</span><a href="Language.Drasil.Code.Imperative.Import.html#getEntryVarsProc"><span class="hs-identifier hs-var">getEntryVarsProc</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Name
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">LinePattern
</span><a href="#local-6989586621679359527"><span class="hs-identifier hs-var">lp</span></a></span><span>
</span><span id="line-1006"></span><span>  </span><span id="local-6989586621679359529"><span class="annot"><span class="annottext">[[MSStatement r]]
</span><a href="#local-6989586621679359529"><span class="hs-identifier hs-var">logs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(VS (r (Variable r)) -&gt; GenState [MSStatement r])
-&gt; [VS (r (Variable r))]
-&gt; StateT DrasilState Identity [[MSStatement r]]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Variable r)) -&gt; GenState [MSStatement r]
forall (r :: * -&gt; *).
SharedProg r =&gt;
SVariable r -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Logging.html#maybeLog"><span class="hs-identifier hs-var">maybeLog</span></a></span><span> </span><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679359528"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-1007"></span><span>  </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; GenState [MSStatement r]
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([MSStatement r] -&gt; GenState [MSStatement r])
-&gt; [MSStatement r] -&gt; GenState [MSStatement r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[MSStatement r]] -&gt; [MSStatement r]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">[[MSStatement r]]
</span><a href="#local-6989586621679359529"><span class="hs-identifier hs-var">logs</span></a></span><span>
</span><span id="line-1008"></span><span>
</span><span id="line-1009"></span><span class="annot"><span class="hs-comment">-- | Converts an 'Expr' to a GOOL Value.</span></span><span>
</span><span id="line-1010"></span><span id="local-6989586621679353957"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-type">convExprProc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353957"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CodeExpr</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679353957"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-1011"></span><span id="convExprProc"><span class="annot"><span class="annottext">convExprProc :: forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var hs-var">convExprProc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Lit</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dbl</span></span><span> </span><span id="local-6989586621679359689"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679359689"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1012"></span><span>  </span><span id="local-6989586621679359690"><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679359690"><span class="hs-identifier hs-var">sm</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Space -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#spaceCodeType"><span class="hs-identifier hs-var">spaceCodeType</span></a></span><span> </span><span class="annot"><span class="annottext">Space
</span><span class="hs-identifier hs-var">Real</span></span><span>
</span><span id="line-1013"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359702"><span class="annot"><span class="annottext">getLiteral :: CodeType -&gt; SValue r
</span><a href="#local-6989586621679359702"><span class="hs-identifier hs-var hs-var">getLiteral</span></a></span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><span class="hs-identifier hs-var">Double</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; SValue r
forall (r :: * -&gt; *). Literal r =&gt; Double -&gt; SValue r
</span><span class="hs-identifier hs-var">litDouble</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679359689"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-1014"></span><span>      </span><span class="annot"><a href="#local-6989586621679359702"><span class="hs-identifier hs-var">getLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><span class="hs-identifier hs-var">Float</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; SValue r
forall (r :: * -&gt; *). Literal r =&gt; Float -&gt; SValue r
</span><span class="hs-identifier hs-var">litFloat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Float
forall a b. (Real a, Fractional b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">realToFrac</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679359689"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1015"></span><span>      </span><span class="annot"><a href="#local-6989586621679359702"><span class="hs-identifier hs-var">getLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; SValue r
forall a. HasCallStack =&gt; Name -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;convExprProc: Real space matched to invalid CodeType; should be Double or Float&quot;</span></span><span>
</span><span id="line-1016"></span><span>  </span><span class="annot"><span class="annottext">SValue r -&gt; GenState (SValue r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; GenState (SValue r))
-&gt; SValue r -&gt; GenState (SValue r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CodeType -&gt; SValue r
forall {r :: * -&gt; *}. Literal r =&gt; CodeType -&gt; SValue r
</span><a href="#local-6989586621679359702"><span class="hs-identifier hs-var">getLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679359690"><span class="hs-identifier hs-var">sm</span></a></span><span>
</span><span id="line-1017"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Lit</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ExactDbl</span></span><span> </span><span id="local-6989586621679359703"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679359703"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">(CodeExpr -&gt; GenState (SValue r))
-&gt; CodeExpr -&gt; GenState (SValue r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CodeExpr
</span><span class="hs-identifier hs-var">Lit</span></span><span> </span><span class="annot"><span class="annottext">(Literal -&gt; CodeExpr) -&gt; (Double -&gt; Literal) -&gt; Double -&gt; CodeExpr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Literal
</span><span class="hs-identifier hs-var">Dbl</span></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; CodeExpr) -&gt; Double -&gt; CodeExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Double
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679359703"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-1018"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Lit</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span id="local-6989586621679359704"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679359704"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; GenState (SValue r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; GenState (SValue r))
-&gt; SValue r -&gt; GenState (SValue r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; SValue r
forall (r :: * -&gt; *). Literal r =&gt; Integer -&gt; SValue r
</span><span class="hs-identifier hs-var">litInt</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679359704"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-1019"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Lit</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Str</span></span><span> </span><span id="local-6989586621679359705"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679359705"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; GenState (SValue r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; GenState (SValue r))
-&gt; SValue r -&gt; GenState (SValue r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; SValue r
forall (r :: * -&gt; *). Literal r =&gt; Name -&gt; SValue r
</span><span class="hs-identifier hs-var">litString</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679359705"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-1020"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Lit</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Perc</span></span><span> </span><span id="local-6989586621679359706"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679359706"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679359707"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679359707"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1021"></span><span>  </span><span id="local-6989586621679359708"><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679359708"><span class="hs-identifier hs-var">sm</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Space -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#spaceCodeType"><span class="hs-identifier hs-var">spaceCodeType</span></a></span><span> </span><span class="annot"><span class="annottext">Space
</span><span class="hs-identifier hs-var">Rational</span></span><span>
</span><span id="line-1022"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359720"><span class="annot"><span class="annottext">getLiteral :: CodeType -&gt; Double -&gt; SValue r
</span><a href="#local-6989586621679359720"><span class="hs-identifier hs-var hs-var">getLiteral</span></a></span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><span class="hs-identifier hs-var">Double</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; SValue r
forall (r :: * -&gt; *). Literal r =&gt; Double -&gt; SValue r
</span><span class="hs-identifier hs-var">litDouble</span></span><span>
</span><span id="line-1023"></span><span>      </span><span class="annot"><a href="#local-6989586621679359720"><span class="hs-identifier hs-var">getLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><span class="hs-identifier hs-var">Float</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; SValue r
forall (r :: * -&gt; *). Literal r =&gt; Float -&gt; SValue r
</span><span class="hs-identifier hs-var">litFloat</span></span><span> </span><span class="annot"><span class="annottext">(Float -&gt; SValue r) -&gt; (Double -&gt; Float) -&gt; Double -&gt; SValue r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Float
forall a b. (Real a, Fractional b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">realToFrac</span></span><span>
</span><span id="line-1024"></span><span>      </span><span class="annot"><a href="#local-6989586621679359720"><span class="hs-identifier hs-var">getLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Double -&gt; SValue r
forall a. HasCallStack =&gt; Name -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;convExprProc: Rational space matched to invalid CodeType; should be Double or Float&quot;</span></span><span>
</span><span id="line-1025"></span><span>  </span><span class="annot"><span class="annottext">SValue r -&gt; GenState (SValue r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; GenState (SValue r))
-&gt; SValue r -&gt; GenState (SValue r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CodeType -&gt; Double -&gt; SValue r
forall {r :: * -&gt; *}. Literal r =&gt; CodeType -&gt; Double -&gt; SValue r
</span><a href="#local-6989586621679359720"><span class="hs-identifier hs-var">getLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679359708"><span class="hs-identifier hs-var">sm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679359706"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">**</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679359707"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1026"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AssocA</span></span><span> </span><span class="annot"><span class="annottext">AssocArithOper
</span><span class="hs-identifier hs-var">Add</span></span><span> </span><span id="local-6989586621679359721"><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679359721"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r -&gt; SValue r) -&gt; [SValue r] -&gt; SValue r
forall a. (a -&gt; a -&gt; a) -&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; a -&gt; a) -&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">foldl1</span></span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
NumericExpression r =&gt;
SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-operator hs-var">(#+)</span></span><span>  </span><span class="annot"><span class="annottext">([SValue r] -&gt; SValue r)
-&gt; StateT DrasilState Identity [SValue r] -&gt; GenState (SValue r)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(CodeExpr -&gt; GenState (SValue r))
-&gt; [CodeExpr] -&gt; StateT DrasilState Identity [SValue r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679359721"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-1027"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AssocA</span></span><span> </span><span class="annot"><span class="annottext">AssocArithOper
</span><span class="hs-identifier hs-var">Mul</span></span><span> </span><span id="local-6989586621679359722"><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679359722"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r -&gt; SValue r) -&gt; [SValue r] -&gt; SValue r
forall a. (a -&gt; a -&gt; a) -&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; a -&gt; a) -&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">foldl1</span></span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
NumericExpression r =&gt;
SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-operator hs-var">(#*)</span></span><span>  </span><span class="annot"><span class="annottext">([SValue r] -&gt; SValue r)
-&gt; StateT DrasilState Identity [SValue r] -&gt; GenState (SValue r)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(CodeExpr -&gt; GenState (SValue r))
-&gt; [CodeExpr] -&gt; StateT DrasilState Identity [SValue r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679359722"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-1028"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AssocB</span></span><span> </span><span class="annot"><span class="annottext">AssocBoolOper
</span><span class="hs-identifier hs-var">And</span></span><span> </span><span id="local-6989586621679359723"><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679359723"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r -&gt; SValue r) -&gt; [SValue r] -&gt; SValue r
forall a. (a -&gt; a -&gt; a) -&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; a -&gt; a) -&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">foldl1</span></span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
BooleanExpression r =&gt;
SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-operator hs-var">(?&amp;&amp;)</span></span><span> </span><span class="annot"><span class="annottext">([SValue r] -&gt; SValue r)
-&gt; StateT DrasilState Identity [SValue r] -&gt; GenState (SValue r)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(CodeExpr -&gt; GenState (SValue r))
-&gt; [CodeExpr] -&gt; StateT DrasilState Identity [SValue r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679359723"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-1029"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AssocB</span></span><span> </span><span class="annot"><span class="annottext">AssocBoolOper
</span><span class="hs-identifier hs-var">Or</span></span><span> </span><span id="local-6989586621679359724"><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679359724"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r -&gt; SValue r) -&gt; [SValue r] -&gt; SValue r
forall a. (a -&gt; a -&gt; a) -&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; a -&gt; a) -&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">foldl1</span></span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
BooleanExpression r =&gt;
SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-operator hs-var">(?||)</span></span><span> </span><span class="annot"><span class="annottext">([SValue r] -&gt; SValue r)
-&gt; StateT DrasilState Identity [SValue r] -&gt; GenState (SValue r)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(CodeExpr -&gt; GenState (SValue r))
-&gt; [CodeExpr] -&gt; StateT DrasilState Identity [SValue r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679359724"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-1030"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AssocC</span></span><span> </span><span class="annot"><span class="annottext">AssocConcatOper
</span><span class="hs-identifier hs-var">SUnion</span></span><span> </span><span id="local-6989586621679359725"><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679359725"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r -&gt; SValue r) -&gt; [SValue r] -&gt; SValue r
forall a. (a -&gt; a -&gt; a) -&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; a -&gt; a) -&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">foldl1</span></span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
NumericExpression r =&gt;
SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-operator hs-var">(#+)</span></span><span> </span><span class="annot"><span class="annottext">([SValue r] -&gt; SValue r)
-&gt; StateT DrasilState Identity [SValue r] -&gt; GenState (SValue r)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(CodeExpr -&gt; GenState (SValue r))
-&gt; [CodeExpr] -&gt; StateT DrasilState Identity [SValue r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679359725"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-1031"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">C</span></span><span> </span><span id="local-6989586621679359726"><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679359726"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1032"></span><span>  </span><span id="local-6989586621679359727"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679359727"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-1033"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359734"><span class="annot"><span class="annottext">v :: Input
</span><a href="#local-6989586621679359734"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DefinedQuantityDict -&gt; Input
forall c. (Quantity c, MayHaveUnit c, Concept c) =&gt; c -&gt; Input
</span><a href="Language.Drasil.Chunk.CodeBase.html#quantvar"><span class="hs-identifier hs-var">quantvar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; UID -&gt; DefinedQuantityDict
</span><a href="Language.Drasil.Code.Imperative.Helpers.html#lookupC"><span class="hs-identifier hs-var">lookupC</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679359727"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679359726"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1034"></span><span>  </span><span class="annot"><span class="annottext">Input -&gt; GenState (SValue r)
forall (r :: * -&gt; *). SharedProg r =&gt; Input -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkValProc"><span class="hs-identifier hs-var">mkValProc</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679359734"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-1035"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FCall</span></span><span> </span><span id="local-6989586621679359735"><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679359735"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679359736"><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679359736"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679359737"><span class="annot"><span class="annottext">[(UID, CodeExpr)]
</span><a href="#local-6989586621679359737"><span class="hs-identifier hs-var">ns</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UID
-&gt; [CodeExpr]
-&gt; [(UID, CodeExpr)]
-&gt; (Name
    -&gt; Name
    -&gt; VSType r
    -&gt; [SValue r]
    -&gt; NamedArgs r
    -&gt; GenState (SValue r))
-&gt; (Name
    -&gt; Name -&gt; VSType r -&gt; [SValue r] -&gt; NamedArgs r -&gt; SValue r)
-&gt; GenState (SValue r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
UID
-&gt; [CodeExpr]
-&gt; [(UID, CodeExpr)]
-&gt; (Name
    -&gt; Name
    -&gt; VSType r
    -&gt; [SValue r]
    -&gt; NamedArgs r
    -&gt; GenState (SValue r))
-&gt; (Name
    -&gt; Name -&gt; VSType r -&gt; [SValue r] -&gt; NamedArgs r -&gt; SValue r)
-&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convCallProc"><span class="hs-identifier hs-var">convCallProc</span></a></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679359735"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679359736"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">[(UID, CodeExpr)]
</span><a href="#local-6989586621679359737"><span class="hs-identifier hs-var">ns</span></a></span><span> </span><span class="annot"><span class="annottext">Name
-&gt; Name
-&gt; VSType r
-&gt; [SValue r]
-&gt; NamedArgs r
-&gt; GenState (SValue r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
Name
-&gt; Name
-&gt; VSType r
-&gt; [SValue r]
-&gt; NamedArgs r
-&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.GenerateGOOL.html#fAppProc"><span class="hs-identifier hs-var">fAppProc</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; VSType r -&gt; [SValue r] -&gt; NamedArgs r -&gt; SValue r
forall (r :: * -&gt; *). ValueExpression r =&gt; Name -&gt; MixedCall r
</span><span class="hs-identifier hs-var">libFuncAppMixedArgs</span></span><span>
</span><span id="line-1036"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">New</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; GenState (SValue r)
forall a. HasCallStack =&gt; Name -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;convExprProc: Procedural renderers do not support object creation&quot;</span></span><span>
</span><span id="line-1037"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Message</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; GenState (SValue r)
forall a. HasCallStack =&gt; Name -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;convExprProc: Procedural renderers do not support methods&quot;</span></span><span>
</span><span id="line-1038"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Field</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; GenState (SValue r)
forall a. HasCallStack =&gt; Name -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;convExprProc: Procedural renderers do not support object field access&quot;</span></span><span>
</span><span id="line-1039"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UnaryOp</span></span><span> </span><span id="local-6989586621679359739"><span class="annot"><span class="annottext">UFunc
</span><a href="#local-6989586621679359739"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679359740"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679359740"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r)
-&gt; GenState (SValue r) -&gt; GenState (SValue r)
forall a b.
(a -&gt; b)
-&gt; StateT DrasilState Identity a -&gt; StateT DrasilState Identity b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UFunc -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *). SharedProg r =&gt; UFunc -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#unop"><span class="hs-identifier hs-var">unop</span></a></span><span> </span><span class="annot"><span class="annottext">UFunc
</span><a href="#local-6989586621679359739"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679359740"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1040"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UnaryOpB</span></span><span> </span><span id="local-6989586621679359741"><span class="annot"><span class="annottext">UFuncB
</span><a href="#local-6989586621679359741"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679359742"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679359742"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r)
-&gt; GenState (SValue r) -&gt; GenState (SValue r)
forall a b.
(a -&gt; b)
-&gt; StateT DrasilState Identity a -&gt; StateT DrasilState Identity b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UFuncB -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
SharedProg r =&gt;
UFuncB -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#unopB"><span class="hs-identifier hs-var">unopB</span></a></span><span> </span><span class="annot"><span class="annottext">UFuncB
</span><a href="#local-6989586621679359741"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679359742"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1041"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UnaryOpVV</span></span><span> </span><span id="local-6989586621679359743"><span class="annot"><span class="annottext">UFuncVV
</span><a href="#local-6989586621679359743"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679359744"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679359744"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r)
-&gt; GenState (SValue r) -&gt; GenState (SValue r)
forall a b.
(a -&gt; b)
-&gt; StateT DrasilState Identity a -&gt; StateT DrasilState Identity b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UFuncVV -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
SharedProg r =&gt;
UFuncVV -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#unopVV"><span class="hs-identifier hs-var">unopVV</span></a></span><span> </span><span class="annot"><span class="annottext">UFuncVV
</span><a href="#local-6989586621679359743"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679359744"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1042"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UnaryOpVN</span></span><span> </span><span id="local-6989586621679359745"><span class="annot"><span class="annottext">UFuncVN
</span><a href="#local-6989586621679359745"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679359746"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679359746"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r)
-&gt; GenState (SValue r) -&gt; GenState (SValue r)
forall a b.
(a -&gt; b)
-&gt; StateT DrasilState Identity a -&gt; StateT DrasilState Identity b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UFuncVN -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
SharedProg r =&gt;
UFuncVN -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#unopVN"><span class="hs-identifier hs-var">unopVN</span></a></span><span> </span><span class="annot"><span class="annottext">UFuncVN
</span><a href="#local-6989586621679359745"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679359746"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1043"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ArithBinaryOp</span></span><span> </span><span class="annot"><span class="annottext">ArithBinOp
</span><span class="hs-identifier hs-var">Frac</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Lit</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span id="local-6989586621679359747"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679359747"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Lit</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span id="local-6989586621679359748"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679359748"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-comment">-- hack to deal with integer division</span><span>
</span><span id="line-1044"></span><span>  </span><span id="local-6989586621679359749"><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679359749"><span class="hs-identifier hs-var">sm</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Space -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#spaceCodeType"><span class="hs-identifier hs-var">spaceCodeType</span></a></span><span> </span><span class="annot"><span class="annottext">Space
</span><span class="hs-identifier hs-var">Rational</span></span><span>
</span><span id="line-1045"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359774"><span class="annot"><span class="annottext">getLiteral :: CodeType -&gt; SValue r
</span><a href="#local-6989586621679359774"><span class="hs-identifier hs-var hs-var">getLiteral</span></a></span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><span class="hs-identifier hs-var">Double</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; SValue r
forall (r :: * -&gt; *). Literal r =&gt; Double -&gt; SValue r
</span><span class="hs-identifier hs-var">litDouble</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679359747"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
NumericExpression r =&gt;
SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-operator hs-var">#/</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; SValue r
forall (r :: * -&gt; *). Literal r =&gt; Double -&gt; SValue r
</span><span class="hs-identifier hs-var">litDouble</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679359748"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1046"></span><span>      </span><span class="annot"><a href="#local-6989586621679359774"><span class="hs-identifier hs-var">getLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><span class="hs-identifier hs-var">Float</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; SValue r
forall (r :: * -&gt; *). Literal r =&gt; Float -&gt; SValue r
</span><span class="hs-identifier hs-var">litFloat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Float
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679359747"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
NumericExpression r =&gt;
SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-operator hs-var">#/</span></span><span> </span><span class="annot"><span class="annottext">Float -&gt; SValue r
forall (r :: * -&gt; *). Literal r =&gt; Float -&gt; SValue r
</span><span class="hs-identifier hs-var">litFloat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Float
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679359748"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1047"></span><span>      </span><span class="annot"><a href="#local-6989586621679359774"><span class="hs-identifier hs-var">getLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; SValue r
forall a. HasCallStack =&gt; Name -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;convExprProc: Rational space matched to invalid CodeType; should be Double or Float&quot;</span></span><span>
</span><span id="line-1048"></span><span>  </span><span class="annot"><span class="annottext">SValue r -&gt; GenState (SValue r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; GenState (SValue r))
-&gt; SValue r -&gt; GenState (SValue r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CodeType -&gt; SValue r
forall {r :: * -&gt; *}.
(NumericExpression r, Literal r) =&gt;
CodeType -&gt; SValue r
</span><a href="#local-6989586621679359774"><span class="hs-identifier hs-var">getLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679359749"><span class="hs-identifier hs-var">sm</span></a></span><span>
</span><span id="line-1049"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ArithBinaryOp</span></span><span> </span><span id="local-6989586621679359775"><span class="annot"><span class="annottext">ArithBinOp
</span><a href="#local-6989586621679359775"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679359776"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679359776"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679359777"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679359777"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r -&gt; SValue r)
-&gt; GenState (SValue r)
-&gt; GenState (SValue r)
-&gt; GenState (SValue r)
forall (m :: * -&gt; *) a1 a2 r.
Monad m =&gt;
(a1 -&gt; a2 -&gt; r) -&gt; m a1 -&gt; m a2 -&gt; m r
</span><span class="hs-identifier hs-var">liftM2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArithBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
SharedProg r =&gt;
ArithBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#arithBfunc"><span class="hs-identifier hs-var">arithBfunc</span></a></span><span> </span><span class="annot"><span class="annottext">ArithBinOp
</span><a href="#local-6989586621679359775"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679359776"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679359777"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1050"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">BoolBinaryOp</span></span><span> </span><span id="local-6989586621679359778"><span class="annot"><span class="annottext">BoolBinOp
</span><a href="#local-6989586621679359778"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679359779"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679359779"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679359780"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679359780"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r -&gt; SValue r)
-&gt; GenState (SValue r)
-&gt; GenState (SValue r)
-&gt; GenState (SValue r)
forall (m :: * -&gt; *) a1 a2 r.
Monad m =&gt;
(a1 -&gt; a2 -&gt; r) -&gt; m a1 -&gt; m a2 -&gt; m r
</span><span class="hs-identifier hs-var">liftM2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BoolBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *). BoolBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#boolBfunc"><span class="hs-identifier hs-var">boolBfunc</span></a></span><span> </span><span class="annot"><span class="annottext">BoolBinOp
</span><a href="#local-6989586621679359778"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679359779"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679359780"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1051"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LABinaryOp</span></span><span> </span><span id="local-6989586621679359781"><span class="annot"><span class="annottext">LABinOp
</span><a href="#local-6989586621679359781"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679359782"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679359782"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679359783"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679359783"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r -&gt; SValue r)
-&gt; GenState (SValue r)
-&gt; GenState (SValue r)
-&gt; GenState (SValue r)
forall (m :: * -&gt; *) a1 a2 r.
Monad m =&gt;
(a1 -&gt; a2 -&gt; r) -&gt; m a1 -&gt; m a2 -&gt; m r
</span><span class="hs-identifier hs-var">liftM2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LABinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
SharedProg r =&gt;
LABinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#laBfunc"><span class="hs-identifier hs-var">laBfunc</span></a></span><span> </span><span class="annot"><span class="annottext">LABinOp
</span><a href="#local-6989586621679359781"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679359782"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679359783"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1052"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">EqBinaryOp</span></span><span> </span><span id="local-6989586621679359784"><span class="annot"><span class="annottext">EqBinOp
</span><a href="#local-6989586621679359784"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679359785"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679359785"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679359786"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679359786"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r -&gt; SValue r)
-&gt; GenState (SValue r)
-&gt; GenState (SValue r)
-&gt; GenState (SValue r)
forall (m :: * -&gt; *) a1 a2 r.
Monad m =&gt;
(a1 -&gt; a2 -&gt; r) -&gt; m a1 -&gt; m a2 -&gt; m r
</span><span class="hs-identifier hs-var">liftM2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EqBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
SharedProg r =&gt;
EqBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#eqBfunc"><span class="hs-identifier hs-var">eqBfunc</span></a></span><span> </span><span class="annot"><span class="annottext">EqBinOp
</span><a href="#local-6989586621679359784"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679359785"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679359786"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1053"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OrdBinaryOp</span></span><span> </span><span id="local-6989586621679359787"><span class="annot"><span class="annottext">OrdBinOp
</span><a href="#local-6989586621679359787"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679359788"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679359788"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679359789"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679359789"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r -&gt; SValue r)
-&gt; GenState (SValue r)
-&gt; GenState (SValue r)
-&gt; GenState (SValue r)
forall (m :: * -&gt; *) a1 a2 r.
Monad m =&gt;
(a1 -&gt; a2 -&gt; r) -&gt; m a1 -&gt; m a2 -&gt; m r
</span><span class="hs-identifier hs-var">liftM2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OrdBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
SharedProg r =&gt;
OrdBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#ordBfunc"><span class="hs-identifier hs-var">ordBfunc</span></a></span><span> </span><span class="annot"><span class="annottext">OrdBinOp
</span><a href="#local-6989586621679359787"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679359788"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679359789"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1054"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VVVBinaryOp</span></span><span> </span><span id="local-6989586621679359790"><span class="annot"><span class="annottext">VVVBinOp
</span><a href="#local-6989586621679359790"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679359791"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679359791"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679359792"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679359792"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r -&gt; SValue r)
-&gt; GenState (SValue r)
-&gt; GenState (SValue r)
-&gt; GenState (SValue r)
forall (m :: * -&gt; *) a1 a2 r.
Monad m =&gt;
(a1 -&gt; a2 -&gt; r) -&gt; m a1 -&gt; m a2 -&gt; m r
</span><span class="hs-identifier hs-var">liftM2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VVVBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *). VVVBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#vecVecVecBfunc"><span class="hs-identifier hs-var">vecVecVecBfunc</span></a></span><span> </span><span class="annot"><span class="annottext">VVVBinOp
</span><a href="#local-6989586621679359790"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679359791"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679359792"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1055"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VVNBinaryOp</span></span><span> </span><span id="local-6989586621679359793"><span class="annot"><span class="annottext">VVNBinOp
</span><a href="#local-6989586621679359793"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679359794"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679359794"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679359795"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679359795"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r -&gt; SValue r)
-&gt; GenState (SValue r)
-&gt; GenState (SValue r)
-&gt; GenState (SValue r)
forall (m :: * -&gt; *) a1 a2 r.
Monad m =&gt;
(a1 -&gt; a2 -&gt; r) -&gt; m a1 -&gt; m a2 -&gt; m r
</span><span class="hs-identifier hs-var">liftM2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VVNBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *). VVNBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#vecVecNumBfunc"><span class="hs-identifier hs-var">vecVecNumBfunc</span></a></span><span> </span><span class="annot"><span class="annottext">VVNBinOp
</span><a href="#local-6989586621679359793"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679359794"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679359795"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1056"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NVVBinaryOp</span></span><span> </span><span id="local-6989586621679359796"><span class="annot"><span class="annottext">NVVBinOp
</span><a href="#local-6989586621679359796"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679359797"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679359797"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679359798"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679359798"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r -&gt; SValue r)
-&gt; GenState (SValue r)
-&gt; GenState (SValue r)
-&gt; GenState (SValue r)
forall (m :: * -&gt; *) a1 a2 r.
Monad m =&gt;
(a1 -&gt; a2 -&gt; r) -&gt; m a1 -&gt; m a2 -&gt; m r
</span><span class="hs-identifier hs-var">liftM2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NVVBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *). NVVBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#numVecVecBfunc"><span class="hs-identifier hs-var">numVecVecBfunc</span></a></span><span> </span><span class="annot"><span class="annottext">NVVBinOp
</span><a href="#local-6989586621679359796"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679359797"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679359798"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1057"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ESSBinaryOp</span></span><span> </span><span id="local-6989586621679359799"><span class="annot"><span class="annottext">ESSBinOp
</span><a href="#local-6989586621679359799"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679359800"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679359800"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679359801"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679359801"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r -&gt; SValue r)
-&gt; GenState (SValue r)
-&gt; GenState (SValue r)
-&gt; GenState (SValue r)
forall (m :: * -&gt; *) a1 a2 r.
Monad m =&gt;
(a1 -&gt; a2 -&gt; r) -&gt; m a1 -&gt; m a2 -&gt; m r
</span><span class="hs-identifier hs-var">liftM2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ESSBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
SharedProg r =&gt;
ESSBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#elementSetSetBfunc"><span class="hs-identifier hs-var">elementSetSetBfunc</span></a></span><span> </span><span class="annot"><span class="annottext">ESSBinOp
</span><a href="#local-6989586621679359799"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679359800"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679359801"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1058"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ESBBinaryOp</span></span><span> </span><span id="local-6989586621679359802"><span class="annot"><span class="annottext">ESBBinOp
</span><a href="#local-6989586621679359802"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679359803"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679359803"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679359804"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679359804"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r -&gt; SValue r)
-&gt; GenState (SValue r)
-&gt; GenState (SValue r)
-&gt; GenState (SValue r)
forall (m :: * -&gt; *) a1 a2 r.
Monad m =&gt;
(a1 -&gt; a2 -&gt; r) -&gt; m a1 -&gt; m a2 -&gt; m r
</span><span class="hs-identifier hs-var">liftM2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ESBBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
SharedProg r =&gt;
ESBBinOp -&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#elementSetBoolBfunc"><span class="hs-identifier hs-var">elementSetBoolBfunc</span></a></span><span> </span><span class="annot"><span class="annottext">ESBBinOp
</span><a href="#local-6989586621679359802"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679359803"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679359804"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1059"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Case</span></span><span> </span><span id="local-6989586621679359805"><span class="annot"><span class="annottext">Completeness
</span><a href="#local-6989586621679359805"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679359806"><span class="annot"><span class="annottext">[(CodeExpr, CodeExpr)]
</span><a href="#local-6989586621679359806"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(CodeExpr, CodeExpr)] -&gt; GenState (SValue r)
forall {r :: * -&gt; *}.
SharedProg r =&gt;
[(CodeExpr, CodeExpr)]
-&gt; StateT DrasilState Identity (VS (r (Value r)))
</span><a href="#local-6989586621679359807"><span class="hs-identifier hs-var">doit</span></a></span><span> </span><span class="annot"><span class="annottext">[(CodeExpr, CodeExpr)]
</span><a href="#local-6989586621679359806"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-comment">-- FIXME this is sub-optimal</span><span>
</span><span id="line-1060"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1061"></span><span>    </span><span id="local-6989586621679359807"><span class="annot"><span class="annottext">doit :: [(CodeExpr, CodeExpr)]
-&gt; StateT DrasilState Identity (VS (r (Value r)))
</span><a href="#local-6989586621679359807"><span class="hs-identifier hs-var hs-var">doit</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall a. HasCallStack =&gt; Name -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;should never happen&quot;</span></span><span> </span><span class="hs-comment">-- TODO: change error message?</span><span>
</span><span id="line-1062"></span><span>    </span><span class="annot"><a href="#local-6989586621679359807"><span class="hs-identifier hs-var">doit</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621679359987"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679359987"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">CodeExpr
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679359987"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-comment">-- should always be the else clause</span><span>
</span><span id="line-1063"></span><span>    </span><span class="annot"><a href="#local-6989586621679359807"><span class="hs-identifier hs-var">doit</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679359988"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679359988"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679359989"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679359989"><span class="hs-identifier hs-var">cond</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679359990"><span class="annot"><span class="annottext">[(CodeExpr, CodeExpr)]
</span><a href="#local-6989586621679359990"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(VS (r (Value r))
 -&gt; VS (r (Value r)) -&gt; VS (r (Value r)) -&gt; VS (r (Value r)))
-&gt; StateT DrasilState Identity (VS (r (Value r)))
-&gt; StateT DrasilState Identity (VS (r (Value r)))
-&gt; StateT DrasilState Identity (VS (r (Value r)))
-&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (m :: * -&gt; *) a1 a2 a3 r.
Monad m =&gt;
(a1 -&gt; a2 -&gt; a3 -&gt; r) -&gt; m a1 -&gt; m a2 -&gt; m a3 -&gt; m r
</span><span class="hs-identifier hs-var">liftM3</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
-&gt; VS (r (Value r)) -&gt; VS (r (Value r)) -&gt; VS (r (Value r))
forall (r :: * -&gt; *).
ValueExpression r =&gt;
SValue r -&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-identifier hs-var">inlineIf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679359989"><span class="hs-identifier hs-var">cond</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679359988"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1064"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Completeness -&gt; [(CodeExpr, CodeExpr)] -&gt; CodeExpr
</span><span class="hs-identifier hs-var">Case</span></span><span> </span><span class="annot"><span class="annottext">Completeness
</span><a href="#local-6989586621679359805"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">[(CodeExpr, CodeExpr)]
</span><a href="#local-6989586621679359990"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1065"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Matrix</span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679359991"><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679359991"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1066"></span><span>  </span><span id="local-6989586621679359992"><span class="annot"><span class="annottext">[SValue r]
</span><a href="#local-6989586621679359992"><span class="hs-identifier hs-var">ar</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(CodeExpr -&gt; GenState (SValue r))
-&gt; [CodeExpr] -&gt; StateT DrasilState Identity [SValue r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679359991"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-1067"></span><span>                                    </span><span class="hs-comment">-- hd will never fail here</span><span>
</span><span id="line-1068"></span><span>  </span><span class="annot"><span class="annottext">SValue r -&gt; GenState (SValue r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; GenState (SValue r))
-&gt; SValue r -&gt; GenState (SValue r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VSType r -&gt; [SValue r] -&gt; SValue r
forall (r :: * -&gt; *).
Literal r =&gt;
VSType r -&gt; [SValue r] -&gt; SValue r
</span><span class="hs-identifier hs-var">litArray</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(r (Value r) -&gt; r (Type r)) -&gt; SValue r -&gt; VSType r
forall a b.
(a -&gt; b)
-&gt; StateT ValueState Identity a -&gt; StateT ValueState Identity b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">r (Value r) -&gt; r (Type r)
forall (r :: * -&gt; *). ValueSym r =&gt; r (Value r) -&gt; r (Type r)
</span><span class="hs-identifier hs-var">valueType</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SValue r] -&gt; SValue r
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[SValue r]
</span><a href="#local-6989586621679359992"><span class="hs-identifier hs-var">ar</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[SValue r]
</span><a href="#local-6989586621679359992"><span class="hs-identifier hs-var">ar</span></a></span><span>
</span><span id="line-1069"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Matrix</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; GenState (SValue r)
forall a. HasCallStack =&gt; Name -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;convExprProc: Matrix&quot;</span></span><span>
</span><span id="line-1070"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">S.Set</span></span><span> </span><span id="local-6989586621679359993"><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621679359993"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679359994"><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679359994"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span>
</span><span id="line-1071"></span><span>  </span><span id="local-6989586621679359995"><span class="annot"><span class="annottext">[SValue r]
</span><a href="#local-6989586621679359995"><span class="hs-identifier hs-var">ar</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(CodeExpr -&gt; GenState (SValue r))
-&gt; [CodeExpr] -&gt; StateT DrasilState Identity [SValue r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679359994"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-1072"></span><span>  </span><span id="local-6989586621679359996"><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679359996"><span class="hs-identifier hs-var">sm</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Space -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#spaceCodeType"><span class="hs-identifier hs-var">spaceCodeType</span></a></span><span> </span><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621679359993"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-1073"></span><span>  </span><span class="annot"><span class="annottext">SValue r -&gt; GenState (SValue r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; GenState (SValue r))
-&gt; SValue r -&gt; GenState (SValue r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VSType r -&gt; [SValue r] -&gt; SValue r
forall (r :: * -&gt; *).
Literal r =&gt;
VSType r -&gt; [SValue r] -&gt; SValue r
</span><span class="hs-identifier hs-var">litSet</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeType -&gt; VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; CodeType -&gt; VSType r
</span><span class="hs-identifier hs-var">convType</span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679359996"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[SValue r]
</span><a href="#local-6989586621679359995"><span class="hs-identifier hs-var">ar</span></a></span><span>
</span><span id="line-1074"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Variable</span></span><span> </span><span id="local-6989586621679359997"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679359997"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">S.Set</span></span><span> </span><span id="local-6989586621679359998"><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621679359998"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><span class="annottext">[CodeExpr]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1075"></span><span>  </span><span id="local-6989586621679359999"><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679359999"><span class="hs-identifier hs-var">sm</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Space -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#spaceCodeType"><span class="hs-identifier hs-var">spaceCodeType</span></a></span><span> </span><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621679359998"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-1076"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360004"><span class="annot"><span class="annottext">varSet :: SVariable r
</span><a href="#local-6989586621679360004"><span class="hs-identifier hs-var hs-var">varSet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; VSType r -&gt; SVariable r
forall (r :: * -&gt; *).
VariableSym r =&gt;
Name -&gt; VSType r -&gt; SVariable r
</span><span class="hs-identifier hs-var">var</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679359997"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VSType r -&gt; VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; VSType r -&gt; VSType r
</span><span class="hs-identifier hs-var">setType</span></span><span> </span><span class="annot"><span class="annottext">(VSType r -&gt; VSType r) -&gt; VSType r -&gt; VSType r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CodeType -&gt; VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; CodeType -&gt; VSType r
</span><span class="hs-identifier hs-var">convType</span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679359999"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1077"></span><span>  </span><span class="annot"><span class="annottext">SValue r -&gt; GenState (SValue r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; GenState (SValue r))
-&gt; SValue r -&gt; GenState (SValue r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SVariable r -&gt; SValue r
forall (r :: * -&gt; *). VariableValue r =&gt; SVariable r -&gt; SValue r
</span><span class="hs-identifier hs-var">valueOf</span></span><span> </span><span class="annot"><span class="annottext">SVariable r
</span><a href="#local-6989586621679360004"><span class="hs-identifier hs-var">varSet</span></a></span><span>
</span><span id="line-1078"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Variable</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; GenState (SValue r)
forall a. HasCallStack =&gt; Name -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;convExpr: Variable&quot;</span></span><span>
</span><span id="line-1079"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Operator</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; GenState (SValue r)
forall a. HasCallStack =&gt; Name -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;convExprProc: Operator&quot;</span></span><span>
</span><span id="line-1080"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RealI</span></span><span> </span><span id="local-6989586621679360005"><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679360005"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679360006"><span class="annot"><span class="annottext">RealInterval CodeExpr CodeExpr
</span><a href="#local-6989586621679360006"><span class="hs-identifier hs-var">ri</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1081"></span><span>  </span><span id="local-6989586621679360007"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679360007"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-1082"></span><span>  </span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">(CodeExpr -&gt; GenState (SValue r))
-&gt; CodeExpr -&gt; GenState (SValue r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DefinedQuantityDict -&gt; RealInterval CodeExpr CodeExpr -&gt; CodeExpr
forall c.
(HasUID c, HasSymbol c) =&gt;
c -&gt; RealInterval CodeExpr CodeExpr -&gt; CodeExpr
</span><a href="Language.Drasil.Code.Imperative.Import.html#renderRealInt"><span class="hs-identifier hs-var">renderRealInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrasilState -&gt; UID -&gt; DefinedQuantityDict
</span><a href="Language.Drasil.Code.Imperative.Helpers.html#lookupC"><span class="hs-identifier hs-var">lookupC</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679360007"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679360005"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">RealInterval CodeExpr CodeExpr
</span><a href="#local-6989586621679360006"><span class="hs-identifier hs-var">ri</span></a></span><span>
</span><span id="line-1083"></span><span>
</span><span id="line-1084"></span><span class="hs-comment">-- | Generates a function call, based on the 'UID' of the chunk representing</span><span>
</span><span id="line-1085"></span><span class="hs-comment">-- the function, the list of argument 'Expr's, the list of named argument 'Expr's,</span><span>
</span><span id="line-1086"></span><span class="hs-comment">-- the function call generator to use, and the library version of the function</span><span>
</span><span id="line-1087"></span><span class="hs-comment">-- call generator (used if the function is in the library export map).</span><span>
</span><span id="line-1088"></span><span id="local-6989586621679354016"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convCallProc"><span class="hs-identifier hs-type">convCallProc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679354016"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">CodeExpr</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CodeExpr</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1089"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VSType</span></span><span> </span><span class="annot"><a href="#local-6989586621679354016"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679354016"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NamedArgs</span></span><span> </span><span class="annot"><a href="#local-6989586621679354016"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1090"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679354016"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VSType</span></span><span> </span><span class="annot"><a href="#local-6989586621679354016"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679354016"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1091"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NamedArgs</span></span><span> </span><span class="annot"><a href="#local-6989586621679354016"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679354016"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679354016"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-1092"></span><span id="convCallProc"><span class="annot"><span class="annottext">convCallProc :: forall (r :: * -&gt; *).
SharedProg r =&gt;
UID
-&gt; [CodeExpr]
-&gt; [(UID, CodeExpr)]
-&gt; (Name
    -&gt; Name
    -&gt; VSType r
    -&gt; [SValue r]
    -&gt; NamedArgs r
    -&gt; GenState (SValue r))
-&gt; (Name
    -&gt; Name -&gt; VSType r -&gt; [SValue r] -&gt; NamedArgs r -&gt; SValue r)
-&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convCallProc"><span class="hs-identifier hs-var hs-var">convCallProc</span></a></span></span><span> </span><span id="local-6989586621679360041"><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679360041"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679360042"><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679360042"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679360043"><span class="annot"><span class="annottext">[(UID, CodeExpr)]
</span><a href="#local-6989586621679360043"><span class="hs-identifier hs-var">ns</span></a></span></span><span> </span><span id="local-6989586621679360044"><span class="annot"><span class="annottext">Name
-&gt; Name
-&gt; VSType r
-&gt; [SValue r]
-&gt; NamedArgs r
-&gt; GenState (SValue r)
</span><a href="#local-6989586621679360044"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679360045"><span class="annot"><span class="annottext">Name -&gt; Name -&gt; VSType r -&gt; [SValue r] -&gt; NamedArgs r -&gt; SValue r
</span><a href="#local-6989586621679360045"><span class="hs-identifier hs-var">libf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1093"></span><span>  </span><span id="local-6989586621679360046"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679360046"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-1094"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360049"><span class="annot"><span class="annottext">info :: ChunkDB
</span><a href="#local-6989586621679360049"><span class="hs-identifier hs-var hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; CodeSpec
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#codeSpec"><span class="hs-identifier hs-var">codeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679360046"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">CodeSpec -&gt; Getting ChunkDB CodeSpec ChunkDB -&gt; ChunkDB
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting ChunkDB CodeSpec ChunkDB
forall c. HasOldCodeSpec c =&gt; Lens' c ChunkDB
Lens' CodeSpec ChunkDB
</span><a href="Language.Drasil.CodeSpec.html#systemdbO"><span class="hs-identifier hs-var">systemdbO</span></a></span><span>
</span><span id="line-1095"></span><span>      </span><span id="local-6989586621679360050"><span class="annot"><span class="annottext">mem :: Map Name Name
</span><a href="#local-6989586621679360050"><span class="hs-identifier hs-var hs-var">mem</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; Map Name Name
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#eMap"><span class="hs-identifier hs-var">eMap</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679360046"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-1096"></span><span>      </span><span id="local-6989586621679360051"><span class="annot"><span class="annottext">lem :: Map Name Name
</span><a href="#local-6989586621679360051"><span class="hs-identifier hs-var hs-var">lem</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; Map Name Name
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#libEMap"><span class="hs-identifier hs-var">libEMap</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679360046"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-1097"></span><span>      </span><span id="local-6989586621679360058"><span class="annot"><span class="annottext">funcCd :: CodeFuncChunk
</span><a href="#local-6989586621679360058"><span class="hs-identifier hs-var hs-var">funcCd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DefinedQuantityDict -&gt; CodeFuncChunk
forall c.
(Quantity c, MayHaveUnit c, Concept c) =&gt;
c -&gt; CodeFuncChunk
</span><a href="Language.Drasil.Chunk.CodeBase.html#quantfunc"><span class="hs-identifier hs-var">quantfunc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB -&gt; UID -&gt; DefinedQuantityDict
</span><span class="hs-identifier hs-var">symbResolve</span></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679360049"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679360041"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1098"></span><span>      </span><span id="local-6989586621679360060"><span class="annot"><span class="annottext">funcNm :: Name
</span><a href="#local-6989586621679360060"><span class="hs-identifier hs-var hs-var">funcNm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CodeFuncChunk -&gt; Name
forall c. CodeIdea c =&gt; c -&gt; Name
</span><span class="hs-identifier hs-var">codeName</span></span><span> </span><span class="annot"><span class="annottext">CodeFuncChunk
</span><a href="#local-6989586621679360058"><span class="hs-identifier hs-var">funcCd</span></a></span><span>
</span><span id="line-1099"></span><span>  </span><span id="local-6989586621679360061"><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679360061"><span class="hs-identifier hs-var">funcTp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeFuncChunk -&gt; GenState CodeType
forall c. HasSpace c =&gt; c -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#codeType"><span class="hs-identifier hs-var">codeType</span></a></span><span> </span><span class="annot"><span class="annottext">CodeFuncChunk
</span><a href="#local-6989586621679360058"><span class="hs-identifier hs-var">funcCd</span></a></span><span>
</span><span id="line-1100"></span><span>  </span><span id="local-6989586621679360062"><span class="annot"><span class="annottext">[SValue r]
</span><a href="#local-6989586621679360062"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(CodeExpr -&gt; GenState (SValue r))
-&gt; [CodeExpr] -&gt; StateT DrasilState Identity [SValue r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679360042"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1101"></span><span>  </span><span id="local-6989586621679360063"><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679360063"><span class="hs-identifier hs-var">nms</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((UID, CodeExpr)
 -&gt; StateT DrasilState Identity (VS (r (Variable r))))
-&gt; [(UID, CodeExpr)]
-&gt; StateT DrasilState Identity [VS (r (Variable r))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input -&gt; StateT DrasilState Identity (VS (r (Variable r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVarProc"><span class="hs-identifier hs-var">mkVarProc</span></a></span><span> </span><span class="annot"><span class="annottext">(Input -&gt; StateT DrasilState Identity (VS (r (Variable r))))
-&gt; ((UID, CodeExpr) -&gt; Input)
-&gt; (UID, CodeExpr)
-&gt; StateT DrasilState Identity (VS (r (Variable r)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DefinedQuantityDict -&gt; Input
forall c. (Quantity c, MayHaveUnit c, Concept c) =&gt; c -&gt; Input
</span><a href="Language.Drasil.Chunk.CodeBase.html#quantvar"><span class="hs-identifier hs-var">quantvar</span></a></span><span> </span><span class="annot"><span class="annottext">(DefinedQuantityDict -&gt; Input)
-&gt; ((UID, CodeExpr) -&gt; DefinedQuantityDict)
-&gt; (UID, CodeExpr)
-&gt; Input
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ChunkDB -&gt; UID -&gt; DefinedQuantityDict
</span><span class="hs-identifier hs-var">symbResolve</span></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679360049"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">(UID -&gt; DefinedQuantityDict)
-&gt; ((UID, CodeExpr) -&gt; UID)
-&gt; (UID, CodeExpr)
-&gt; DefinedQuantityDict
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(UID, CodeExpr) -&gt; UID
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(UID, CodeExpr)]
</span><a href="#local-6989586621679360043"><span class="hs-identifier hs-var">ns</span></a></span><span>
</span><span id="line-1102"></span><span>  </span><span id="local-6989586621679360064"><span class="annot"><span class="annottext">[SValue r]
</span><a href="#local-6989586621679360064"><span class="hs-identifier hs-var">nargs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((UID, CodeExpr) -&gt; GenState (SValue r))
-&gt; [(UID, CodeExpr)] -&gt; StateT DrasilState Identity [SValue r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (SValue r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">(CodeExpr -&gt; GenState (SValue r))
-&gt; ((UID, CodeExpr) -&gt; CodeExpr)
-&gt; (UID, CodeExpr)
-&gt; GenState (SValue r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(UID, CodeExpr) -&gt; CodeExpr
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(UID, CodeExpr)]
</span><a href="#local-6989586621679360043"><span class="hs-identifier hs-var">ns</span></a></span><span>
</span><span id="line-1103"></span><span>  </span><span class="annot"><span class="annottext">GenState (SValue r)
-&gt; (Name -&gt; GenState (SValue r))
-&gt; Maybe Name
-&gt; GenState (SValue r)
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenState (SValue r)
-&gt; (Name -&gt; GenState (SValue r))
-&gt; Maybe Name
-&gt; GenState (SValue r)
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; GenState (SValue r)
forall a. HasCallStack =&gt; Name -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; GenState (SValue r)) -&gt; Name -&gt; GenState (SValue r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Call to non-existent function &quot;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679360060"><span class="hs-identifier hs-var">funcNm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1104"></span><span>      </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679360065"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679360065"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; GenState (SValue r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; GenState (SValue r))
-&gt; SValue r -&gt; GenState (SValue r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; VSType r -&gt; [SValue r] -&gt; NamedArgs r -&gt; SValue r
</span><a href="#local-6989586621679360045"><span class="hs-identifier hs-var">libf</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679360065"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679360060"><span class="hs-identifier hs-var">funcNm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeType -&gt; VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; CodeType -&gt; VSType r
</span><span class="hs-identifier hs-var">convType</span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679360061"><span class="hs-identifier hs-var">funcTp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[SValue r]
</span><a href="#local-6989586621679360062"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[VS (r (Variable r))] -&gt; [SValue r] -&gt; NamedArgs r
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679360063"><span class="hs-identifier hs-var">nms</span></a></span><span> </span><span class="annot"><span class="annottext">[SValue r]
</span><a href="#local-6989586621679360064"><span class="hs-identifier hs-var">nargs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1105"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Map Name Name -&gt; Maybe Name
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679360060"><span class="hs-identifier hs-var">funcNm</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name Name
</span><a href="#local-6989586621679360051"><span class="hs-identifier hs-var">lem</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1106"></span><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679360066"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679360066"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; Name
-&gt; VSType r
-&gt; [SValue r]
-&gt; NamedArgs r
-&gt; GenState (SValue r)
</span><a href="#local-6989586621679360044"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679360066"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679360060"><span class="hs-identifier hs-var">funcNm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeType -&gt; VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; CodeType -&gt; VSType r
</span><span class="hs-identifier hs-var">convType</span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679360061"><span class="hs-identifier hs-var">funcTp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[SValue r]
</span><a href="#local-6989586621679360062"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[VS (r (Variable r))] -&gt; [SValue r] -&gt; NamedArgs r
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[VS (r (Variable r))]
</span><a href="#local-6989586621679360063"><span class="hs-identifier hs-var">nms</span></a></span><span> </span><span class="annot"><span class="annottext">[SValue r]
</span><a href="#local-6989586621679360064"><span class="hs-identifier hs-var">nargs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1107"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Map Name Name -&gt; Maybe Name
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679360060"><span class="hs-identifier hs-var">funcNm</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name Name
</span><a href="#local-6989586621679360050"><span class="hs-identifier hs-var">mem</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1108"></span><span>
</span><span id="line-1109"></span><span class="annot"><span class="hs-comment">-- | Converts a 'FuncStmt' to a GOOL Statement.</span></span><span>
</span><span id="line-1110"></span><span id="local-6989586621679353991"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmtProc"><span class="hs-identifier hs-type">convStmtProc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353991"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#FuncStmt"><span class="hs-identifier hs-type">FuncStmt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MSStatement</span></span><span> </span><span class="annot"><a href="#local-6989586621679353991"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-1111"></span><span id="convStmtProc"><span class="annot"><span class="annottext">convStmtProc :: forall (r :: * -&gt; *).
SharedProg r =&gt;
FuncStmt -&gt; GenState (MSStatement r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convStmtProc"><span class="hs-identifier hs-var hs-var">convStmtProc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FAsg"><span class="hs-identifier hs-type">FAsg</span></a></span><span> </span><span id="local-6989586621679360282"><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679360282"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Matrix</span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679360283"><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679360283"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1112"></span><span>  </span><span id="local-6989586621679360284"><span class="annot"><span class="annottext">[VS (r (Value r))]
</span><a href="#local-6989586621679360284"><span class="hs-identifier hs-var">els</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r))))
-&gt; [CodeExpr] -&gt; StateT DrasilState Identity [VS (r (Value r))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679360283"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-1113"></span><span>  </span><span id="local-6989586621679360285"><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679360285"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input
-&gt; StateT
     DrasilState Identity (StateT ValueState Identity (r (Variable r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVarProc"><span class="hs-identifier hs-var">mkVarProc</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679360282"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-1114"></span><span>  </span><span id="local-6989586621679360286"><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679360286"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input -&gt; GenState CodeType
forall c. HasSpace c =&gt; c -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#codeType"><span class="hs-identifier hs-var">codeType</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679360282"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-1115"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360296"><span class="annot"><span class="annottext">listFunc :: CodeType -&gt; VSType r -&gt; [SValue r] -&gt; SValue r
</span><a href="#local-6989586621679360296"><span class="hs-identifier hs-var hs-var">listFunc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">C.List</span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VSType r -&gt; [SValue r] -&gt; SValue r
forall (r :: * -&gt; *).
Literal r =&gt;
VSType r -&gt; [SValue r] -&gt; SValue r
</span><span class="hs-identifier hs-var">litList</span></span><span>
</span><span id="line-1116"></span><span>      </span><span class="annot"><a href="#local-6989586621679360296"><span class="hs-identifier hs-var">listFunc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">C.Array</span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VSType r -&gt; [SValue r] -&gt; SValue r
forall (r :: * -&gt; *).
Literal r =&gt;
VSType r -&gt; [SValue r] -&gt; SValue r
</span><span class="hs-identifier hs-var">litArray</span></span><span>
</span><span id="line-1117"></span><span>      </span><span class="annot"><a href="#local-6989586621679360296"><span class="hs-identifier hs-var">listFunc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; VSType r -&gt; [SValue r] -&gt; SValue r
forall a. HasCallStack =&gt; Name -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Type mismatch between variable and value in assignment FuncStmt&quot;</span></span><span>
</span><span id="line-1118"></span><span>  </span><span id="local-6989586621679360297"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679360297"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
-&gt; StateT DrasilState Identity [MSStatement r]
forall (r :: * -&gt; *).
SharedProg r =&gt;
SVariable r -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Logging.html#maybeLog"><span class="hs-identifier hs-var">maybeLog</span></a></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679360285"><span class="hs-identifier hs-var">v'</span></a></span><span>
</span><span id="line-1119"></span><span>  </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; GenState (MSStatement r))
-&gt; MSStatement r -&gt; GenState (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSStatement r
forall (r :: * -&gt; *).
StatementSym r =&gt;
[MSStatement r] -&gt; MSStatement r
</span><span class="hs-identifier hs-var">multi</span></span><span> </span><span class="annot"><span class="annottext">([MSStatement r] -&gt; MSStatement r)
-&gt; [MSStatement r] -&gt; MSStatement r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
-&gt; VS (r (Value r)) -&gt; MSStatement r
forall (r :: * -&gt; *).
AssignStatement r =&gt;
SVariable r -&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">assign</span></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679360285"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeType
-&gt; VS (r (Type r)) -&gt; [VS (r (Value r))] -&gt; VS (r (Value r))
forall {r :: * -&gt; *}.
Literal r =&gt;
CodeType -&gt; VSType r -&gt; [SValue r] -&gt; SValue r
</span><a href="#local-6989586621679360296"><span class="hs-identifier hs-var">listFunc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679360286"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VS (r (Type r)) -&gt; VS (r (Type r))
forall (r :: * -&gt; *). TypeSym r =&gt; VSType r -&gt; VSType r
</span><span class="hs-identifier hs-var">listInnerType</span></span><span> </span><span class="annot"><span class="annottext">(VS (r (Type r)) -&gt; VS (r (Type r)))
-&gt; VS (r (Type r)) -&gt; VS (r (Type r))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(r (Variable r) -&gt; r (Type r))
-&gt; StateT ValueState Identity (r (Variable r)) -&gt; VS (r (Type r))
forall a b.
(a -&gt; b)
-&gt; StateT ValueState Identity a -&gt; StateT ValueState Identity b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">r (Variable r) -&gt; r (Type r)
forall (r :: * -&gt; *).
VariableElim r =&gt;
r (Variable r) -&gt; r (Type r)
</span><span class="hs-identifier hs-var">variableType</span></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679360285"><span class="hs-identifier hs-var">v'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1120"></span><span>    </span><span class="annot"><span class="annottext">[VS (r (Value r))]
</span><a href="#local-6989586621679360284"><span class="hs-identifier hs-var">els</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MSStatement r -&gt; [MSStatement r] -&gt; [MSStatement r]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679360297"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-1121"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmtProc"><span class="hs-identifier hs-var">convStmtProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FAsg"><span class="hs-identifier hs-type">FAsg</span></a></span><span> </span><span id="local-6989586621679360298"><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679360298"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679360299"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679360299"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1122"></span><span>  </span><span id="local-6989586621679360300"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679360300"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679360299"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1123"></span><span>  </span><span id="local-6989586621679360301"><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679360301"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input
-&gt; StateT
     DrasilState Identity (StateT ValueState Identity (r (Variable r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVarProc"><span class="hs-identifier hs-var">mkVarProc</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679360298"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-1124"></span><span>  </span><span id="local-6989586621679360302"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679360302"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
-&gt; StateT DrasilState Identity [MSStatement r]
forall (r :: * -&gt; *).
SharedProg r =&gt;
SVariable r -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Logging.html#maybeLog"><span class="hs-identifier hs-var">maybeLog</span></a></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679360301"><span class="hs-identifier hs-var">v'</span></a></span><span>
</span><span id="line-1125"></span><span>  </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; GenState (MSStatement r))
-&gt; MSStatement r -&gt; GenState (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSStatement r
forall (r :: * -&gt; *).
StatementSym r =&gt;
[MSStatement r] -&gt; MSStatement r
</span><span class="hs-identifier hs-var">multi</span></span><span> </span><span class="annot"><span class="annottext">([MSStatement r] -&gt; MSStatement r)
-&gt; [MSStatement r] -&gt; MSStatement r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
-&gt; VS (r (Value r)) -&gt; MSStatement r
forall (r :: * -&gt; *).
AssignStatement r =&gt;
SVariable r -&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">assign</span></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679360301"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679360300"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="annot"><span class="annottext">MSStatement r -&gt; [MSStatement r] -&gt; [MSStatement r]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679360302"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-1126"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmtProc"><span class="hs-identifier hs-var">convStmtProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FAsgIndex"><span class="hs-identifier hs-type">FAsgIndex</span></a></span><span> </span><span id="local-6989586621679360303"><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679360303"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679360304"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679360304"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679360305"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679360305"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1127"></span><span>  </span><span id="local-6989586621679360306"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679360306"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679360305"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1128"></span><span>  </span><span id="local-6989586621679360307"><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679360307"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input
-&gt; StateT
     DrasilState Identity (StateT ValueState Identity (r (Variable r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVarProc"><span class="hs-identifier hs-var">mkVarProc</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679360303"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-1129"></span><span>  </span><span id="local-6989586621679360308"><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679360308"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input -&gt; GenState CodeType
forall c. HasSpace c =&gt; c -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#codeType"><span class="hs-identifier hs-var">codeType</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679360303"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-1130"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360333"><span class="annot"><span class="annottext">asgFunc :: CodeType -&gt; MSStatement r
</span><a href="#local-6989586621679360333"><span class="hs-identifier hs-var hs-var">asgFunc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">C.List</span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VS (r (Value r)) -&gt; MSStatement r
forall (r :: * -&gt; *). StatementSym r =&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">valStmt</span></span><span> </span><span class="annot"><span class="annottext">(VS (r (Value r)) -&gt; MSStatement r)
-&gt; VS (r (Value r)) -&gt; MSStatement r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
-&gt; VS (r (Value r)) -&gt; VS (r (Value r)) -&gt; VS (r (Value r))
forall (r :: * -&gt; *).
List r =&gt;
SValue r -&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-identifier hs-var">listSet</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r)) -&gt; VS (r (Value r))
forall (r :: * -&gt; *). VariableValue r =&gt; SVariable r -&gt; SValue r
</span><span class="hs-identifier hs-var">valueOf</span></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679360307"><span class="hs-identifier hs-var">v'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; VS (r (Value r))
forall (r :: * -&gt; *). Literal r =&gt; Integer -&gt; SValue r
</span><span class="hs-identifier hs-var">litInt</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679360304"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679360306"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-1131"></span><span>      </span><span class="annot"><a href="#local-6989586621679360333"><span class="hs-identifier hs-var">asgFunc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">C.Array</span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
-&gt; VS (r (Value r)) -&gt; MSStatement r
forall (r :: * -&gt; *).
AssignStatement r =&gt;
SVariable r -&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">assign</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
-&gt; StateT ValueState Identity (r (Variable r))
-&gt; StateT ValueState Identity (r (Variable r))
forall (r :: * -&gt; *).
VariableSym r =&gt;
Integer -&gt; SVariable r -&gt; SVariable r
</span><span class="hs-identifier hs-var">arrayElem</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679360304"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679360307"><span class="hs-identifier hs-var">v'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679360306"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-1132"></span><span>      </span><span class="annot"><a href="#local-6989586621679360333"><span class="hs-identifier hs-var">asgFunc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; MSStatement r
forall a. HasCallStack =&gt; Name -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;FAsgIndex used with non-indexed value&quot;</span></span><span>
</span><span id="line-1133"></span><span>      </span><span id="local-6989586621679360336"><span class="annot"><span class="annottext">vi :: StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679360336"><span class="hs-identifier hs-var hs-var">vi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
-&gt; StateT ValueState Identity (r (Variable r))
-&gt; StateT ValueState Identity (r (Variable r))
forall (r :: * -&gt; *).
VariableSym r =&gt;
Integer -&gt; SVariable r -&gt; SVariable r
</span><span class="hs-identifier hs-var">arrayElem</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679360304"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679360307"><span class="hs-identifier hs-var">v'</span></a></span><span>
</span><span id="line-1134"></span><span>  </span><span id="local-6989586621679360337"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679360337"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
-&gt; StateT DrasilState Identity [MSStatement r]
forall (r :: * -&gt; *).
SharedProg r =&gt;
SVariable r -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Logging.html#maybeLog"><span class="hs-identifier hs-var">maybeLog</span></a></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679360336"><span class="hs-identifier hs-var">vi</span></a></span><span>
</span><span id="line-1135"></span><span>  </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; GenState (MSStatement r))
-&gt; MSStatement r -&gt; GenState (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSStatement r
forall (r :: * -&gt; *).
StatementSym r =&gt;
[MSStatement r] -&gt; MSStatement r
</span><span class="hs-identifier hs-var">multi</span></span><span> </span><span class="annot"><span class="annottext">([MSStatement r] -&gt; MSStatement r)
-&gt; [MSStatement r] -&gt; MSStatement r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CodeType -&gt; MSStatement r
</span><a href="#local-6989586621679360333"><span class="hs-identifier hs-var">asgFunc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679360308"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">MSStatement r -&gt; [MSStatement r] -&gt; [MSStatement r]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679360337"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-1136"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmtProc"><span class="hs-identifier hs-var">convStmtProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FFor"><span class="hs-identifier hs-type">FFor</span></a></span><span> </span><span id="local-6989586621679360338"><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679360338"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679360339"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679360339"><span class="hs-identifier hs-var">start</span></a></span></span><span> </span><span id="local-6989586621679360340"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679360340"><span class="hs-identifier hs-var">end</span></a></span></span><span> </span><span id="local-6989586621679360341"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679360341"><span class="hs-identifier hs-var">step</span></a></span></span><span> </span><span id="local-6989586621679360342"><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679360342"><span class="hs-identifier hs-var">st</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1137"></span><span>  </span><span id="local-6989586621679360343"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679360343"><span class="hs-identifier hs-var">stmts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FuncStmt -&gt; GenState (MSStatement r))
-&gt; [FuncStmt] -&gt; StateT DrasilState Identity [MSStatement r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">FuncStmt -&gt; GenState (MSStatement r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
FuncStmt -&gt; GenState (MSStatement r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convStmtProc"><span class="hs-identifier hs-var">convStmtProc</span></a></span><span> </span><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679360342"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-1138"></span><span>  </span><span id="local-6989586621679360344"><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679360344"><span class="hs-identifier hs-var">vari</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input
-&gt; StateT
     DrasilState Identity (StateT ValueState Identity (r (Variable r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVarProc"><span class="hs-identifier hs-var">mkVarProc</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679360338"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-1139"></span><span>  </span><span id="local-6989586621679360345"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679360345"><span class="hs-identifier hs-var">start'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679360339"><span class="hs-identifier hs-var">start</span></a></span><span>
</span><span id="line-1140"></span><span>  </span><span id="local-6989586621679360346"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679360346"><span class="hs-identifier hs-var">end'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679360340"><span class="hs-identifier hs-var">end</span></a></span><span>
</span><span id="line-1141"></span><span>  </span><span id="local-6989586621679360347"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679360347"><span class="hs-identifier hs-var">step'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679360341"><span class="hs-identifier hs-var">step</span></a></span><span>
</span><span id="line-1142"></span><span>  </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; GenState (MSStatement r))
-&gt; MSStatement r -&gt; GenState (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
-&gt; VS (r (Value r))
-&gt; VS (r (Value r))
-&gt; VS (r (Value r))
-&gt; MSBody r
-&gt; MSStatement r
forall (r :: * -&gt; *).
ControlStatement r =&gt;
SVariable r
-&gt; SValue r -&gt; SValue r -&gt; SValue r -&gt; MSBody r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">forRange</span></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679360344"><span class="hs-identifier hs-var">vari</span></a></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679360345"><span class="hs-identifier hs-var">start'</span></a></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679360346"><span class="hs-identifier hs-var">end'</span></a></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679360347"><span class="hs-identifier hs-var">step'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSBody r
forall (r :: * -&gt; *). BodySym r =&gt; [MSStatement r] -&gt; MSBody r
</span><span class="hs-identifier hs-var">bodyStatements</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679360343"><span class="hs-identifier hs-var">stmts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1143"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmtProc"><span class="hs-identifier hs-var">convStmtProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FForEach"><span class="hs-identifier hs-type">FForEach</span></a></span><span> </span><span id="local-6989586621679360348"><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679360348"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679360349"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679360349"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679360350"><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679360350"><span class="hs-identifier hs-var">st</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1144"></span><span>  </span><span id="local-6989586621679360351"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679360351"><span class="hs-identifier hs-var">stmts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FuncStmt -&gt; GenState (MSStatement r))
-&gt; [FuncStmt] -&gt; StateT DrasilState Identity [MSStatement r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">FuncStmt -&gt; GenState (MSStatement r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
FuncStmt -&gt; GenState (MSStatement r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convStmtProc"><span class="hs-identifier hs-var">convStmtProc</span></a></span><span> </span><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679360350"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-1145"></span><span>  </span><span id="local-6989586621679360352"><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679360352"><span class="hs-identifier hs-var">vari</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input
-&gt; StateT
     DrasilState Identity (StateT ValueState Identity (r (Variable r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVarProc"><span class="hs-identifier hs-var">mkVarProc</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679360348"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-1146"></span><span>  </span><span id="local-6989586621679360353"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679360353"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679360349"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1147"></span><span>  </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; GenState (MSStatement r))
-&gt; MSStatement r -&gt; GenState (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
-&gt; VS (r (Value r)) -&gt; MSBody r -&gt; MSStatement r
forall (r :: * -&gt; *).
ControlStatement r =&gt;
SVariable r -&gt; SValue r -&gt; MSBody r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">forEach</span></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679360352"><span class="hs-identifier hs-var">vari</span></a></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679360353"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSBody r
forall (r :: * -&gt; *). BodySym r =&gt; [MSStatement r] -&gt; MSBody r
</span><span class="hs-identifier hs-var">bodyStatements</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679360351"><span class="hs-identifier hs-var">stmts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1148"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmtProc"><span class="hs-identifier hs-var">convStmtProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FWhile"><span class="hs-identifier hs-type">FWhile</span></a></span><span> </span><span id="local-6989586621679360354"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679360354"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679360355"><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679360355"><span class="hs-identifier hs-var">st</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1149"></span><span>  </span><span id="local-6989586621679360356"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679360356"><span class="hs-identifier hs-var">stmts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FuncStmt -&gt; GenState (MSStatement r))
-&gt; [FuncStmt] -&gt; StateT DrasilState Identity [MSStatement r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">FuncStmt -&gt; GenState (MSStatement r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
FuncStmt -&gt; GenState (MSStatement r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convStmtProc"><span class="hs-identifier hs-var">convStmtProc</span></a></span><span> </span><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679360355"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-1150"></span><span>  </span><span id="local-6989586621679360357"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679360357"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679360354"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1151"></span><span>  </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; GenState (MSStatement r))
-&gt; MSStatement r -&gt; GenState (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r)) -&gt; MSBody r -&gt; MSStatement r
forall (r :: * -&gt; *).
ControlStatement r =&gt;
SValue r -&gt; MSBody r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">while</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679360357"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSBody r
forall (r :: * -&gt; *). BodySym r =&gt; [MSStatement r] -&gt; MSBody r
</span><span class="hs-identifier hs-var">bodyStatements</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679360356"><span class="hs-identifier hs-var">stmts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1152"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmtProc"><span class="hs-identifier hs-var">convStmtProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FCond"><span class="hs-identifier hs-type">FCond</span></a></span><span> </span><span id="local-6989586621679360358"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679360358"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679360359"><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679360359"><span class="hs-identifier hs-var">tSt</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1153"></span><span>  </span><span id="local-6989586621679360360"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679360360"><span class="hs-identifier hs-var">stmts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FuncStmt -&gt; GenState (MSStatement r))
-&gt; [FuncStmt] -&gt; StateT DrasilState Identity [MSStatement r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">FuncStmt -&gt; GenState (MSStatement r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
FuncStmt -&gt; GenState (MSStatement r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convStmtProc"><span class="hs-identifier hs-var">convStmtProc</span></a></span><span> </span><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679360359"><span class="hs-identifier hs-var">tSt</span></a></span><span>
</span><span id="line-1154"></span><span>  </span><span id="local-6989586621679360361"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679360361"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679360358"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1155"></span><span>  </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; GenState (MSStatement r))
-&gt; MSStatement r -&gt; GenState (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(VS (r (Value r)), MSBody r)] -&gt; MSStatement r
forall (r :: * -&gt; *).
ControlStatement r =&gt;
[(SValue r, MSBody r)] -&gt; MSStatement r
</span><span class="hs-identifier hs-var">ifNoElse</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679360361"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSBody r
forall (r :: * -&gt; *). BodySym r =&gt; [MSStatement r] -&gt; MSBody r
</span><span class="hs-identifier hs-var">bodyStatements</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679360360"><span class="hs-identifier hs-var">stmts</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1156"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmtProc"><span class="hs-identifier hs-var">convStmtProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FCond"><span class="hs-identifier hs-type">FCond</span></a></span><span> </span><span id="local-6989586621679360362"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679360362"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679360363"><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679360363"><span class="hs-identifier hs-var">tSt</span></a></span></span><span> </span><span id="local-6989586621679360364"><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679360364"><span class="hs-identifier hs-var">eSt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1157"></span><span>  </span><span id="local-6989586621679360365"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679360365"><span class="hs-identifier hs-var">stmt1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FuncStmt -&gt; GenState (MSStatement r))
-&gt; [FuncStmt] -&gt; StateT DrasilState Identity [MSStatement r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">FuncStmt -&gt; GenState (MSStatement r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
FuncStmt -&gt; GenState (MSStatement r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convStmtProc"><span class="hs-identifier hs-var">convStmtProc</span></a></span><span> </span><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679360363"><span class="hs-identifier hs-var">tSt</span></a></span><span>
</span><span id="line-1158"></span><span>  </span><span id="local-6989586621679360366"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679360366"><span class="hs-identifier hs-var">stmt2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FuncStmt -&gt; GenState (MSStatement r))
-&gt; [FuncStmt] -&gt; StateT DrasilState Identity [MSStatement r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">FuncStmt -&gt; GenState (MSStatement r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
FuncStmt -&gt; GenState (MSStatement r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convStmtProc"><span class="hs-identifier hs-var">convStmtProc</span></a></span><span> </span><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679360364"><span class="hs-identifier hs-var">eSt</span></a></span><span>
</span><span id="line-1159"></span><span>  </span><span id="local-6989586621679360367"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679360367"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679360362"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1160"></span><span>  </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; GenState (MSStatement r))
-&gt; MSStatement r -&gt; GenState (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(VS (r (Value r)), MSBody r)] -&gt; MSBody r -&gt; MSStatement r
forall (r :: * -&gt; *).
ControlStatement r =&gt;
[(SValue r, MSBody r)] -&gt; MSBody r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">ifCond</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679360367"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSBody r
forall (r :: * -&gt; *). BodySym r =&gt; [MSStatement r] -&gt; MSBody r
</span><span class="hs-identifier hs-var">bodyStatements</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679360365"><span class="hs-identifier hs-var">stmt1</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSBody r
forall (r :: * -&gt; *). BodySym r =&gt; [MSStatement r] -&gt; MSBody r
</span><span class="hs-identifier hs-var">bodyStatements</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679360366"><span class="hs-identifier hs-var">stmt2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1161"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmtProc"><span class="hs-identifier hs-var">convStmtProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FRet"><span class="hs-identifier hs-type">FRet</span></a></span><span> </span><span id="local-6989586621679360368"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679360368"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1162"></span><span>  </span><span id="local-6989586621679360369"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679360369"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679360368"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1163"></span><span>  </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; GenState (MSStatement r))
-&gt; MSStatement r -&gt; GenState (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r)) -&gt; MSStatement r
forall (r :: * -&gt; *).
ControlStatement r =&gt;
SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">returnStmt</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679360369"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-1164"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmtProc"><span class="hs-identifier hs-var">convStmtProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FThrow"><span class="hs-identifier hs-type">FThrow</span></a></span><span> </span><span id="local-6989586621679360370"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679360370"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; GenState (MSStatement r))
-&gt; MSStatement r -&gt; GenState (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; MSStatement r
forall (r :: * -&gt; *). ControlStatement r =&gt; Name -&gt; MSStatement r
</span><span class="hs-identifier hs-var">throw</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679360370"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-1165"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmtProc"><span class="hs-identifier hs-var">convStmtProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FTry"><span class="hs-identifier hs-type">FTry</span></a></span><span> </span><span id="local-6989586621679360371"><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679360371"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679360372"><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679360372"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1166"></span><span>  </span><span id="local-6989586621679360373"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679360373"><span class="hs-identifier hs-var">stmt1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FuncStmt -&gt; GenState (MSStatement r))
-&gt; [FuncStmt] -&gt; StateT DrasilState Identity [MSStatement r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">FuncStmt -&gt; GenState (MSStatement r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
FuncStmt -&gt; GenState (MSStatement r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convStmtProc"><span class="hs-identifier hs-var">convStmtProc</span></a></span><span> </span><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679360371"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1167"></span><span>  </span><span id="local-6989586621679360374"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679360374"><span class="hs-identifier hs-var">stmt2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FuncStmt -&gt; GenState (MSStatement r))
-&gt; [FuncStmt] -&gt; StateT DrasilState Identity [MSStatement r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">FuncStmt -&gt; GenState (MSStatement r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
FuncStmt -&gt; GenState (MSStatement r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convStmtProc"><span class="hs-identifier hs-var">convStmtProc</span></a></span><span> </span><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679360372"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-1168"></span><span>  </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; GenState (MSStatement r))
-&gt; MSStatement r -&gt; GenState (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MSBody r -&gt; MSBody r -&gt; MSStatement r
forall (r :: * -&gt; *).
ControlStatement r =&gt;
MSBody r -&gt; MSBody r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">tryCatch</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSBody r
forall (r :: * -&gt; *). BodySym r =&gt; [MSStatement r] -&gt; MSBody r
</span><span class="hs-identifier hs-var">bodyStatements</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679360373"><span class="hs-identifier hs-var">stmt1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSBody r
forall (r :: * -&gt; *). BodySym r =&gt; [MSStatement r] -&gt; MSBody r
</span><span class="hs-identifier hs-var">bodyStatements</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679360374"><span class="hs-identifier hs-var">stmt2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1169"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmtProc"><span class="hs-identifier hs-var">convStmtProc</span></a></span><span> </span><span class="annot"><span class="annottext">FuncStmt
</span><a href="Language.Drasil.Mod.html#FContinue"><span class="hs-identifier hs-var">FContinue</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">MSStatement r
forall (r :: * -&gt; *). ControlStatement r =&gt; MSStatement r
</span><span class="hs-identifier hs-var">continue</span></span><span>
</span><span id="line-1170"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmtProc"><span class="hs-identifier hs-var">convStmtProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FDecDef"><span class="hs-identifier hs-type">FDecDef</span></a></span><span> </span><span id="local-6989586621679360375"><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679360375"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Matrix</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1171"></span><span>  </span><span id="local-6989586621679360376"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679360376"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-1172"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360505"><span class="annot"><span class="annottext">scp :: r (Scope r)
</span><a href="#local-6989586621679360505"><span class="hs-identifier hs-var hs-var">scp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScopeType -&gt; r (Scope r)
forall (r :: * -&gt; *). SharedProg r =&gt; ScopeType -&gt; r (Scope r)
</span><a href="Language.Drasil.Code.Imperative.Helpers.html#convScope"><span class="hs-identifier hs-var">convScope</span></a></span><span> </span><span class="annot"><span class="annottext">(ScopeType -&gt; r (Scope r)) -&gt; ScopeType -&gt; r (Scope r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; ScopeType
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#currentScope"><span class="hs-identifier hs-var">currentScope</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679360376"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-1173"></span><span>  </span><span id="local-6989586621679360506"><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679360506"><span class="hs-identifier hs-var">vari</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input
-&gt; StateT
     DrasilState Identity (StateT ValueState Identity (r (Variable r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVarProc"><span class="hs-identifier hs-var">mkVarProc</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679360375"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-1174"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360516"><span class="annot"><span class="annottext">convDec :: CodeType -&gt; r (Scope r) -&gt; MSStatement r
</span><a href="#local-6989586621679360516"><span class="hs-identifier hs-var hs-var">convDec</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">C.List</span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
-&gt; StateT ValueState Identity (r (Variable r))
-&gt; r (Scope r)
-&gt; MSStatement r
forall (r :: * -&gt; *).
DeclStatement r =&gt;
Integer -&gt; SVariable r -&gt; r (Scope r) -&gt; MSStatement r
</span><span class="hs-identifier hs-var">listDec</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679360506"><span class="hs-identifier hs-var">vari</span></a></span><span>
</span><span id="line-1175"></span><span>      </span><span class="annot"><a href="#local-6989586621679360516"><span class="hs-identifier hs-var">convDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">C.Array</span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
-&gt; StateT ValueState Identity (r (Variable r))
-&gt; r (Scope r)
-&gt; MSStatement r
forall (r :: * -&gt; *).
DeclStatement r =&gt;
Integer -&gt; SVariable r -&gt; r (Scope r) -&gt; MSStatement r
</span><span class="hs-identifier hs-var">arrayDec</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679360506"><span class="hs-identifier hs-var">vari</span></a></span><span>
</span><span id="line-1176"></span><span>      </span><span class="annot"><a href="#local-6989586621679360516"><span class="hs-identifier hs-var">convDec</span></a></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
-&gt; r (Scope r) -&gt; MSStatement r
forall (r :: * -&gt; *).
DeclStatement r =&gt;
SVariable r -&gt; r (Scope r) -&gt; MSStatement r
</span><span class="hs-identifier hs-var">varDec</span></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679360506"><span class="hs-identifier hs-var">vari</span></a></span><span>
</span><span id="line-1177"></span><span>  </span><span class="annot"><span class="annottext">(CodeType -&gt; MSStatement r)
-&gt; GenState CodeType -&gt; GenState (MSStatement r)
forall a b.
(a -&gt; b)
-&gt; StateT DrasilState Identity a -&gt; StateT DrasilState Identity b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeType -&gt; r (Scope r) -&gt; MSStatement r
</span><a href="#local-6989586621679360516"><span class="hs-operator hs-var">`convDec`</span></a></span><span> </span><span class="annot"><span class="annottext">r (Scope r)
</span><a href="#local-6989586621679360505"><span class="hs-identifier hs-var">scp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input -&gt; GenState CodeType
forall c. HasSpace c =&gt; c -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#codeType"><span class="hs-identifier hs-var">codeType</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679360375"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1178"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmtProc"><span class="hs-identifier hs-var">convStmtProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FDecDef"><span class="hs-identifier hs-type">FDecDef</span></a></span><span> </span><span id="local-6989586621679360517"><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679360517"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679360518"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679360518"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1179"></span><span>  </span><span id="local-6989586621679360519"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679360519"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-1180"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360648"><span class="annot"><span class="annottext">scp :: r (Scope r)
</span><a href="#local-6989586621679360648"><span class="hs-identifier hs-var hs-var">scp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScopeType -&gt; r (Scope r)
forall (r :: * -&gt; *). SharedProg r =&gt; ScopeType -&gt; r (Scope r)
</span><a href="Language.Drasil.Code.Imperative.Helpers.html#convScope"><span class="hs-identifier hs-var">convScope</span></a></span><span> </span><span class="annot"><span class="annottext">(ScopeType -&gt; r (Scope r)) -&gt; ScopeType -&gt; r (Scope r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; ScopeType
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#currentScope"><span class="hs-identifier hs-var">currentScope</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679360519"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-1181"></span><span>  </span><span id="local-6989586621679360649"><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679360649"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input
-&gt; StateT
     DrasilState Identity (StateT ValueState Identity (r (Variable r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVarProc"><span class="hs-identifier hs-var">mkVarProc</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679360517"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-1182"></span><span>  </span><span id="local-6989586621679360650"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679360650"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
-&gt; StateT DrasilState Identity [MSStatement r]
forall (r :: * -&gt; *).
SharedProg r =&gt;
SVariable r -&gt; GenState [MSStatement r]
</span><a href="Language.Drasil.Code.Imperative.Logging.html#maybeLog"><span class="hs-identifier hs-var">maybeLog</span></a></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679360649"><span class="hs-identifier hs-var">v'</span></a></span><span>
</span><span id="line-1183"></span><span>  </span><span id="local-6989586621679360651"><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679360651"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input -&gt; GenState CodeType
forall c. HasSpace c =&gt; c -&gt; GenState CodeType
</span><a href="Language.Drasil.Code.Imperative.Import.html#codeType"><span class="hs-identifier hs-var">codeType</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679360517"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-1184"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360796"><span class="annot"><span class="annottext">convDecDef :: CodeExpr -&gt; GenState (MSStatement r)
</span><a href="#local-6989586621679360796"><span class="hs-identifier hs-var hs-var">convDecDef</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Matrix</span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679360797"><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679360797"><span class="hs-identifier hs-var">lst</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1185"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360814"><span class="annot"><span class="annottext">contDecDef :: CodeType
-&gt; SVariable r -&gt; r (Scope r) -&gt; [SValue r] -&gt; MSStatement r
</span><a href="#local-6989586621679360814"><span class="hs-identifier hs-var hs-var">contDecDef</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">C.List</span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SVariable r -&gt; r (Scope r) -&gt; [SValue r] -&gt; MSStatement r
forall (r :: * -&gt; *).
DeclStatement r =&gt;
SVariable r -&gt; r (Scope r) -&gt; [SValue r] -&gt; MSStatement r
</span><span class="hs-identifier hs-var">listDecDef</span></span><span>
</span><span id="line-1186"></span><span>            </span><span class="annot"><a href="#local-6989586621679360814"><span class="hs-identifier hs-var">contDecDef</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">C.Array</span></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SVariable r -&gt; r (Scope r) -&gt; [SValue r] -&gt; MSStatement r
forall (r :: * -&gt; *).
DeclStatement r =&gt;
SVariable r -&gt; r (Scope r) -&gt; [SValue r] -&gt; MSStatement r
</span><span class="hs-identifier hs-var">arrayDecDef</span></span><span>
</span><span id="line-1187"></span><span>            </span><span class="annot"><a href="#local-6989586621679360814"><span class="hs-identifier hs-var">contDecDef</span></a></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; SVariable r -&gt; r (Scope r) -&gt; [SValue r] -&gt; MSStatement r
forall a. HasCallStack =&gt; Name -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Type mismatch between variable and value in declare-define FuncStmt&quot;</span></span><span>
</span><span id="line-1188"></span><span>        </span><span id="local-6989586621679360815"><span class="annot"><span class="annottext">[VS (r (Value r))]
</span><a href="#local-6989586621679360815"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r))))
-&gt; [CodeExpr] -&gt; StateT DrasilState Identity [VS (r (Value r))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">[CodeExpr]
</span><a href="#local-6989586621679360797"><span class="hs-identifier hs-var">lst</span></a></span><span>
</span><span id="line-1189"></span><span>        </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; GenState (MSStatement r))
-&gt; MSStatement r -&gt; GenState (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CodeType
-&gt; StateT ValueState Identity (r (Variable r))
-&gt; r (Scope r)
-&gt; [VS (r (Value r))]
-&gt; MSStatement r
forall {r :: * -&gt; *}.
DeclStatement r =&gt;
CodeType
-&gt; SVariable r -&gt; r (Scope r) -&gt; [SValue r] -&gt; MSStatement r
</span><a href="#local-6989586621679360814"><span class="hs-identifier hs-var">contDecDef</span></a></span><span> </span><span class="annot"><span class="annottext">CodeType
</span><a href="#local-6989586621679360651"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679360649"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">r (Scope r)
</span><a href="#local-6989586621679360648"><span class="hs-identifier hs-var">scp</span></a></span><span> </span><span class="annot"><span class="annottext">[VS (r (Value r))]
</span><a href="#local-6989586621679360815"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-1190"></span><span>      </span><span class="annot"><a href="#local-6989586621679360796"><span class="hs-identifier hs-var">convDecDef</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1191"></span><span>        </span><span id="local-6989586621679360816"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679360816"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679360518"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1192"></span><span>        </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; GenState (MSStatement r))
-&gt; MSStatement r -&gt; GenState (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
-&gt; r (Scope r) -&gt; VS (r (Value r)) -&gt; MSStatement r
forall (r :: * -&gt; *).
DeclStatement r =&gt;
SVariable r -&gt; r (Scope r) -&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">varDecDef</span></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679360649"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">r (Scope r)
</span><a href="#local-6989586621679360648"><span class="hs-identifier hs-var">scp</span></a></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679360816"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-1193"></span><span>  </span><span id="local-6989586621679360817"><span class="annot"><span class="annottext">MSStatement r
</span><a href="#local-6989586621679360817"><span class="hs-identifier hs-var">dd</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; GenState (MSStatement r)
</span><a href="#local-6989586621679360796"><span class="hs-identifier hs-var">convDecDef</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679360518"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1194"></span><span>  </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; GenState (MSStatement r))
-&gt; MSStatement r -&gt; GenState (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSStatement r
forall (r :: * -&gt; *).
StatementSym r =&gt;
[MSStatement r] -&gt; MSStatement r
</span><span class="hs-identifier hs-var">multi</span></span><span> </span><span class="annot"><span class="annottext">([MSStatement r] -&gt; MSStatement r)
-&gt; [MSStatement r] -&gt; MSStatement r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MSStatement r
</span><a href="#local-6989586621679360817"><span class="hs-identifier hs-var">dd</span></a></span><span> </span><span class="annot"><span class="annottext">MSStatement r -&gt; [MSStatement r] -&gt; [MSStatement r]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679360650"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-1195"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmtProc"><span class="hs-identifier hs-var">convStmtProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FFuncDef"><span class="hs-identifier hs-type">FFuncDef</span></a></span><span> </span><span id="local-6989586621679360818"><span class="annot"><span class="annottext">CodeFuncChunk
</span><a href="#local-6989586621679360818"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679360819"><span class="annot"><span class="annottext">[ParameterChunk]
</span><a href="#local-6989586621679360819"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621679360820"><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679360820"><span class="hs-identifier hs-var">sts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1196"></span><span>  </span><span id="local-6989586621679360821"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679360821"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-1197"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360950"><span class="annot"><span class="annottext">scp :: r (Scope r)
</span><a href="#local-6989586621679360950"><span class="hs-identifier hs-var hs-var">scp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScopeType -&gt; r (Scope r)
forall (r :: * -&gt; *). SharedProg r =&gt; ScopeType -&gt; r (Scope r)
</span><a href="Language.Drasil.Code.Imperative.Helpers.html#convScope"><span class="hs-identifier hs-var">convScope</span></a></span><span> </span><span class="annot"><span class="annottext">(ScopeType -&gt; r (Scope r)) -&gt; ScopeType -&gt; r (Scope r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; ScopeType
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#currentScope"><span class="hs-identifier hs-var">currentScope</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679360821"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-1198"></span><span>  </span><span id="local-6989586621679360951"><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679360951"><span class="hs-identifier hs-var">f'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Input
-&gt; StateT
     DrasilState Identity (StateT ValueState Identity (r (Variable r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVarProc"><span class="hs-identifier hs-var">mkVarProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeFuncChunk -&gt; Input
forall c. (Quantity c, MayHaveUnit c, Concept c) =&gt; c -&gt; Input
</span><a href="Language.Drasil.Chunk.CodeBase.html#quantvar"><span class="hs-identifier hs-var">quantvar</span></a></span><span> </span><span class="annot"><span class="annottext">CodeFuncChunk
</span><a href="#local-6989586621679360818"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1199"></span><span>  </span><span id="local-6989586621679360952"><span class="annot"><span class="annottext">[StateT ValueState Identity (r (Variable r))]
</span><a href="#local-6989586621679360952"><span class="hs-identifier hs-var">pms</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ParameterChunk
 -&gt; StateT
      DrasilState Identity (StateT ValueState Identity (r (Variable r))))
-&gt; [ParameterChunk]
-&gt; StateT
     DrasilState Identity [StateT ValueState Identity (r (Variable r))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Input
-&gt; StateT
     DrasilState Identity (StateT ValueState Identity (r (Variable r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVarProc"><span class="hs-identifier hs-var">mkVarProc</span></a></span><span> </span><span class="annot"><span class="annottext">(Input
 -&gt; StateT
      DrasilState Identity (StateT ValueState Identity (r (Variable r))))
-&gt; (ParameterChunk -&gt; Input)
-&gt; ParameterChunk
-&gt; StateT
     DrasilState Identity (StateT ValueState Identity (r (Variable r)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ParameterChunk -&gt; Input
forall c. (Quantity c, MayHaveUnit c, Concept c) =&gt; c -&gt; Input
</span><a href="Language.Drasil.Chunk.CodeBase.html#quantvar"><span class="hs-identifier hs-var">quantvar</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ParameterChunk]
</span><a href="#local-6989586621679360819"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-1200"></span><span>  </span><span id="local-6989586621679360953"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679360953"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FuncStmt -&gt; GenState (MSStatement r))
-&gt; [FuncStmt] -&gt; StateT DrasilState Identity [MSStatement r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">FuncStmt -&gt; GenState (MSStatement r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
FuncStmt -&gt; GenState (MSStatement r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convStmtProc"><span class="hs-identifier hs-var">convStmtProc</span></a></span><span> </span><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679360820"><span class="hs-identifier hs-var">sts</span></a></span><span>
</span><span id="line-1201"></span><span>  </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; GenState (MSStatement r))
-&gt; MSStatement r -&gt; GenState (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
-&gt; r (Scope r)
-&gt; [StateT ValueState Identity (r (Variable r))]
-&gt; MSBody r
-&gt; MSStatement r
forall (r :: * -&gt; *).
DeclStatement r =&gt;
SVariable r
-&gt; r (Scope r) -&gt; [SVariable r] -&gt; MSBody r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">funcDecDef</span></span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (r (Variable r))
</span><a href="#local-6989586621679360951"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="annot"><span class="annottext">r (Scope r)
</span><a href="#local-6989586621679360950"><span class="hs-identifier hs-var">scp</span></a></span><span> </span><span class="annot"><span class="annottext">[StateT ValueState Identity (r (Variable r))]
</span><a href="#local-6989586621679360952"><span class="hs-identifier hs-var">pms</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSBody r
forall (r :: * -&gt; *). BodySym r =&gt; [MSStatement r] -&gt; MSBody r
</span><span class="hs-identifier hs-var">bodyStatements</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679360953"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1202"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmtProc"><span class="hs-identifier hs-var">convStmtProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FVal"><span class="hs-identifier hs-type">FVal</span></a></span><span> </span><span id="local-6989586621679360954"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679360954"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1203"></span><span>  </span><span id="local-6989586621679360955"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679360955"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679360954"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1204"></span><span>  </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; GenState (MSStatement r))
-&gt; MSStatement r -&gt; GenState (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r)) -&gt; MSStatement r
forall (r :: * -&gt; *). StatementSym r =&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">valStmt</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679360955"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-1205"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmtProc"><span class="hs-identifier hs-var">convStmtProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FMulti"><span class="hs-identifier hs-type">FMulti</span></a></span><span> </span><span id="local-6989586621679360956"><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679360956"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1206"></span><span>  </span><span id="local-6989586621679360957"><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679360957"><span class="hs-identifier hs-var">stmts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FuncStmt -&gt; GenState (MSStatement r))
-&gt; [FuncStmt] -&gt; StateT DrasilState Identity [MSStatement r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">FuncStmt -&gt; GenState (MSStatement r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
FuncStmt -&gt; GenState (MSStatement r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convStmtProc"><span class="hs-identifier hs-var">convStmtProc</span></a></span><span> </span><span class="annot"><span class="annottext">[FuncStmt]
</span><a href="#local-6989586621679360956"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-1207"></span><span>  </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; GenState (MSStatement r))
-&gt; MSStatement r -&gt; GenState (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r] -&gt; MSStatement r
forall (r :: * -&gt; *).
StatementSym r =&gt;
[MSStatement r] -&gt; MSStatement r
</span><span class="hs-identifier hs-var">multi</span></span><span> </span><span class="annot"><span class="annottext">[MSStatement r]
</span><a href="#local-6989586621679360957"><span class="hs-identifier hs-var">stmts</span></a></span><span>
</span><span id="line-1208"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#convStmtProc"><span class="hs-identifier hs-var">convStmtProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Mod.html#FAppend"><span class="hs-identifier hs-type">FAppend</span></a></span><span> </span><span id="local-6989586621679360958"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679360958"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679360959"><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679360959"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1209"></span><span>  </span><span id="local-6989586621679360960"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679360960"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679360958"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-1210"></span><span>  </span><span id="local-6989586621679360961"><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679360961"><span class="hs-identifier hs-var">b'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeExpr -&gt; StateT DrasilState Identity (VS (r (Value r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
CodeExpr -&gt; GenState (SValue r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#convExprProc"><span class="hs-identifier hs-var">convExprProc</span></a></span><span> </span><span class="annot"><span class="annottext">CodeExpr
</span><a href="#local-6989586621679360959"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-1211"></span><span>  </span><span class="annot"><span class="annottext">MSStatement r -&gt; GenState (MSStatement r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MSStatement r -&gt; GenState (MSStatement r))
-&gt; MSStatement r -&gt; GenState (MSStatement r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r)) -&gt; MSStatement r
forall (r :: * -&gt; *). StatementSym r =&gt; SValue r -&gt; MSStatement r
</span><span class="hs-identifier hs-var">valStmt</span></span><span> </span><span class="annot"><span class="annottext">(VS (r (Value r)) -&gt; MSStatement r)
-&gt; VS (r (Value r)) -&gt; MSStatement r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r)) -&gt; VS (r (Value r)) -&gt; VS (r (Value r))
forall (r :: * -&gt; *). List r =&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><span class="hs-identifier hs-var">listAppend</span></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679360960"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="annot"><span class="annottext">VS (r (Value r))
</span><a href="#local-6989586621679360961"><span class="hs-identifier hs-var">b'</span></a></span><span>
</span><span id="line-1212"></span><span>
</span><span id="line-1213"></span><span class="hs-comment">-- | Generates a function that reads a file whose format is based on the passed</span><span>
</span><span id="line-1214"></span><span class="hs-comment">-- 'DataDesc'.</span><span>
</span><span id="line-1215"></span><span id="local-6989586621679353992"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#genDataFuncProc"><span class="hs-identifier hs-type">genDataFuncProc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353992"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Description"><span class="hs-identifier hs-type">Description</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.DataDesc.html#DataDesc"><span class="hs-identifier hs-type">DataDesc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1216"></span><span>  </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679353992"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-1217"></span><span id="genDataFuncProc"><span class="annot"><span class="annottext">genDataFuncProc :: forall (r :: * -&gt; *).
SharedProg r =&gt;
Name -&gt; Name -&gt; DataDesc -&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genDataFuncProc"><span class="hs-identifier hs-var hs-var">genDataFuncProc</span></a></span></span><span> </span><span id="local-6989586621679360976"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679360976"><span class="hs-identifier hs-var">nameTitle</span></a></span></span><span> </span><span id="local-6989586621679360977"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679360977"><span class="hs-identifier hs-var">desc</span></a></span></span><span> </span><span id="local-6989586621679360978"><span class="annot"><span class="annottext">DataDesc
</span><a href="#local-6989586621679360978"><span class="hs-identifier hs-var">ddef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1218"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360979"><span class="annot"><span class="annottext">parms :: [Input]
</span><a href="#local-6989586621679360979"><span class="hs-identifier hs-var hs-var">parms</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataDesc -&gt; [Input]
</span><a href="Language.Drasil.Code.DataDesc.html#getInputs"><span class="hs-identifier hs-var">getInputs</span></a></span><span> </span><span class="annot"><span class="annottext">DataDesc
</span><a href="#local-6989586621679360978"><span class="hs-identifier hs-var">ddef</span></a></span><span>
</span><span id="line-1219"></span><span>  </span><span id="local-6989586621679360980"><span class="annot"><span class="annottext">[MS (r (Block r))]
</span><a href="#local-6989586621679360980"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DataDesc -&gt; StateT DrasilState Identity [MS (r (Block r))]
forall (r :: * -&gt; *).
SharedProg r =&gt;
DataDesc -&gt; GenState [MSBlock r]
</span><a href="Language.Drasil.Code.Imperative.Import.html#readDataProc"><span class="hs-identifier hs-var">readDataProc</span></a></span><span> </span><span class="annot"><span class="annottext">DataDesc
</span><a href="#local-6989586621679360978"><span class="hs-identifier hs-var">ddef</span></a></span><span>
</span><span id="line-1220"></span><span>  </span><span class="annot"><span class="annottext">Name
-&gt; VSType r
-&gt; Name
-&gt; [ParameterChunk]
-&gt; Maybe Name
-&gt; [MS (r (Block r))]
-&gt; GenState (SMethod r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
Name
-&gt; VSType r
-&gt; Name
-&gt; [ParameterChunk]
-&gt; Maybe Name
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#publicFuncProc"><span class="hs-identifier hs-var">publicFuncProc</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679360976"><span class="hs-identifier hs-var">nameTitle</span></a></span><span> </span><span class="annot"><span class="annottext">VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; VSType r
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679360977"><span class="hs-identifier hs-var">desc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Input -&gt; ParameterChunk) -&gt; [Input] -&gt; [ParameterChunk]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Input -&gt; ParameterChunk
forall c. CodeIdea c =&gt; c -&gt; ParameterChunk
</span><a href="Language.Drasil.Chunk.Parameter.html#pcAuto"><span class="hs-identifier hs-var">pcAuto</span></a></span><span> </span><span class="annot"><span class="annottext">([Input] -&gt; [ParameterChunk]) -&gt; [Input] -&gt; [ParameterChunk]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DefinedQuantityDict -&gt; Input
forall c. (Quantity c, MayHaveUnit c, Concept c) =&gt; c -&gt; Input
</span><a href="Language.Drasil.Chunk.CodeBase.html#quantvar"><span class="hs-identifier hs-var">quantvar</span></a></span><span> </span><span class="annot"><span class="annottext">DefinedQuantityDict
</span><a href="Language.Drasil.Code.CodeQuantityDicts.html#inFileName"><span class="hs-identifier hs-var">inFileName</span></a></span><span> </span><span class="annot"><span class="annottext">Input -&gt; [Input] -&gt; [Input]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679360979"><span class="hs-identifier hs-var">parms</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1221"></span><span>    </span><span class="annot"><span class="annottext">Maybe Name
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">[MS (r (Block r))]
</span><a href="#local-6989586621679360980"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-1222"></span><span>
</span><span id="line-1223"></span><span class="annot"><span class="hs-comment">-- | Generates a public function, defined by its inputs and outputs.</span></span><span>
</span><span id="line-1224"></span><span id="local-6989586621679354025"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#publicInOutFuncProc"><span class="hs-identifier hs-type">publicInOutFuncProc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679354025"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Label</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Description"><span class="hs-identifier hs-type">Description</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">CodeVarChunk</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1225"></span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">CodeVarChunk</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSBlock</span></span><span> </span><span class="annot"><a href="#local-6989586621679354025"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679354025"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-1226"></span><span id="publicInOutFuncProc"><span class="annot"><span class="annottext">publicInOutFuncProc :: forall (r :: * -&gt; *).
SharedProg r =&gt;
Name
-&gt; Name
-&gt; [Input]
-&gt; [Input]
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#publicInOutFuncProc"><span class="hs-identifier hs-var hs-var">publicInOutFuncProc</span></a></span></span><span> </span><span id="local-6989586621679360989"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679360989"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([SVariable r]
 -&gt; [SVariable r]
 -&gt; [SVariable r]
 -&gt; MSBody r
 -&gt; StateT MethodState Identity (r (Method r)))
-&gt; (Name
    -&gt; [(Name, SVariable r)]
    -&gt; [(Name, SVariable r)]
    -&gt; [(Name, SVariable r)]
    -&gt; MSBody r
    -&gt; StateT MethodState Identity (r (Method r)))
-&gt; Name
-&gt; Name
-&gt; [Input]
-&gt; [Input]
-&gt; [StateT MethodState Identity (r (Block r))]
-&gt; StateT
     DrasilState Identity (StateT MethodState Identity (r (Method r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
([SVariable r]
 -&gt; [SVariable r] -&gt; [SVariable r] -&gt; MSBody r -&gt; SMethod r)
-&gt; (Name
    -&gt; [(Name, SVariable r)]
    -&gt; [(Name, SVariable r)]
    -&gt; [(Name, SVariable r)]
    -&gt; MSBody r
    -&gt; SMethod r)
-&gt; Name
-&gt; Name
-&gt; [Input]
-&gt; [Input]
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genInOutFuncProc"><span class="hs-identifier hs-var">genInOutFuncProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
-&gt; r (Visibility r)
-&gt; [SVariable r]
-&gt; [SVariable r]
-&gt; [SVariable r]
-&gt; MSBody r
-&gt; StateT MethodState Identity (r (Method r))
forall (r :: * -&gt; *).
MethodSym r =&gt;
Name -&gt; r (Visibility r) -&gt; InOutFunc r
</span><span class="hs-identifier hs-var">inOutFunc</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679360989"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">r (Visibility r)
forall (r :: * -&gt; *). VisibilitySym r =&gt; r (Visibility r)
</span><span class="hs-identifier hs-var">public</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
-&gt; r (Visibility r)
-&gt; Name
-&gt; [(Name, SVariable r)]
-&gt; [(Name, SVariable r)]
-&gt; [(Name, SVariable r)]
-&gt; MSBody r
-&gt; StateT MethodState Identity (r (Method r))
forall (r :: * -&gt; *).
MethodSym r =&gt;
Name -&gt; r (Visibility r) -&gt; DocInOutFunc r
</span><span class="hs-identifier hs-var">docInOutFunc</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679360989"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">r (Visibility r)
forall (r :: * -&gt; *). VisibilitySym r =&gt; r (Visibility r)
</span><span class="hs-identifier hs-var">public</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679360989"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1227"></span><span>
</span><span id="line-1228"></span><span class="annot"><span class="hs-comment">-- | Generates a private function, defined by its inputs and outputs.</span></span><span>
</span><span id="line-1229"></span><span id="local-6989586621679360991"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#privateInOutFuncProc"><span class="hs-identifier hs-type">privateInOutFuncProc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679360991"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Label</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Description"><span class="hs-identifier hs-type">Description</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">CodeVarChunk</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1230"></span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">CodeVarChunk</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSBlock</span></span><span> </span><span class="annot"><a href="#local-6989586621679360991"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679360991"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-1231"></span><span id="privateInOutFuncProc"><span class="annot"><span class="annottext">privateInOutFuncProc :: forall (r :: * -&gt; *).
SharedProg r =&gt;
Name
-&gt; Name
-&gt; [Input]
-&gt; [Input]
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#privateInOutFuncProc"><span class="hs-identifier hs-var hs-var">privateInOutFuncProc</span></a></span></span><span> </span><span id="local-6989586621679361000"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679361000"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([SVariable r]
 -&gt; [SVariable r]
 -&gt; [SVariable r]
 -&gt; MSBody r
 -&gt; StateT MethodState Identity (r (Method r)))
-&gt; (Name
    -&gt; [(Name, SVariable r)]
    -&gt; [(Name, SVariable r)]
    -&gt; [(Name, SVariable r)]
    -&gt; MSBody r
    -&gt; StateT MethodState Identity (r (Method r)))
-&gt; Name
-&gt; Name
-&gt; [Input]
-&gt; [Input]
-&gt; [StateT MethodState Identity (r (Block r))]
-&gt; StateT
     DrasilState Identity (StateT MethodState Identity (r (Method r)))
forall (r :: * -&gt; *).
SharedProg r =&gt;
([SVariable r]
 -&gt; [SVariable r] -&gt; [SVariable r] -&gt; MSBody r -&gt; SMethod r)
-&gt; (Name
    -&gt; [(Name, SVariable r)]
    -&gt; [(Name, SVariable r)]
    -&gt; [(Name, SVariable r)]
    -&gt; MSBody r
    -&gt; SMethod r)
-&gt; Name
-&gt; Name
-&gt; [Input]
-&gt; [Input]
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genInOutFuncProc"><span class="hs-identifier hs-var">genInOutFuncProc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
-&gt; r (Visibility r)
-&gt; [SVariable r]
-&gt; [SVariable r]
-&gt; [SVariable r]
-&gt; MSBody r
-&gt; StateT MethodState Identity (r (Method r))
forall (r :: * -&gt; *).
MethodSym r =&gt;
Name -&gt; r (Visibility r) -&gt; InOutFunc r
</span><span class="hs-identifier hs-var">inOutFunc</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679361000"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">r (Visibility r)
forall (r :: * -&gt; *). VisibilitySym r =&gt; r (Visibility r)
</span><span class="hs-identifier hs-var">private</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
-&gt; r (Visibility r)
-&gt; Name
-&gt; [(Name, SVariable r)]
-&gt; [(Name, SVariable r)]
-&gt; [(Name, SVariable r)]
-&gt; MSBody r
-&gt; StateT MethodState Identity (r (Method r))
forall (r :: * -&gt; *).
MethodSym r =&gt;
Name -&gt; r (Visibility r) -&gt; DocInOutFunc r
</span><span class="hs-identifier hs-var">docInOutFunc</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679361000"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">r (Visibility r)
forall (r :: * -&gt; *). VisibilitySym r =&gt; r (Visibility r)
</span><span class="hs-identifier hs-var">private</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679361000"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1232"></span><span>
</span><span id="line-1233"></span><span class="hs-comment">-- | Generates a function or method defined by its inputs and outputs.</span><span>
</span><span id="line-1234"></span><span class="hs-comment">-- Parameters are: the GOOL constructor to use, the equivalent GOOL constructor</span><span>
</span><span id="line-1235"></span><span class="hs-comment">-- for a documented function/method, the visibility, permanence, name, description,</span><span>
</span><span id="line-1236"></span><span class="hs-comment">-- list of inputs, list of outputs, and body.</span><span>
</span><span id="line-1237"></span><span id="local-6989586621679354027"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#genInOutFuncProc"><span class="hs-identifier hs-type">genInOutFuncProc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679354027"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">SVariable</span></span><span> </span><span class="annot"><a href="#local-6989586621679354027"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">SVariable</span></span><span> </span><span class="annot"><a href="#local-6989586621679354027"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1238"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">SVariable</span></span><span> </span><span class="annot"><a href="#local-6989586621679354027"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MSBody</span></span><span> </span><span class="annot"><a href="#local-6989586621679354027"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679354027"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1239"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SVariable</span></span><span> </span><span class="annot"><a href="#local-6989586621679354027"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SVariable</span></span><span> </span><span class="annot"><a href="#local-6989586621679354027"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1240"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SVariable</span></span><span> </span><span class="annot"><a href="#local-6989586621679354027"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MSBody</span></span><span> </span><span class="annot"><a href="#local-6989586621679354027"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679354027"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1241"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Label</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Mod.html#Description"><span class="hs-identifier hs-type">Description</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">CodeVarChunk</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">CodeVarChunk</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1242"></span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MSBlock</span></span><span> </span><span class="annot"><a href="#local-6989586621679354027"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679354027"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-1243"></span><span id="genInOutFuncProc"><span class="annot"><span class="annottext">genInOutFuncProc :: forall (r :: * -&gt; *).
SharedProg r =&gt;
([SVariable r]
 -&gt; [SVariable r] -&gt; [SVariable r] -&gt; MSBody r -&gt; SMethod r)
-&gt; (Name
    -&gt; [(Name, SVariable r)]
    -&gt; [(Name, SVariable r)]
    -&gt; [(Name, SVariable r)]
    -&gt; MSBody r
    -&gt; SMethod r)
-&gt; Name
-&gt; Name
-&gt; [Input]
-&gt; [Input]
-&gt; [MSBlock r]
-&gt; GenState (SMethod r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#genInOutFuncProc"><span class="hs-identifier hs-var hs-var">genInOutFuncProc</span></a></span></span><span> </span><span id="local-6989586621679361035"><span class="annot"><span class="annottext">[SVariable r]
-&gt; [SVariable r] -&gt; [SVariable r] -&gt; MSBody r -&gt; SMethod r
</span><a href="#local-6989586621679361035"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679361036"><span class="annot"><span class="annottext">Name
-&gt; [(Name, SVariable r)]
-&gt; [(Name, SVariable r)]
-&gt; [(Name, SVariable r)]
-&gt; MSBody r
-&gt; SMethod r
</span><a href="#local-6989586621679361036"><span class="hs-identifier hs-var">docf</span></a></span></span><span> </span><span id="local-6989586621679361037"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679361037"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679361038"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679361038"><span class="hs-identifier hs-var">desc</span></a></span></span><span> </span><span id="local-6989586621679361039"><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679361039"><span class="hs-identifier hs-var">ins'</span></a></span></span><span> </span><span id="local-6989586621679361040"><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679361040"><span class="hs-identifier hs-var">outs'</span></a></span></span><span> </span><span id="local-6989586621679361041"><span class="annot"><span class="annottext">[MSBlock r]
</span><a href="#local-6989586621679361041"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1244"></span><span>  </span><span id="local-6989586621679361042"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679361042"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT DrasilState Identity DrasilState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-1245"></span><span>  </span><span class="annot"><span class="annottext">(DrasilState -&gt; DrasilState) -&gt; StateT DrasilState Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679361043"><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679361043"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679361043"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#currentScope"><span class="hs-identifier hs-var">currentScope</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.DrasilState.html#Local"><span class="hs-identifier hs-type">Local</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-1246"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679361045"><span class="annot"><span class="annottext">ins :: [Input]
</span><a href="#local-6989586621679361045"><span class="hs-identifier hs-var hs-var">ins</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679361039"><span class="hs-identifier hs-var">ins'</span></a></span><span> </span><span class="annot"><span class="annottext">[Input] -&gt; [Input] -&gt; [Input]
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">\\</span></span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679361040"><span class="hs-identifier hs-var">outs'</span></a></span><span>
</span><span id="line-1247"></span><span>      </span><span id="local-6989586621679361047"><span class="annot"><span class="annottext">outs :: [Input]
</span><a href="#local-6989586621679361047"><span class="hs-identifier hs-var hs-var">outs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679361040"><span class="hs-identifier hs-var">outs'</span></a></span><span> </span><span class="annot"><span class="annottext">[Input] -&gt; [Input] -&gt; [Input]
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">\\</span></span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679361039"><span class="hs-identifier hs-var">ins'</span></a></span><span>
</span><span id="line-1248"></span><span>      </span><span id="local-6989586621679361049"><span class="annot"><span class="annottext">both :: [Input]
</span><a href="#local-6989586621679361049"><span class="hs-identifier hs-var hs-var">both</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679361039"><span class="hs-identifier hs-var">ins'</span></a></span><span> </span><span class="annot"><span class="annottext">[Input] -&gt; [Input] -&gt; [Input]
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">`intersect`</span></span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679361040"><span class="hs-identifier hs-var">outs'</span></a></span><span>
</span><span id="line-1249"></span><span>  </span><span id="local-6989586621679361050"><span class="annot"><span class="annottext">[SVariable r]
</span><a href="#local-6989586621679361050"><span class="hs-identifier hs-var">inVs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Input -&gt; StateT DrasilState Identity (SVariable r))
-&gt; [Input] -&gt; StateT DrasilState Identity [SVariable r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Input -&gt; StateT DrasilState Identity (SVariable r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVarProc"><span class="hs-identifier hs-var">mkVarProc</span></a></span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679361045"><span class="hs-identifier hs-var">ins</span></a></span><span>
</span><span id="line-1250"></span><span>  </span><span id="local-6989586621679361051"><span class="annot"><span class="annottext">[SVariable r]
</span><a href="#local-6989586621679361051"><span class="hs-identifier hs-var">outVs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Input -&gt; StateT DrasilState Identity (SVariable r))
-&gt; [Input] -&gt; StateT DrasilState Identity [SVariable r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Input -&gt; StateT DrasilState Identity (SVariable r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVarProc"><span class="hs-identifier hs-var">mkVarProc</span></a></span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679361047"><span class="hs-identifier hs-var">outs</span></a></span><span>
</span><span id="line-1251"></span><span>  </span><span id="local-6989586621679361052"><span class="annot"><span class="annottext">[SVariable r]
</span><a href="#local-6989586621679361052"><span class="hs-identifier hs-var">bothVs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Input -&gt; StateT DrasilState Identity (SVariable r))
-&gt; [Input] -&gt; StateT DrasilState Identity [SVariable r]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Input -&gt; StateT DrasilState Identity (SVariable r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
Input -&gt; GenState (SVariable r)
</span><a href="Language.Drasil.Code.Imperative.Import.html#mkVarProc"><span class="hs-identifier hs-var">mkVarProc</span></a></span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679361049"><span class="hs-identifier hs-var">both</span></a></span><span>
</span><span id="line-1252"></span><span>  </span><span id="local-6989586621679361053"><span class="annot"><span class="annottext">MSBody r
</span><a href="#local-6989586621679361053"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; [SVariable r]
-&gt; [MSBlock r]
-&gt; StateT DrasilState Identity (MSBody r)
forall (r :: * -&gt; *).
SharedProg r =&gt;
Name -&gt; [SVariable r] -&gt; [MSBlock r] -&gt; GenState (MSBody r)
</span><a href="Language.Drasil.Code.Imperative.Logging.html#logBody"><span class="hs-identifier hs-var">logBody</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679361037"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SVariable r]
</span><a href="#local-6989586621679361052"><span class="hs-identifier hs-var">bothVs</span></a></span><span> </span><span class="annot"><span class="annottext">[SVariable r] -&gt; [SVariable r] -&gt; [SVariable r]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[SVariable r]
</span><a href="#local-6989586621679361050"><span class="hs-identifier hs-var">inVs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[MSBlock r]
</span><a href="#local-6989586621679361041"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-1253"></span><span>  </span><span id="local-6989586621679361054"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679361054"><span class="hs-identifier hs-var">pComms</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Input -&gt; GenState Name)
-&gt; [Input] -&gt; StateT DrasilState Identity [Name]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Input -&gt; GenState Name
forall c. CodeIdea c =&gt; c -&gt; GenState Name
</span><a href="Language.Drasil.Code.Imperative.Comments.html#getCommentBrief"><span class="hs-identifier hs-var">getCommentBrief</span></a></span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679361045"><span class="hs-identifier hs-var">ins</span></a></span><span>
</span><span id="line-1254"></span><span>  </span><span id="local-6989586621679361055"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679361055"><span class="hs-identifier hs-var">oComms</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Input -&gt; GenState Name)
-&gt; [Input] -&gt; StateT DrasilState Identity [Name]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Input -&gt; GenState Name
forall c. CodeIdea c =&gt; c -&gt; GenState Name
</span><a href="Language.Drasil.Code.Imperative.Comments.html#getCommentBrief"><span class="hs-identifier hs-var">getCommentBrief</span></a></span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679361047"><span class="hs-identifier hs-var">outs</span></a></span><span>
</span><span id="line-1255"></span><span>  </span><span id="local-6989586621679361056"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679361056"><span class="hs-identifier hs-var">bComms</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Input -&gt; GenState Name)
-&gt; [Input] -&gt; StateT DrasilState Identity [Name]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Input -&gt; GenState Name
forall c. CodeIdea c =&gt; c -&gt; GenState Name
</span><a href="Language.Drasil.Code.Imperative.Comments.html#getCommentBrief"><span class="hs-identifier hs-var">getCommentBrief</span></a></span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679361049"><span class="hs-identifier hs-var">both</span></a></span><span>
</span><span id="line-1256"></span><span>  </span><span class="annot"><span class="annottext">SMethod r -&gt; GenState (SMethod r)
forall a. a -&gt; StateT DrasilState Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SMethod r -&gt; GenState (SMethod r))
-&gt; SMethod r -&gt; GenState (SMethod r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Comments
</span><a href="Language.Drasil.Choices.html#CommentFunc"><span class="hs-identifier hs-var">CommentFunc</span></a></span><span> </span><span class="annot"><span class="annottext">Comments -&gt; [Comments] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">DrasilState -&gt; [Comments]
</span><a href="Language.Drasil.Code.Imperative.DrasilState.html#commented"><span class="hs-identifier hs-var">commented</span></a></span><span> </span><span class="annot"><span class="annottext">DrasilState
</span><a href="#local-6989586621679361042"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-1257"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; [(Name, SVariable r)]
-&gt; [(Name, SVariable r)]
-&gt; [(Name, SVariable r)]
-&gt; MSBody r
-&gt; SMethod r
</span><a href="#local-6989586621679361036"><span class="hs-identifier hs-var">docf</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679361038"><span class="hs-identifier hs-var">desc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Name] -&gt; [SVariable r] -&gt; [(Name, SVariable r)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679361054"><span class="hs-identifier hs-var">pComms</span></a></span><span> </span><span class="annot"><span class="annottext">[SVariable r]
</span><a href="#local-6989586621679361050"><span class="hs-identifier hs-var">inVs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Name] -&gt; [SVariable r] -&gt; [(Name, SVariable r)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679361055"><span class="hs-identifier hs-var">oComms</span></a></span><span> </span><span class="annot"><span class="annottext">[SVariable r]
</span><a href="#local-6989586621679361051"><span class="hs-identifier hs-var">outVs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Name] -&gt; [SVariable r] -&gt; [(Name, SVariable r)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span>
</span><span id="line-1258"></span><span>    </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679361056"><span class="hs-identifier hs-var">bComms</span></a></span><span> </span><span class="annot"><span class="annottext">[SVariable r]
</span><a href="#local-6989586621679361052"><span class="hs-identifier hs-var">bothVs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MSBody r
</span><a href="#local-6989586621679361053"><span class="hs-identifier hs-var">bod</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[SVariable r]
-&gt; [SVariable r] -&gt; [SVariable r] -&gt; MSBody r -&gt; SMethod r
</span><a href="#local-6989586621679361035"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[SVariable r]
</span><a href="#local-6989586621679361050"><span class="hs-identifier hs-var">inVs</span></a></span><span> </span><span class="annot"><span class="annottext">[SVariable r]
</span><a href="#local-6989586621679361051"><span class="hs-identifier hs-var">outVs</span></a></span><span> </span><span class="annot"><span class="annottext">[SVariable r]
</span><a href="#local-6989586621679361052"><span class="hs-identifier hs-var">bothVs</span></a></span><span> </span><span class="annot"><span class="annottext">MSBody r
</span><a href="#local-6989586621679361053"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-1259"></span><span>
</span><span id="line-1260"></span><span class="hs-comment">-- Used for readData and readDataProc</span><span>
</span><span id="line-1261"></span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#l_line"><span class="hs-identifier hs-type">l_line</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#l_lines"><span class="hs-identifier hs-type">l_lines</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#l_linetokens"><span class="hs-identifier hs-type">l_linetokens</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#l_infile"><span class="hs-identifier hs-type">l_infile</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#l_i"><span class="hs-identifier hs-type">l_i</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Label</span></span><span>
</span><span id="line-1262"></span><span id="local-6989586621679353925"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#var_line"><span class="hs-identifier hs-type">var_line</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#var_lines"><span class="hs-identifier hs-type">var_lines</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#var_linetokens"><span class="hs-identifier hs-type">var_linetokens</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#var_infile"><span class="hs-identifier hs-type">var_infile</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#var_i"><span class="hs-identifier hs-type">var_i</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1263"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353925"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SVariable</span></span><span> </span><span class="annot"><a href="#local-6989586621679353925"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-1264"></span><span id="local-6989586621679353931"><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#v_line"><span class="hs-identifier hs-type">v_line</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#v_lines"><span class="hs-identifier hs-type">v_lines</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#v_linetokens"><span class="hs-identifier hs-type">v_linetokens</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#v_infile"><span class="hs-identifier hs-type">v_infile</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Code.Imperative.Import.html#v_i"><span class="hs-identifier hs-type">v_i</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1265"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedProg</span></span><span> </span><span class="annot"><a href="#local-6989586621679353931"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679353931"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-1266"></span><span id="l_line"><span class="annot"><span class="annottext">l_line :: Name
</span><a href="Language.Drasil.Code.Imperative.Import.html#l_line"><span class="hs-identifier hs-var hs-var">l_line</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;line&quot;</span></span><span>
</span><span id="line-1267"></span><span id="var_line"><span class="annot"><span class="annottext">var_line :: forall (r :: * -&gt; *). SharedProg r =&gt; SVariable r
</span><a href="Language.Drasil.Code.Imperative.Import.html#var_line"><span class="hs-identifier hs-var hs-var">var_line</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; VSType r -&gt; StateT ValueState Identity (r (Variable r))
forall (r :: * -&gt; *).
VariableSym r =&gt;
Name -&gt; VSType r -&gt; SVariable r
</span><span class="hs-identifier hs-var">var</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Language.Drasil.Code.Imperative.Import.html#l_line"><span class="hs-identifier hs-var">l_line</span></a></span><span> </span><span class="annot"><span class="annottext">VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; VSType r
</span><span class="hs-identifier hs-var">string</span></span><span>
</span><span id="line-1268"></span><span id="v_line"><span class="annot"><span class="annottext">v_line :: forall (r :: * -&gt; *). SharedProg r =&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#v_line"><span class="hs-identifier hs-var hs-var">v_line</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SVariable r -&gt; StateT ValueState Identity (r (Value r))
forall (r :: * -&gt; *). VariableValue r =&gt; SVariable r -&gt; SValue r
</span><span class="hs-identifier hs-var">valueOf</span></span><span> </span><span class="annot"><span class="annottext">SVariable r
forall (r :: * -&gt; *). SharedProg r =&gt; SVariable r
</span><a href="Language.Drasil.Code.Imperative.Import.html#var_line"><span class="hs-identifier hs-var">var_line</span></a></span><span>
</span><span id="line-1269"></span><span id="l_lines"><span class="annot"><span class="annottext">l_lines :: Name
</span><a href="Language.Drasil.Code.Imperative.Import.html#l_lines"><span class="hs-identifier hs-var hs-var">l_lines</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;lines&quot;</span></span><span>
</span><span id="line-1270"></span><span id="var_lines"><span class="annot"><span class="annottext">var_lines :: forall (r :: * -&gt; *). SharedProg r =&gt; SVariable r
</span><a href="Language.Drasil.Code.Imperative.Import.html#var_lines"><span class="hs-identifier hs-var hs-var">var_lines</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; VSType r -&gt; StateT ValueState Identity (r (Variable r))
forall (r :: * -&gt; *).
VariableSym r =&gt;
Name -&gt; VSType r -&gt; SVariable r
</span><span class="hs-identifier hs-var">var</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Language.Drasil.Code.Imperative.Import.html#l_lines"><span class="hs-identifier hs-var">l_lines</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VSType r -&gt; VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; VSType r -&gt; VSType r
</span><span class="hs-identifier hs-var">listType</span></span><span> </span><span class="annot"><span class="annottext">VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; VSType r
</span><span class="hs-identifier hs-var">string</span></span><span class="hs-special">)</span><span>
</span><span id="line-1271"></span><span id="v_lines"><span class="annot"><span class="annottext">v_lines :: forall (r :: * -&gt; *). SharedProg r =&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#v_lines"><span class="hs-identifier hs-var hs-var">v_lines</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SVariable r -&gt; StateT ValueState Identity (r (Value r))
forall (r :: * -&gt; *). VariableValue r =&gt; SVariable r -&gt; SValue r
</span><span class="hs-identifier hs-var">valueOf</span></span><span> </span><span class="annot"><span class="annottext">SVariable r
forall (r :: * -&gt; *). SharedProg r =&gt; SVariable r
</span><a href="Language.Drasil.Code.Imperative.Import.html#var_lines"><span class="hs-identifier hs-var">var_lines</span></a></span><span>
</span><span id="line-1272"></span><span id="l_linetokens"><span class="annot"><span class="annottext">l_linetokens :: Name
</span><a href="Language.Drasil.Code.Imperative.Import.html#l_linetokens"><span class="hs-identifier hs-var hs-var">l_linetokens</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;linetokens&quot;</span></span><span>
</span><span id="line-1273"></span><span id="var_linetokens"><span class="annot"><span class="annottext">var_linetokens :: forall (r :: * -&gt; *). SharedProg r =&gt; SVariable r
</span><a href="Language.Drasil.Code.Imperative.Import.html#var_linetokens"><span class="hs-identifier hs-var hs-var">var_linetokens</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; VSType r -&gt; StateT ValueState Identity (r (Variable r))
forall (r :: * -&gt; *).
VariableSym r =&gt;
Name -&gt; VSType r -&gt; SVariable r
</span><span class="hs-identifier hs-var">var</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Language.Drasil.Code.Imperative.Import.html#l_linetokens"><span class="hs-identifier hs-var">l_linetokens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VSType r -&gt; VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; VSType r -&gt; VSType r
</span><span class="hs-identifier hs-var">listType</span></span><span> </span><span class="annot"><span class="annottext">VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; VSType r
</span><span class="hs-identifier hs-var">string</span></span><span class="hs-special">)</span><span>
</span><span id="line-1274"></span><span id="v_linetokens"><span class="annot"><span class="annottext">v_linetokens :: forall (r :: * -&gt; *). SharedProg r =&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#v_linetokens"><span class="hs-identifier hs-var hs-var">v_linetokens</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SVariable r -&gt; StateT ValueState Identity (r (Value r))
forall (r :: * -&gt; *). VariableValue r =&gt; SVariable r -&gt; SValue r
</span><span class="hs-identifier hs-var">valueOf</span></span><span> </span><span class="annot"><span class="annottext">SVariable r
forall (r :: * -&gt; *). SharedProg r =&gt; SVariable r
</span><a href="Language.Drasil.Code.Imperative.Import.html#var_linetokens"><span class="hs-identifier hs-var">var_linetokens</span></a></span><span>
</span><span id="line-1275"></span><span id="l_infile"><span class="annot"><span class="annottext">l_infile :: Name
</span><a href="Language.Drasil.Code.Imperative.Import.html#l_infile"><span class="hs-identifier hs-var hs-var">l_infile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;infile&quot;</span></span><span>
</span><span id="line-1276"></span><span id="var_infile"><span class="annot"><span class="annottext">var_infile :: forall (r :: * -&gt; *). SharedProg r =&gt; SVariable r
</span><a href="Language.Drasil.Code.Imperative.Import.html#var_infile"><span class="hs-identifier hs-var hs-var">var_infile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; VSType r -&gt; StateT ValueState Identity (r (Variable r))
forall (r :: * -&gt; *).
VariableSym r =&gt;
Name -&gt; VSType r -&gt; SVariable r
</span><span class="hs-identifier hs-var">var</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Language.Drasil.Code.Imperative.Import.html#l_infile"><span class="hs-identifier hs-var">l_infile</span></a></span><span> </span><span class="annot"><span class="annottext">VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; VSType r
</span><span class="hs-identifier hs-var">infile</span></span><span>
</span><span id="line-1277"></span><span id="v_infile"><span class="annot"><span class="annottext">v_infile :: forall (r :: * -&gt; *). SharedProg r =&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#v_infile"><span class="hs-identifier hs-var hs-var">v_infile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SVariable r -&gt; StateT ValueState Identity (r (Value r))
forall (r :: * -&gt; *). VariableValue r =&gt; SVariable r -&gt; SValue r
</span><span class="hs-identifier hs-var">valueOf</span></span><span> </span><span class="annot"><span class="annottext">SVariable r
forall (r :: * -&gt; *). SharedProg r =&gt; SVariable r
</span><a href="Language.Drasil.Code.Imperative.Import.html#var_infile"><span class="hs-identifier hs-var">var_infile</span></a></span><span>
</span><span id="line-1278"></span><span id="l_i"><span class="annot"><span class="annottext">l_i :: Name
</span><a href="Language.Drasil.Code.Imperative.Import.html#l_i"><span class="hs-identifier hs-var hs-var">l_i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;i&quot;</span></span><span>
</span><span id="line-1279"></span><span id="var_i"><span class="annot"><span class="annottext">var_i :: forall (r :: * -&gt; *). SharedProg r =&gt; SVariable r
</span><a href="Language.Drasil.Code.Imperative.Import.html#var_i"><span class="hs-identifier hs-var hs-var">var_i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; VSType r -&gt; StateT ValueState Identity (r (Variable r))
forall (r :: * -&gt; *).
VariableSym r =&gt;
Name -&gt; VSType r -&gt; SVariable r
</span><span class="hs-identifier hs-var">var</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Language.Drasil.Code.Imperative.Import.html#l_i"><span class="hs-identifier hs-var">l_i</span></a></span><span> </span><span class="annot"><span class="annottext">VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; VSType r
</span><span class="hs-identifier hs-var">int</span></span><span>
</span><span id="line-1280"></span><span id="v_i"><span class="annot"><span class="annottext">v_i :: forall (r :: * -&gt; *). SharedProg r =&gt; SValue r
</span><a href="Language.Drasil.Code.Imperative.Import.html#v_i"><span class="hs-identifier hs-var hs-var">v_i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SVariable r -&gt; StateT ValueState Identity (r (Value r))
forall (r :: * -&gt; *). VariableValue r =&gt; SVariable r -&gt; SValue r
</span><span class="hs-identifier hs-var">valueOf</span></span><span> </span><span class="annot"><span class="annottext">SVariable r
forall (r :: * -&gt; *). SharedProg r =&gt; SVariable r
</span><a href="Language.Drasil.Code.Imperative.Import.html#var_i"><span class="hs-identifier hs-var">var_i</span></a></span></pre></body></html>