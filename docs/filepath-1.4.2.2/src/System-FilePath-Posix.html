<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>System/FilePath/Posix.hs</title>
<link type='text/css' rel='stylesheet' href='hscolour.css' />
</head>
<body>
<pre><a name="line-1"></a>
<a name="line-2"></a>
<a name="line-3"></a>
<a name="line-4"></a><span class='hs-comment'>{-# LANGUAGE PatternGuards #-}</span>
<a name="line-5"></a>
<a name="line-6"></a><span class='hs-comment'>-- This template expects CPP definitions for:</span>
<a name="line-7"></a><span class='hs-comment'>--     MODULE_NAME = Posix | Windows</span>
<a name="line-8"></a><span class='hs-comment'>--     IS_WINDOWS  = False | True</span>
<a name="line-9"></a>
<a name="line-10"></a><span class='hs-comment'>-- |</span>
<a name="line-11"></a><span class='hs-comment'>-- Module      :  System.FilePath.MODULE_NAME</span>
<a name="line-12"></a><span class='hs-comment'>-- Copyright   :  (c) Neil Mitchell 2005-2014</span>
<a name="line-13"></a><span class='hs-comment'>-- License     :  BSD3</span>
<a name="line-14"></a><span class='hs-comment'>--</span>
<a name="line-15"></a><span class='hs-comment'>-- Maintainer  :  ndmitchell@gmail.com</span>
<a name="line-16"></a><span class='hs-comment'>-- Stability   :  stable</span>
<a name="line-17"></a><span class='hs-comment'>-- Portability :  portable</span>
<a name="line-18"></a><span class='hs-comment'>--</span>
<a name="line-19"></a><span class='hs-comment'>-- A library for 'FilePath' manipulations, using MODULE_NAME style paths on</span>
<a name="line-20"></a><span class='hs-comment'>-- all platforms. Importing "System.FilePath" is usually better.</span>
<a name="line-21"></a><span class='hs-comment'>--</span>
<a name="line-22"></a><span class='hs-comment'>-- Given the example 'FilePath': @\/directory\/file.ext@</span>
<a name="line-23"></a><span class='hs-comment'>--</span>
<a name="line-24"></a><span class='hs-comment'>-- We can use the following functions to extract pieces.</span>
<a name="line-25"></a><span class='hs-comment'>--</span>
<a name="line-26"></a><span class='hs-comment'>-- * 'takeFileName' gives @\"file.ext\"@</span>
<a name="line-27"></a><span class='hs-comment'>--</span>
<a name="line-28"></a><span class='hs-comment'>-- * 'takeDirectory' gives @\"\/directory\"@</span>
<a name="line-29"></a><span class='hs-comment'>--</span>
<a name="line-30"></a><span class='hs-comment'>-- * 'takeExtension' gives @\".ext\"@</span>
<a name="line-31"></a><span class='hs-comment'>--</span>
<a name="line-32"></a><span class='hs-comment'>-- * 'dropExtension' gives @\"\/directory\/file\"@</span>
<a name="line-33"></a><span class='hs-comment'>--</span>
<a name="line-34"></a><span class='hs-comment'>-- * 'takeBaseName' gives @\"file\"@</span>
<a name="line-35"></a><span class='hs-comment'>--</span>
<a name="line-36"></a><span class='hs-comment'>-- And we could have built an equivalent path with the following expressions:</span>
<a name="line-37"></a><span class='hs-comment'>--</span>
<a name="line-38"></a><span class='hs-comment'>-- * @\"\/directory\" '&lt;/&gt;' \"file.ext\"@.</span>
<a name="line-39"></a><span class='hs-comment'>--</span>
<a name="line-40"></a><span class='hs-comment'>-- * @\"\/directory\/file" '&lt;.&gt;' \"ext\"@.</span>
<a name="line-41"></a><span class='hs-comment'>--</span>
<a name="line-42"></a><span class='hs-comment'>-- * @\"\/directory\/file.txt" '-&lt;.&gt;' \"ext\"@.</span>
<a name="line-43"></a><span class='hs-comment'>--</span>
<a name="line-44"></a><span class='hs-comment'>-- Each function in this module is documented with several examples,</span>
<a name="line-45"></a><span class='hs-comment'>-- which are also used as tests.</span>
<a name="line-46"></a><span class='hs-comment'>--</span>
<a name="line-47"></a><span class='hs-comment'>-- Here are a few examples of using the @filepath@ functions together:</span>
<a name="line-48"></a><span class='hs-comment'>--</span>
<a name="line-49"></a><span class='hs-comment'>-- /Example 1:/ Find the possible locations of a Haskell module @Test@ imported from module @Main@:</span>
<a name="line-50"></a><span class='hs-comment'>--</span>
<a name="line-51"></a><span class='hs-comment'>-- @['replaceFileName' path_to_main \"Test\" '&lt;.&gt;' ext | ext &lt;- [\"hs\",\"lhs\"] ]@</span>
<a name="line-52"></a><span class='hs-comment'>--</span>
<a name="line-53"></a><span class='hs-comment'>-- /Example 2:/ Download a file from @url@ and save it to disk:</span>
<a name="line-54"></a><span class='hs-comment'>--</span>
<a name="line-55"></a><span class='hs-comment'>-- @do let file = 'makeValid' url</span>
<a name="line-56"></a><span class='hs-comment'>--   System.Directory.createDirectoryIfMissing True ('takeDirectory' file)@</span>
<a name="line-57"></a><span class='hs-comment'>--</span>
<a name="line-58"></a><span class='hs-comment'>-- /Example 3:/ Compile a Haskell file, putting the @.hi@ file under @interface@:</span>
<a name="line-59"></a><span class='hs-comment'>--</span>
<a name="line-60"></a><span class='hs-comment'>-- @'takeDirectory' file '&lt;/&gt;' \"interface\" '&lt;/&gt;' ('takeFileName' file '-&lt;.&gt;' \"hi\")@</span>
<a name="line-61"></a><span class='hs-comment'>--</span>
<a name="line-62"></a><span class='hs-comment'>-- References:</span>
<a name="line-63"></a><span class='hs-comment'>-- [1] &lt;<a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa365247.aspx">http://msdn.microsoft.com/en-us/library/windows/desktop/aa365247.aspx</a> Naming Files, Paths and Namespaces&gt; (Microsoft MSDN)</span>
<a name="line-64"></a><span class='hs-keyword'>module</span> <span class='hs-conid'>System.FilePath.Posix</span>
<a name="line-65"></a>    <span class='hs-layout'>(</span>
<a name="line-66"></a>    <span class='hs-comment'>-- * Separator predicates</span>
<a name="line-67"></a>    <span class='hs-conid'>FilePath</span><span class='hs-layout'>,</span>
<a name="line-68"></a>    <span class='hs-varid'>pathSeparator</span><span class='hs-layout'>,</span> <span class='hs-varid'>pathSeparators</span><span class='hs-layout'>,</span> <span class='hs-varid'>isPathSeparator</span><span class='hs-layout'>,</span>
<a name="line-69"></a>    <span class='hs-varid'>searchPathSeparator</span><span class='hs-layout'>,</span> <span class='hs-varid'>isSearchPathSeparator</span><span class='hs-layout'>,</span>
<a name="line-70"></a>    <span class='hs-varid'>extSeparator</span><span class='hs-layout'>,</span> <span class='hs-varid'>isExtSeparator</span><span class='hs-layout'>,</span>
<a name="line-71"></a>
<a name="line-72"></a>    <span class='hs-comment'>-- * @$PATH@ methods</span>
<a name="line-73"></a>    <span class='hs-varid'>splitSearchPath</span><span class='hs-layout'>,</span> <span class='hs-varid'>getSearchPath</span><span class='hs-layout'>,</span>
<a name="line-74"></a>
<a name="line-75"></a>    <span class='hs-comment'>-- * Extension functions</span>
<a name="line-76"></a>    <span class='hs-varid'>splitExtension</span><span class='hs-layout'>,</span>
<a name="line-77"></a>    <span class='hs-varid'>takeExtension</span><span class='hs-layout'>,</span> <span class='hs-varid'>replaceExtension</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-varop'>-&lt;.&gt;</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>dropExtension</span><span class='hs-layout'>,</span> <span class='hs-varid'>addExtension</span><span class='hs-layout'>,</span> <span class='hs-varid'>hasExtension</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-varop'>&lt;.&gt;</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-78"></a>    <span class='hs-varid'>splitExtensions</span><span class='hs-layout'>,</span> <span class='hs-varid'>dropExtensions</span><span class='hs-layout'>,</span> <span class='hs-varid'>takeExtensions</span><span class='hs-layout'>,</span> <span class='hs-varid'>replaceExtensions</span><span class='hs-layout'>,</span> <span class='hs-varid'>isExtensionOf</span><span class='hs-layout'>,</span>
<a name="line-79"></a>    <span class='hs-varid'>stripExtension</span><span class='hs-layout'>,</span>
<a name="line-80"></a>
<a name="line-81"></a>    <span class='hs-comment'>-- * Filename\/directory functions</span>
<a name="line-82"></a>    <span class='hs-varid'>splitFileName</span><span class='hs-layout'>,</span>
<a name="line-83"></a>    <span class='hs-varid'>takeFileName</span><span class='hs-layout'>,</span> <span class='hs-varid'>replaceFileName</span><span class='hs-layout'>,</span> <span class='hs-varid'>dropFileName</span><span class='hs-layout'>,</span>
<a name="line-84"></a>    <span class='hs-varid'>takeBaseName</span><span class='hs-layout'>,</span> <span class='hs-varid'>replaceBaseName</span><span class='hs-layout'>,</span>
<a name="line-85"></a>    <span class='hs-varid'>takeDirectory</span><span class='hs-layout'>,</span> <span class='hs-varid'>replaceDirectory</span><span class='hs-layout'>,</span>
<a name="line-86"></a>    <span class='hs-varid'>combine</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-varop'>&lt;/&gt;</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-87"></a>    <span class='hs-varid'>splitPath</span><span class='hs-layout'>,</span> <span class='hs-varid'>joinPath</span><span class='hs-layout'>,</span> <span class='hs-varid'>splitDirectories</span><span class='hs-layout'>,</span>
<a name="line-88"></a>
<a name="line-89"></a>    <span class='hs-comment'>-- * Drive functions</span>
<a name="line-90"></a>    <span class='hs-varid'>splitDrive</span><span class='hs-layout'>,</span> <span class='hs-varid'>joinDrive</span><span class='hs-layout'>,</span>
<a name="line-91"></a>    <span class='hs-varid'>takeDrive</span><span class='hs-layout'>,</span> <span class='hs-varid'>hasDrive</span><span class='hs-layout'>,</span> <span class='hs-varid'>dropDrive</span><span class='hs-layout'>,</span> <span class='hs-varid'>isDrive</span><span class='hs-layout'>,</span>
<a name="line-92"></a>
<a name="line-93"></a>    <span class='hs-comment'>-- * Trailing slash functions</span>
<a name="line-94"></a>    <span class='hs-varid'>hasTrailingPathSeparator</span><span class='hs-layout'>,</span>
<a name="line-95"></a>    <span class='hs-varid'>addTrailingPathSeparator</span><span class='hs-layout'>,</span>
<a name="line-96"></a>    <span class='hs-varid'>dropTrailingPathSeparator</span><span class='hs-layout'>,</span>
<a name="line-97"></a>
<a name="line-98"></a>    <span class='hs-comment'>-- * File name manipulations</span>
<a name="line-99"></a>    <span class='hs-varid'>normalise</span><span class='hs-layout'>,</span> <span class='hs-varid'>equalFilePath</span><span class='hs-layout'>,</span>
<a name="line-100"></a>    <span class='hs-varid'>makeRelative</span><span class='hs-layout'>,</span>
<a name="line-101"></a>    <span class='hs-varid'>isRelative</span><span class='hs-layout'>,</span> <span class='hs-varid'>isAbsolute</span><span class='hs-layout'>,</span>
<a name="line-102"></a>    <span class='hs-varid'>isValid</span><span class='hs-layout'>,</span> <span class='hs-varid'>makeValid</span>
<a name="line-103"></a>    <span class='hs-layout'>)</span>
<a name="line-104"></a>    <span class='hs-keyword'>where</span>
<a name="line-105"></a>
<a name="line-106"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Char</span><span class='hs-layout'>(</span><span class='hs-varid'>toLower</span><span class='hs-layout'>,</span> <span class='hs-varid'>toUpper</span><span class='hs-layout'>,</span> <span class='hs-varid'>isAsciiLower</span><span class='hs-layout'>,</span> <span class='hs-varid'>isAsciiUpper</span><span class='hs-layout'>)</span>
<a name="line-107"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Maybe</span><span class='hs-layout'>(</span><span class='hs-varid'>isJust</span><span class='hs-layout'>)</span>
<a name="line-108"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.List</span><span class='hs-layout'>(</span><span class='hs-varid'>stripPrefix</span><span class='hs-layout'>,</span> <span class='hs-varid'>isSuffixOf</span><span class='hs-layout'>)</span>
<a name="line-109"></a>
<a name="line-110"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>System.Environment</span><span class='hs-layout'>(</span><span class='hs-varid'>getEnv</span><span class='hs-layout'>)</span>
<a name="line-111"></a>
<a name="line-112"></a>
<a name="line-113"></a><span class='hs-keyword'>infixr</span> <span class='hs-num'>7</span>  <span class='hs-varop'>&lt;.&gt;</span><span class='hs-layout'>,</span> <span class='hs-varop'>-&lt;.&gt;</span>
<a name="line-114"></a><span class='hs-keyword'>infixr</span> <span class='hs-num'>5</span>  <span class='hs-varop'>&lt;/&gt;</span>
<a name="line-115"></a>
<a name="line-116"></a>
<a name="line-117"></a>
<a name="line-118"></a>
<a name="line-119"></a>
<a name="line-120"></a><span class='hs-comment'>---------------------------------------------------------------------</span>
<a name="line-121"></a><span class='hs-comment'>-- Platform Abstraction Methods (private)</span>
<a name="line-122"></a>
<a name="line-123"></a><a name="isPosix"></a><span class='hs-comment'>-- | Is the operating system Unix or Linux like</span>
<a name="line-124"></a><span class='hs-definition'>isPosix</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Bool</span>
<a name="line-125"></a><span class='hs-definition'>isPosix</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>not</span> <span class='hs-varid'>isWindows</span>
<a name="line-126"></a>
<a name="line-127"></a><a name="isWindows"></a><span class='hs-comment'>-- | Is the operating system Windows like</span>
<a name="line-128"></a><span class='hs-definition'>isWindows</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Bool</span>
<a name="line-129"></a><span class='hs-definition'>isWindows</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-130"></a>
<a name="line-131"></a>
<a name="line-132"></a><span class='hs-comment'>---------------------------------------------------------------------</span>
<a name="line-133"></a><span class='hs-comment'>-- The basic functions</span>
<a name="line-134"></a>
<a name="line-135"></a><a name="pathSeparator"></a><span class='hs-comment'>-- | The character that separates directories. In the case where more than</span>
<a name="line-136"></a><span class='hs-comment'>--   one character is possible, 'pathSeparator' is the \'ideal\' one.</span>
<a name="line-137"></a><span class='hs-comment'>--</span>
<a name="line-138"></a><span class='hs-comment'>-- &gt; Windows: pathSeparator == '\\'</span>
<a name="line-139"></a><span class='hs-comment'>-- &gt; Posix:   pathSeparator ==  '/'</span>
<a name="line-140"></a><span class='hs-comment'>-- &gt; isPathSeparator pathSeparator</span>
<a name="line-141"></a><span class='hs-definition'>pathSeparator</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Char</span>
<a name="line-142"></a><span class='hs-definition'>pathSeparator</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>isWindows</span> <span class='hs-keyword'>then</span> <span class='hs-chr'>'\\'</span> <span class='hs-keyword'>else</span> <span class='hs-chr'>'/'</span>
<a name="line-143"></a>
<a name="line-144"></a><a name="pathSeparators"></a><span class='hs-comment'>-- | The list of all possible separators.</span>
<a name="line-145"></a><span class='hs-comment'>--</span>
<a name="line-146"></a><span class='hs-comment'>-- &gt; Windows: pathSeparators == ['\\', '/']</span>
<a name="line-147"></a><span class='hs-comment'>-- &gt; Posix:   pathSeparators == ['/']</span>
<a name="line-148"></a><span class='hs-comment'>-- &gt; pathSeparator `elem` pathSeparators</span>
<a name="line-149"></a><span class='hs-definition'>pathSeparators</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Char</span><span class='hs-keyglyph'>]</span>
<a name="line-150"></a><span class='hs-definition'>pathSeparators</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>isWindows</span> <span class='hs-keyword'>then</span> <span class='hs-str'>"\\/"</span> <span class='hs-keyword'>else</span> <span class='hs-str'>"/"</span>
<a name="line-151"></a>
<a name="line-152"></a><a name="isPathSeparator"></a><span class='hs-comment'>-- | Rather than using @(== 'pathSeparator')@, use this. Test if something</span>
<a name="line-153"></a><span class='hs-comment'>--   is a path separator.</span>
<a name="line-154"></a><span class='hs-comment'>--</span>
<a name="line-155"></a><span class='hs-comment'>-- &gt; isPathSeparator a == (a `elem` pathSeparators)</span>
<a name="line-156"></a><span class='hs-definition'>isPathSeparator</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Char</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-157"></a><span class='hs-definition'>isPathSeparator</span> <span class='hs-chr'>'/'</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
<a name="line-158"></a><span class='hs-definition'>isPathSeparator</span> <span class='hs-chr'>'\\'</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>isWindows</span>
<a name="line-159"></a><span class='hs-definition'>isPathSeparator</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-160"></a>
<a name="line-161"></a>
<a name="line-162"></a><a name="searchPathSeparator"></a><span class='hs-comment'>-- | The character that is used to separate the entries in the $PATH environment variable.</span>
<a name="line-163"></a><span class='hs-comment'>--</span>
<a name="line-164"></a><span class='hs-comment'>-- &gt; Windows: searchPathSeparator == ';'</span>
<a name="line-165"></a><span class='hs-comment'>-- &gt; Posix:   searchPathSeparator == ':'</span>
<a name="line-166"></a><span class='hs-definition'>searchPathSeparator</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Char</span>
<a name="line-167"></a><span class='hs-definition'>searchPathSeparator</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>isWindows</span> <span class='hs-keyword'>then</span> <span class='hs-chr'>';'</span> <span class='hs-keyword'>else</span> <span class='hs-chr'>':'</span>
<a name="line-168"></a>
<a name="line-169"></a><a name="isSearchPathSeparator"></a><span class='hs-comment'>-- | Is the character a file separator?</span>
<a name="line-170"></a><span class='hs-comment'>--</span>
<a name="line-171"></a><span class='hs-comment'>-- &gt; isSearchPathSeparator a == (a == searchPathSeparator)</span>
<a name="line-172"></a><span class='hs-definition'>isSearchPathSeparator</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Char</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-173"></a><span class='hs-definition'>isSearchPathSeparator</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varop'>==</span> <span class='hs-varid'>searchPathSeparator</span><span class='hs-layout'>)</span>
<a name="line-174"></a>
<a name="line-175"></a>
<a name="line-176"></a><a name="extSeparator"></a><span class='hs-comment'>-- | File extension character</span>
<a name="line-177"></a><span class='hs-comment'>--</span>
<a name="line-178"></a><span class='hs-comment'>-- &gt; extSeparator == '.'</span>
<a name="line-179"></a><span class='hs-definition'>extSeparator</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Char</span>
<a name="line-180"></a><span class='hs-definition'>extSeparator</span> <span class='hs-keyglyph'>=</span> <span class='hs-chr'>'.'</span>
<a name="line-181"></a>
<a name="line-182"></a><a name="isExtSeparator"></a><span class='hs-comment'>-- | Is the character an extension character?</span>
<a name="line-183"></a><span class='hs-comment'>--</span>
<a name="line-184"></a><span class='hs-comment'>-- &gt; isExtSeparator a == (a == extSeparator)</span>
<a name="line-185"></a><span class='hs-definition'>isExtSeparator</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Char</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-186"></a><span class='hs-definition'>isExtSeparator</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varop'>==</span> <span class='hs-varid'>extSeparator</span><span class='hs-layout'>)</span>
<a name="line-187"></a>
<a name="line-188"></a>
<a name="line-189"></a><span class='hs-comment'>---------------------------------------------------------------------</span>
<a name="line-190"></a><span class='hs-comment'>-- Path methods (environment $PATH)</span>
<a name="line-191"></a>
<a name="line-192"></a><a name="splitSearchPath"></a><span class='hs-comment'>-- | Take a string, split it on the 'searchPathSeparator' character.</span>
<a name="line-193"></a><span class='hs-comment'>--   Blank items are ignored on Windows, and converted to @.@ on Posix.</span>
<a name="line-194"></a><span class='hs-comment'>--   On Windows path elements are stripped of quotes.</span>
<a name="line-195"></a><span class='hs-comment'>--</span>
<a name="line-196"></a><span class='hs-comment'>--   Follows the recommendations in</span>
<a name="line-197"></a><span class='hs-comment'>--   &lt;<a href="http://www.opengroup.org/onlinepubs/009695399/basedefs/xbd_chap08.html">http://www.opengroup.org/onlinepubs/009695399/basedefs/xbd_chap08.html</a>&gt;</span>
<a name="line-198"></a><span class='hs-comment'>--</span>
<a name="line-199"></a><span class='hs-comment'>-- &gt; Posix:   splitSearchPath "File1:File2:File3"  == ["File1","File2","File3"]</span>
<a name="line-200"></a><span class='hs-comment'>-- &gt; Posix:   splitSearchPath "File1::File2:File3" == ["File1",".","File2","File3"]</span>
<a name="line-201"></a><span class='hs-comment'>-- &gt; Windows: splitSearchPath "File1;File2;File3"  == ["File1","File2","File3"]</span>
<a name="line-202"></a><span class='hs-comment'>-- &gt; Windows: splitSearchPath "File1;;File2;File3" == ["File1","File2","File3"]</span>
<a name="line-203"></a><span class='hs-comment'>-- &gt; Windows: splitSearchPath "File1;\"File2\";File3" == ["File1","File2","File3"]</span>
<a name="line-204"></a><span class='hs-definition'>splitSearchPath</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>String</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>FilePath</span><span class='hs-keyglyph'>]</span>
<a name="line-205"></a><span class='hs-definition'>splitSearchPath</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>f</span>
<a name="line-206"></a>    <span class='hs-keyword'>where</span>
<a name="line-207"></a>    <span class='hs-varid'>f</span> <span class='hs-varid'>xs</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>break</span> <span class='hs-varid'>isSearchPathSeparator</span> <span class='hs-varid'>xs</span> <span class='hs-keyword'>of</span>
<a name="line-208"></a>           <span class='hs-layout'>(</span><span class='hs-varid'>pre</span><span class='hs-layout'>,</span> <span class='hs-conid'>[]</span>    <span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>g</span> <span class='hs-varid'>pre</span>
<a name="line-209"></a>           <span class='hs-layout'>(</span><span class='hs-varid'>pre</span><span class='hs-layout'>,</span> <span class='hs-keyword'>_</span><span class='hs-conop'>:</span><span class='hs-varid'>post</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>g</span> <span class='hs-varid'>pre</span> <span class='hs-varop'>++</span> <span class='hs-varid'>f</span> <span class='hs-varid'>post</span>
<a name="line-210"></a>
<a name="line-211"></a>    <span class='hs-varid'>g</span> <span class='hs-str'>""</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>[</span><span class='hs-str'>"."</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>isPosix</span><span class='hs-keyglyph'>]</span>
<a name="line-212"></a>    <span class='hs-varid'>g</span> <span class='hs-layout'>(</span><span class='hs-chr'>'\"'</span><span class='hs-conop'>:</span><span class='hs-varid'>x</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-keyword'>_</span><span class='hs-conop'>:</span><span class='hs-keyword'>_</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>isWindows</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>last</span> <span class='hs-varid'>x</span> <span class='hs-varop'>==</span> <span class='hs-chr'>'\"'</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>init</span> <span class='hs-varid'>x</span><span class='hs-keyglyph'>]</span>
<a name="line-213"></a>    <span class='hs-varid'>g</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>x</span><span class='hs-keyglyph'>]</span>
<a name="line-214"></a>
<a name="line-215"></a>
<a name="line-216"></a><a name="getSearchPath"></a><span class='hs-comment'>-- | Get a list of 'FilePath's in the $PATH variable.</span>
<a name="line-217"></a><span class='hs-definition'>getSearchPath</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IO</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>FilePath</span><span class='hs-keyglyph'>]</span>
<a name="line-218"></a><span class='hs-definition'>getSearchPath</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fmap</span> <span class='hs-varid'>splitSearchPath</span> <span class='hs-layout'>(</span><span class='hs-varid'>getEnv</span> <span class='hs-str'>"PATH"</span><span class='hs-layout'>)</span>
<a name="line-219"></a>
<a name="line-220"></a>
<a name="line-221"></a><span class='hs-comment'>---------------------------------------------------------------------</span>
<a name="line-222"></a><span class='hs-comment'>-- Extension methods</span>
<a name="line-223"></a>
<a name="line-224"></a><a name="splitExtension"></a><span class='hs-comment'>-- | Split on the extension. 'addExtension' is the inverse.</span>
<a name="line-225"></a><span class='hs-comment'>--</span>
<a name="line-226"></a><span class='hs-comment'>-- &gt; splitExtension "/directory/path.ext" == ("/directory/path",".ext")</span>
<a name="line-227"></a><span class='hs-comment'>-- &gt; uncurry (++) (splitExtension x) == x</span>
<a name="line-228"></a><span class='hs-comment'>-- &gt; Valid x =&gt; uncurry addExtension (splitExtension x) == x</span>
<a name="line-229"></a><span class='hs-comment'>-- &gt; splitExtension "file.txt" == ("file",".txt")</span>
<a name="line-230"></a><span class='hs-comment'>-- &gt; splitExtension "file" == ("file","")</span>
<a name="line-231"></a><span class='hs-comment'>-- &gt; splitExtension "file/file.txt" == ("file/file",".txt")</span>
<a name="line-232"></a><span class='hs-comment'>-- &gt; splitExtension "file.txt/boris" == ("file.txt/boris","")</span>
<a name="line-233"></a><span class='hs-comment'>-- &gt; splitExtension "file.txt/boris.ext" == ("file.txt/boris",".ext")</span>
<a name="line-234"></a><span class='hs-comment'>-- &gt; splitExtension "file/path.txt.bob.fred" == ("file/path.txt.bob",".fred")</span>
<a name="line-235"></a><span class='hs-comment'>-- &gt; splitExtension "file/path.txt/" == ("file/path.txt/","")</span>
<a name="line-236"></a><span class='hs-definition'>splitExtension</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>String</span><span class='hs-layout'>,</span> <span class='hs-conid'>String</span><span class='hs-layout'>)</span>
<a name="line-237"></a><span class='hs-definition'>splitExtension</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>nameDot</span> <span class='hs-keyword'>of</span>
<a name="line-238"></a>                       <span class='hs-str'>""</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-layout'>,</span><span class='hs-str'>""</span><span class='hs-layout'>)</span>
<a name="line-239"></a>                       <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-varid'>dir</span> <span class='hs-varop'>++</span> <span class='hs-varid'>init</span> <span class='hs-varid'>nameDot</span><span class='hs-layout'>,</span> <span class='hs-varid'>extSeparator</span> <span class='hs-conop'>:</span> <span class='hs-varid'>ext</span><span class='hs-layout'>)</span>
<a name="line-240"></a>    <span class='hs-keyword'>where</span>
<a name="line-241"></a>        <span class='hs-layout'>(</span><span class='hs-varid'>dir</span><span class='hs-layout'>,</span><span class='hs-varid'>file</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>splitFileName_</span> <span class='hs-varid'>x</span>
<a name="line-242"></a>        <span class='hs-layout'>(</span><span class='hs-varid'>nameDot</span><span class='hs-layout'>,</span><span class='hs-varid'>ext</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>breakEnd</span> <span class='hs-varid'>isExtSeparator</span> <span class='hs-varid'>file</span>
<a name="line-243"></a>
<a name="line-244"></a><a name="takeExtension"></a><span class='hs-comment'>-- | Get the extension of a file, returns @\"\"@ for no extension, @.ext@ otherwise.</span>
<a name="line-245"></a><span class='hs-comment'>--</span>
<a name="line-246"></a><span class='hs-comment'>-- &gt; takeExtension "/directory/path.ext" == ".ext"</span>
<a name="line-247"></a><span class='hs-comment'>-- &gt; takeExtension x == snd (splitExtension x)</span>
<a name="line-248"></a><span class='hs-comment'>-- &gt; Valid x =&gt; takeExtension (addExtension x "ext") == ".ext"</span>
<a name="line-249"></a><span class='hs-comment'>-- &gt; Valid x =&gt; takeExtension (replaceExtension x "ext") == ".ext"</span>
<a name="line-250"></a><span class='hs-definition'>takeExtension</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>String</span>
<a name="line-251"></a><span class='hs-definition'>takeExtension</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>snd</span> <span class='hs-varop'>.</span> <span class='hs-varid'>splitExtension</span>
<a name="line-252"></a>
<a name="line-253"></a><a name="-%3c.%3e"></a><span class='hs-comment'>-- | Remove the current extension and add another, equivalent to 'replaceExtension'.</span>
<a name="line-254"></a><span class='hs-comment'>--</span>
<a name="line-255"></a><span class='hs-comment'>-- &gt; "/directory/path.txt" -&lt;.&gt; "ext" == "/directory/path.ext"</span>
<a name="line-256"></a><span class='hs-comment'>-- &gt; "/directory/path.txt" -&lt;.&gt; ".ext" == "/directory/path.ext"</span>
<a name="line-257"></a><span class='hs-comment'>-- &gt; "foo.o" -&lt;.&gt; "c" == "foo.c"</span>
<a name="line-258"></a><span class='hs-layout'>(</span><span class='hs-varop'>-&lt;.&gt;</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>String</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FilePath</span>
<a name="line-259"></a><span class='hs-layout'>(</span><span class='hs-varop'>-&lt;.&gt;</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>replaceExtension</span>
<a name="line-260"></a>
<a name="line-261"></a><a name="replaceExtension"></a><span class='hs-comment'>-- | Set the extension of a file, overwriting one if already present, equivalent to '-&lt;.&gt;'.</span>
<a name="line-262"></a><span class='hs-comment'>--</span>
<a name="line-263"></a><span class='hs-comment'>-- &gt; replaceExtension "/directory/path.txt" "ext" == "/directory/path.ext"</span>
<a name="line-264"></a><span class='hs-comment'>-- &gt; replaceExtension "/directory/path.txt" ".ext" == "/directory/path.ext"</span>
<a name="line-265"></a><span class='hs-comment'>-- &gt; replaceExtension "file.txt" ".bob" == "file.bob"</span>
<a name="line-266"></a><span class='hs-comment'>-- &gt; replaceExtension "file.txt" "bob" == "file.bob"</span>
<a name="line-267"></a><span class='hs-comment'>-- &gt; replaceExtension "file" ".bob" == "file.bob"</span>
<a name="line-268"></a><span class='hs-comment'>-- &gt; replaceExtension "file.txt" "" == "file"</span>
<a name="line-269"></a><span class='hs-comment'>-- &gt; replaceExtension "file.fred.bob" "txt" == "file.fred.txt"</span>
<a name="line-270"></a><span class='hs-comment'>-- &gt; replaceExtension x y == addExtension (dropExtension x) y</span>
<a name="line-271"></a><span class='hs-definition'>replaceExtension</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>String</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FilePath</span>
<a name="line-272"></a><span class='hs-definition'>replaceExtension</span> <span class='hs-varid'>x</span> <span class='hs-varid'>y</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>dropExtension</span> <span class='hs-varid'>x</span> <span class='hs-varop'>&lt;.&gt;</span> <span class='hs-varid'>y</span>
<a name="line-273"></a>
<a name="line-274"></a><a name="%3c.%3e"></a><span class='hs-comment'>-- | Add an extension, even if there is already one there, equivalent to 'addExtension'.</span>
<a name="line-275"></a><span class='hs-comment'>--</span>
<a name="line-276"></a><span class='hs-comment'>-- &gt; "/directory/path" &lt;.&gt; "ext" == "/directory/path.ext"</span>
<a name="line-277"></a><span class='hs-comment'>-- &gt; "/directory/path" &lt;.&gt; ".ext" == "/directory/path.ext"</span>
<a name="line-278"></a><span class='hs-layout'>(</span><span class='hs-varop'>&lt;.&gt;</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>String</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FilePath</span>
<a name="line-279"></a><span class='hs-layout'>(</span><span class='hs-varop'>&lt;.&gt;</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>addExtension</span>
<a name="line-280"></a>
<a name="line-281"></a><a name="dropExtension"></a><span class='hs-comment'>-- | Remove last extension, and the \".\" preceding it.</span>
<a name="line-282"></a><span class='hs-comment'>--</span>
<a name="line-283"></a><span class='hs-comment'>-- &gt; dropExtension "/directory/path.ext" == "/directory/path"</span>
<a name="line-284"></a><span class='hs-comment'>-- &gt; dropExtension x == fst (splitExtension x)</span>
<a name="line-285"></a><span class='hs-definition'>dropExtension</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FilePath</span>
<a name="line-286"></a><span class='hs-definition'>dropExtension</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fst</span> <span class='hs-varop'>.</span> <span class='hs-varid'>splitExtension</span>
<a name="line-287"></a>
<a name="line-288"></a><a name="addExtension"></a><span class='hs-comment'>-- | Add an extension, even if there is already one there, equivalent to '&lt;.&gt;'.</span>
<a name="line-289"></a><span class='hs-comment'>--</span>
<a name="line-290"></a><span class='hs-comment'>-- &gt; addExtension "/directory/path" "ext" == "/directory/path.ext"</span>
<a name="line-291"></a><span class='hs-comment'>-- &gt; addExtension "file.txt" "bib" == "file.txt.bib"</span>
<a name="line-292"></a><span class='hs-comment'>-- &gt; addExtension "file." ".bib" == "file..bib"</span>
<a name="line-293"></a><span class='hs-comment'>-- &gt; addExtension "file" ".bib" == "file.bib"</span>
<a name="line-294"></a><span class='hs-comment'>-- &gt; addExtension "/" "x" == "/.x"</span>
<a name="line-295"></a><span class='hs-comment'>-- &gt; addExtension x "" == x</span>
<a name="line-296"></a><span class='hs-comment'>-- &gt; Valid x =&gt; takeFileName (addExtension (addTrailingPathSeparator x) "ext") == ".ext"</span>
<a name="line-297"></a><span class='hs-comment'>-- &gt; Windows: addExtension "\\\\share" ".txt" == "\\\\share\\.txt"</span>
<a name="line-298"></a><span class='hs-definition'>addExtension</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>String</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FilePath</span>
<a name="line-299"></a><span class='hs-definition'>addExtension</span> <span class='hs-varid'>file</span> <span class='hs-str'>""</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>file</span>
<a name="line-300"></a><span class='hs-definition'>addExtension</span> <span class='hs-varid'>file</span> <span class='hs-varid'>xs</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>joinDrive</span> <span class='hs-varid'>a</span> <span class='hs-varid'>res</span>
<a name="line-301"></a>    <span class='hs-keyword'>where</span>
<a name="line-302"></a>        <span class='hs-varid'>res</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>isExtSeparator</span> <span class='hs-varid'>x</span> <span class='hs-keyword'>then</span> <span class='hs-varid'>b</span> <span class='hs-varop'>++</span> <span class='hs-varid'>xs</span>
<a name="line-303"></a>              <span class='hs-keyword'>else</span> <span class='hs-varid'>b</span> <span class='hs-varop'>++</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>extSeparator</span><span class='hs-keyglyph'>]</span> <span class='hs-varop'>++</span> <span class='hs-varid'>xs</span>
<a name="line-304"></a>
<a name="line-305"></a>        <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-layout'>,</span><span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>splitDrive</span> <span class='hs-varid'>file</span>
<a name="line-306"></a>
<a name="line-307"></a><a name="hasExtension"></a><span class='hs-comment'>-- | Does the given filename have an extension?</span>
<a name="line-308"></a><span class='hs-comment'>--</span>
<a name="line-309"></a><span class='hs-comment'>-- &gt; hasExtension "/directory/path.ext" == True</span>
<a name="line-310"></a><span class='hs-comment'>-- &gt; hasExtension "/directory/path" == False</span>
<a name="line-311"></a><span class='hs-comment'>-- &gt; null (takeExtension x) == not (hasExtension x)</span>
<a name="line-312"></a><span class='hs-definition'>hasExtension</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-313"></a><span class='hs-definition'>hasExtension</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>any</span> <span class='hs-varid'>isExtSeparator</span> <span class='hs-varop'>.</span> <span class='hs-varid'>takeFileName</span>
<a name="line-314"></a>
<a name="line-315"></a>
<a name="line-316"></a><a name="isExtensionOf"></a><span class='hs-comment'>-- | Does the given filename have the specified extension?</span>
<a name="line-317"></a><span class='hs-comment'>--</span>
<a name="line-318"></a><span class='hs-comment'>-- &gt; "png" `isExtensionOf` "/directory/file.png" == True</span>
<a name="line-319"></a><span class='hs-comment'>-- &gt; ".png" `isExtensionOf` "/directory/file.png" == True</span>
<a name="line-320"></a><span class='hs-comment'>-- &gt; ".tar.gz" `isExtensionOf` "bar/foo.tar.gz" == True</span>
<a name="line-321"></a><span class='hs-comment'>-- &gt; "ar.gz" `isExtensionOf` "bar/foo.tar.gz" == False</span>
<a name="line-322"></a><span class='hs-comment'>-- &gt; "png" `isExtensionOf` "/directory/file.png.jpg" == False</span>
<a name="line-323"></a><span class='hs-comment'>-- &gt; "csv/table.csv" `isExtensionOf` "/data/csv/table.csv" == False</span>
<a name="line-324"></a><span class='hs-definition'>isExtensionOf</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>String</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-325"></a><span class='hs-definition'>isExtensionOf</span> <span class='hs-varid'>ext</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-chr'>'.'</span><span class='hs-conop'>:</span><span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>isSuffixOf</span> <span class='hs-varid'>ext</span> <span class='hs-varop'>.</span> <span class='hs-varid'>takeExtensions</span>
<a name="line-326"></a><span class='hs-definition'>isExtensionOf</span> <span class='hs-varid'>ext</span>         <span class='hs-keyglyph'>=</span> <span class='hs-varid'>isSuffixOf</span> <span class='hs-layout'>(</span><span class='hs-chr'>'.'</span><span class='hs-conop'>:</span><span class='hs-varid'>ext</span><span class='hs-layout'>)</span> <span class='hs-varop'>.</span> <span class='hs-varid'>takeExtensions</span>
<a name="line-327"></a>
<a name="line-328"></a><a name="stripExtension"></a><span class='hs-comment'>-- | Drop the given extension from a FilePath, and the @\".\"@ preceding it.</span>
<a name="line-329"></a><span class='hs-comment'>--   Returns 'Nothing' if the FilePath does not have the given extension, or</span>
<a name="line-330"></a><span class='hs-comment'>--   'Just' and the part before the extension if it does.</span>
<a name="line-331"></a><span class='hs-comment'>--</span>
<a name="line-332"></a><span class='hs-comment'>--   This function can be more predictable than 'dropExtensions', especially if the filename</span>
<a name="line-333"></a><span class='hs-comment'>--   might itself contain @.@ characters.</span>
<a name="line-334"></a><span class='hs-comment'>--</span>
<a name="line-335"></a><span class='hs-comment'>-- &gt; stripExtension "hs.o" "foo.x.hs.o" == Just "foo.x"</span>
<a name="line-336"></a><span class='hs-comment'>-- &gt; stripExtension "hi.o" "foo.x.hs.o" == Nothing</span>
<a name="line-337"></a><span class='hs-comment'>-- &gt; dropExtension x == fromJust (stripExtension (takeExtension x) x)</span>
<a name="line-338"></a><span class='hs-comment'>-- &gt; dropExtensions x == fromJust (stripExtension (takeExtensions x) x)</span>
<a name="line-339"></a><span class='hs-comment'>-- &gt; stripExtension ".c.d" "a.b.c.d"  == Just "a.b"</span>
<a name="line-340"></a><span class='hs-comment'>-- &gt; stripExtension ".c.d" "a.b..c.d" == Just "a.b."</span>
<a name="line-341"></a><span class='hs-comment'>-- &gt; stripExtension "baz"  "foo.bar"  == Nothing</span>
<a name="line-342"></a><span class='hs-comment'>-- &gt; stripExtension "bar"  "foobar"   == Nothing</span>
<a name="line-343"></a><span class='hs-comment'>-- &gt; stripExtension ""     x          == Just x</span>
<a name="line-344"></a><span class='hs-definition'>stripExtension</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>String</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>FilePath</span>
<a name="line-345"></a><span class='hs-definition'>stripExtension</span> <span class='hs-conid'>[]</span>        <span class='hs-varid'>path</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Just</span> <span class='hs-varid'>path</span>
<a name="line-346"></a><span class='hs-definition'>stripExtension</span> <span class='hs-varid'>ext</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>path</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>stripSuffix</span> <span class='hs-varid'>dotExt</span> <span class='hs-varid'>path</span>
<a name="line-347"></a>    <span class='hs-keyword'>where</span> <span class='hs-varid'>dotExt</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>isExtSeparator</span> <span class='hs-varid'>x</span> <span class='hs-keyword'>then</span> <span class='hs-varid'>ext</span> <span class='hs-keyword'>else</span> <span class='hs-chr'>'.'</span><span class='hs-conop'>:</span><span class='hs-varid'>ext</span>
<a name="line-348"></a>
<a name="line-349"></a>
<a name="line-350"></a><a name="splitExtensions"></a><span class='hs-comment'>-- | Split on all extensions.</span>
<a name="line-351"></a><span class='hs-comment'>--</span>
<a name="line-352"></a><span class='hs-comment'>-- &gt; splitExtensions "/directory/path.ext" == ("/directory/path",".ext")</span>
<a name="line-353"></a><span class='hs-comment'>-- &gt; splitExtensions "file.tar.gz" == ("file",".tar.gz")</span>
<a name="line-354"></a><span class='hs-comment'>-- &gt; uncurry (++) (splitExtensions x) == x</span>
<a name="line-355"></a><span class='hs-comment'>-- &gt; Valid x =&gt; uncurry addExtension (splitExtensions x) == x</span>
<a name="line-356"></a><span class='hs-comment'>-- &gt; splitExtensions "file.tar.gz" == ("file",".tar.gz")</span>
<a name="line-357"></a><span class='hs-definition'>splitExtensions</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>FilePath</span><span class='hs-layout'>,</span> <span class='hs-conid'>String</span><span class='hs-layout'>)</span>
<a name="line-358"></a><span class='hs-definition'>splitExtensions</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-varop'>++</span> <span class='hs-varid'>c</span><span class='hs-layout'>,</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span>
<a name="line-359"></a>    <span class='hs-keyword'>where</span>
<a name="line-360"></a>        <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-layout'>,</span><span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>splitFileName_</span> <span class='hs-varid'>x</span>
<a name="line-361"></a>        <span class='hs-layout'>(</span><span class='hs-varid'>c</span><span class='hs-layout'>,</span><span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>break</span> <span class='hs-varid'>isExtSeparator</span> <span class='hs-varid'>b</span>
<a name="line-362"></a>
<a name="line-363"></a><a name="dropExtensions"></a><span class='hs-comment'>-- | Drop all extensions.</span>
<a name="line-364"></a><span class='hs-comment'>--</span>
<a name="line-365"></a><span class='hs-comment'>-- &gt; dropExtensions "/directory/path.ext" == "/directory/path"</span>
<a name="line-366"></a><span class='hs-comment'>-- &gt; dropExtensions "file.tar.gz" == "file"</span>
<a name="line-367"></a><span class='hs-comment'>-- &gt; not $ hasExtension $ dropExtensions x</span>
<a name="line-368"></a><span class='hs-comment'>-- &gt; not $ any isExtSeparator $ takeFileName $ dropExtensions x</span>
<a name="line-369"></a><span class='hs-definition'>dropExtensions</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FilePath</span>
<a name="line-370"></a><span class='hs-definition'>dropExtensions</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fst</span> <span class='hs-varop'>.</span> <span class='hs-varid'>splitExtensions</span>
<a name="line-371"></a>
<a name="line-372"></a><a name="takeExtensions"></a><span class='hs-comment'>-- | Get all extensions.</span>
<a name="line-373"></a><span class='hs-comment'>--</span>
<a name="line-374"></a><span class='hs-comment'>-- &gt; takeExtensions "/directory/path.ext" == ".ext"</span>
<a name="line-375"></a><span class='hs-comment'>-- &gt; takeExtensions "file.tar.gz" == ".tar.gz"</span>
<a name="line-376"></a><span class='hs-definition'>takeExtensions</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>String</span>
<a name="line-377"></a><span class='hs-definition'>takeExtensions</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>snd</span> <span class='hs-varop'>.</span> <span class='hs-varid'>splitExtensions</span>
<a name="line-378"></a>
<a name="line-379"></a>
<a name="line-380"></a><a name="replaceExtensions"></a><span class='hs-comment'>-- | Replace all extensions of a file with a new extension. Note</span>
<a name="line-381"></a><span class='hs-comment'>--   that 'replaceExtension' and 'addExtension' both work for adding</span>
<a name="line-382"></a><span class='hs-comment'>--   multiple extensions, so only required when you need to drop</span>
<a name="line-383"></a><span class='hs-comment'>--   all extensions first.</span>
<a name="line-384"></a><span class='hs-comment'>--</span>
<a name="line-385"></a><span class='hs-comment'>-- &gt; replaceExtensions "file.fred.bob" "txt" == "file.txt"</span>
<a name="line-386"></a><span class='hs-comment'>-- &gt; replaceExtensions "file.fred.bob" "tar.gz" == "file.tar.gz"</span>
<a name="line-387"></a><span class='hs-definition'>replaceExtensions</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>String</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FilePath</span>
<a name="line-388"></a><span class='hs-definition'>replaceExtensions</span> <span class='hs-varid'>x</span> <span class='hs-varid'>y</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>dropExtensions</span> <span class='hs-varid'>x</span> <span class='hs-varop'>&lt;.&gt;</span> <span class='hs-varid'>y</span>
<a name="line-389"></a>
<a name="line-390"></a>
<a name="line-391"></a>
<a name="line-392"></a><span class='hs-comment'>---------------------------------------------------------------------</span>
<a name="line-393"></a><span class='hs-comment'>-- Drive methods</span>
<a name="line-394"></a>
<a name="line-395"></a><a name="isLetter"></a><span class='hs-comment'>-- | Is the given character a valid drive letter?</span>
<a name="line-396"></a><span class='hs-comment'>-- only a-z and A-Z are letters, not isAlpha which is more unicodey</span>
<a name="line-397"></a><span class='hs-definition'>isLetter</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Char</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-398"></a><span class='hs-definition'>isLetter</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>isAsciiLower</span> <span class='hs-varid'>x</span> <span class='hs-varop'>||</span> <span class='hs-varid'>isAsciiUpper</span> <span class='hs-varid'>x</span>
<a name="line-399"></a>
<a name="line-400"></a>
<a name="line-401"></a><a name="splitDrive"></a><span class='hs-comment'>-- | Split a path into a drive and a path.</span>
<a name="line-402"></a><span class='hs-comment'>--   On Posix, \/ is a Drive.</span>
<a name="line-403"></a><span class='hs-comment'>--</span>
<a name="line-404"></a><span class='hs-comment'>-- &gt; uncurry (++) (splitDrive x) == x</span>
<a name="line-405"></a><span class='hs-comment'>-- &gt; Windows: splitDrive "file" == ("","file")</span>
<a name="line-406"></a><span class='hs-comment'>-- &gt; Windows: splitDrive "c:/file" == ("c:/","file")</span>
<a name="line-407"></a><span class='hs-comment'>-- &gt; Windows: splitDrive "c:\\file" == ("c:\\","file")</span>
<a name="line-408"></a><span class='hs-comment'>-- &gt; Windows: splitDrive "\\\\shared\\test" == ("\\\\shared\\","test")</span>
<a name="line-409"></a><span class='hs-comment'>-- &gt; Windows: splitDrive "\\\\shared" == ("\\\\shared","")</span>
<a name="line-410"></a><span class='hs-comment'>-- &gt; Windows: splitDrive "\\\\?\\UNC\\shared\\file" == ("\\\\?\\UNC\\shared\\","file")</span>
<a name="line-411"></a><span class='hs-comment'>-- &gt; Windows: splitDrive "\\\\?\\UNCshared\\file" == ("\\\\?\\","UNCshared\\file")</span>
<a name="line-412"></a><span class='hs-comment'>-- &gt; Windows: splitDrive "\\\\?\\d:\\file" == ("\\\\?\\d:\\","file")</span>
<a name="line-413"></a><span class='hs-comment'>-- &gt; Windows: splitDrive "/d" == ("","/d")</span>
<a name="line-414"></a><span class='hs-comment'>-- &gt; Posix:   splitDrive "/test" == ("/","test")</span>
<a name="line-415"></a><span class='hs-comment'>-- &gt; Posix:   splitDrive "//test" == ("//","test")</span>
<a name="line-416"></a><span class='hs-comment'>-- &gt; Posix:   splitDrive "test/file" == ("","test/file")</span>
<a name="line-417"></a><span class='hs-comment'>-- &gt; Posix:   splitDrive "file" == ("","file")</span>
<a name="line-418"></a><span class='hs-definition'>splitDrive</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>FilePath</span><span class='hs-layout'>,</span> <span class='hs-conid'>FilePath</span><span class='hs-layout'>)</span>
<a name="line-419"></a><span class='hs-definition'>splitDrive</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>isPosix</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>span</span> <span class='hs-layout'>(</span><span class='hs-varop'>==</span> <span class='hs-chr'>'/'</span><span class='hs-layout'>)</span> <span class='hs-varid'>x</span>
<a name="line-420"></a><span class='hs-definition'>splitDrive</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Just</span> <span class='hs-varid'>y</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>readDriveLetter</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>y</span>
<a name="line-421"></a><span class='hs-definition'>splitDrive</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Just</span> <span class='hs-varid'>y</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>readDriveUNC</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>y</span>
<a name="line-422"></a><span class='hs-definition'>splitDrive</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Just</span> <span class='hs-varid'>y</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>readDriveShare</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>y</span>
<a name="line-423"></a><span class='hs-definition'>splitDrive</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-str'>""</span><span class='hs-layout'>,</span><span class='hs-varid'>x</span><span class='hs-layout'>)</span>
<a name="line-424"></a>
<a name="line-425"></a><a name="addSlash"></a><span class='hs-definition'>addSlash</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>FilePath</span><span class='hs-layout'>,</span> <span class='hs-conid'>FilePath</span><span class='hs-layout'>)</span>
<a name="line-426"></a><span class='hs-definition'>addSlash</span> <span class='hs-varid'>a</span> <span class='hs-varid'>xs</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-varop'>++</span><span class='hs-varid'>c</span><span class='hs-layout'>,</span><span class='hs-varid'>d</span><span class='hs-layout'>)</span>
<a name="line-427"></a>    <span class='hs-keyword'>where</span> <span class='hs-layout'>(</span><span class='hs-varid'>c</span><span class='hs-layout'>,</span><span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>span</span> <span class='hs-varid'>isPathSeparator</span> <span class='hs-varid'>xs</span>
<a name="line-428"></a>
<a name="line-429"></a><a name="readDriveUNC"></a><span class='hs-comment'>-- See [1].</span>
<a name="line-430"></a><span class='hs-comment'>-- "\\?\D:\&lt;path&gt;" or "\\?\UNC\&lt;server&gt;\&lt;share&gt;"</span>
<a name="line-431"></a><span class='hs-definition'>readDriveUNC</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Maybe</span> <span class='hs-layout'>(</span><span class='hs-conid'>FilePath</span><span class='hs-layout'>,</span> <span class='hs-conid'>FilePath</span><span class='hs-layout'>)</span>
<a name="line-432"></a><span class='hs-definition'>readDriveUNC</span> <span class='hs-layout'>(</span><span class='hs-varid'>s1</span><span class='hs-conop'>:</span><span class='hs-varid'>s2</span><span class='hs-conop'>:</span><span class='hs-chr'>'?'</span><span class='hs-conop'>:</span><span class='hs-varid'>s3</span><span class='hs-conop'>:</span><span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>all</span> <span class='hs-varid'>isPathSeparator</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>s1</span><span class='hs-layout'>,</span><span class='hs-varid'>s2</span><span class='hs-layout'>,</span><span class='hs-varid'>s3</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>=</span>
<a name="line-433"></a>    <span class='hs-keyword'>case</span> <span class='hs-varid'>map</span> <span class='hs-varid'>toUpper</span> <span class='hs-varid'>xs</span> <span class='hs-keyword'>of</span>
<a name="line-434"></a>        <span class='hs-layout'>(</span><span class='hs-chr'>'U'</span><span class='hs-conop'>:</span><span class='hs-chr'>'N'</span><span class='hs-conop'>:</span><span class='hs-chr'>'C'</span><span class='hs-conop'>:</span><span class='hs-varid'>s4</span><span class='hs-conop'>:</span><span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>isPathSeparator</span> <span class='hs-varid'>s4</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-435"></a>            <span class='hs-keyword'>let</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-layout'>,</span><span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>readDriveShareName</span> <span class='hs-layout'>(</span><span class='hs-varid'>drop</span> <span class='hs-num'>4</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span>
<a name="line-436"></a>            <span class='hs-keyword'>in</span> <span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><span class='hs-varid'>s1</span><span class='hs-conop'>:</span><span class='hs-varid'>s2</span><span class='hs-conop'>:</span><span class='hs-chr'>'?'</span><span class='hs-conop'>:</span><span class='hs-varid'>s3</span><span class='hs-conop'>:</span><span class='hs-varid'>take</span> <span class='hs-num'>4</span> <span class='hs-varid'>xs</span> <span class='hs-varop'>++</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-437"></a>        <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>readDriveLetter</span> <span class='hs-varid'>xs</span> <span class='hs-keyword'>of</span>
<a name="line-438"></a>                 <span class='hs-comment'>-- Extended-length path.</span>
<a name="line-439"></a>                 <span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-layout'>,</span><span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><span class='hs-varid'>s1</span><span class='hs-conop'>:</span><span class='hs-varid'>s2</span><span class='hs-conop'>:</span><span class='hs-chr'>'?'</span><span class='hs-conop'>:</span><span class='hs-varid'>s3</span><span class='hs-conop'>:</span><span class='hs-varid'>a</span><span class='hs-layout'>,</span><span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-440"></a>                 <span class='hs-conid'>Nothing</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Nothing</span>
<a name="line-441"></a><span class='hs-definition'>readDriveUNC</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Nothing</span>
<a name="line-442"></a>
<a name="line-443"></a><a name="readDriveLetter"></a><span class='hs-comment'>{- c:\ -}</span>
<a name="line-444"></a><span class='hs-definition'>readDriveLetter</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>String</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Maybe</span> <span class='hs-layout'>(</span><span class='hs-conid'>FilePath</span><span class='hs-layout'>,</span> <span class='hs-conid'>FilePath</span><span class='hs-layout'>)</span>
<a name="line-445"></a><span class='hs-definition'>readDriveLetter</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-chr'>':'</span><span class='hs-conop'>:</span><span class='hs-varid'>y</span><span class='hs-conop'>:</span><span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>isLetter</span> <span class='hs-varid'>x</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>isPathSeparator</span> <span class='hs-varid'>y</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Just</span> <span class='hs-varop'>$</span> <span class='hs-varid'>addSlash</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>x</span><span class='hs-layout'>,</span><span class='hs-chr'>':'</span><span class='hs-keyglyph'>]</span> <span class='hs-layout'>(</span><span class='hs-varid'>y</span><span class='hs-conop'>:</span><span class='hs-varid'>xs</span><span class='hs-layout'>)</span>
<a name="line-446"></a><span class='hs-definition'>readDriveLetter</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-chr'>':'</span><span class='hs-conop'>:</span><span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>isLetter</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>[</span><span class='hs-varid'>x</span><span class='hs-layout'>,</span><span class='hs-chr'>':'</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span>
<a name="line-447"></a><span class='hs-definition'>readDriveLetter</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Nothing</span>
<a name="line-448"></a>
<a name="line-449"></a><a name="readDriveShare"></a><span class='hs-comment'>{- \\sharename\ -}</span>
<a name="line-450"></a><span class='hs-definition'>readDriveShare</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>String</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Maybe</span> <span class='hs-layout'>(</span><span class='hs-conid'>FilePath</span><span class='hs-layout'>,</span> <span class='hs-conid'>FilePath</span><span class='hs-layout'>)</span>
<a name="line-451"></a><span class='hs-definition'>readDriveShare</span> <span class='hs-layout'>(</span><span class='hs-varid'>s1</span><span class='hs-conop'>:</span><span class='hs-varid'>s2</span><span class='hs-conop'>:</span><span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>isPathSeparator</span> <span class='hs-varid'>s1</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>isPathSeparator</span> <span class='hs-varid'>s2</span> <span class='hs-keyglyph'>=</span>
<a name="line-452"></a>        <span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><span class='hs-varid'>s1</span><span class='hs-conop'>:</span><span class='hs-varid'>s2</span><span class='hs-conop'>:</span><span class='hs-varid'>a</span><span class='hs-layout'>,</span><span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-453"></a>    <span class='hs-keyword'>where</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-layout'>,</span><span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>readDriveShareName</span> <span class='hs-varid'>xs</span>
<a name="line-454"></a><span class='hs-definition'>readDriveShare</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Nothing</span>
<a name="line-455"></a>
<a name="line-456"></a><a name="readDriveShareName"></a><span class='hs-comment'>{- assume you have already seen \\ -}</span>
<a name="line-457"></a><span class='hs-comment'>{- share\bob -&gt; "share\", "bob" -}</span>
<a name="line-458"></a><span class='hs-definition'>readDriveShareName</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>String</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>FilePath</span><span class='hs-layout'>,</span> <span class='hs-conid'>FilePath</span><span class='hs-layout'>)</span>
<a name="line-459"></a><span class='hs-definition'>readDriveShareName</span> <span class='hs-varid'>name</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>addSlash</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span>
<a name="line-460"></a>    <span class='hs-keyword'>where</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-layout'>,</span><span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>break</span> <span class='hs-varid'>isPathSeparator</span> <span class='hs-varid'>name</span>
<a name="line-461"></a>
<a name="line-462"></a>
<a name="line-463"></a>
<a name="line-464"></a><a name="joinDrive"></a><span class='hs-comment'>-- | Join a drive and the rest of the path.</span>
<a name="line-465"></a><span class='hs-comment'>--</span>
<a name="line-466"></a><span class='hs-comment'>-- &gt; Valid x =&gt; uncurry joinDrive (splitDrive x) == x</span>
<a name="line-467"></a><span class='hs-comment'>-- &gt; Windows: joinDrive "C:" "foo" == "C:foo"</span>
<a name="line-468"></a><span class='hs-comment'>-- &gt; Windows: joinDrive "C:\\" "bar" == "C:\\bar"</span>
<a name="line-469"></a><span class='hs-comment'>-- &gt; Windows: joinDrive "\\\\share" "foo" == "\\\\share\\foo"</span>
<a name="line-470"></a><span class='hs-comment'>-- &gt; Windows: joinDrive "/:" "foo" == "/:\\foo"</span>
<a name="line-471"></a><span class='hs-definition'>joinDrive</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FilePath</span>
<a name="line-472"></a><span class='hs-definition'>joinDrive</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>combineAlways</span>
<a name="line-473"></a>
<a name="line-474"></a><a name="takeDrive"></a><span class='hs-comment'>-- | Get the drive from a filepath.</span>
<a name="line-475"></a><span class='hs-comment'>--</span>
<a name="line-476"></a><span class='hs-comment'>-- &gt; takeDrive x == fst (splitDrive x)</span>
<a name="line-477"></a><span class='hs-definition'>takeDrive</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FilePath</span>
<a name="line-478"></a><span class='hs-definition'>takeDrive</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fst</span> <span class='hs-varop'>.</span> <span class='hs-varid'>splitDrive</span>
<a name="line-479"></a>
<a name="line-480"></a><a name="dropDrive"></a><span class='hs-comment'>-- | Delete the drive, if it exists.</span>
<a name="line-481"></a><span class='hs-comment'>--</span>
<a name="line-482"></a><span class='hs-comment'>-- &gt; dropDrive x == snd (splitDrive x)</span>
<a name="line-483"></a><span class='hs-definition'>dropDrive</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FilePath</span>
<a name="line-484"></a><span class='hs-definition'>dropDrive</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>snd</span> <span class='hs-varop'>.</span> <span class='hs-varid'>splitDrive</span>
<a name="line-485"></a>
<a name="line-486"></a><a name="hasDrive"></a><span class='hs-comment'>-- | Does a path have a drive.</span>
<a name="line-487"></a><span class='hs-comment'>--</span>
<a name="line-488"></a><span class='hs-comment'>-- &gt; not (hasDrive x) == null (takeDrive x)</span>
<a name="line-489"></a><span class='hs-comment'>-- &gt; Posix:   hasDrive "/foo" == True</span>
<a name="line-490"></a><span class='hs-comment'>-- &gt; Windows: hasDrive "C:\\foo" == True</span>
<a name="line-491"></a><span class='hs-comment'>-- &gt; Windows: hasDrive "C:foo" == True</span>
<a name="line-492"></a><span class='hs-comment'>-- &gt;          hasDrive "foo" == False</span>
<a name="line-493"></a><span class='hs-comment'>-- &gt;          hasDrive "" == False</span>
<a name="line-494"></a><span class='hs-definition'>hasDrive</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-495"></a><span class='hs-definition'>hasDrive</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>not</span> <span class='hs-varop'>.</span> <span class='hs-varid'>null</span> <span class='hs-varop'>.</span> <span class='hs-varid'>takeDrive</span>
<a name="line-496"></a>
<a name="line-497"></a>
<a name="line-498"></a><a name="isDrive"></a><span class='hs-comment'>-- | Is an element a drive</span>
<a name="line-499"></a><span class='hs-comment'>--</span>
<a name="line-500"></a><span class='hs-comment'>-- &gt; Posix:   isDrive "/" == True</span>
<a name="line-501"></a><span class='hs-comment'>-- &gt; Posix:   isDrive "/foo" == False</span>
<a name="line-502"></a><span class='hs-comment'>-- &gt; Windows: isDrive "C:\\" == True</span>
<a name="line-503"></a><span class='hs-comment'>-- &gt; Windows: isDrive "C:\\foo" == False</span>
<a name="line-504"></a><span class='hs-comment'>-- &gt;          isDrive "" == False</span>
<a name="line-505"></a><span class='hs-definition'>isDrive</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-506"></a><span class='hs-definition'>isDrive</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>not</span> <span class='hs-layout'>(</span><span class='hs-varid'>null</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>null</span> <span class='hs-layout'>(</span><span class='hs-varid'>dropDrive</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span>
<a name="line-507"></a>
<a name="line-508"></a>
<a name="line-509"></a><span class='hs-comment'>---------------------------------------------------------------------</span>
<a name="line-510"></a><span class='hs-comment'>-- Operations on a filepath, as a list of directories</span>
<a name="line-511"></a>
<a name="line-512"></a><a name="splitFileName"></a><span class='hs-comment'>-- | Split a filename into directory and file. '&lt;/&gt;' is the inverse.</span>
<a name="line-513"></a><span class='hs-comment'>--   The first component will often end with a trailing slash.</span>
<a name="line-514"></a><span class='hs-comment'>--</span>
<a name="line-515"></a><span class='hs-comment'>-- &gt; splitFileName "/directory/file.ext" == ("/directory/","file.ext")</span>
<a name="line-516"></a><span class='hs-comment'>-- &gt; Valid x =&gt; uncurry (&lt;/&gt;) (splitFileName x) == x || fst (splitFileName x) == "./"</span>
<a name="line-517"></a><span class='hs-comment'>-- &gt; Valid x =&gt; isValid (fst (splitFileName x))</span>
<a name="line-518"></a><span class='hs-comment'>-- &gt; splitFileName "file/bob.txt" == ("file/", "bob.txt")</span>
<a name="line-519"></a><span class='hs-comment'>-- &gt; splitFileName "file/" == ("file/", "")</span>
<a name="line-520"></a><span class='hs-comment'>-- &gt; splitFileName "bob" == ("./", "bob")</span>
<a name="line-521"></a><span class='hs-comment'>-- &gt; Posix:   splitFileName "/" == ("/","")</span>
<a name="line-522"></a><span class='hs-comment'>-- &gt; Windows: splitFileName "c:" == ("c:","")</span>
<a name="line-523"></a><span class='hs-definition'>splitFileName</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>String</span><span class='hs-layout'>,</span> <span class='hs-conid'>String</span><span class='hs-layout'>)</span>
<a name="line-524"></a><span class='hs-definition'>splitFileName</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-keyword'>if</span> <span class='hs-varid'>null</span> <span class='hs-varid'>dir</span> <span class='hs-keyword'>then</span> <span class='hs-str'>"./"</span> <span class='hs-keyword'>else</span> <span class='hs-varid'>dir</span><span class='hs-layout'>,</span> <span class='hs-varid'>name</span><span class='hs-layout'>)</span>
<a name="line-525"></a>    <span class='hs-keyword'>where</span>
<a name="line-526"></a>        <span class='hs-layout'>(</span><span class='hs-varid'>dir</span><span class='hs-layout'>,</span> <span class='hs-varid'>name</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>splitFileName_</span> <span class='hs-varid'>x</span>
<a name="line-527"></a>
<a name="line-528"></a><a name="splitFileName_"></a><span class='hs-comment'>-- version of splitFileName where, if the FilePath has no directory</span>
<a name="line-529"></a><span class='hs-comment'>-- component, the returned directory is "" rather than "./".  This</span>
<a name="line-530"></a><span class='hs-comment'>-- is used in cases where we are going to combine the returned</span>
<a name="line-531"></a><span class='hs-comment'>-- directory to make a valid FilePath, and having a "./" appear would</span>
<a name="line-532"></a><span class='hs-comment'>-- look strange and upset simple equality properties.  See</span>
<a name="line-533"></a><span class='hs-comment'>-- e.g. replaceFileName.</span>
<a name="line-534"></a><span class='hs-definition'>splitFileName_</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>String</span><span class='hs-layout'>,</span> <span class='hs-conid'>String</span><span class='hs-layout'>)</span>
<a name="line-535"></a><span class='hs-definition'>splitFileName_</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>drv</span> <span class='hs-varop'>++</span> <span class='hs-varid'>dir</span><span class='hs-layout'>,</span> <span class='hs-varid'>file</span><span class='hs-layout'>)</span>
<a name="line-536"></a>    <span class='hs-keyword'>where</span>
<a name="line-537"></a>        <span class='hs-layout'>(</span><span class='hs-varid'>drv</span><span class='hs-layout'>,</span><span class='hs-varid'>pth</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>splitDrive</span> <span class='hs-varid'>x</span>
<a name="line-538"></a>        <span class='hs-layout'>(</span><span class='hs-varid'>dir</span><span class='hs-layout'>,</span><span class='hs-varid'>file</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>breakEnd</span> <span class='hs-varid'>isPathSeparator</span> <span class='hs-varid'>pth</span>
<a name="line-539"></a>
<a name="line-540"></a><a name="replaceFileName"></a><span class='hs-comment'>-- | Set the filename.</span>
<a name="line-541"></a><span class='hs-comment'>--</span>
<a name="line-542"></a><span class='hs-comment'>-- &gt; replaceFileName "/directory/other.txt" "file.ext" == "/directory/file.ext"</span>
<a name="line-543"></a><span class='hs-comment'>-- &gt; Valid x =&gt; replaceFileName x (takeFileName x) == x</span>
<a name="line-544"></a><span class='hs-definition'>replaceFileName</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>String</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FilePath</span>
<a name="line-545"></a><span class='hs-definition'>replaceFileName</span> <span class='hs-varid'>x</span> <span class='hs-varid'>y</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a</span> <span class='hs-varop'>&lt;/&gt;</span> <span class='hs-varid'>y</span> <span class='hs-keyword'>where</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-layout'>,</span><span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>splitFileName_</span> <span class='hs-varid'>x</span>
<a name="line-546"></a>
<a name="line-547"></a><a name="dropFileName"></a><span class='hs-comment'>-- | Drop the filename. Unlike 'takeDirectory', this function will leave</span>
<a name="line-548"></a><span class='hs-comment'>--   a trailing path separator on the directory.</span>
<a name="line-549"></a><span class='hs-comment'>--</span>
<a name="line-550"></a><span class='hs-comment'>-- &gt; dropFileName "/directory/file.ext" == "/directory/"</span>
<a name="line-551"></a><span class='hs-comment'>-- &gt; dropFileName x == fst (splitFileName x)</span>
<a name="line-552"></a><span class='hs-definition'>dropFileName</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FilePath</span>
<a name="line-553"></a><span class='hs-definition'>dropFileName</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fst</span> <span class='hs-varop'>.</span> <span class='hs-varid'>splitFileName</span>
<a name="line-554"></a>
<a name="line-555"></a>
<a name="line-556"></a><a name="takeFileName"></a><span class='hs-comment'>-- | Get the file name.</span>
<a name="line-557"></a><span class='hs-comment'>--</span>
<a name="line-558"></a><span class='hs-comment'>-- &gt; takeFileName "/directory/file.ext" == "file.ext"</span>
<a name="line-559"></a><span class='hs-comment'>-- &gt; takeFileName "test/" == ""</span>
<a name="line-560"></a><span class='hs-comment'>-- &gt; takeFileName x `isSuffixOf` x</span>
<a name="line-561"></a><span class='hs-comment'>-- &gt; takeFileName x == snd (splitFileName x)</span>
<a name="line-562"></a><span class='hs-comment'>-- &gt; Valid x =&gt; takeFileName (replaceFileName x "fred") == "fred"</span>
<a name="line-563"></a><span class='hs-comment'>-- &gt; Valid x =&gt; takeFileName (x &lt;/&gt; "fred") == "fred"</span>
<a name="line-564"></a><span class='hs-comment'>-- &gt; Valid x =&gt; isRelative (takeFileName x)</span>
<a name="line-565"></a><span class='hs-definition'>takeFileName</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FilePath</span>
<a name="line-566"></a><span class='hs-definition'>takeFileName</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>snd</span> <span class='hs-varop'>.</span> <span class='hs-varid'>splitFileName</span>
<a name="line-567"></a>
<a name="line-568"></a><a name="takeBaseName"></a><span class='hs-comment'>-- | Get the base name, without an extension or path.</span>
<a name="line-569"></a><span class='hs-comment'>--</span>
<a name="line-570"></a><span class='hs-comment'>-- &gt; takeBaseName "/directory/file.ext" == "file"</span>
<a name="line-571"></a><span class='hs-comment'>-- &gt; takeBaseName "file/test.txt" == "test"</span>
<a name="line-572"></a><span class='hs-comment'>-- &gt; takeBaseName "dave.ext" == "dave"</span>
<a name="line-573"></a><span class='hs-comment'>-- &gt; takeBaseName "" == ""</span>
<a name="line-574"></a><span class='hs-comment'>-- &gt; takeBaseName "test" == "test"</span>
<a name="line-575"></a><span class='hs-comment'>-- &gt; takeBaseName (addTrailingPathSeparator x) == ""</span>
<a name="line-576"></a><span class='hs-comment'>-- &gt; takeBaseName "file/file.tar.gz" == "file.tar"</span>
<a name="line-577"></a><span class='hs-definition'>takeBaseName</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>String</span>
<a name="line-578"></a><span class='hs-definition'>takeBaseName</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>dropExtension</span> <span class='hs-varop'>.</span> <span class='hs-varid'>takeFileName</span>
<a name="line-579"></a>
<a name="line-580"></a><a name="replaceBaseName"></a><span class='hs-comment'>-- | Set the base name.</span>
<a name="line-581"></a><span class='hs-comment'>--</span>
<a name="line-582"></a><span class='hs-comment'>-- &gt; replaceBaseName "/directory/other.ext" "file" == "/directory/file.ext"</span>
<a name="line-583"></a><span class='hs-comment'>-- &gt; replaceBaseName "file/test.txt" "bob" == "file/bob.txt"</span>
<a name="line-584"></a><span class='hs-comment'>-- &gt; replaceBaseName "fred" "bill" == "bill"</span>
<a name="line-585"></a><span class='hs-comment'>-- &gt; replaceBaseName "/dave/fred/bob.gz.tar" "new" == "/dave/fred/new.tar"</span>
<a name="line-586"></a><span class='hs-comment'>-- &gt; Valid x =&gt; replaceBaseName x (takeBaseName x) == x</span>
<a name="line-587"></a><span class='hs-definition'>replaceBaseName</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>String</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FilePath</span>
<a name="line-588"></a><span class='hs-definition'>replaceBaseName</span> <span class='hs-varid'>pth</span> <span class='hs-varid'>nam</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>combineAlways</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-varid'>nam</span> <span class='hs-varop'>&lt;.&gt;</span> <span class='hs-varid'>ext</span><span class='hs-layout'>)</span>
<a name="line-589"></a>    <span class='hs-keyword'>where</span>
<a name="line-590"></a>        <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-layout'>,</span><span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>splitFileName_</span> <span class='hs-varid'>pth</span>
<a name="line-591"></a>        <span class='hs-varid'>ext</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>takeExtension</span> <span class='hs-varid'>b</span>
<a name="line-592"></a>
<a name="line-593"></a><a name="hasTrailingPathSeparator"></a><span class='hs-comment'>-- | Is an item either a directory or the last character a path separator?</span>
<a name="line-594"></a><span class='hs-comment'>--</span>
<a name="line-595"></a><span class='hs-comment'>-- &gt; hasTrailingPathSeparator "test" == False</span>
<a name="line-596"></a><span class='hs-comment'>-- &gt; hasTrailingPathSeparator "test/" == True</span>
<a name="line-597"></a><span class='hs-definition'>hasTrailingPathSeparator</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-598"></a><span class='hs-definition'>hasTrailingPathSeparator</span> <span class='hs-str'>""</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-599"></a><span class='hs-definition'>hasTrailingPathSeparator</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>isPathSeparator</span> <span class='hs-layout'>(</span><span class='hs-varid'>last</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span>
<a name="line-600"></a>
<a name="line-601"></a>
<a name="line-602"></a><a name="hasLeadingPathSeparator"></a><span class='hs-definition'>hasLeadingPathSeparator</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-603"></a><span class='hs-definition'>hasLeadingPathSeparator</span> <span class='hs-str'>""</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-604"></a><span class='hs-definition'>hasLeadingPathSeparator</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>isPathSeparator</span> <span class='hs-layout'>(</span><span class='hs-varid'>head</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span>
<a name="line-605"></a>
<a name="line-606"></a>
<a name="line-607"></a><a name="addTrailingPathSeparator"></a><span class='hs-comment'>-- | Add a trailing file path separator if one is not already present.</span>
<a name="line-608"></a><span class='hs-comment'>--</span>
<a name="line-609"></a><span class='hs-comment'>-- &gt; hasTrailingPathSeparator (addTrailingPathSeparator x)</span>
<a name="line-610"></a><span class='hs-comment'>-- &gt; hasTrailingPathSeparator x ==&gt; addTrailingPathSeparator x == x</span>
<a name="line-611"></a><span class='hs-comment'>-- &gt; Posix:    addTrailingPathSeparator "test/rest" == "test/rest/"</span>
<a name="line-612"></a><span class='hs-definition'>addTrailingPathSeparator</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FilePath</span>
<a name="line-613"></a><span class='hs-definition'>addTrailingPathSeparator</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>hasTrailingPathSeparator</span> <span class='hs-varid'>x</span> <span class='hs-keyword'>then</span> <span class='hs-varid'>x</span> <span class='hs-keyword'>else</span> <span class='hs-varid'>x</span> <span class='hs-varop'>++</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>pathSeparator</span><span class='hs-keyglyph'>]</span>
<a name="line-614"></a>
<a name="line-615"></a>
<a name="line-616"></a><a name="dropTrailingPathSeparator"></a><span class='hs-comment'>-- | Remove any trailing path separators</span>
<a name="line-617"></a><span class='hs-comment'>--</span>
<a name="line-618"></a><span class='hs-comment'>-- &gt; dropTrailingPathSeparator "file/test/" == "file/test"</span>
<a name="line-619"></a><span class='hs-comment'>-- &gt;           dropTrailingPathSeparator "/" == "/"</span>
<a name="line-620"></a><span class='hs-comment'>-- &gt; Windows:  dropTrailingPathSeparator "\\" == "\\"</span>
<a name="line-621"></a><span class='hs-comment'>-- &gt; Posix:    not (hasTrailingPathSeparator (dropTrailingPathSeparator x)) || isDrive x</span>
<a name="line-622"></a><span class='hs-definition'>dropTrailingPathSeparator</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FilePath</span>
<a name="line-623"></a><span class='hs-definition'>dropTrailingPathSeparator</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span>
<a name="line-624"></a>    <span class='hs-keyword'>if</span> <span class='hs-varid'>hasTrailingPathSeparator</span> <span class='hs-varid'>x</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>not</span> <span class='hs-layout'>(</span><span class='hs-varid'>isDrive</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span>
<a name="line-625"></a>    <span class='hs-keyword'>then</span> <span class='hs-keyword'>let</span> <span class='hs-varid'>x'</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>dropWhileEnd</span> <span class='hs-varid'>isPathSeparator</span> <span class='hs-varid'>x</span>
<a name="line-626"></a>         <span class='hs-keyword'>in</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>null</span> <span class='hs-varid'>x'</span> <span class='hs-keyword'>then</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>last</span> <span class='hs-varid'>x</span><span class='hs-keyglyph'>]</span> <span class='hs-keyword'>else</span> <span class='hs-varid'>x'</span>
<a name="line-627"></a>    <span class='hs-keyword'>else</span> <span class='hs-varid'>x</span>
<a name="line-628"></a>
<a name="line-629"></a>
<a name="line-630"></a><a name="takeDirectory"></a><span class='hs-comment'>-- | Get the directory name, move up one level.</span>
<a name="line-631"></a><span class='hs-comment'>--</span>
<a name="line-632"></a><span class='hs-comment'>-- &gt;           takeDirectory "/directory/other.ext" == "/directory"</span>
<a name="line-633"></a><span class='hs-comment'>-- &gt;           takeDirectory x `isPrefixOf` x || takeDirectory x == "."</span>
<a name="line-634"></a><span class='hs-comment'>-- &gt;           takeDirectory "foo" == "."</span>
<a name="line-635"></a><span class='hs-comment'>-- &gt;           takeDirectory "/" == "/"</span>
<a name="line-636"></a><span class='hs-comment'>-- &gt;           takeDirectory "/foo" == "/"</span>
<a name="line-637"></a><span class='hs-comment'>-- &gt;           takeDirectory "/foo/bar/baz" == "/foo/bar"</span>
<a name="line-638"></a><span class='hs-comment'>-- &gt;           takeDirectory "/foo/bar/baz/" == "/foo/bar/baz"</span>
<a name="line-639"></a><span class='hs-comment'>-- &gt;           takeDirectory "foo/bar/baz" == "foo/bar"</span>
<a name="line-640"></a><span class='hs-comment'>-- &gt; Windows:  takeDirectory "foo\\bar" == "foo"</span>
<a name="line-641"></a><span class='hs-comment'>-- &gt; Windows:  takeDirectory "foo\\bar\\\\" == "foo\\bar"</span>
<a name="line-642"></a><span class='hs-comment'>-- &gt; Windows:  takeDirectory "C:\\" == "C:\\"</span>
<a name="line-643"></a><span class='hs-definition'>takeDirectory</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FilePath</span>
<a name="line-644"></a><span class='hs-definition'>takeDirectory</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>dropTrailingPathSeparator</span> <span class='hs-varop'>.</span> <span class='hs-varid'>dropFileName</span>
<a name="line-645"></a>
<a name="line-646"></a><a name="replaceDirectory"></a><span class='hs-comment'>-- | Set the directory, keeping the filename the same.</span>
<a name="line-647"></a><span class='hs-comment'>--</span>
<a name="line-648"></a><span class='hs-comment'>-- &gt; replaceDirectory "root/file.ext" "/directory/" == "/directory/file.ext"</span>
<a name="line-649"></a><span class='hs-comment'>-- &gt; Valid x =&gt; replaceDirectory x (takeDirectory x) `equalFilePath` x</span>
<a name="line-650"></a><span class='hs-definition'>replaceDirectory</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>String</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FilePath</span>
<a name="line-651"></a><span class='hs-definition'>replaceDirectory</span> <span class='hs-varid'>x</span> <span class='hs-varid'>dir</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>combineAlways</span> <span class='hs-varid'>dir</span> <span class='hs-layout'>(</span><span class='hs-varid'>takeFileName</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span>
<a name="line-652"></a>
<a name="line-653"></a>
<a name="line-654"></a><a name="combine"></a><span class='hs-comment'>-- | An alias for '&lt;/&gt;'.</span>
<a name="line-655"></a><span class='hs-definition'>combine</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FilePath</span>
<a name="line-656"></a><span class='hs-definition'>combine</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>hasLeadingPathSeparator</span> <span class='hs-varid'>b</span> <span class='hs-varop'>||</span> <span class='hs-varid'>hasDrive</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>b</span>
<a name="line-657"></a>            <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>combineAlways</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span>
<a name="line-658"></a>
<a name="line-659"></a><a name="combineAlways"></a><span class='hs-comment'>-- | Combine two paths, assuming rhs is NOT absolute.</span>
<a name="line-660"></a><span class='hs-definition'>combineAlways</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FilePath</span>
<a name="line-661"></a><span class='hs-definition'>combineAlways</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>null</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>b</span>
<a name="line-662"></a>                  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>null</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a</span>
<a name="line-663"></a>                  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>hasTrailingPathSeparator</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a</span> <span class='hs-varop'>++</span> <span class='hs-varid'>b</span>
<a name="line-664"></a>                  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>of</span>
<a name="line-665"></a>                      <span class='hs-keyglyph'>[</span><span class='hs-varid'>a1</span><span class='hs-layout'>,</span><span class='hs-chr'>':'</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>isWindows</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>isLetter</span> <span class='hs-varid'>a1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-varop'>++</span> <span class='hs-varid'>b</span>
<a name="line-666"></a>                      <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-varop'>++</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>pathSeparator</span><span class='hs-keyglyph'>]</span> <span class='hs-varop'>++</span> <span class='hs-varid'>b</span>
<a name="line-667"></a>
<a name="line-668"></a>
<a name="line-669"></a><a name="%3c/%3e"></a><span class='hs-comment'>-- | Combine two paths with a path separator.</span>
<a name="line-670"></a><span class='hs-comment'>--   If the second path starts with a path separator or a drive letter, then it returns the second.</span>
<a name="line-671"></a><span class='hs-comment'>--   The intention is that @readFile (dir '&lt;/&gt;' file)@ will access the same file as</span>
<a name="line-672"></a><span class='hs-comment'>--   @setCurrentDirectory dir; readFile file@.</span>
<a name="line-673"></a><span class='hs-comment'>--</span>
<a name="line-674"></a><span class='hs-comment'>-- &gt; Posix:   "/directory" &lt;/&gt; "file.ext" == "/directory/file.ext"</span>
<a name="line-675"></a><span class='hs-comment'>-- &gt; Windows: "/directory" &lt;/&gt; "file.ext" == "/directory\\file.ext"</span>
<a name="line-676"></a><span class='hs-comment'>-- &gt;          "directory" &lt;/&gt; "/file.ext" == "/file.ext"</span>
<a name="line-677"></a><span class='hs-comment'>-- &gt; Valid x =&gt; (takeDirectory x &lt;/&gt; takeFileName x) `equalFilePath` x</span>
<a name="line-678"></a><span class='hs-comment'>--</span>
<a name="line-679"></a><span class='hs-comment'>--   Combined:</span>
<a name="line-680"></a><span class='hs-comment'>--</span>
<a name="line-681"></a><span class='hs-comment'>-- &gt; Posix:   "/" &lt;/&gt; "test" == "/test"</span>
<a name="line-682"></a><span class='hs-comment'>-- &gt; Posix:   "home" &lt;/&gt; "bob" == "home/bob"</span>
<a name="line-683"></a><span class='hs-comment'>-- &gt; Posix:   "x:" &lt;/&gt; "foo" == "x:/foo"</span>
<a name="line-684"></a><span class='hs-comment'>-- &gt; Windows: "C:\\foo" &lt;/&gt; "bar" == "C:\\foo\\bar"</span>
<a name="line-685"></a><span class='hs-comment'>-- &gt; Windows: "home" &lt;/&gt; "bob" == "home\\bob"</span>
<a name="line-686"></a><span class='hs-comment'>--</span>
<a name="line-687"></a><span class='hs-comment'>--   Not combined:</span>
<a name="line-688"></a><span class='hs-comment'>--</span>
<a name="line-689"></a><span class='hs-comment'>-- &gt; Posix:   "home" &lt;/&gt; "/bob" == "/bob"</span>
<a name="line-690"></a><span class='hs-comment'>-- &gt; Windows: "home" &lt;/&gt; "C:\\bob" == "C:\\bob"</span>
<a name="line-691"></a><span class='hs-comment'>--</span>
<a name="line-692"></a><span class='hs-comment'>--   Not combined (tricky):</span>
<a name="line-693"></a><span class='hs-comment'>--</span>
<a name="line-694"></a><span class='hs-comment'>--   On Windows, if a filepath starts with a single slash, it is relative to the</span>
<a name="line-695"></a><span class='hs-comment'>--   root of the current drive. In [1], this is (confusingly) referred to as an</span>
<a name="line-696"></a><span class='hs-comment'>--   absolute path.</span>
<a name="line-697"></a><span class='hs-comment'>--   The current behavior of '&lt;/&gt;' is to never combine these forms.</span>
<a name="line-698"></a><span class='hs-comment'>--</span>
<a name="line-699"></a><span class='hs-comment'>-- &gt; Windows: "home" &lt;/&gt; "/bob" == "/bob"</span>
<a name="line-700"></a><span class='hs-comment'>-- &gt; Windows: "home" &lt;/&gt; "\\bob" == "\\bob"</span>
<a name="line-701"></a><span class='hs-comment'>-- &gt; Windows: "C:\\home" &lt;/&gt; "\\bob" == "\\bob"</span>
<a name="line-702"></a><span class='hs-comment'>--</span>
<a name="line-703"></a><span class='hs-comment'>--   On Windows, from [1]: "If a file name begins with only a disk designator</span>
<a name="line-704"></a><span class='hs-comment'>--   but not the backslash after the colon, it is interpreted as a relative path</span>
<a name="line-705"></a><span class='hs-comment'>--   to the current directory on the drive with the specified letter."</span>
<a name="line-706"></a><span class='hs-comment'>--   The current behavior of '&lt;/&gt;' is to never combine these forms.</span>
<a name="line-707"></a><span class='hs-comment'>--</span>
<a name="line-708"></a><span class='hs-comment'>-- &gt; Windows: "D:\\foo" &lt;/&gt; "C:bar" == "C:bar"</span>
<a name="line-709"></a><span class='hs-comment'>-- &gt; Windows: "C:\\foo" &lt;/&gt; "C:bar" == "C:bar"</span>
<a name="line-710"></a><span class='hs-layout'>(</span><span class='hs-varop'>&lt;/&gt;</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FilePath</span>
<a name="line-711"></a><span class='hs-layout'>(</span><span class='hs-varop'>&lt;/&gt;</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>combine</span>
<a name="line-712"></a>
<a name="line-713"></a>
<a name="line-714"></a><a name="splitPath"></a><span class='hs-comment'>-- | Split a path by the directory separator.</span>
<a name="line-715"></a><span class='hs-comment'>--</span>
<a name="line-716"></a><span class='hs-comment'>-- &gt; splitPath "/directory/file.ext" == ["/","directory/","file.ext"]</span>
<a name="line-717"></a><span class='hs-comment'>-- &gt; concat (splitPath x) == x</span>
<a name="line-718"></a><span class='hs-comment'>-- &gt; splitPath "test//item/" == ["test//","item/"]</span>
<a name="line-719"></a><span class='hs-comment'>-- &gt; splitPath "test/item/file" == ["test/","item/","file"]</span>
<a name="line-720"></a><span class='hs-comment'>-- &gt; splitPath "" == []</span>
<a name="line-721"></a><span class='hs-comment'>-- &gt; Windows: splitPath "c:\\test\\path" == ["c:\\","test\\","path"]</span>
<a name="line-722"></a><span class='hs-comment'>-- &gt; Posix:   splitPath "/file/test" == ["/","file/","test"]</span>
<a name="line-723"></a><span class='hs-definition'>splitPath</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>FilePath</span><span class='hs-keyglyph'>]</span>
<a name="line-724"></a><span class='hs-definition'>splitPath</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>drive</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>drive</span> <span class='hs-varop'>/=</span> <span class='hs-str'>""</span><span class='hs-keyglyph'>]</span> <span class='hs-varop'>++</span> <span class='hs-varid'>f</span> <span class='hs-varid'>path</span>
<a name="line-725"></a>    <span class='hs-keyword'>where</span>
<a name="line-726"></a>        <span class='hs-layout'>(</span><span class='hs-varid'>drive</span><span class='hs-layout'>,</span><span class='hs-varid'>path</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>splitDrive</span> <span class='hs-varid'>x</span>
<a name="line-727"></a>
<a name="line-728"></a>        <span class='hs-varid'>f</span> <span class='hs-str'>""</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>[]</span>
<a name="line-729"></a>        <span class='hs-varid'>f</span> <span class='hs-varid'>y</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-varop'>++</span><span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-conop'>:</span> <span class='hs-varid'>f</span> <span class='hs-varid'>d</span>
<a name="line-730"></a>            <span class='hs-keyword'>where</span>
<a name="line-731"></a>                <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-layout'>,</span><span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>break</span> <span class='hs-varid'>isPathSeparator</span> <span class='hs-varid'>y</span>
<a name="line-732"></a>                <span class='hs-layout'>(</span><span class='hs-varid'>c</span><span class='hs-layout'>,</span><span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>span</span>  <span class='hs-varid'>isPathSeparator</span> <span class='hs-varid'>b</span>
<a name="line-733"></a>
<a name="line-734"></a><a name="splitDirectories"></a><span class='hs-comment'>-- | Just as 'splitPath', but don't add the trailing slashes to each element.</span>
<a name="line-735"></a><span class='hs-comment'>--</span>
<a name="line-736"></a><span class='hs-comment'>-- &gt;          splitDirectories "/directory/file.ext" == ["/","directory","file.ext"]</span>
<a name="line-737"></a><span class='hs-comment'>-- &gt;          splitDirectories "test/file" == ["test","file"]</span>
<a name="line-738"></a><span class='hs-comment'>-- &gt;          splitDirectories "/test/file" == ["/","test","file"]</span>
<a name="line-739"></a><span class='hs-comment'>-- &gt; Windows: splitDirectories "C:\\test\\file" == ["C:\\", "test", "file"]</span>
<a name="line-740"></a><span class='hs-comment'>-- &gt;          Valid x =&gt; joinPath (splitDirectories x) `equalFilePath` x</span>
<a name="line-741"></a><span class='hs-comment'>-- &gt;          splitDirectories "" == []</span>
<a name="line-742"></a><span class='hs-comment'>-- &gt; Windows: splitDirectories "C:\\test\\\\\\file" == ["C:\\", "test", "file"]</span>
<a name="line-743"></a><span class='hs-comment'>-- &gt;          splitDirectories "/test///file" == ["/","test","file"]</span>
<a name="line-744"></a><span class='hs-definition'>splitDirectories</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>FilePath</span><span class='hs-keyglyph'>]</span>
<a name="line-745"></a><span class='hs-definition'>splitDirectories</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>map</span> <span class='hs-varid'>dropTrailingPathSeparator</span> <span class='hs-varop'>.</span> <span class='hs-varid'>splitPath</span>
<a name="line-746"></a>
<a name="line-747"></a>
<a name="line-748"></a><a name="joinPath"></a><span class='hs-comment'>-- | Join path elements back together.</span>
<a name="line-749"></a><span class='hs-comment'>--</span>
<a name="line-750"></a><span class='hs-comment'>-- &gt; joinPath a == foldr (&lt;/&gt;) "" a</span>
<a name="line-751"></a><span class='hs-comment'>-- &gt; joinPath ["/","directory/","file.ext"] == "/directory/file.ext"</span>
<a name="line-752"></a><span class='hs-comment'>-- &gt; Valid x =&gt; joinPath (splitPath x) == x</span>
<a name="line-753"></a><span class='hs-comment'>-- &gt; joinPath [] == ""</span>
<a name="line-754"></a><span class='hs-comment'>-- &gt; Posix: joinPath ["test","file","path"] == "test/file/path"</span>
<a name="line-755"></a><span class='hs-definition'>joinPath</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>FilePath</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FilePath</span>
<a name="line-756"></a><span class='hs-comment'>-- Note that this definition on c:\\c:\\, join then split will give c:\\.</span>
<a name="line-757"></a><span class='hs-definition'>joinPath</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>foldr</span> <span class='hs-varid'>combine</span> <span class='hs-str'>""</span>
<a name="line-758"></a>
<a name="line-759"></a>
<a name="line-760"></a>
<a name="line-761"></a>
<a name="line-762"></a>
<a name="line-763"></a>
<a name="line-764"></a><span class='hs-comment'>---------------------------------------------------------------------</span>
<a name="line-765"></a><span class='hs-comment'>-- File name manipulators</span>
<a name="line-766"></a>
<a name="line-767"></a><a name="equalFilePath"></a><span class='hs-comment'>-- | Equality of two 'FilePath's.</span>
<a name="line-768"></a><span class='hs-comment'>--   If you call @System.Directory.canonicalizePath@</span>
<a name="line-769"></a><span class='hs-comment'>--   first this has a much better chance of working.</span>
<a name="line-770"></a><span class='hs-comment'>--   Note that this doesn't follow symlinks or DOSNAM~1s.</span>
<a name="line-771"></a><span class='hs-comment'>--</span>
<a name="line-772"></a><span class='hs-comment'>-- Similar to 'normalise', this does not expand @".."@, because of symlinks.</span>
<a name="line-773"></a><span class='hs-comment'>--</span>
<a name="line-774"></a><span class='hs-comment'>-- &gt;          x == y ==&gt; equalFilePath x y</span>
<a name="line-775"></a><span class='hs-comment'>-- &gt;          normalise x == normalise y ==&gt; equalFilePath x y</span>
<a name="line-776"></a><span class='hs-comment'>-- &gt;          equalFilePath "foo" "foo/"</span>
<a name="line-777"></a><span class='hs-comment'>-- &gt;          not (equalFilePath "/a/../c" "/c")</span>
<a name="line-778"></a><span class='hs-comment'>-- &gt;          not (equalFilePath "foo" "/foo")</span>
<a name="line-779"></a><span class='hs-comment'>-- &gt; Posix:   not (equalFilePath "foo" "FOO")</span>
<a name="line-780"></a><span class='hs-comment'>-- &gt; Windows: equalFilePath "foo" "FOO"</span>
<a name="line-781"></a><span class='hs-comment'>-- &gt; Windows: not (equalFilePath "C:" "C:/")</span>
<a name="line-782"></a><span class='hs-definition'>equalFilePath</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-783"></a><span class='hs-definition'>equalFilePath</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>f</span> <span class='hs-varid'>a</span> <span class='hs-varop'>==</span> <span class='hs-varid'>f</span> <span class='hs-varid'>b</span>
<a name="line-784"></a>    <span class='hs-keyword'>where</span>
<a name="line-785"></a>        <span class='hs-varid'>f</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>isWindows</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>dropTrailingPathSeparator</span> <span class='hs-varop'>$</span> <span class='hs-varid'>map</span> <span class='hs-varid'>toLower</span> <span class='hs-varop'>$</span> <span class='hs-varid'>normalise</span> <span class='hs-varid'>x</span>
<a name="line-786"></a>            <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>dropTrailingPathSeparator</span> <span class='hs-varop'>$</span> <span class='hs-varid'>normalise</span> <span class='hs-varid'>x</span>
<a name="line-787"></a>
<a name="line-788"></a>
<a name="line-789"></a><a name="makeRelative"></a><span class='hs-comment'>-- | Contract a filename, based on a relative path. Note that the resulting path</span>
<a name="line-790"></a><span class='hs-comment'>--   will never introduce @..@ paths, as the presence of symlinks means @..\/b@</span>
<a name="line-791"></a><span class='hs-comment'>--   may not reach @a\/b@ if it starts from @a\/c@. For a worked example see</span>
<a name="line-792"></a><span class='hs-comment'>--   &lt;<a href="http://neilmitchell.blogspot.co.uk/2015/10/filepaths-are-subtle-symlinks-are-hard.html">http://neilmitchell.blogspot.co.uk/2015/10/filepaths-are-subtle-symlinks-are-hard.html</a> this blog post&gt;.</span>
<a name="line-793"></a><span class='hs-comment'>--</span>
<a name="line-794"></a><span class='hs-comment'>--   The corresponding @makeAbsolute@ function can be found in</span>
<a name="line-795"></a><span class='hs-comment'>--   @System.Directory@.</span>
<a name="line-796"></a><span class='hs-comment'>--</span>
<a name="line-797"></a><span class='hs-comment'>-- &gt;          makeRelative "/directory" "/directory/file.ext" == "file.ext"</span>
<a name="line-798"></a><span class='hs-comment'>-- &gt;          Valid x =&gt; makeRelative (takeDirectory x) x `equalFilePath` takeFileName x</span>
<a name="line-799"></a><span class='hs-comment'>-- &gt;          makeRelative x x == "."</span>
<a name="line-800"></a><span class='hs-comment'>-- &gt;          Valid x y =&gt; equalFilePath x y || (isRelative x &amp;&amp; makeRelative y x == x) || equalFilePath (y &lt;/&gt; makeRelative y x) x</span>
<a name="line-801"></a><span class='hs-comment'>-- &gt; Windows: makeRelative "C:\\Home" "c:\\home\\bob" == "bob"</span>
<a name="line-802"></a><span class='hs-comment'>-- &gt; Windows: makeRelative "C:\\Home" "c:/home/bob" == "bob"</span>
<a name="line-803"></a><span class='hs-comment'>-- &gt; Windows: makeRelative "C:\\Home" "D:\\Home\\Bob" == "D:\\Home\\Bob"</span>
<a name="line-804"></a><span class='hs-comment'>-- &gt; Windows: makeRelative "C:\\Home" "C:Home\\Bob" == "C:Home\\Bob"</span>
<a name="line-805"></a><span class='hs-comment'>-- &gt; Windows: makeRelative "/Home" "/home/bob" == "bob"</span>
<a name="line-806"></a><span class='hs-comment'>-- &gt; Windows: makeRelative "/" "//" == "//"</span>
<a name="line-807"></a><span class='hs-comment'>-- &gt; Posix:   makeRelative "/Home" "/home/bob" == "/home/bob"</span>
<a name="line-808"></a><span class='hs-comment'>-- &gt; Posix:   makeRelative "/home/" "/home/bob/foo/bar" == "bob/foo/bar"</span>
<a name="line-809"></a><span class='hs-comment'>-- &gt; Posix:   makeRelative "/fred" "bob" == "bob"</span>
<a name="line-810"></a><span class='hs-comment'>-- &gt; Posix:   makeRelative "/file/test" "/file/test/fred" == "fred"</span>
<a name="line-811"></a><span class='hs-comment'>-- &gt; Posix:   makeRelative "/file/test" "/file/test/fred/" == "fred/"</span>
<a name="line-812"></a><span class='hs-comment'>-- &gt; Posix:   makeRelative "some/path" "some/path/a/b/c" == "a/b/c"</span>
<a name="line-813"></a><span class='hs-definition'>makeRelative</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FilePath</span>
<a name="line-814"></a><span class='hs-definition'>makeRelative</span> <span class='hs-varid'>root</span> <span class='hs-varid'>path</span>
<a name="line-815"></a> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>equalFilePath</span> <span class='hs-varid'>root</span> <span class='hs-varid'>path</span> <span class='hs-keyglyph'>=</span> <span class='hs-str'>"."</span>
<a name="line-816"></a> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>takeAbs</span> <span class='hs-varid'>root</span> <span class='hs-varop'>/=</span> <span class='hs-varid'>takeAbs</span> <span class='hs-varid'>path</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>path</span>
<a name="line-817"></a> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-varid'>dropAbs</span> <span class='hs-varid'>root</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>dropAbs</span> <span class='hs-varid'>path</span><span class='hs-layout'>)</span>
<a name="line-818"></a>    <span class='hs-keyword'>where</span>
<a name="line-819"></a>        <span class='hs-varid'>f</span> <span class='hs-str'>""</span> <span class='hs-varid'>y</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>dropWhile</span> <span class='hs-varid'>isPathSeparator</span> <span class='hs-varid'>y</span>
<a name="line-820"></a>        <span class='hs-varid'>f</span> <span class='hs-varid'>x</span> <span class='hs-varid'>y</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>let</span> <span class='hs-layout'>(</span><span class='hs-varid'>x1</span><span class='hs-layout'>,</span><span class='hs-varid'>x2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>g</span> <span class='hs-varid'>x</span>
<a name="line-821"></a>                    <span class='hs-layout'>(</span><span class='hs-varid'>y1</span><span class='hs-layout'>,</span><span class='hs-varid'>y2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>g</span> <span class='hs-varid'>y</span>
<a name="line-822"></a>                <span class='hs-keyword'>in</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>equalFilePath</span> <span class='hs-varid'>x1</span> <span class='hs-varid'>y1</span> <span class='hs-keyword'>then</span> <span class='hs-varid'>f</span> <span class='hs-varid'>x2</span> <span class='hs-varid'>y2</span> <span class='hs-keyword'>else</span> <span class='hs-varid'>path</span>
<a name="line-823"></a>
<a name="line-824"></a>        <span class='hs-varid'>g</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>dropWhile</span> <span class='hs-varid'>isPathSeparator</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-varid'>dropWhile</span> <span class='hs-varid'>isPathSeparator</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-825"></a>            <span class='hs-keyword'>where</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-layout'>,</span><span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>break</span> <span class='hs-varid'>isPathSeparator</span> <span class='hs-varop'>$</span> <span class='hs-varid'>dropWhile</span> <span class='hs-varid'>isPathSeparator</span> <span class='hs-varid'>x</span>
<a name="line-826"></a>
<a name="line-827"></a>        <span class='hs-comment'>-- on windows, need to drop '/' which is kind of absolute, but not a drive</span>
<a name="line-828"></a>        <span class='hs-varid'>dropAbs</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>hasLeadingPathSeparator</span> <span class='hs-varid'>x</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>not</span> <span class='hs-layout'>(</span><span class='hs-varid'>hasDrive</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>tail</span> <span class='hs-varid'>x</span>
<a name="line-829"></a>        <span class='hs-varid'>dropAbs</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>dropDrive</span> <span class='hs-varid'>x</span>
<a name="line-830"></a>
<a name="line-831"></a>        <span class='hs-varid'>takeAbs</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>hasLeadingPathSeparator</span> <span class='hs-varid'>x</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>not</span> <span class='hs-layout'>(</span><span class='hs-varid'>hasDrive</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>pathSeparator</span><span class='hs-keyglyph'>]</span>
<a name="line-832"></a>        <span class='hs-varid'>takeAbs</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>map</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><span class='hs-varid'>y</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>isPathSeparator</span> <span class='hs-varid'>y</span> <span class='hs-keyword'>then</span> <span class='hs-varid'>pathSeparator</span> <span class='hs-keyword'>else</span> <span class='hs-varid'>toLower</span> <span class='hs-varid'>y</span><span class='hs-layout'>)</span> <span class='hs-varop'>$</span> <span class='hs-varid'>takeDrive</span> <span class='hs-varid'>x</span>
<a name="line-833"></a>
<a name="line-834"></a><a name="normalise"></a><span class='hs-comment'>-- | Normalise a file</span>
<a name="line-835"></a><span class='hs-comment'>--</span>
<a name="line-836"></a><span class='hs-comment'>-- * \/\/ outside of the drive can be made blank</span>
<a name="line-837"></a><span class='hs-comment'>--</span>
<a name="line-838"></a><span class='hs-comment'>-- * \/ -&gt; 'pathSeparator'</span>
<a name="line-839"></a><span class='hs-comment'>--</span>
<a name="line-840"></a><span class='hs-comment'>-- * .\/ -&gt; \"\"</span>
<a name="line-841"></a><span class='hs-comment'>--</span>
<a name="line-842"></a><span class='hs-comment'>-- Does not remove @".."@, because of symlinks.</span>
<a name="line-843"></a><span class='hs-comment'>--</span>
<a name="line-844"></a><span class='hs-comment'>-- &gt; Posix:   normalise "/file/\\test////" == "/file/\\test/"</span>
<a name="line-845"></a><span class='hs-comment'>-- &gt; Posix:   normalise "/file/./test" == "/file/test"</span>
<a name="line-846"></a><span class='hs-comment'>-- &gt; Posix:   normalise "/test/file/../bob/fred/" == "/test/file/../bob/fred/"</span>
<a name="line-847"></a><span class='hs-comment'>-- &gt; Posix:   normalise "../bob/fred/" == "../bob/fred/"</span>
<a name="line-848"></a><span class='hs-comment'>-- &gt; Posix:   normalise "/a/../c" == "/a/../c"</span>
<a name="line-849"></a><span class='hs-comment'>-- &gt; Posix:   normalise "./bob/fred/" == "bob/fred/"</span>
<a name="line-850"></a><span class='hs-comment'>-- &gt; Windows: normalise "c:\\file/bob\\" == "C:\\file\\bob\\"</span>
<a name="line-851"></a><span class='hs-comment'>-- &gt; Windows: normalise "c:\\" == "C:\\"</span>
<a name="line-852"></a><span class='hs-comment'>-- &gt; Windows: normalise "C:.\\" == "C:"</span>
<a name="line-853"></a><span class='hs-comment'>-- &gt; Windows: normalise "\\\\server\\test" == "\\\\server\\test"</span>
<a name="line-854"></a><span class='hs-comment'>-- &gt; Windows: normalise "//server/test" == "\\\\server\\test"</span>
<a name="line-855"></a><span class='hs-comment'>-- &gt; Windows: normalise "c:/file" == "C:\\file"</span>
<a name="line-856"></a><span class='hs-comment'>-- &gt; Windows: normalise "/file" == "\\file"</span>
<a name="line-857"></a><span class='hs-comment'>-- &gt; Windows: normalise "\\" == "\\"</span>
<a name="line-858"></a><span class='hs-comment'>-- &gt; Windows: normalise "/./" == "\\"</span>
<a name="line-859"></a><span class='hs-comment'>-- &gt;          normalise "." == "."</span>
<a name="line-860"></a><span class='hs-comment'>-- &gt; Posix:   normalise "./" == "./"</span>
<a name="line-861"></a><span class='hs-comment'>-- &gt; Posix:   normalise "./." == "./"</span>
<a name="line-862"></a><span class='hs-comment'>-- &gt; Posix:   normalise "/./" == "/"</span>
<a name="line-863"></a><span class='hs-comment'>-- &gt; Posix:   normalise "/" == "/"</span>
<a name="line-864"></a><span class='hs-comment'>-- &gt; Posix:   normalise "bob/fred/." == "bob/fred/"</span>
<a name="line-865"></a><span class='hs-comment'>-- &gt; Posix:   normalise "//home" == "/home"</span>
<a name="line-866"></a><span class='hs-definition'>normalise</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FilePath</span>
<a name="line-867"></a><span class='hs-definition'>normalise</span> <span class='hs-varid'>path</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>result</span> <span class='hs-varop'>++</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>pathSeparator</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>addPathSeparator</span><span class='hs-keyglyph'>]</span>
<a name="line-868"></a>    <span class='hs-keyword'>where</span>
<a name="line-869"></a>        <span class='hs-layout'>(</span><span class='hs-varid'>drv</span><span class='hs-layout'>,</span><span class='hs-varid'>pth</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>splitDrive</span> <span class='hs-varid'>path</span>
<a name="line-870"></a>        <span class='hs-varid'>result</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>joinDrive'</span> <span class='hs-layout'>(</span><span class='hs-varid'>normaliseDrive</span> <span class='hs-varid'>drv</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>f</span> <span class='hs-varid'>pth</span><span class='hs-layout'>)</span>
<a name="line-871"></a>
<a name="line-872"></a>        <span class='hs-varid'>joinDrive'</span> <span class='hs-str'>""</span> <span class='hs-str'>""</span> <span class='hs-keyglyph'>=</span> <span class='hs-str'>"."</span>
<a name="line-873"></a>        <span class='hs-varid'>joinDrive'</span> <span class='hs-varid'>d</span> <span class='hs-varid'>p</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>joinDrive</span> <span class='hs-varid'>d</span> <span class='hs-varid'>p</span>
<a name="line-874"></a>
<a name="line-875"></a>        <span class='hs-varid'>addPathSeparator</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>isDirPath</span> <span class='hs-varid'>pth</span>
<a name="line-876"></a>            <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>not</span> <span class='hs-layout'>(</span><span class='hs-varid'>hasTrailingPathSeparator</span> <span class='hs-varid'>result</span><span class='hs-layout'>)</span>
<a name="line-877"></a>            <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>not</span> <span class='hs-layout'>(</span><span class='hs-varid'>isRelativeDrive</span> <span class='hs-varid'>drv</span><span class='hs-layout'>)</span>
<a name="line-878"></a>
<a name="line-879"></a>        <span class='hs-varid'>isDirPath</span> <span class='hs-varid'>xs</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hasTrailingPathSeparator</span> <span class='hs-varid'>xs</span>
<a name="line-880"></a>            <span class='hs-varop'>||</span> <span class='hs-varid'>not</span> <span class='hs-layout'>(</span><span class='hs-varid'>null</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>last</span> <span class='hs-varid'>xs</span> <span class='hs-varop'>==</span> <span class='hs-chr'>'.'</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>hasTrailingPathSeparator</span> <span class='hs-layout'>(</span><span class='hs-varid'>init</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span>
<a name="line-881"></a>
<a name="line-882"></a>        <span class='hs-varid'>f</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>joinPath</span> <span class='hs-varop'>.</span> <span class='hs-varid'>dropDots</span> <span class='hs-varop'>.</span> <span class='hs-varid'>propSep</span> <span class='hs-varop'>.</span> <span class='hs-varid'>splitDirectories</span>
<a name="line-883"></a>
<a name="line-884"></a>        <span class='hs-varid'>propSep</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>all</span> <span class='hs-varid'>isPathSeparator</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>pathSeparator</span><span class='hs-keyglyph'>]</span> <span class='hs-conop'>:</span> <span class='hs-varid'>xs</span>
<a name="line-885"></a>                       <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>x</span> <span class='hs-conop'>:</span> <span class='hs-varid'>xs</span>
<a name="line-886"></a>        <span class='hs-varid'>propSep</span> <span class='hs-conid'>[]</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>[]</span>
<a name="line-887"></a>
<a name="line-888"></a>        <span class='hs-varid'>dropDots</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>filter</span> <span class='hs-layout'>(</span><span class='hs-str'>"."</span> <span class='hs-varop'>/=</span><span class='hs-layout'>)</span>
<a name="line-889"></a>
<a name="line-890"></a><a name="normaliseDrive"></a><span class='hs-definition'>normaliseDrive</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FilePath</span>
<a name="line-891"></a><span class='hs-definition'>normaliseDrive</span> <span class='hs-str'>""</span> <span class='hs-keyglyph'>=</span> <span class='hs-str'>""</span>
<a name="line-892"></a><span class='hs-definition'>normaliseDrive</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>isPosix</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>pathSeparator</span><span class='hs-keyglyph'>]</span>
<a name="line-893"></a><span class='hs-definition'>normaliseDrive</span> <span class='hs-varid'>drive</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>isJust</span> <span class='hs-varop'>$</span> <span class='hs-varid'>readDriveLetter</span> <span class='hs-varid'>x2</span>
<a name="line-894"></a>                       <span class='hs-keyword'>then</span> <span class='hs-varid'>map</span> <span class='hs-varid'>toUpper</span> <span class='hs-varid'>x2</span>
<a name="line-895"></a>                       <span class='hs-keyword'>else</span> <span class='hs-varid'>x2</span>
<a name="line-896"></a>    <span class='hs-keyword'>where</span>
<a name="line-897"></a>        <span class='hs-varid'>x2</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>map</span> <span class='hs-varid'>repSlash</span> <span class='hs-varid'>drive</span>
<a name="line-898"></a>
<a name="line-899"></a>        <span class='hs-varid'>repSlash</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>isPathSeparator</span> <span class='hs-varid'>x</span> <span class='hs-keyword'>then</span> <span class='hs-varid'>pathSeparator</span> <span class='hs-keyword'>else</span> <span class='hs-varid'>x</span>
<a name="line-900"></a>
<a name="line-901"></a><a name="isBadCharacter"></a><span class='hs-comment'>-- Information for validity functions on Windows. See [1].</span>
<a name="line-902"></a><span class='hs-definition'>isBadCharacter</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Char</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-903"></a><span class='hs-definition'>isBadCharacter</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>x</span> <span class='hs-varop'>&gt;=</span> <span class='hs-chr'>'\0'</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>x</span> <span class='hs-varop'>&lt;=</span> <span class='hs-chr'>'\31'</span> <span class='hs-varop'>||</span> <span class='hs-varid'>x</span> <span class='hs-varop'>`elem`</span> <span class='hs-str'>":*?&gt;&lt;|\""</span>
<a name="line-904"></a>
<a name="line-905"></a><a name="badElements"></a><span class='hs-definition'>badElements</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>FilePath</span><span class='hs-keyglyph'>]</span>
<a name="line-906"></a><span class='hs-definition'>badElements</span> <span class='hs-keyglyph'>=</span>
<a name="line-907"></a>    <span class='hs-keyglyph'>[</span><span class='hs-str'>"CON"</span><span class='hs-layout'>,</span><span class='hs-str'>"PRN"</span><span class='hs-layout'>,</span><span class='hs-str'>"AUX"</span><span class='hs-layout'>,</span><span class='hs-str'>"NUL"</span><span class='hs-layout'>,</span><span class='hs-str'>"CLOCK$"</span>
<a name="line-908"></a>    <span class='hs-layout'>,</span><span class='hs-str'>"COM1"</span><span class='hs-layout'>,</span><span class='hs-str'>"COM2"</span><span class='hs-layout'>,</span><span class='hs-str'>"COM3"</span><span class='hs-layout'>,</span><span class='hs-str'>"COM4"</span><span class='hs-layout'>,</span><span class='hs-str'>"COM5"</span><span class='hs-layout'>,</span><span class='hs-str'>"COM6"</span><span class='hs-layout'>,</span><span class='hs-str'>"COM7"</span><span class='hs-layout'>,</span><span class='hs-str'>"COM8"</span><span class='hs-layout'>,</span><span class='hs-str'>"COM9"</span>
<a name="line-909"></a>    <span class='hs-layout'>,</span><span class='hs-str'>"LPT1"</span><span class='hs-layout'>,</span><span class='hs-str'>"LPT2"</span><span class='hs-layout'>,</span><span class='hs-str'>"LPT3"</span><span class='hs-layout'>,</span><span class='hs-str'>"LPT4"</span><span class='hs-layout'>,</span><span class='hs-str'>"LPT5"</span><span class='hs-layout'>,</span><span class='hs-str'>"LPT6"</span><span class='hs-layout'>,</span><span class='hs-str'>"LPT7"</span><span class='hs-layout'>,</span><span class='hs-str'>"LPT8"</span><span class='hs-layout'>,</span><span class='hs-str'>"LPT9"</span><span class='hs-keyglyph'>]</span>
<a name="line-910"></a>
<a name="line-911"></a>
<a name="line-912"></a><a name="isValid"></a><span class='hs-comment'>-- | Is a FilePath valid, i.e. could you create a file like it? This function checks for invalid names,</span>
<a name="line-913"></a><span class='hs-comment'>--   and invalid characters, but does not check if length limits are exceeded, as these are typically</span>
<a name="line-914"></a><span class='hs-comment'>--   filesystem dependent.</span>
<a name="line-915"></a><span class='hs-comment'>--</span>
<a name="line-916"></a><span class='hs-comment'>-- &gt;          isValid "" == False</span>
<a name="line-917"></a><span class='hs-comment'>-- &gt;          isValid "\0" == False</span>
<a name="line-918"></a><span class='hs-comment'>-- &gt; Posix:   isValid "/random_ path:*" == True</span>
<a name="line-919"></a><span class='hs-comment'>-- &gt; Posix:   isValid x == not (null x)</span>
<a name="line-920"></a><span class='hs-comment'>-- &gt; Windows: isValid "c:\\test" == True</span>
<a name="line-921"></a><span class='hs-comment'>-- &gt; Windows: isValid "c:\\test:of_test" == False</span>
<a name="line-922"></a><span class='hs-comment'>-- &gt; Windows: isValid "test*" == False</span>
<a name="line-923"></a><span class='hs-comment'>-- &gt; Windows: isValid "c:\\test\\nul" == False</span>
<a name="line-924"></a><span class='hs-comment'>-- &gt; Windows: isValid "c:\\test\\prn.txt" == False</span>
<a name="line-925"></a><span class='hs-comment'>-- &gt; Windows: isValid "c:\\nul\\file" == False</span>
<a name="line-926"></a><span class='hs-comment'>-- &gt; Windows: isValid "\\\\" == False</span>
<a name="line-927"></a><span class='hs-comment'>-- &gt; Windows: isValid "\\\\\\foo" == False</span>
<a name="line-928"></a><span class='hs-comment'>-- &gt; Windows: isValid "\\\\?\\D:file" == False</span>
<a name="line-929"></a><span class='hs-comment'>-- &gt; Windows: isValid "foo\tbar" == False</span>
<a name="line-930"></a><span class='hs-comment'>-- &gt; Windows: isValid "nul .txt" == False</span>
<a name="line-931"></a><span class='hs-comment'>-- &gt; Windows: isValid " nul.txt" == True</span>
<a name="line-932"></a><span class='hs-definition'>isValid</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-933"></a><span class='hs-definition'>isValid</span> <span class='hs-str'>""</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-934"></a><span class='hs-definition'>isValid</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>|</span> <span class='hs-chr'>'\0'</span> <span class='hs-varop'>`elem`</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-935"></a><span class='hs-definition'>isValid</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>isPosix</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
<a name="line-936"></a><span class='hs-definition'>isValid</span> <span class='hs-varid'>path</span> <span class='hs-keyglyph'>=</span>
<a name="line-937"></a>        <span class='hs-varid'>not</span> <span class='hs-layout'>(</span><span class='hs-varid'>any</span> <span class='hs-varid'>isBadCharacter</span> <span class='hs-varid'>x2</span><span class='hs-layout'>)</span> <span class='hs-varop'>&amp;&amp;</span>
<a name="line-938"></a>        <span class='hs-varid'>not</span> <span class='hs-layout'>(</span><span class='hs-varid'>any</span> <span class='hs-varid'>f</span> <span class='hs-varop'>$</span> <span class='hs-varid'>splitDirectories</span> <span class='hs-varid'>x2</span><span class='hs-layout'>)</span> <span class='hs-varop'>&amp;&amp;</span>
<a name="line-939"></a>        <span class='hs-varid'>not</span> <span class='hs-layout'>(</span><span class='hs-varid'>isJust</span> <span class='hs-layout'>(</span><span class='hs-varid'>readDriveShare</span> <span class='hs-varid'>x1</span><span class='hs-layout'>)</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>all</span> <span class='hs-varid'>isPathSeparator</span> <span class='hs-varid'>x1</span><span class='hs-layout'>)</span> <span class='hs-varop'>&amp;&amp;</span>
<a name="line-940"></a>        <span class='hs-varid'>not</span> <span class='hs-layout'>(</span><span class='hs-varid'>isJust</span> <span class='hs-layout'>(</span><span class='hs-varid'>readDriveUNC</span> <span class='hs-varid'>x1</span><span class='hs-layout'>)</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>not</span> <span class='hs-layout'>(</span><span class='hs-varid'>hasTrailingPathSeparator</span> <span class='hs-varid'>x1</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-941"></a>    <span class='hs-keyword'>where</span>
<a name="line-942"></a>        <span class='hs-layout'>(</span><span class='hs-varid'>x1</span><span class='hs-layout'>,</span><span class='hs-varid'>x2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>splitDrive</span> <span class='hs-varid'>path</span>
<a name="line-943"></a>        <span class='hs-varid'>f</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>map</span> <span class='hs-varid'>toUpper</span> <span class='hs-layout'>(</span><span class='hs-varid'>dropWhileEnd</span> <span class='hs-layout'>(</span><span class='hs-varop'>==</span> <span class='hs-chr'>' '</span><span class='hs-layout'>)</span> <span class='hs-varop'>$</span> <span class='hs-varid'>dropExtensions</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-varop'>`elem`</span> <span class='hs-varid'>badElements</span>
<a name="line-944"></a>
<a name="line-945"></a>
<a name="line-946"></a><a name="makeValid"></a><span class='hs-comment'>-- | Take a FilePath and make it valid; does not change already valid FilePaths.</span>
<a name="line-947"></a><span class='hs-comment'>--</span>
<a name="line-948"></a><span class='hs-comment'>-- &gt; isValid (makeValid x)</span>
<a name="line-949"></a><span class='hs-comment'>-- &gt; isValid x ==&gt; makeValid x == x</span>
<a name="line-950"></a><span class='hs-comment'>-- &gt; makeValid "" == "_"</span>
<a name="line-951"></a><span class='hs-comment'>-- &gt; makeValid "file\0name" == "file_name"</span>
<a name="line-952"></a><span class='hs-comment'>-- &gt; Windows: makeValid "c:\\already\\/valid" == "c:\\already\\/valid"</span>
<a name="line-953"></a><span class='hs-comment'>-- &gt; Windows: makeValid "c:\\test:of_test" == "c:\\test_of_test"</span>
<a name="line-954"></a><span class='hs-comment'>-- &gt; Windows: makeValid "test*" == "test_"</span>
<a name="line-955"></a><span class='hs-comment'>-- &gt; Windows: makeValid "c:\\test\\nul" == "c:\\test\\nul_"</span>
<a name="line-956"></a><span class='hs-comment'>-- &gt; Windows: makeValid "c:\\test\\prn.txt" == "c:\\test\\prn_.txt"</span>
<a name="line-957"></a><span class='hs-comment'>-- &gt; Windows: makeValid "c:\\test/prn.txt" == "c:\\test/prn_.txt"</span>
<a name="line-958"></a><span class='hs-comment'>-- &gt; Windows: makeValid "c:\\nul\\file" == "c:\\nul_\\file"</span>
<a name="line-959"></a><span class='hs-comment'>-- &gt; Windows: makeValid "\\\\\\foo" == "\\\\drive"</span>
<a name="line-960"></a><span class='hs-comment'>-- &gt; Windows: makeValid "\\\\?\\D:file" == "\\\\?\\D:\\file"</span>
<a name="line-961"></a><span class='hs-comment'>-- &gt; Windows: makeValid "nul .txt" == "nul _.txt"</span>
<a name="line-962"></a><span class='hs-definition'>makeValid</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FilePath</span>
<a name="line-963"></a><span class='hs-definition'>makeValid</span> <span class='hs-str'>""</span> <span class='hs-keyglyph'>=</span> <span class='hs-str'>"_"</span>
<a name="line-964"></a><span class='hs-definition'>makeValid</span> <span class='hs-varid'>path</span>
<a name="line-965"></a>        <span class='hs-keyglyph'>|</span> <span class='hs-varid'>isPosix</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>map</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><span class='hs-varid'>x</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>x</span> <span class='hs-varop'>==</span> <span class='hs-chr'>'\0'</span> <span class='hs-keyword'>then</span> <span class='hs-chr'>'_'</span> <span class='hs-keyword'>else</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-varid'>path</span>
<a name="line-966"></a>        <span class='hs-keyglyph'>|</span> <span class='hs-varid'>isJust</span> <span class='hs-layout'>(</span><span class='hs-varid'>readDriveShare</span> <span class='hs-varid'>drv</span><span class='hs-layout'>)</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>all</span> <span class='hs-varid'>isPathSeparator</span> <span class='hs-varid'>drv</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>take</span> <span class='hs-num'>2</span> <span class='hs-varid'>drv</span> <span class='hs-varop'>++</span> <span class='hs-str'>"drive"</span>
<a name="line-967"></a>        <span class='hs-keyglyph'>|</span> <span class='hs-varid'>isJust</span> <span class='hs-layout'>(</span><span class='hs-varid'>readDriveUNC</span> <span class='hs-varid'>drv</span><span class='hs-layout'>)</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>not</span> <span class='hs-layout'>(</span><span class='hs-varid'>hasTrailingPathSeparator</span> <span class='hs-varid'>drv</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<a name="line-968"></a>            <span class='hs-varid'>makeValid</span> <span class='hs-layout'>(</span><span class='hs-varid'>drv</span> <span class='hs-varop'>++</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>pathSeparator</span><span class='hs-keyglyph'>]</span> <span class='hs-varop'>++</span> <span class='hs-varid'>pth</span><span class='hs-layout'>)</span>
<a name="line-969"></a>        <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>joinDrive</span> <span class='hs-varid'>drv</span> <span class='hs-varop'>$</span> <span class='hs-varid'>validElements</span> <span class='hs-varop'>$</span> <span class='hs-varid'>validChars</span> <span class='hs-varid'>pth</span>
<a name="line-970"></a>    <span class='hs-keyword'>where</span>
<a name="line-971"></a>        <span class='hs-layout'>(</span><span class='hs-varid'>drv</span><span class='hs-layout'>,</span><span class='hs-varid'>pth</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>splitDrive</span> <span class='hs-varid'>path</span>
<a name="line-972"></a>
<a name="line-973"></a>        <span class='hs-varid'>validChars</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>map</span> <span class='hs-varid'>f</span>
<a name="line-974"></a>        <span class='hs-varid'>f</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>isBadCharacter</span> <span class='hs-varid'>x</span> <span class='hs-keyword'>then</span> <span class='hs-chr'>'_'</span> <span class='hs-keyword'>else</span> <span class='hs-varid'>x</span>
<a name="line-975"></a>
<a name="line-976"></a>        <span class='hs-varid'>validElements</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>joinPath</span> <span class='hs-varop'>$</span> <span class='hs-varid'>map</span> <span class='hs-varid'>g</span> <span class='hs-varop'>$</span> <span class='hs-varid'>splitPath</span> <span class='hs-varid'>x</span>
<a name="line-977"></a>        <span class='hs-varid'>g</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>h</span> <span class='hs-varid'>a</span> <span class='hs-varop'>++</span> <span class='hs-varid'>b</span>
<a name="line-978"></a>            <span class='hs-keyword'>where</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-layout'>,</span><span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>break</span> <span class='hs-varid'>isPathSeparator</span> <span class='hs-varid'>x</span>
<a name="line-979"></a>        <span class='hs-varid'>h</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>map</span> <span class='hs-varid'>toUpper</span> <span class='hs-layout'>(</span><span class='hs-varid'>dropWhileEnd</span> <span class='hs-layout'>(</span><span class='hs-varop'>==</span> <span class='hs-chr'>' '</span><span class='hs-layout'>)</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-varop'>`elem`</span> <span class='hs-varid'>badElements</span> <span class='hs-keyword'>then</span> <span class='hs-varid'>a</span> <span class='hs-varop'>++</span> <span class='hs-str'>"_"</span> <span class='hs-varop'>&lt;.&gt;</span> <span class='hs-varid'>b</span> <span class='hs-keyword'>else</span> <span class='hs-varid'>x</span>
<a name="line-980"></a>            <span class='hs-keyword'>where</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-layout'>,</span><span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>splitExtensions</span> <span class='hs-varid'>x</span>
<a name="line-981"></a>
<a name="line-982"></a>
<a name="line-983"></a><a name="isRelative"></a><span class='hs-comment'>-- | Is a path relative, or is it fixed to the root?</span>
<a name="line-984"></a><span class='hs-comment'>--</span>
<a name="line-985"></a><span class='hs-comment'>-- &gt; Windows: isRelative "path\\test" == True</span>
<a name="line-986"></a><span class='hs-comment'>-- &gt; Windows: isRelative "c:\\test" == False</span>
<a name="line-987"></a><span class='hs-comment'>-- &gt; Windows: isRelative "c:test" == True</span>
<a name="line-988"></a><span class='hs-comment'>-- &gt; Windows: isRelative "c:\\" == False</span>
<a name="line-989"></a><span class='hs-comment'>-- &gt; Windows: isRelative "c:/" == False</span>
<a name="line-990"></a><span class='hs-comment'>-- &gt; Windows: isRelative "c:" == True</span>
<a name="line-991"></a><span class='hs-comment'>-- &gt; Windows: isRelative "\\\\foo" == False</span>
<a name="line-992"></a><span class='hs-comment'>-- &gt; Windows: isRelative "\\\\?\\foo" == False</span>
<a name="line-993"></a><span class='hs-comment'>-- &gt; Windows: isRelative "\\\\?\\UNC\\foo" == False</span>
<a name="line-994"></a><span class='hs-comment'>-- &gt; Windows: isRelative "/foo" == True</span>
<a name="line-995"></a><span class='hs-comment'>-- &gt; Windows: isRelative "\\foo" == True</span>
<a name="line-996"></a><span class='hs-comment'>-- &gt; Posix:   isRelative "test/path" == True</span>
<a name="line-997"></a><span class='hs-comment'>-- &gt; Posix:   isRelative "/test" == False</span>
<a name="line-998"></a><span class='hs-comment'>-- &gt; Posix:   isRelative "/" == False</span>
<a name="line-999"></a><span class='hs-comment'>--</span>
<a name="line-1000"></a><span class='hs-comment'>-- According to [1]:</span>
<a name="line-1001"></a><span class='hs-comment'>--</span>
<a name="line-1002"></a><span class='hs-comment'>-- * "A UNC name of any format [is never relative]."</span>
<a name="line-1003"></a><span class='hs-comment'>--</span>
<a name="line-1004"></a><span class='hs-comment'>-- * "You cannot use the "\\?\" prefix with a relative path."</span>
<a name="line-1005"></a><span class='hs-definition'>isRelative</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-1006"></a><span class='hs-definition'>isRelative</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>null</span> <span class='hs-varid'>drive</span> <span class='hs-varop'>||</span> <span class='hs-varid'>isRelativeDrive</span> <span class='hs-varid'>drive</span>
<a name="line-1007"></a>    <span class='hs-keyword'>where</span> <span class='hs-varid'>drive</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>takeDrive</span> <span class='hs-varid'>x</span>
<a name="line-1008"></a>
<a name="line-1009"></a>
<a name="line-1010"></a><a name="isRelativeDrive"></a><span class='hs-comment'>{- c:foo -}</span>
<a name="line-1011"></a><span class='hs-comment'>-- From [1]: "If a file name begins with only a disk designator but not the</span>
<a name="line-1012"></a><span class='hs-comment'>-- backslash after the colon, it is interpreted as a relative path to the</span>
<a name="line-1013"></a><span class='hs-comment'>-- current directory on the drive with the specified letter."</span>
<a name="line-1014"></a><span class='hs-definition'>isRelativeDrive</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>String</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-1015"></a><span class='hs-definition'>isRelativeDrive</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span>
<a name="line-1016"></a>    <span class='hs-varid'>maybe</span> <span class='hs-conid'>False</span> <span class='hs-layout'>(</span><span class='hs-varid'>not</span> <span class='hs-varop'>.</span> <span class='hs-varid'>hasTrailingPathSeparator</span> <span class='hs-varop'>.</span> <span class='hs-varid'>fst</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>readDriveLetter</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span>
<a name="line-1017"></a>
<a name="line-1018"></a>
<a name="line-1019"></a><a name="isAbsolute"></a><span class='hs-comment'>-- | @not . 'isRelative'@</span>
<a name="line-1020"></a><span class='hs-comment'>--</span>
<a name="line-1021"></a><span class='hs-comment'>-- &gt; isAbsolute x == not (isRelative x)</span>
<a name="line-1022"></a><span class='hs-definition'>isAbsolute</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-1023"></a><span class='hs-definition'>isAbsolute</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>not</span> <span class='hs-varop'>.</span> <span class='hs-varid'>isRelative</span>
<a name="line-1024"></a>
<a name="line-1025"></a>
<a name="line-1026"></a><a name="dropWhileEnd"></a><span class='hs-comment'>-----------------------------------------------------------------------------</span>
<a name="line-1027"></a><span class='hs-comment'>-- dropWhileEnd (&gt;2) [1,2,3,4,1,2,3,4] == [1,2,3,4,1,2])</span>
<a name="line-1028"></a><span class='hs-comment'>-- Note that Data.List.dropWhileEnd is only available in base &gt;= 4.5.</span>
<a name="line-1029"></a><span class='hs-definition'>dropWhileEnd</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span>
<a name="line-1030"></a><span class='hs-definition'>dropWhileEnd</span> <span class='hs-varid'>p</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>reverse</span> <span class='hs-varop'>.</span> <span class='hs-varid'>dropWhile</span> <span class='hs-varid'>p</span> <span class='hs-varop'>.</span> <span class='hs-varid'>reverse</span>
<a name="line-1031"></a>
<a name="line-1032"></a><a name="takeWhileEnd"></a><span class='hs-comment'>-- takeWhileEnd (&gt;2) [1,2,3,4,1,2,3,4] == [3,4])</span>
<a name="line-1033"></a><span class='hs-definition'>takeWhileEnd</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span>
<a name="line-1034"></a><span class='hs-definition'>takeWhileEnd</span> <span class='hs-varid'>p</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>reverse</span> <span class='hs-varop'>.</span> <span class='hs-varid'>takeWhile</span> <span class='hs-varid'>p</span> <span class='hs-varop'>.</span> <span class='hs-varid'>reverse</span>
<a name="line-1035"></a>
<a name="line-1036"></a><a name="spanEnd"></a><span class='hs-comment'>-- spanEnd (&gt;2) [1,2,3,4,1,2,3,4] = ([1,2,3,4,1,2], [3,4])</span>
<a name="line-1037"></a><span class='hs-definition'>spanEnd</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<a name="line-1038"></a><span class='hs-definition'>spanEnd</span> <span class='hs-varid'>p</span> <span class='hs-varid'>xs</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>dropWhileEnd</span> <span class='hs-varid'>p</span> <span class='hs-varid'>xs</span><span class='hs-layout'>,</span> <span class='hs-varid'>takeWhileEnd</span> <span class='hs-varid'>p</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span>
<a name="line-1039"></a>
<a name="line-1040"></a><a name="breakEnd"></a><span class='hs-comment'>-- breakEnd (&lt; 2) [1,2,3,4,1,2,3,4] == ([1,2,3,4,1],[2,3,4])</span>
<a name="line-1041"></a><span class='hs-definition'>breakEnd</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<a name="line-1042"></a><span class='hs-definition'>breakEnd</span> <span class='hs-varid'>p</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>spanEnd</span> <span class='hs-layout'>(</span><span class='hs-varid'>not</span> <span class='hs-varop'>.</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span>
<a name="line-1043"></a>
<a name="line-1044"></a><a name="stripSuffix"></a><span class='hs-comment'>-- | The stripSuffix function drops the given suffix from a list. It returns</span>
<a name="line-1045"></a><span class='hs-comment'>-- Nothing if the list did not end with the suffix given, or Just the list</span>
<a name="line-1046"></a><span class='hs-comment'>-- before the suffix, if it does.</span>
<a name="line-1047"></a><span class='hs-definition'>stripSuffix</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Eq</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Maybe</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span>
<a name="line-1048"></a><span class='hs-definition'>stripSuffix</span> <span class='hs-varid'>xs</span> <span class='hs-varid'>ys</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fmap</span> <span class='hs-varid'>reverse</span> <span class='hs-varop'>$</span> <span class='hs-varid'>stripPrefix</span> <span class='hs-layout'>(</span><span class='hs-varid'>reverse</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>reverse</span> <span class='hs-varid'>ys</span><span class='hs-layout'>)</span>
</pre></body>
</html>
