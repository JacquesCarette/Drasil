<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE PostfixOperators, TupleSections #-}</span><span>
</span><span id="line-2"></span><span class="annot"><span class="hs-comment">-- | Defines functions to create traceability graphs in SRS documents.</span></span><span>
</span><span id="line-3"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Drasil.DocumentLanguage.TraceabilityGraph</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Language.Drasil</span></span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Database.Drasil</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">cdb</span></span><span class="hs-special">)</span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">SysInfo.Drasil</span></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(^.)</span></span><span class="hs-special">)</span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Drasil.DocumentLanguage.TraceabilityMatrix.html"><span class="hs-identifier">Drasil.DocumentLanguage.TraceabilityMatrix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Drasil.DocumentLanguage.TraceabilityMatrix.html#TraceViewCat"><span class="hs-identifier">TraceViewCat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Drasil.DocumentLanguage.TraceabilityMatrix.html#traceMReferees"><span class="hs-identifier">traceMReferees</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Drasil.DocumentLanguage.TraceabilityMatrix.html#traceMReferrers"><span class="hs-identifier">traceMReferrers</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>  </span><span class="annot"><a href="Drasil.DocumentLanguage.TraceabilityMatrix.html#traceMColumns"><span class="hs-identifier">traceMColumns</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Drasil.DocumentLanguage.TraceabilityMatrix.html#layoutUIDs"><span class="hs-identifier">layoutUIDs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Drasil.DocumentLanguage.TraceabilityMatrix.html#traceMIntro"><span class="hs-identifier">traceMIntro</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Drasil.Sections.TraceabilityMandGs.html"><span class="hs-identifier">Drasil.Sections.TraceabilityMandGs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Drasil.Sections.TraceabilityMandGs.html#tvAssumps"><span class="hs-identifier">tvAssumps</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>  </span><span class="annot"><a href="Drasil.Sections.TraceabilityMandGs.html#tvDataDefns"><span class="hs-identifier">tvDataDefns</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Drasil.Sections.TraceabilityMandGs.html#tvGenDefns"><span class="hs-identifier">tvGenDefns</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Drasil.Sections.TraceabilityMandGs.html#tvTheoryModels"><span class="hs-identifier">tvTheoryModels</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Drasil.Sections.TraceabilityMandGs.html#tvInsModels"><span class="hs-identifier">tvInsModels</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Drasil.Sections.TraceabilityMandGs.html#tvGoals"><span class="hs-identifier">tvGoals</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Drasil.Sections.TraceabilityMandGs.html#tvReqs"><span class="hs-identifier">tvReqs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>  </span><span class="annot"><a href="Drasil.Sections.TraceabilityMandGs.html#tvChanges"><span class="hs-identifier">tvChanges</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Drasil.DocLang.SRS.html"><span class="hs-identifier">Drasil.DocLang.SRS</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">SRS</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Language.Drasil.Printers</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">GraphInfo</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">NodeFamily</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Drasil.Concepts.Math</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">graph</span></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Drasil.Concepts.Documentation</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">traceyGraph</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">component</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-keyword">dependency</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">reference</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">purpose</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">traceyMatrix</span></span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Language.Drasil.Sentence.Combinators</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Char</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">toLower</span></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Drasil.Sections.ReferenceMaterial.html"><span class="hs-identifier">Drasil.Sections.ReferenceMaterial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Drasil.Sections.ReferenceMaterial.html#emptySectSentPlu"><span class="hs-identifier">emptySectSentPlu</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span class="annot"><span class="hs-comment">-- * Main Functions</span></span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="hs-comment">-- | Wrapper for 'traceMIntro' and 'traceGIntro'. Turns references ('LabelledContent's),</span><span>
</span><span id="line-27"></span><span class="hs-comment">-- trailing notes ('Sentence's), and any other needed contents to create a Traceability 'Section'.</span><span>
</span><span id="line-28"></span><span class="hs-comment">-- Traceability graphs generate as both a link and a figure for convenience.</span><span>
</span><span id="line-29"></span><span class="annot"><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#traceMGF"><span class="hs-identifier hs-type">traceMGF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">LabelledContent</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Sentence</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Contents</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Section</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Section</span></span><span>
</span><span id="line-30"></span><span id="traceMGF"><span class="annot"><span class="annottext">traceMGF :: [LabelledContent]
-&gt; [Sentence] -&gt; [Contents] -&gt; String -&gt; [Section] -&gt; Section
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#traceMGF"><span class="hs-identifier hs-var hs-var">traceMGF</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Contents] -&gt; [Section] -&gt; Section
</span><a href="Drasil.DocLang.SRS.html#traceyMandG"><span class="hs-identifier hs-var">SRS.traceyMandG</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Sentence -&gt; Contents
</span><span class="hs-identifier hs-var">mkParagraph</span></span><span> </span><span class="annot"><span class="annottext">(Sentence -&gt; Contents) -&gt; Sentence -&gt; Contents
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[IdeaDict] -&gt; Sentence
forall n. NamedIdea n =&gt; [n] -&gt; Sentence
</span><a href="Drasil.Sections.ReferenceMaterial.html#emptySectSentPlu"><span class="hs-identifier hs-var">emptySectSentPlu</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">IdeaDict
</span><span class="hs-identifier hs-var">traceyMatrix</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IdeaDict
</span><span class="hs-identifier hs-var">traceyGraph</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-31"></span><span class="annot"><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#traceMGF"><span class="hs-identifier hs-var">traceMGF</span></a></span><span> </span><span id="local-6989586621679099788"><span class="annot"><span class="annottext">[LabelledContent]
</span><a href="#local-6989586621679099788"><span class="hs-identifier hs-var">refs</span></a></span></span><span> </span><span id="local-6989586621679099789"><span class="annot"><span class="annottext">[Sentence]
</span><a href="#local-6989586621679099789"><span class="hs-identifier hs-var">trailing</span></a></span></span><span> </span><span id="local-6989586621679099790"><span class="annot"><span class="annottext">[Contents]
</span><a href="#local-6989586621679099790"><span class="hs-identifier hs-var">otherContents</span></a></span></span><span> </span><span id="local-6989586621679099791"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679099791"><span class="hs-identifier hs-var">ex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Contents] -&gt; [Section] -&gt; Section
</span><a href="Drasil.DocLang.SRS.html#traceyMandG"><span class="hs-identifier hs-var">SRS.traceyMandG</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[LabelledContent] -&gt; [Sentence] -&gt; Contents
</span><a href="Drasil.DocumentLanguage.TraceabilityMatrix.html#traceMIntro"><span class="hs-identifier hs-var">traceMIntro</span></a></span><span> </span><span class="annot"><span class="annottext">[LabelledContent]
</span><a href="#local-6989586621679099788"><span class="hs-identifier hs-var">refs</span></a></span><span> </span><span class="annot"><span class="annottext">[Sentence]
</span><a href="#local-6989586621679099789"><span class="hs-identifier hs-var">trailing</span></a></span><span> </span><span class="annot"><span class="annottext">Contents -&gt; [Contents] -&gt; [Contents]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Contents]
</span><a href="#local-6989586621679099790"><span class="hs-identifier hs-var">otherContents</span></a></span><span>
</span><span id="line-32"></span><span>  </span><span class="annot"><span class="annottext">[Contents] -&gt; [Contents] -&gt; [Contents]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">(UnlabelledContent -&gt; Contents)
-&gt; [UnlabelledContent] -&gt; [Contents]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">UnlabelledContent -&gt; Contents
</span><span class="hs-identifier hs-var">UlC</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[UID] -&gt; [Sentence] -&gt; [UnlabelledContent]
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#traceGIntro"><span class="hs-identifier hs-var">traceGIntro</span></a></span><span> </span><span class="annot"><span class="annottext">[UID]
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#traceGUIDs"><span class="hs-identifier hs-var">traceGUIDs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Sentence]
</span><a href="#local-6989586621679099789"><span class="hs-identifier hs-var">trailing</span></a></span><span> </span><span class="annot"><span class="annottext">[Sentence] -&gt; [Sentence] -&gt; [Sentence]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Sentence
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#allvsallDesc"><span class="hs-identifier hs-var">allvsallDesc</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Contents] -&gt; [Contents] -&gt; [Contents]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [Contents]
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#traceGCon"><span class="hs-identifier hs-var">traceGCon</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679099791"><span class="hs-identifier hs-var">ex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span class="hs-comment">-- | Generalized traceability graph introduction: appends references to the traceability graphs in 'Sentence' form</span><span>
</span><span id="line-35"></span><span class="hs-comment">-- and wraps in 'Contents'. Usually references the five graphs as defined in 'GraphInfo'.</span><span>
</span><span id="line-36"></span><span class="annot"><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#traceGIntro"><span class="hs-identifier hs-type">traceGIntro</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Sentence</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">UnlabelledContent</span></span><span class="hs-special">]</span><span>
</span><span id="line-37"></span><span id="traceGIntro"><span class="annot"><span class="annottext">traceGIntro :: [UID] -&gt; [Sentence] -&gt; [UnlabelledContent]
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#traceGIntro"><span class="hs-identifier hs-var hs-var">traceGIntro</span></a></span></span><span> </span><span id="local-6989586621679099796"><span class="annot"><span class="annottext">[UID]
</span><a href="#local-6989586621679099796"><span class="hs-identifier hs-var">refs</span></a></span></span><span> </span><span id="local-6989586621679099797"><span class="annot"><span class="annottext">[Sentence]
</span><a href="#local-6989586621679099797"><span class="hs-identifier hs-var">trailings</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">RawContent -&gt; UnlabelledContent
</span><span class="hs-identifier hs-var">ulcc</span></span><span> </span><span class="annot"><span class="annottext">(RawContent -&gt; UnlabelledContent)
-&gt; RawContent -&gt; UnlabelledContent
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Sentence -&gt; RawContent
</span><span class="hs-identifier hs-var">Paragraph</span></span><span> </span><span class="annot"><span class="annottext">(Sentence -&gt; RawContent) -&gt; Sentence -&gt; RawContent
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Sentence] -&gt; Sentence
</span><span class="hs-identifier hs-var">foldlSent</span></span><span>
</span><span id="line-38"></span><span>        </span><span class="hs-special">[</span><span class="annot"><span class="annottext">IdeaDict -&gt; Sentence
forall n. NamedIdea n =&gt; n -&gt; Sentence
</span><span class="hs-identifier hs-var">phrase</span></span><span> </span><span class="annot"><span class="annottext">IdeaDict
</span><span class="hs-identifier hs-var">purpose</span></span><span> </span><span class="annot"><span class="annottext">Sentence -&gt; Sentence -&gt; Sentence
</span><span class="hs-operator hs-var">`S.the_ofTheC`</span></span><span> </span><span class="annot"><span class="annottext">IdeaDict -&gt; Sentence
forall n. NamedIdea n =&gt; n -&gt; Sentence
</span><span class="hs-identifier hs-var">plural</span></span><span> </span><span class="annot"><span class="annottext">IdeaDict
</span><span class="hs-identifier hs-var">traceyGraph</span></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; Sentence
</span><span class="hs-identifier hs-var">S</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;is also to provide easy&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IdeaDict -&gt; Sentence
forall n. NamedIdea n =&gt; n -&gt; Sentence
</span><span class="hs-identifier hs-var">plural</span></span><span> </span><span class="annot"><span class="annottext">IdeaDict
</span><span class="hs-identifier hs-var">reference</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Sentence
</span><span class="hs-identifier hs-var">S</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;on what has to be&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; Sentence
</span><span class="hs-identifier hs-var">S</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;additionally modified if a certain&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IdeaDict -&gt; Sentence
forall n. NamedIdea n =&gt; n -&gt; Sentence
</span><span class="hs-identifier hs-var">phrase</span></span><span> </span><span class="annot"><span class="annottext">IdeaDict
</span><span class="hs-identifier hs-var">component</span></span><span> </span><span class="annot"><span class="annottext">Sentence -&gt; Sentence -&gt; Sentence
</span><span class="hs-operator hs-var">+:+.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Sentence
</span><span class="hs-identifier hs-var">S</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;is changed&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; Sentence
</span><span class="hs-identifier hs-var">S</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The arrows in the&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ConceptChunk -&gt; Sentence
forall n. NamedIdea n =&gt; n -&gt; Sentence
</span><span class="hs-identifier hs-var">plural</span></span><span> </span><span class="annot"><span class="annottext">ConceptChunk
</span><span class="hs-identifier hs-var">graph</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Sentence
</span><span class="hs-identifier hs-var">S</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;represent&quot;</span></span><span> </span><span class="annot"><span class="annottext">Sentence -&gt; Sentence -&gt; Sentence
</span><span class="hs-operator hs-var">+:+.</span></span><span> </span><span class="annot"><span class="annottext">IdeaDict -&gt; Sentence
forall n. NamedIdea n =&gt; n -&gt; Sentence
</span><span class="hs-identifier hs-var">plural</span></span><span> </span><span class="annot"><span class="annottext">IdeaDict
</span><span class="hs-keyword hs-var">dependency</span></span><span class="hs-special">,</span><span>
</span><span id="line-42"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; Sentence
</span><span class="hs-identifier hs-var">S</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IdeaDict -&gt; Sentence
forall n. NamedIdea n =&gt; n -&gt; Sentence
</span><span class="hs-identifier hs-var">phrase</span></span><span> </span><span class="annot"><span class="annottext">IdeaDict
</span><span class="hs-identifier hs-var">component</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Sentence
</span><span class="hs-identifier hs-var">S</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;at the tail of an arrow is depended on by the&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span>        </span><span class="annot"><span class="annottext">IdeaDict -&gt; Sentence
forall n. NamedIdea n =&gt; n -&gt; Sentence
</span><span class="hs-identifier hs-var">phrase</span></span><span> </span><span class="annot"><span class="annottext">IdeaDict
</span><span class="hs-identifier hs-var">component</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Sentence
</span><span class="hs-identifier hs-var">S</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;at the head of that arrow. Therefore, if a&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IdeaDict -&gt; Sentence
forall n. NamedIdea n =&gt; n -&gt; Sentence
</span><span class="hs-identifier hs-var">phrase</span></span><span> </span><span class="annot"><span class="annottext">IdeaDict
</span><span class="hs-identifier hs-var">component</span></span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; Sentence
</span><span class="hs-identifier hs-var">S</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;is changed, the&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IdeaDict -&gt; Sentence
forall n. NamedIdea n =&gt; n -&gt; Sentence
</span><span class="hs-identifier hs-var">plural</span></span><span> </span><span class="annot"><span class="annottext">IdeaDict
</span><span class="hs-identifier hs-var">component</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Sentence
</span><span class="hs-identifier hs-var">S</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;that it points to should also be changed&quot;</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Sentence -&gt; Sentence -&gt; Sentence
</span><span class="hs-operator hs-var">+:+</span></span><span>
</span><span id="line-45"></span><span>        </span><span class="annot"><span class="annottext">[Sentence] -&gt; Sentence
</span><span class="hs-identifier hs-var">foldlSent_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(UID -&gt; Sentence -&gt; Sentence) -&gt; [UID] -&gt; [Sentence] -&gt; [Sentence]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">UID -&gt; Sentence -&gt; Sentence
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#graphShows"><span class="hs-identifier hs-var">graphShows</span></a></span><span> </span><span class="annot"><span class="annottext">[UID]
</span><a href="#local-6989586621679099796"><span class="hs-identifier hs-var">refs</span></a></span><span> </span><span class="annot"><span class="annottext">[Sentence]
</span><a href="#local-6989586621679099797"><span class="hs-identifier hs-var">trailings</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span class="annot"><span class="hs-comment">-- | Extracts traceability graph inforomation from filled-in 'SystemInformation'.</span></span><span>
</span><span id="line-48"></span><span class="annot"><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#mkGraphInfo"><span class="hs-identifier hs-type">mkGraphInfo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SystemInformation</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GraphInfo</span></span><span>
</span><span id="line-49"></span><span id="mkGraphInfo"><span class="annot"><span class="annottext">mkGraphInfo :: SystemInformation -&gt; GraphInfo
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#mkGraphInfo"><span class="hs-identifier hs-var hs-var">mkGraphInfo</span></a></span></span><span> </span><span id="local-6989586621679099811"><span class="annot"><span class="annottext">SystemInformation
</span><a href="#local-6989586621679099811"><span class="hs-identifier hs-var">si</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GI</span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-50"></span><span>    </span><span class="annot"><span class="annottext">assumpNF :: NodeFamily
</span><span class="hs-identifier hs-var">assumpNF</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TraceViewCat -&gt; SystemInformation -&gt; String -&gt; NodeFamily
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#mkGraphNodes"><span class="hs-identifier hs-var">mkGraphNodes</span></a></span><span> </span><span class="annot"><span class="annottext">TraceViewCat
</span><a href="Drasil.Sections.TraceabilityMandGs.html#tvAssumps"><span class="hs-identifier hs-var">tvAssumps</span></a></span><span> </span><span class="annot"><span class="annottext">SystemInformation
</span><a href="#local-6989586621679099811"><span class="hs-identifier hs-var">si</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;mistyrose&quot;</span></span><span>
</span><span id="line-51"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ddNF :: NodeFamily
</span><span class="hs-identifier hs-var">ddNF</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TraceViewCat -&gt; SystemInformation -&gt; String -&gt; NodeFamily
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#mkGraphNodes"><span class="hs-identifier hs-var">mkGraphNodes</span></a></span><span> </span><span class="annot"><span class="annottext">TraceViewCat
</span><a href="Drasil.Sections.TraceabilityMandGs.html#tvDataDefns"><span class="hs-identifier hs-var">tvDataDefns</span></a></span><span> </span><span class="annot"><span class="annottext">SystemInformation
</span><a href="#local-6989586621679099811"><span class="hs-identifier hs-var">si</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;paleturquoise1&quot;</span></span><span>
</span><span id="line-52"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">gdNF :: NodeFamily
</span><span class="hs-identifier hs-var">gdNF</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TraceViewCat -&gt; SystemInformation -&gt; String -&gt; NodeFamily
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#mkGraphNodes"><span class="hs-identifier hs-var">mkGraphNodes</span></a></span><span> </span><span class="annot"><span class="annottext">TraceViewCat
</span><a href="Drasil.Sections.TraceabilityMandGs.html#tvGenDefns"><span class="hs-identifier hs-var">tvGenDefns</span></a></span><span> </span><span class="annot"><span class="annottext">SystemInformation
</span><a href="#local-6989586621679099811"><span class="hs-identifier hs-var">si</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;palegreen&quot;</span></span><span>
</span><span id="line-53"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tmNF :: NodeFamily
</span><span class="hs-identifier hs-var">tmNF</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TraceViewCat -&gt; SystemInformation -&gt; String -&gt; NodeFamily
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#mkGraphNodes"><span class="hs-identifier hs-var">mkGraphNodes</span></a></span><span> </span><span class="annot"><span class="annottext">TraceViewCat
</span><a href="Drasil.Sections.TraceabilityMandGs.html#tvTheoryModels"><span class="hs-identifier hs-var">tvTheoryModels</span></a></span><span> </span><span class="annot"><span class="annottext">SystemInformation
</span><a href="#local-6989586621679099811"><span class="hs-identifier hs-var">si</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;pink&quot;</span></span><span>
</span><span id="line-54"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">imNF :: NodeFamily
</span><span class="hs-identifier hs-var">imNF</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TraceViewCat -&gt; SystemInformation -&gt; String -&gt; NodeFamily
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#mkGraphNodes"><span class="hs-identifier hs-var">mkGraphNodes</span></a></span><span> </span><span class="annot"><span class="annottext">TraceViewCat
</span><a href="Drasil.Sections.TraceabilityMandGs.html#tvInsModels"><span class="hs-identifier hs-var">tvInsModels</span></a></span><span> </span><span class="annot"><span class="annottext">SystemInformation
</span><a href="#local-6989586621679099811"><span class="hs-identifier hs-var">si</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;khaki1&quot;</span></span><span>
</span><span id="line-55"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">reqNF :: NodeFamily
</span><span class="hs-identifier hs-var">reqNF</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TraceViewCat -&gt; SystemInformation -&gt; String -&gt; NodeFamily
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#mkGraphNodes"><span class="hs-identifier hs-var">mkGraphNodes</span></a></span><span> </span><span class="annot"><span class="annottext">TraceViewCat
</span><a href="Drasil.Sections.TraceabilityMandGs.html#tvReqs"><span class="hs-identifier hs-var">tvReqs</span></a></span><span> </span><span class="annot"><span class="annottext">SystemInformation
</span><a href="#local-6989586621679099811"><span class="hs-identifier hs-var">si</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ivory&quot;</span></span><span>
</span><span id="line-56"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">gsNF :: NodeFamily
</span><span class="hs-identifier hs-var">gsNF</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TraceViewCat -&gt; SystemInformation -&gt; String -&gt; NodeFamily
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#mkGraphNodes"><span class="hs-identifier hs-var">mkGraphNodes</span></a></span><span> </span><span class="annot"><span class="annottext">TraceViewCat
</span><a href="Drasil.Sections.TraceabilityMandGs.html#tvGoals"><span class="hs-identifier hs-var">tvGoals</span></a></span><span> </span><span class="annot"><span class="annottext">SystemInformation
</span><a href="#local-6989586621679099811"><span class="hs-identifier hs-var">si</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;darkgoldenrod1&quot;</span></span><span>
</span><span id="line-57"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">chgNF :: NodeFamily
</span><span class="hs-identifier hs-var">chgNF</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TraceViewCat -&gt; SystemInformation -&gt; String -&gt; NodeFamily
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#mkGraphNodes"><span class="hs-identifier hs-var">mkGraphNodes</span></a></span><span> </span><span class="annot"><span class="annottext">TraceViewCat
</span><a href="Drasil.Sections.TraceabilityMandGs.html#tvChanges"><span class="hs-identifier hs-var">tvChanges</span></a></span><span> </span><span class="annot"><span class="annottext">SystemInformation
</span><a href="#local-6989586621679099811"><span class="hs-identifier hs-var">si</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;lavender&quot;</span></span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">edgesAvsA :: [(UID, [UID])]
</span><span class="hs-identifier hs-var">edgesAvsA</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TraceViewCat]
-&gt; [TraceViewCat] -&gt; SystemInformation -&gt; [(UID, [UID])]
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#mkGraphEdges"><span class="hs-identifier hs-var">mkGraphEdges</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TraceViewCat
</span><a href="Drasil.Sections.TraceabilityMandGs.html#tvAssumps"><span class="hs-identifier hs-var">tvAssumps</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TraceViewCat
</span><a href="Drasil.Sections.TraceabilityMandGs.html#tvAssumps"><span class="hs-identifier hs-var">tvAssumps</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">SystemInformation
</span><a href="#local-6989586621679099811"><span class="hs-identifier hs-var">si</span></a></span><span>
</span><span id="line-60"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">edgesAvsAll :: [(UID, [UID])]
</span><span class="hs-identifier hs-var">edgesAvsAll</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TraceViewCat]
-&gt; [TraceViewCat] -&gt; SystemInformation -&gt; [(UID, [UID])]
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#mkGraphEdges"><span class="hs-identifier hs-var">mkGraphEdges</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TraceViewCat
</span><a href="Drasil.Sections.TraceabilityMandGs.html#tvAssumps"><span class="hs-identifier hs-var">tvAssumps</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TraceViewCat
</span><a href="Drasil.Sections.TraceabilityMandGs.html#tvDataDefns"><span class="hs-identifier hs-var">tvDataDefns</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TraceViewCat
</span><a href="Drasil.Sections.TraceabilityMandGs.html#tvTheoryModels"><span class="hs-identifier hs-var">tvTheoryModels</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TraceViewCat
</span><a href="Drasil.Sections.TraceabilityMandGs.html#tvGenDefns"><span class="hs-identifier hs-var">tvGenDefns</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TraceViewCat
</span><a href="Drasil.Sections.TraceabilityMandGs.html#tvInsModels"><span class="hs-identifier hs-var">tvInsModels</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TraceViewCat
</span><a href="Drasil.Sections.TraceabilityMandGs.html#tvReqs"><span class="hs-identifier hs-var">tvReqs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TraceViewCat
</span><a href="Drasil.Sections.TraceabilityMandGs.html#tvChanges"><span class="hs-identifier hs-var">tvChanges</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">SystemInformation
</span><a href="#local-6989586621679099811"><span class="hs-identifier hs-var">si</span></a></span><span>
</span><span id="line-61"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">edgesRefvsRef :: [(UID, [UID])]
</span><span class="hs-identifier hs-var">edgesRefvsRef</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TraceViewCat]
-&gt; [TraceViewCat] -&gt; SystemInformation -&gt; [(UID, [UID])]
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#mkGraphEdges"><span class="hs-identifier hs-var">mkGraphEdges</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TraceViewCat
</span><a href="Drasil.Sections.TraceabilityMandGs.html#tvDataDefns"><span class="hs-identifier hs-var">tvDataDefns</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TraceViewCat
</span><a href="Drasil.Sections.TraceabilityMandGs.html#tvTheoryModels"><span class="hs-identifier hs-var">tvTheoryModels</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TraceViewCat
</span><a href="Drasil.Sections.TraceabilityMandGs.html#tvGenDefns"><span class="hs-identifier hs-var">tvGenDefns</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TraceViewCat
</span><a href="Drasil.Sections.TraceabilityMandGs.html#tvInsModels"><span class="hs-identifier hs-var">tvInsModels</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TraceViewCat
</span><a href="Drasil.Sections.TraceabilityMandGs.html#tvDataDefns"><span class="hs-identifier hs-var">tvDataDefns</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TraceViewCat
</span><a href="Drasil.Sections.TraceabilityMandGs.html#tvTheoryModels"><span class="hs-identifier hs-var">tvTheoryModels</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TraceViewCat
</span><a href="Drasil.Sections.TraceabilityMandGs.html#tvGenDefns"><span class="hs-identifier hs-var">tvGenDefns</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TraceViewCat
</span><a href="Drasil.Sections.TraceabilityMandGs.html#tvInsModels"><span class="hs-identifier hs-var">tvInsModels</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">SystemInformation
</span><a href="#local-6989586621679099811"><span class="hs-identifier hs-var">si</span></a></span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">edgesAllvsR :: [(UID, [UID])]
</span><span class="hs-identifier hs-var">edgesAllvsR</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TraceViewCat]
-&gt; [TraceViewCat] -&gt; SystemInformation -&gt; [(UID, [UID])]
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#mkGraphEdges"><span class="hs-identifier hs-var">mkGraphEdges</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TraceViewCat
</span><a href="Drasil.Sections.TraceabilityMandGs.html#tvDataDefns"><span class="hs-identifier hs-var">tvDataDefns</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TraceViewCat
</span><a href="Drasil.Sections.TraceabilityMandGs.html#tvTheoryModels"><span class="hs-identifier hs-var">tvTheoryModels</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">TraceViewCat
</span><a href="Drasil.Sections.TraceabilityMandGs.html#tvGenDefns"><span class="hs-identifier hs-var">tvGenDefns</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TraceViewCat
</span><a href="Drasil.Sections.TraceabilityMandGs.html#tvInsModels"><span class="hs-identifier hs-var">tvInsModels</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TraceViewCat
</span><a href="Drasil.Sections.TraceabilityMandGs.html#tvReqs"><span class="hs-identifier hs-var">tvReqs</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TraceViewCat
</span><a href="Drasil.Sections.TraceabilityMandGs.html#tvGoals"><span class="hs-identifier hs-var">tvGoals</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TraceViewCat
</span><a href="Drasil.Sections.TraceabilityMandGs.html#tvReqs"><span class="hs-identifier hs-var">tvReqs</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">SystemInformation
</span><a href="#local-6989586621679099811"><span class="hs-identifier hs-var">si</span></a></span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">edgesAllvsAll :: [(UID, [UID])]
</span><span class="hs-identifier hs-var">edgesAllvsAll</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TraceViewCat]
-&gt; [TraceViewCat] -&gt; SystemInformation -&gt; [(UID, [UID])]
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#mkGraphEdges"><span class="hs-identifier hs-var">mkGraphEdges</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TraceViewCat
</span><a href="Drasil.Sections.TraceabilityMandGs.html#tvAssumps"><span class="hs-identifier hs-var">tvAssumps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TraceViewCat
</span><a href="Drasil.Sections.TraceabilityMandGs.html#tvDataDefns"><span class="hs-identifier hs-var">tvDataDefns</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TraceViewCat
</span><a href="Drasil.Sections.TraceabilityMandGs.html#tvTheoryModels"><span class="hs-identifier hs-var">tvTheoryModels</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TraceViewCat
</span><a href="Drasil.Sections.TraceabilityMandGs.html#tvGenDefns"><span class="hs-identifier hs-var">tvGenDefns</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TraceViewCat
</span><a href="Drasil.Sections.TraceabilityMandGs.html#tvInsModels"><span class="hs-identifier hs-var">tvInsModels</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TraceViewCat
</span><a href="Drasil.Sections.TraceabilityMandGs.html#tvReqs"><span class="hs-identifier hs-var">tvReqs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TraceViewCat
</span><a href="Drasil.Sections.TraceabilityMandGs.html#tvGoals"><span class="hs-identifier hs-var">tvGoals</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TraceViewCat
</span><a href="Drasil.Sections.TraceabilityMandGs.html#tvChanges"><span class="hs-identifier hs-var">tvChanges</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TraceViewCat
</span><a href="Drasil.Sections.TraceabilityMandGs.html#tvAssumps"><span class="hs-identifier hs-var">tvAssumps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TraceViewCat
</span><a href="Drasil.Sections.TraceabilityMandGs.html#tvDataDefns"><span class="hs-identifier hs-var">tvDataDefns</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TraceViewCat
</span><a href="Drasil.Sections.TraceabilityMandGs.html#tvTheoryModels"><span class="hs-identifier hs-var">tvTheoryModels</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TraceViewCat
</span><a href="Drasil.Sections.TraceabilityMandGs.html#tvGenDefns"><span class="hs-identifier hs-var">tvGenDefns</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TraceViewCat
</span><a href="Drasil.Sections.TraceabilityMandGs.html#tvInsModels"><span class="hs-identifier hs-var">tvInsModels</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TraceViewCat
</span><a href="Drasil.Sections.TraceabilityMandGs.html#tvReqs"><span class="hs-identifier hs-var">tvReqs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TraceViewCat
</span><a href="Drasil.Sections.TraceabilityMandGs.html#tvGoals"><span class="hs-identifier hs-var">tvGoals</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TraceViewCat
</span><a href="Drasil.Sections.TraceabilityMandGs.html#tvChanges"><span class="hs-identifier hs-var">tvChanges</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">SystemInformation
</span><a href="#local-6989586621679099811"><span class="hs-identifier hs-var">si</span></a></span><span>
</span><span id="line-64"></span><span class="hs-special">}</span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span class="annot"><span class="hs-comment">-- * Helper Functions</span></span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-comment">-- | Gets the node family of a graph based on the given section</span><span>
</span><span id="line-69"></span><span class="hs-comment">-- and system information. Also applies a given colour to the node family.</span><span>
</span><span id="line-70"></span><span class="annot"><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#mkGraphNodes"><span class="hs-identifier hs-type">mkGraphNodes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Drasil.DocumentLanguage.TraceabilityMatrix.html#TraceViewCat"><span class="hs-identifier hs-type">TraceViewCat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SystemInformation</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NodeFamily</span></span><span>
</span><span id="line-71"></span><span id="mkGraphNodes"><span class="annot"><span class="annottext">mkGraphNodes :: TraceViewCat -&gt; SystemInformation -&gt; String -&gt; NodeFamily
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#mkGraphNodes"><span class="hs-identifier hs-var hs-var">mkGraphNodes</span></a></span></span><span> </span><span id="local-6989586621679099828"><span class="annot"><span class="annottext">TraceViewCat
</span><a href="#local-6989586621679099828"><span class="hs-identifier hs-var">entry</span></a></span></span><span> </span><span id="local-6989586621679099829"><span class="annot"><span class="annottext">SystemInformation
</span><a href="#local-6989586621679099829"><span class="hs-identifier hs-var">si</span></a></span></span><span> </span><span id="local-6989586621679099830"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679099830"><span class="hs-identifier hs-var">col</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NF</span></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">nodeUIDs :: [UID]
</span><span class="hs-identifier hs-var">nodeUIDs</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[UID]
</span><a href="#local-6989586621679099833"><span class="hs-identifier hs-var">nodeContents</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">nodeLabels :: [String]
</span><span class="hs-identifier hs-var">nodeLabels</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(UID -&gt; String) -&gt; [UID] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SystemInformation -&gt; UID -&gt; String
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#checkUIDRefAdd"><span class="hs-identifier hs-var">checkUIDRefAdd</span></a></span><span> </span><span class="annot"><span class="annottext">SystemInformation
</span><a href="#local-6989586621679099829"><span class="hs-identifier hs-var">si</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[UID]
</span><a href="#local-6989586621679099833"><span class="hs-identifier hs-var">nodeContents</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">nfLabel :: String
</span><span class="hs-identifier hs-var">nfLabel</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[UID] -&gt; String
</span><a href="#local-6989586621679099837"><span class="hs-identifier hs-var">checkNodeContents</span></a></span><span> </span><span class="annot"><span class="annottext">[UID]
</span><a href="#local-6989586621679099833"><span class="hs-identifier hs-var">nodeContents</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">nfColour :: String
</span><span class="hs-identifier hs-var">nfColour</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679099830"><span class="hs-identifier hs-var">col</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-72"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-73"></span><span>        </span><span class="annot"><a href="#local-6989586621679099837"><span class="hs-identifier hs-type">checkNodeContents</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-74"></span><span>        </span><span id="local-6989586621679099837"><span class="annot"><span class="annottext">checkNodeContents :: [UID] -&gt; String
</span><a href="#local-6989586621679099837"><span class="hs-identifier hs-var hs-var">checkNodeContents</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-75"></span><span>        </span><span class="annot"><a href="#local-6989586621679099837"><span class="hs-identifier hs-var">checkNodeContents</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679099839"><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679099839"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[UID]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SystemInformation -&gt; UID -&gt; String
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#checkUIDAbbrev"><span class="hs-identifier hs-var">checkUIDAbbrev</span></a></span><span> </span><span class="annot"><span class="annottext">SystemInformation
</span><a href="#local-6989586621679099829"><span class="hs-identifier hs-var">si</span></a></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679099839"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-76"></span><span>        </span><span id="local-6989586621679099833"><span class="annot"><span class="annottext">nodeContents :: [UID]
</span><a href="#local-6989586621679099833"><span class="hs-identifier hs-var hs-var">nodeContents</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([UID] -&gt; [UID]) -&gt; ChunkDB -&gt; [UID]
</span><a href="Drasil.DocumentLanguage.TraceabilityMatrix.html#traceMReferees"><span class="hs-identifier hs-var">traceMReferees</span></a></span><span> </span><span class="annot"><span class="annottext">[UID] -&gt; [UID]
</span><a href="#local-6989586621679099841"><span class="hs-identifier hs-var">entryF</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679099842"><span class="hs-identifier hs-var">cdb</span></a></span><span>
</span><span id="line-77"></span><span>        </span><span id="local-6989586621679099842"><span class="annot"><span class="annottext">cdb :: ChunkDB
</span><a href="#local-6989586621679099842"><span class="hs-identifier hs-var hs-var">cdb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SystemInformation -&gt; ChunkDB
</span><span class="hs-identifier hs-var">_sysinfodb</span></span><span> </span><span class="annot"><span class="annottext">SystemInformation
</span><a href="#local-6989586621679099829"><span class="hs-identifier hs-var">si</span></a></span><span>
</span><span id="line-78"></span><span>        </span><span id="local-6989586621679099841"><span class="annot"><span class="annottext">entryF :: [UID] -&gt; [UID]
</span><a href="#local-6989586621679099841"><span class="hs-identifier hs-var hs-var">entryF</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TraceViewCat] -&gt; ChunkDB -&gt; [UID] -&gt; [UID]
</span><a href="Drasil.DocumentLanguage.TraceabilityMatrix.html#layoutUIDs"><span class="hs-identifier hs-var">layoutUIDs</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TraceViewCat
</span><a href="#local-6989586621679099828"><span class="hs-identifier hs-var">entry</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679099842"><span class="hs-identifier hs-var">cdb</span></a></span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span class="hs-comment">-- | Creates the graph edges based on the relation of the first list of sections to the second.</span><span>
</span><span id="line-81"></span><span class="hs-comment">-- Also needs the system information. Return value is of the form (Section, [Dependencies]).</span><span>
</span><span id="line-82"></span><span class="annot"><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#mkGraphEdges"><span class="hs-identifier hs-type">mkGraphEdges</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Drasil.DocumentLanguage.TraceabilityMatrix.html#TraceViewCat"><span class="hs-identifier hs-type">TraceViewCat</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Drasil.DocumentLanguage.TraceabilityMatrix.html#TraceViewCat"><span class="hs-identifier hs-type">TraceViewCat</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SystemInformation</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-83"></span><span id="mkGraphEdges"><span class="annot"><span class="annottext">mkGraphEdges :: [TraceViewCat]
-&gt; [TraceViewCat] -&gt; SystemInformation -&gt; [(UID, [UID])]
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#mkGraphEdges"><span class="hs-identifier hs-var hs-var">mkGraphEdges</span></a></span></span><span> </span><span id="local-6989586621679099844"><span class="annot"><span class="annottext">[TraceViewCat]
</span><a href="#local-6989586621679099844"><span class="hs-identifier hs-var">cols</span></a></span></span><span> </span><span id="local-6989586621679099845"><span class="annot"><span class="annottext">[TraceViewCat]
</span><a href="#local-6989586621679099845"><span class="hs-identifier hs-var">rows</span></a></span></span><span> </span><span id="local-6989586621679099846"><span class="annot"><span class="annottext">SystemInformation
</span><a href="#local-6989586621679099846"><span class="hs-identifier hs-var">si</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[UID] -&gt; [[UID]] -&gt; [UID] -&gt; [(UID, [UID])]
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#makeTGraph"><span class="hs-identifier hs-var">makeTGraph</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([UID] -&gt; [UID]) -&gt; SystemInformation -&gt; [UID]
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#traceGRowHeader"><span class="hs-identifier hs-var">traceGRowHeader</span></a></span><span> </span><span class="annot"><span class="annottext">[UID] -&gt; [UID]
</span><a href="#local-6989586621679099849"><span class="hs-identifier hs-var">rowf</span></a></span><span> </span><span class="annot"><span class="annottext">SystemInformation
</span><a href="#local-6989586621679099846"><span class="hs-identifier hs-var">si</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([UID] -&gt; [UID]) -&gt; ([UID] -&gt; [UID]) -&gt; ChunkDB -&gt; [[UID]]
</span><a href="Drasil.DocumentLanguage.TraceabilityMatrix.html#traceMColumns"><span class="hs-identifier hs-var">traceMColumns</span></a></span><span> </span><span class="annot"><span class="annottext">[UID] -&gt; [UID]
</span><a href="#local-6989586621679099850"><span class="hs-identifier hs-var">colf</span></a></span><span> </span><span class="annot"><span class="annottext">[UID] -&gt; [UID]
</span><a href="#local-6989586621679099849"><span class="hs-identifier hs-var">rowf</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679099851"><span class="hs-identifier hs-var">cdb</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([UID] -&gt; [(UID, [UID])]) -&gt; [UID] -&gt; [(UID, [UID])]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">([UID] -&gt; [UID]) -&gt; ChunkDB -&gt; [UID]
</span><a href="Drasil.DocumentLanguage.TraceabilityMatrix.html#traceMReferees"><span class="hs-identifier hs-var">traceMReferees</span></a></span><span> </span><span class="annot"><span class="annottext">[UID] -&gt; [UID]
</span><a href="#local-6989586621679099850"><span class="hs-identifier hs-var">colf</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679099851"><span class="hs-identifier hs-var">cdb</span></a></span><span>
</span><span id="line-84"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-85"></span><span>        </span><span id="local-6989586621679099851"><span class="annot"><span class="annottext">cdb :: ChunkDB
</span><a href="#local-6989586621679099851"><span class="hs-identifier hs-var hs-var">cdb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SystemInformation -&gt; ChunkDB
</span><span class="hs-identifier hs-var">_sysinfodb</span></span><span> </span><span class="annot"><span class="annottext">SystemInformation
</span><a href="#local-6989586621679099846"><span class="hs-identifier hs-var">si</span></a></span><span>
</span><span id="line-86"></span><span>        </span><span id="local-6989586621679099850"><span class="annot"><span class="annottext">colf :: [UID] -&gt; [UID]
</span><a href="#local-6989586621679099850"><span class="hs-identifier hs-var hs-var">colf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TraceViewCat] -&gt; ChunkDB -&gt; [UID] -&gt; [UID]
</span><a href="Drasil.DocumentLanguage.TraceabilityMatrix.html#layoutUIDs"><span class="hs-identifier hs-var">layoutUIDs</span></a></span><span> </span><span class="annot"><span class="annottext">[TraceViewCat]
</span><a href="#local-6989586621679099844"><span class="hs-identifier hs-var">cols</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679099851"><span class="hs-identifier hs-var">cdb</span></a></span><span>
</span><span id="line-87"></span><span>        </span><span id="local-6989586621679099849"><span class="annot"><span class="annottext">rowf :: [UID] -&gt; [UID]
</span><a href="#local-6989586621679099849"><span class="hs-identifier hs-var hs-var">rowf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TraceViewCat] -&gt; ChunkDB -&gt; [UID] -&gt; [UID]
</span><a href="Drasil.DocumentLanguage.TraceabilityMatrix.html#layoutUIDs"><span class="hs-identifier hs-var">layoutUIDs</span></a></span><span> </span><span class="annot"><span class="annottext">[TraceViewCat]
</span><a href="#local-6989586621679099845"><span class="hs-identifier hs-var">rows</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679099851"><span class="hs-identifier hs-var">cdb</span></a></span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="hs-comment">-- | Helper for making graph edges. Taken from Utils.Drasil's traceability matrix relation finder.</span><span>
</span><span id="line-90"></span><span class="hs-comment">-- But, instead of marking &quot;X&quot; on two related ideas, it makes them an edge.</span><span>
</span><span id="line-91"></span><span class="annot"><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#makeTGraph"><span class="hs-identifier hs-type">makeTGraph</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-92"></span><span id="makeTGraph"><span class="annot"><span class="annottext">makeTGraph :: [UID] -&gt; [[UID]] -&gt; [UID] -&gt; [(UID, [UID])]
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#makeTGraph"><span class="hs-identifier hs-var hs-var">makeTGraph</span></a></span></span><span> </span><span id="local-6989586621679099852"><span class="annot"><span class="annottext">[UID]
</span><a href="#local-6989586621679099852"><span class="hs-identifier hs-var">rowName</span></a></span></span><span> </span><span id="local-6989586621679099853"><span class="annot"><span class="annottext">[[UID]]
</span><a href="#local-6989586621679099853"><span class="hs-identifier hs-var">rows</span></a></span></span><span> </span><span id="local-6989586621679099854"><span class="annot"><span class="annottext">[UID]
</span><a href="#local-6989586621679099854"><span class="hs-identifier hs-var">cols</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[UID] -&gt; [[UID]] -&gt; [(UID, [UID])]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[UID]
</span><a href="#local-6989586621679099852"><span class="hs-identifier hs-var">rowName</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[UID] -&gt; [UID] -&gt; [UID]
forall {t :: * -&gt; *} {a}. (Foldable t, Eq a) =&gt; t a -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621679099855"><span class="hs-identifier hs-var">zipFTable'</span></a></span><span> </span><span class="annot"><span class="annottext">[UID]
</span><a href="#local-6989586621679099856"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">[UID]
</span><a href="#local-6989586621679099854"><span class="hs-identifier hs-var">cols</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679099856"><span class="annot"><span class="annottext">[UID]
</span><a href="#local-6989586621679099856"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[[UID]]
</span><a href="#local-6989586621679099853"><span class="hs-identifier hs-var">rows</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-93"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-94"></span><span>    </span><span id="local-6989586621679099855"><span class="annot"><span class="annottext">zipFTable' :: t a -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621679099855"><span class="hs-identifier hs-var hs-var">zipFTable'</span></a></span></span><span> </span><span id="local-6989586621679099861"><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679099861"><span class="hs-identifier hs-var">content</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; [a] -&gt; [a]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; t a -&gt; Bool
forall a. Eq a =&gt; a -&gt; t a -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679099861"><span class="hs-identifier hs-var">content</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="annot"><span class="hs-comment">-- | Checker for uids by finding if the 'UID' is in one of the possible data sets contained in the 'SystemInformation' database.</span></span><span>
</span><span id="line-97"></span><span class="annot"><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#checkUID"><span class="hs-identifier hs-type">checkUID</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SystemInformation</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span>
</span><span id="line-98"></span><span id="checkUID"><span class="annot"><span class="annottext">checkUID :: UID -&gt; SystemInformation -&gt; UID
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#checkUID"><span class="hs-identifier hs-var hs-var">checkUID</span></a></span></span><span> </span><span id="local-6989586621679099864"><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679099864"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679099865"><span class="annot"><span class="annottext">SystemInformation
</span><a href="#local-6989586621679099865"><span class="hs-identifier hs-var">si</span></a></span></span><span>
</span><span id="line-99"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UID -&gt; Map UID (DataDefinition, Int) -&gt; Maybe Int
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe Int
</span><span class="hs-identifier hs-var">Map.lookupIndex</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679099864"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679099867"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
-&gt; Getting
     (Map UID (DataDefinition, Int))
     ChunkDB
     (Map UID (DataDefinition, Int))
-&gt; Map UID (DataDefinition, Int)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting
  (Map UID (DataDefinition, Int))
  ChunkDB
  (Map UID (DataDefinition, Int))
Lens' ChunkDB (Map UID (DataDefinition, Int))
</span><span class="hs-identifier hs-var">dataDefnTable</span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679099864"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-100"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UID -&gt; Map UID (InstanceModel, Int) -&gt; Maybe Int
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe Int
</span><span class="hs-identifier hs-var">Map.lookupIndex</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679099864"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679099867"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
-&gt; Getting
     (Map UID (InstanceModel, Int))
     ChunkDB
     (Map UID (InstanceModel, Int))
-&gt; Map UID (InstanceModel, Int)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting
  (Map UID (InstanceModel, Int))
  ChunkDB
  (Map UID (InstanceModel, Int))
Lens' ChunkDB (Map UID (InstanceModel, Int))
</span><span class="hs-identifier hs-var">insmodelTable</span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679099864"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UID -&gt; Map UID (GenDefn, Int) -&gt; Maybe Int
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe Int
</span><span class="hs-identifier hs-var">Map.lookupIndex</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679099864"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679099867"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
-&gt; Getting
     (Map UID (GenDefn, Int)) ChunkDB (Map UID (GenDefn, Int))
-&gt; Map UID (GenDefn, Int)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting (Map UID (GenDefn, Int)) ChunkDB (Map UID (GenDefn, Int))
Lens' ChunkDB (Map UID (GenDefn, Int))
</span><span class="hs-identifier hs-var">gendefTable</span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679099864"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-102"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UID -&gt; Map UID (TheoryModel, Int) -&gt; Maybe Int
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe Int
</span><span class="hs-identifier hs-var">Map.lookupIndex</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679099864"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679099867"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
-&gt; Getting
     (Map UID (TheoryModel, Int)) ChunkDB (Map UID (TheoryModel, Int))
-&gt; Map UID (TheoryModel, Int)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting
  (Map UID (TheoryModel, Int)) ChunkDB (Map UID (TheoryModel, Int))
Lens' ChunkDB (Map UID (TheoryModel, Int))
</span><span class="hs-identifier hs-var">theoryModelTable</span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679099864"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-103"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UID -&gt; Map UID (ConceptInstance, Int) -&gt; Maybe Int
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe Int
</span><span class="hs-identifier hs-var">Map.lookupIndex</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679099864"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679099867"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
-&gt; Getting
     (Map UID (ConceptInstance, Int))
     ChunkDB
     (Map UID (ConceptInstance, Int))
-&gt; Map UID (ConceptInstance, Int)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting
  (Map UID (ConceptInstance, Int))
  ChunkDB
  (Map UID (ConceptInstance, Int))
Lens' ChunkDB (Map UID (ConceptInstance, Int))
</span><span class="hs-identifier hs-var">conceptinsTable</span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679099864"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UID -&gt; Map UID (Section, Int) -&gt; Maybe Int
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe Int
</span><span class="hs-identifier hs-var">Map.lookupIndex</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679099864"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679099867"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
-&gt; Getting
     (Map UID (Section, Int)) ChunkDB (Map UID (Section, Int))
-&gt; Map UID (Section, Int)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting (Map UID (Section, Int)) ChunkDB (Map UID (Section, Int))
Lens' ChunkDB (Map UID (Section, Int))
</span><span class="hs-identifier hs-var">sectionTable</span></span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679099864"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-105"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UID -&gt; Map UID (LabelledContent, Int) -&gt; Maybe Int
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe Int
</span><span class="hs-identifier hs-var">Map.lookupIndex</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679099864"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679099867"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
-&gt; Getting
     (Map UID (LabelledContent, Int))
     ChunkDB
     (Map UID (LabelledContent, Int))
-&gt; Map UID (LabelledContent, Int)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting
  (Map UID (LabelledContent, Int))
  ChunkDB
  (Map UID (LabelledContent, Int))
Lens' ChunkDB (Map UID (LabelledContent, Int))
</span><span class="hs-identifier hs-var">labelledcontentTable</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679099864"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-106"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679099864"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">UID -&gt; [UID] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">(Citation -&gt; UID) -&gt; [Citation] -&gt; [UID]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Citation -&gt; Getting UID Citation UID -&gt; UID
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting UID Citation UID
forall c. HasUID c =&gt; Getter c UID
Getter Citation UID
</span><span class="hs-identifier hs-var">uid</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SystemInformation -&gt; [Citation]
</span><span class="hs-identifier hs-var">citeDB</span></span><span> </span><span class="annot"><span class="annottext">SystemInformation
</span><a href="#local-6989586621679099865"><span class="hs-identifier hs-var">si</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; UID
</span><span class="hs-identifier hs-var">mkUid</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-107"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; UID
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; UID) -&gt; String -&gt; UID
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UID -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679099864"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Caught.&quot;</span></span><span>
</span><span id="line-108"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679099867"><span class="annot"><span class="annottext">s :: ChunkDB
</span><a href="#local-6989586621679099867"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SystemInformation -&gt; ChunkDB
</span><span class="hs-identifier hs-var">_sysinfodb</span></span><span> </span><span class="annot"><span class="annottext">SystemInformation
</span><a href="#local-6989586621679099865"><span class="hs-identifier hs-var">si</span></a></span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span class="annot"><span class="hs-comment">-- | Similar to 'checkUID' but prepends domain for labelling.</span></span><span>
</span><span id="line-111"></span><span class="annot"><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#checkUIDAbbrev"><span class="hs-identifier hs-type">checkUIDAbbrev</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SystemInformation</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-112"></span><span id="checkUIDAbbrev"><span class="annot"><span class="annottext">checkUIDAbbrev :: SystemInformation -&gt; UID -&gt; String
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#checkUIDAbbrev"><span class="hs-identifier hs-var hs-var">checkUIDAbbrev</span></a></span></span><span> </span><span id="local-6989586621679099880"><span class="annot"><span class="annottext">SystemInformation
</span><a href="#local-6989586621679099880"><span class="hs-identifier hs-var">si</span></a></span></span><span> </span><span id="local-6989586621679099881"><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679099881"><span class="hs-identifier hs-var">t</span></a></span></span><span>
</span><span id="line-113"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679099882"><span class="annot"><span class="annottext">DataDefinition
</span><a href="#local-6989586621679099882"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UID -&gt; Map UID (DataDefinition, Int) -&gt; Maybe (DataDefinition, Int)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679099881"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679099884"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
-&gt; Getting
     (Map UID (DataDefinition, Int))
     ChunkDB
     (Map UID (DataDefinition, Int))
-&gt; Map UID (DataDefinition, Int)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting
  (Map UID (DataDefinition, Int))
  ChunkDB
  (Map UID (DataDefinition, Int))
Lens' ChunkDB (Map UID (DataDefinition, Int))
</span><span class="hs-identifier hs-var">dataDefnTable</span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataDefinition -&gt; String
forall c. CommonIdea c =&gt; c -&gt; String
</span><span class="hs-identifier hs-var">abrv</span></span><span> </span><span class="annot"><span class="annottext">DataDefinition
</span><a href="#local-6989586621679099882"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-114"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679099886"><span class="annot"><span class="annottext">InstanceModel
</span><a href="#local-6989586621679099886"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UID -&gt; Map UID (InstanceModel, Int) -&gt; Maybe (InstanceModel, Int)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679099881"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679099884"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
-&gt; Getting
     (Map UID (InstanceModel, Int))
     ChunkDB
     (Map UID (InstanceModel, Int))
-&gt; Map UID (InstanceModel, Int)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting
  (Map UID (InstanceModel, Int))
  ChunkDB
  (Map UID (InstanceModel, Int))
Lens' ChunkDB (Map UID (InstanceModel, Int))
</span><span class="hs-identifier hs-var">insmodelTable</span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstanceModel -&gt; String
forall c. CommonIdea c =&gt; c -&gt; String
</span><span class="hs-identifier hs-var">abrv</span></span><span> </span><span class="annot"><span class="annottext">InstanceModel
</span><a href="#local-6989586621679099886"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-115"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679099887"><span class="annot"><span class="annottext">GenDefn
</span><a href="#local-6989586621679099887"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UID -&gt; Map UID (GenDefn, Int) -&gt; Maybe (GenDefn, Int)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679099881"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679099884"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
-&gt; Getting
     (Map UID (GenDefn, Int)) ChunkDB (Map UID (GenDefn, Int))
-&gt; Map UID (GenDefn, Int)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting (Map UID (GenDefn, Int)) ChunkDB (Map UID (GenDefn, Int))
Lens' ChunkDB (Map UID (GenDefn, Int))
</span><span class="hs-identifier hs-var">gendefTable</span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenDefn -&gt; String
forall c. CommonIdea c =&gt; c -&gt; String
</span><span class="hs-identifier hs-var">abrv</span></span><span> </span><span class="annot"><span class="annottext">GenDefn
</span><a href="#local-6989586621679099887"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-116"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679099888"><span class="annot"><span class="annottext">TheoryModel
</span><a href="#local-6989586621679099888"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UID -&gt; Map UID (TheoryModel, Int) -&gt; Maybe (TheoryModel, Int)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679099881"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679099884"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
-&gt; Getting
     (Map UID (TheoryModel, Int)) ChunkDB (Map UID (TheoryModel, Int))
-&gt; Map UID (TheoryModel, Int)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting
  (Map UID (TheoryModel, Int)) ChunkDB (Map UID (TheoryModel, Int))
Lens' ChunkDB (Map UID (TheoryModel, Int))
</span><span class="hs-identifier hs-var">theoryModelTable</span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TheoryModel -&gt; String
forall c. CommonIdea c =&gt; c -&gt; String
</span><span class="hs-identifier hs-var">abrv</span></span><span> </span><span class="annot"><span class="annottext">TheoryModel
</span><a href="#local-6989586621679099888"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-117"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679099889"><span class="annot"><span class="annottext">ConceptInstance
</span><a href="#local-6989586621679099889"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UID
-&gt; Map UID (ConceptInstance, Int) -&gt; Maybe (ConceptInstance, Int)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679099881"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679099884"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
-&gt; Getting
     (Map UID (ConceptInstance, Int))
     ChunkDB
     (Map UID (ConceptInstance, Int))
-&gt; Map UID (ConceptInstance, Int)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting
  (Map UID (ConceptInstance, Int))
  ChunkDB
  (Map UID (ConceptInstance, Int))
Lens' ChunkDB (Map UID (ConceptInstance, Int))
</span><span class="hs-identifier hs-var">conceptinsTable</span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe String -&gt; String
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe String -&gt; String) -&gt; Maybe String -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ConceptChunk -&gt; Maybe String
forall c. Idea c =&gt; c -&gt; Maybe String
</span><span class="hs-identifier hs-var">getA</span></span><span> </span><span class="annot"><span class="annottext">(ConceptChunk -&gt; Maybe String) -&gt; ConceptChunk -&gt; Maybe String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ChunkDB -&gt; UID -&gt; ConceptChunk
</span><span class="hs-identifier hs-var">defResolve</span></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679099884"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">(UID -&gt; ConceptChunk) -&gt; UID -&gt; ConceptChunk
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[UID] -&gt; UID
</span><span class="hs-identifier hs-var">sDom</span></span><span> </span><span class="annot"><span class="annottext">([UID] -&gt; UID) -&gt; [UID] -&gt; UID
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ConceptInstance -&gt; [UID]
forall c. ConceptDomain c =&gt; c -&gt; [UID]
</span><span class="hs-identifier hs-var">cdom</span></span><span> </span><span class="annot"><span class="annottext">ConceptInstance
</span><a href="#local-6989586621679099889"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-118"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">(Section, Int)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UID -&gt; Map UID (Section, Int) -&gt; Maybe (Section, Int)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679099881"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679099884"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
-&gt; Getting
     (Map UID (Section, Int)) ChunkDB (Map UID (Section, Int))
-&gt; Map UID (Section, Int)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting (Map UID (Section, Int)) ChunkDB (Map UID (Section, Int))
Lens' ChunkDB (Map UID (Section, Int))
</span><span class="hs-identifier hs-var">sectionTable</span></span><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UID -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679099881"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-comment">-- shouldn't really reach these cases</span><span>
</span><span id="line-119"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">(LabelledContent, Int)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UID
-&gt; Map UID (LabelledContent, Int) -&gt; Maybe (LabelledContent, Int)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679099881"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679099884"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
-&gt; Getting
     (Map UID (LabelledContent, Int))
     ChunkDB
     (Map UID (LabelledContent, Int))
-&gt; Map UID (LabelledContent, Int)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting
  (Map UID (LabelledContent, Int))
  ChunkDB
  (Map UID (LabelledContent, Int))
Lens' ChunkDB (Map UID (LabelledContent, Int))
</span><span class="hs-identifier hs-var">labelledcontentTable</span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UID -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679099881"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-120"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679099881"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">UID -&gt; [UID] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">(Citation -&gt; UID) -&gt; [Citation] -&gt; [UID]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Citation -&gt; Getting UID Citation UID -&gt; UID
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting UID Citation UID
forall c. HasUID c =&gt; Getter c UID
Getter Citation UID
</span><span class="hs-identifier hs-var">uid</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SystemInformation -&gt; [Citation]
</span><span class="hs-identifier hs-var">citeDB</span></span><span> </span><span class="annot"><span class="annottext">SystemInformation
</span><a href="#local-6989586621679099880"><span class="hs-identifier hs-var">si</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-121"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; String -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UID -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679099881"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Caught.&quot;</span></span><span>
</span><span id="line-122"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679099884"><span class="annot"><span class="annottext">s :: ChunkDB
</span><a href="#local-6989586621679099884"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SystemInformation -&gt; ChunkDB
</span><span class="hs-identifier hs-var">_sysinfodb</span></span><span> </span><span class="annot"><span class="annottext">SystemInformation
</span><a href="#local-6989586621679099880"><span class="hs-identifier hs-var">si</span></a></span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span class="annot"><span class="hs-comment">-- | Similar to 'checkUID' but gets reference addresses for display.</span></span><span>
</span><span id="line-125"></span><span class="annot"><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#checkUIDRefAdd"><span class="hs-identifier hs-type">checkUIDRefAdd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SystemInformation</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-126"></span><span id="checkUIDRefAdd"><span class="annot"><span class="annottext">checkUIDRefAdd :: SystemInformation -&gt; UID -&gt; String
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#checkUIDRefAdd"><span class="hs-identifier hs-var hs-var">checkUIDRefAdd</span></a></span></span><span> </span><span id="local-6989586621679099894"><span class="annot"><span class="annottext">SystemInformation
</span><a href="#local-6989586621679099894"><span class="hs-identifier hs-var">si</span></a></span></span><span> </span><span id="local-6989586621679099895"><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679099895"><span class="hs-identifier hs-var">t</span></a></span></span><span>
</span><span id="line-127"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679099896"><span class="annot"><span class="annottext">DataDefinition
</span><a href="#local-6989586621679099896"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UID -&gt; Map UID (DataDefinition, Int) -&gt; Maybe (DataDefinition, Int)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679099895"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679099897"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
-&gt; Getting
     (Map UID (DataDefinition, Int))
     ChunkDB
     (Map UID (DataDefinition, Int))
-&gt; Map UID (DataDefinition, Int)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting
  (Map UID (DataDefinition, Int))
  ChunkDB
  (Map UID (DataDefinition, Int))
Lens' ChunkDB (Map UID (DataDefinition, Int))
</span><span class="hs-identifier hs-var">dataDefnTable</span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LblType -&gt; String
</span><span class="hs-identifier hs-var">getAdd</span></span><span> </span><span class="annot"><span class="annottext">(LblType -&gt; String) -&gt; LblType -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DataDefinition -&gt; LblType
forall b. HasRefAddress b =&gt; b -&gt; LblType
</span><span class="hs-identifier hs-var">getRefAdd</span></span><span> </span><span class="annot"><span class="annottext">DataDefinition
</span><a href="#local-6989586621679099896"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-128"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679099900"><span class="annot"><span class="annottext">InstanceModel
</span><a href="#local-6989586621679099900"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UID -&gt; Map UID (InstanceModel, Int) -&gt; Maybe (InstanceModel, Int)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679099895"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679099897"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
-&gt; Getting
     (Map UID (InstanceModel, Int))
     ChunkDB
     (Map UID (InstanceModel, Int))
-&gt; Map UID (InstanceModel, Int)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting
  (Map UID (InstanceModel, Int))
  ChunkDB
  (Map UID (InstanceModel, Int))
Lens' ChunkDB (Map UID (InstanceModel, Int))
</span><span class="hs-identifier hs-var">insmodelTable</span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LblType -&gt; String
</span><span class="hs-identifier hs-var">getAdd</span></span><span> </span><span class="annot"><span class="annottext">(LblType -&gt; String) -&gt; LblType -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">InstanceModel -&gt; LblType
forall b. HasRefAddress b =&gt; b -&gt; LblType
</span><span class="hs-identifier hs-var">getRefAdd</span></span><span> </span><span class="annot"><span class="annottext">InstanceModel
</span><a href="#local-6989586621679099900"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-129"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679099901"><span class="annot"><span class="annottext">GenDefn
</span><a href="#local-6989586621679099901"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UID -&gt; Map UID (GenDefn, Int) -&gt; Maybe (GenDefn, Int)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679099895"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679099897"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
-&gt; Getting
     (Map UID (GenDefn, Int)) ChunkDB (Map UID (GenDefn, Int))
-&gt; Map UID (GenDefn, Int)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting (Map UID (GenDefn, Int)) ChunkDB (Map UID (GenDefn, Int))
Lens' ChunkDB (Map UID (GenDefn, Int))
</span><span class="hs-identifier hs-var">gendefTable</span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LblType -&gt; String
</span><span class="hs-identifier hs-var">getAdd</span></span><span> </span><span class="annot"><span class="annottext">(LblType -&gt; String) -&gt; LblType -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GenDefn -&gt; LblType
forall b. HasRefAddress b =&gt; b -&gt; LblType
</span><span class="hs-identifier hs-var">getRefAdd</span></span><span> </span><span class="annot"><span class="annottext">GenDefn
</span><a href="#local-6989586621679099901"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-130"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679099902"><span class="annot"><span class="annottext">TheoryModel
</span><a href="#local-6989586621679099902"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UID -&gt; Map UID (TheoryModel, Int) -&gt; Maybe (TheoryModel, Int)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679099895"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679099897"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
-&gt; Getting
     (Map UID (TheoryModel, Int)) ChunkDB (Map UID (TheoryModel, Int))
-&gt; Map UID (TheoryModel, Int)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting
  (Map UID (TheoryModel, Int)) ChunkDB (Map UID (TheoryModel, Int))
Lens' ChunkDB (Map UID (TheoryModel, Int))
</span><span class="hs-identifier hs-var">theoryModelTable</span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LblType -&gt; String
</span><span class="hs-identifier hs-var">getAdd</span></span><span> </span><span class="annot"><span class="annottext">(LblType -&gt; String) -&gt; LblType -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TheoryModel -&gt; LblType
forall b. HasRefAddress b =&gt; b -&gt; LblType
</span><span class="hs-identifier hs-var">getRefAdd</span></span><span> </span><span class="annot"><span class="annottext">TheoryModel
</span><a href="#local-6989586621679099902"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-131"></span><span>  </span><span class="hs-comment">-- Concept instances can range from likely changes to non-functional requirements, so use domain abbreviations for labelling in addition to the reference address.</span><span>
</span><span id="line-132"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679099903"><span class="annot"><span class="annottext">ConceptInstance
</span><a href="#local-6989586621679099903"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UID
-&gt; Map UID (ConceptInstance, Int) -&gt; Maybe (ConceptInstance, Int)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679099895"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679099897"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
-&gt; Getting
     (Map UID (ConceptInstance, Int))
     ChunkDB
     (Map UID (ConceptInstance, Int))
-&gt; Map UID (ConceptInstance, Int)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting
  (Map UID (ConceptInstance, Int))
  ChunkDB
  (Map UID (ConceptInstance, Int))
Lens' ChunkDB (Map UID (ConceptInstance, Int))
</span><span class="hs-identifier hs-var">conceptinsTable</span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe String -&gt; String
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConceptChunk -&gt; Maybe String
forall c. Idea c =&gt; c -&gt; Maybe String
</span><span class="hs-identifier hs-var">getA</span></span><span> </span><span class="annot"><span class="annottext">(ConceptChunk -&gt; Maybe String) -&gt; ConceptChunk -&gt; Maybe String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ChunkDB -&gt; UID -&gt; ConceptChunk
</span><span class="hs-identifier hs-var">defResolve</span></span><span> </span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679099897"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">(UID -&gt; ConceptChunk) -&gt; UID -&gt; ConceptChunk
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[UID] -&gt; UID
</span><span class="hs-identifier hs-var">sDom</span></span><span> </span><span class="annot"><span class="annottext">([UID] -&gt; UID) -&gt; [UID] -&gt; UID
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ConceptInstance -&gt; [UID]
forall c. ConceptDomain c =&gt; c -&gt; [UID]
</span><span class="hs-identifier hs-var">cdom</span></span><span> </span><span class="annot"><span class="annottext">ConceptInstance
</span><a href="#local-6989586621679099903"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;:&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">LblType -&gt; String
</span><span class="hs-identifier hs-var">getAdd</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConceptInstance -&gt; LblType
forall b. HasRefAddress b =&gt; b -&gt; LblType
</span><span class="hs-identifier hs-var">getRefAdd</span></span><span> </span><span class="annot"><span class="annottext">ConceptInstance
</span><a href="#local-6989586621679099903"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">(Section, Int)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UID -&gt; Map UID (Section, Int) -&gt; Maybe (Section, Int)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679099895"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679099897"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
-&gt; Getting
     (Map UID (Section, Int)) ChunkDB (Map UID (Section, Int))
-&gt; Map UID (Section, Int)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting (Map UID (Section, Int)) ChunkDB (Map UID (Section, Int))
Lens' ChunkDB (Map UID (Section, Int))
</span><span class="hs-identifier hs-var">sectionTable</span></span><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UID -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679099895"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-comment">-- shouldn't really reach these cases</span><span>
</span><span id="line-134"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">(LabelledContent, Int)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UID
-&gt; Map UID (LabelledContent, Int) -&gt; Maybe (LabelledContent, Int)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679099895"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChunkDB
</span><a href="#local-6989586621679099897"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">ChunkDB
-&gt; Getting
     (Map UID (LabelledContent, Int))
     ChunkDB
     (Map UID (LabelledContent, Int))
-&gt; Map UID (LabelledContent, Int)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting
  (Map UID (LabelledContent, Int))
  ChunkDB
  (Map UID (LabelledContent, Int))
Lens' ChunkDB (Map UID (LabelledContent, Int))
</span><span class="hs-identifier hs-var">labelledcontentTable</span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UID -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679099895"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-135"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679099895"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">UID -&gt; [UID] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">(Citation -&gt; UID) -&gt; [Citation] -&gt; [UID]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Citation -&gt; Getting UID Citation UID -&gt; UID
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting UID Citation UID
forall c. HasUID c =&gt; Getter c UID
Getter Citation UID
</span><span class="hs-identifier hs-var">uid</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SystemInformation -&gt; [Citation]
</span><span class="hs-identifier hs-var">citeDB</span></span><span> </span><span class="annot"><span class="annottext">SystemInformation
</span><a href="#local-6989586621679099894"><span class="hs-identifier hs-var">si</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-136"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; String -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UID -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679099895"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Caught.&quot;</span></span><span>
</span><span id="line-137"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679099897"><span class="annot"><span class="annottext">s :: ChunkDB
</span><a href="#local-6989586621679099897"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SystemInformation -&gt; ChunkDB
</span><span class="hs-identifier hs-var">_sysinfodb</span></span><span> </span><span class="annot"><span class="annottext">SystemInformation
</span><a href="#local-6989586621679099894"><span class="hs-identifier hs-var">si</span></a></span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span class="hs-comment">-- | Helper that finds the header of a traceability matrix.</span><span>
</span><span id="line-140"></span><span class="hs-comment">-- However, here we use this to get a list of 'UID's for a traceability graph instead.</span><span>
</span><span id="line-141"></span><span class="annot"><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#traceGHeader"><span class="hs-identifier hs-type">traceGHeader</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ChunkDB</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SystemInformation</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span class="hs-special">]</span><span>
</span><span id="line-142"></span><span id="traceGHeader"><span class="annot"><span class="annottext">traceGHeader :: (ChunkDB -&gt; [UID]) -&gt; SystemInformation -&gt; [UID]
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#traceGHeader"><span class="hs-identifier hs-var hs-var">traceGHeader</span></a></span></span><span> </span><span id="local-6989586621679099905"><span class="annot"><span class="annottext">ChunkDB -&gt; [UID]
</span><a href="#local-6989586621679099905"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679099906"><span class="annot"><span class="annottext">SystemInformation
</span><a href="#local-6989586621679099906"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(UID -&gt; UID) -&gt; [UID] -&gt; [UID]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UID -&gt; SystemInformation -&gt; UID
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#checkUID"><span class="hs-operator hs-var">`checkUID`</span></a></span><span> </span><span class="annot"><span class="annottext">SystemInformation
</span><a href="#local-6989586621679099906"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([UID] -&gt; [UID]) -&gt; [UID] -&gt; [UID]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ChunkDB -&gt; [UID]
</span><a href="#local-6989586621679099905"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(ChunkDB -&gt; [UID]) -&gt; ChunkDB -&gt; [UID]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SystemInformation -&gt; ChunkDB
</span><span class="hs-identifier hs-var">_sysinfodb</span></span><span> </span><span class="annot"><span class="annottext">SystemInformation
</span><a href="#local-6989586621679099906"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span class="hs-comment">-- | Helper that finds the headers of the traceability matrix rows.</span><span>
</span><span id="line-145"></span><span class="hs-comment">-- However, here we use this to get a list of 'UID's for a traceability graph instead.</span><span>
</span><span id="line-146"></span><span class="hs-comment">-- This is then used to create the graph edges.</span><span>
</span><span id="line-147"></span><span class="annot"><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#traceGRowHeader"><span class="hs-identifier hs-type">traceGRowHeader</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SystemInformation</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span class="hs-special">]</span><span>
</span><span id="line-148"></span><span id="traceGRowHeader"><span class="annot"><span class="annottext">traceGRowHeader :: ([UID] -&gt; [UID]) -&gt; SystemInformation -&gt; [UID]
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#traceGRowHeader"><span class="hs-identifier hs-var hs-var">traceGRowHeader</span></a></span></span><span> </span><span id="local-6989586621679099907"><span class="annot"><span class="annottext">[UID] -&gt; [UID]
</span><a href="#local-6989586621679099907"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ChunkDB -&gt; [UID]) -&gt; SystemInformation -&gt; [UID]
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#traceGHeader"><span class="hs-identifier hs-var">traceGHeader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([UID] -&gt; [UID]) -&gt; ChunkDB -&gt; [UID]
</span><a href="Drasil.DocumentLanguage.TraceabilityMatrix.html#traceMReferrers"><span class="hs-identifier hs-var">traceMReferrers</span></a></span><span> </span><span class="annot"><span class="annottext">[UID] -&gt; [UID]
</span><a href="#local-6989586621679099907"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span class="hs-comment">-- FIXME: Should take a Reference instead of just a Reference UID</span><span>
</span><span id="line-151"></span><span class="annot"><span class="hs-comment">-- | Helper that makes references of the form &quot;@reference@ shows the dependencies of @something@&quot;. Only takes a reference `UID` instead of a `Reference`.</span></span><span>
</span><span id="line-152"></span><span class="annot"><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#graphShows"><span class="hs-identifier hs-type">graphShows</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Sentence</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Sentence</span></span><span>
</span><span id="line-153"></span><span id="graphShows"><span class="annot"><span class="annottext">graphShows :: UID -&gt; Sentence -&gt; Sentence
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#graphShows"><span class="hs-identifier hs-var hs-var">graphShows</span></a></span></span><span> </span><span id="local-6989586621679099909"><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679099909"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679099910"><span class="annot"><span class="annottext">Sentence
</span><a href="#local-6989586621679099910"><span class="hs-identifier hs-var">end</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Reference -&gt; Sentence
forall r.
(HasUID r, HasRefAddress r, HasShortName r) =&gt;
r -&gt; Sentence
</span><span class="hs-identifier hs-var">refS</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UID -&gt; Reference
</span><span class="hs-identifier hs-var">makeFigRef'</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679099909"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Sentence -&gt; Sentence -&gt; Sentence
</span><span class="hs-operator hs-var">+:+</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Sentence
</span><span class="hs-identifier hs-var">S</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;shows the&quot;</span></span><span> </span><span class="annot"><span class="annottext">Sentence -&gt; Sentence -&gt; Sentence
</span><span class="hs-operator hs-var">+:+</span></span><span> </span><span class="annot"><span class="annottext">IdeaDict -&gt; Sentence
forall n. NamedIdea n =&gt; n -&gt; Sentence
</span><span class="hs-identifier hs-var">plural</span></span><span> </span><span class="annot"><span class="annottext">IdeaDict
</span><span class="hs-keyword hs-var">dependency</span></span><span> </span><span class="annot"><span class="annottext">Sentence -&gt; Sentence -&gt; Sentence
</span><span class="hs-operator hs-var">`S.of_`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Sentence
</span><a href="#local-6989586621679099910"><span class="hs-identifier hs-var">end</span></a></span><span> </span><span class="hs-operator">!.</span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span class="annot"><span class="hs-comment">-- * Functions to Create a Traceability Graphs</span></span><span>
</span><span id="line-156"></span><span class="hs-comment">--</span><span>
</span><span id="line-157"></span><span class="hs-comment">-- $createTraceyGraphs</span><span>
</span><span id="line-158"></span><span class="hs-comment">--</span><span>
</span><span id="line-159"></span><span class="hs-comment">-- Functions related to setting up the structure and contents of the traceability graphs section.</span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span class="annot"><span class="hs-comment">-- | Description of the @AllvsAll@ traceability graph.</span></span><span>
</span><span id="line-162"></span><span class="annot"><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#allvsallDesc"><span class="hs-identifier hs-type">allvsallDesc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Sentence</span></span><span>
</span><span id="line-163"></span><span id="allvsallDesc"><span class="annot"><span class="annottext">allvsallDesc :: Sentence
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#allvsallDesc"><span class="hs-identifier hs-var hs-var">allvsallDesc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Sentence
</span><span class="hs-identifier hs-var">S</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;dependencies of assumptions, models, definitions, requirements, goals, and changes with each other&quot;</span></span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span class="annot"><span class="hs-comment">-- | Create a list of traceability graph references.</span></span><span>
</span><span id="line-166"></span><span class="annot"><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#traceGLst"><span class="hs-identifier hs-type">traceGLst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Contents</span></span><span>
</span><span id="line-167"></span><span id="traceGLst"><span class="annot"><span class="annottext">traceGLst :: Contents
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#traceGLst"><span class="hs-identifier hs-var hs-var">traceGLst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnlabelledContent -&gt; Contents
</span><span class="hs-identifier hs-var">UlC</span></span><span> </span><span class="annot"><span class="annottext">(UnlabelledContent -&gt; Contents) -&gt; UnlabelledContent -&gt; Contents
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RawContent -&gt; UnlabelledContent
</span><span class="hs-identifier hs-var">ulcc</span></span><span> </span><span class="annot"><span class="annottext">(RawContent -&gt; UnlabelledContent)
-&gt; RawContent -&gt; UnlabelledContent
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ListType -&gt; RawContent
</span><span class="hs-identifier hs-var">Enumeration</span></span><span> </span><span class="annot"><span class="annottext">(ListType -&gt; RawContent) -&gt; ListType -&gt; RawContent
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(ItemType, Maybe String)] -&gt; ListType
</span><span class="hs-identifier hs-var">Bullet</span></span><span> </span><span class="annot"><span class="annottext">([(ItemType, Maybe String)] -&gt; ListType)
-&gt; [(ItemType, Maybe String)] -&gt; ListType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(ItemType -&gt; (ItemType, Maybe String))
-&gt; [ItemType] -&gt; [(ItemType, Maybe String)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe String
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ItemType]
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#folderList%27"><span class="hs-identifier hs-var">folderList'</span></a></span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span class="annot"><span class="hs-comment">-- | The Traceability Graph contents.</span></span><span>
</span><span id="line-170"></span><span class="annot"><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#traceGCon"><span class="hs-identifier hs-type">traceGCon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Contents</span></span><span class="hs-special">]</span><span>
</span><span id="line-171"></span><span id="traceGCon"><span class="annot"><span class="annottext">traceGCon :: String -&gt; [Contents]
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#traceGCon"><span class="hs-identifier hs-var hs-var">traceGCon</span></a></span></span><span> </span><span id="local-6989586621679099918"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679099918"><span class="hs-identifier hs-var">ex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LabelledContent -&gt; Contents) -&gt; [LabelledContent] -&gt; [Contents]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">LabelledContent -&gt; Contents
</span><span class="hs-identifier hs-var">LlC</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(String -&gt; UID -&gt; LabelledContent)
-&gt; [String] -&gt; [UID] -&gt; [LabelledContent]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String -&gt; UID -&gt; LabelledContent
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#traceGraphLC"><span class="hs-identifier hs-var">traceGraphLC</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679099918"><span class="hs-identifier hs-var">ex</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#traceGFiles"><span class="hs-identifier hs-var">traceGFiles</span></a></span><span> </span><span class="annot"><span class="annottext">[UID]
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#traceGUIDs"><span class="hs-identifier hs-var">traceGUIDs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Contents] -&gt; [Contents] -&gt; [Contents]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Sentence -&gt; Contents
</span><span class="hs-identifier hs-var">mkParagraph</span></span><span> </span><span class="annot"><span class="annottext">(Sentence -&gt; Contents) -&gt; Sentence -&gt; Contents
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Sentence
</span><span class="hs-identifier hs-var">S</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;For convenience, the following graphs can be found at the links below:&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Contents
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#traceGLst"><span class="hs-identifier hs-var">traceGLst</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="annot"><span class="hs-comment">-- | Generates traceability graphs as figures on an SRS document.</span></span><span>
</span><span id="line-174"></span><span class="annot"><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#traceGraphLC"><span class="hs-identifier hs-type">traceGraphLC</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LabelledContent</span></span><span>
</span><span id="line-175"></span><span id="traceGraphLC"><span class="annot"><span class="annottext">traceGraphLC :: String -&gt; String -&gt; UID -&gt; LabelledContent
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#traceGraphLC"><span class="hs-identifier hs-var hs-var">traceGraphLC</span></a></span></span><span> </span><span id="local-6989586621679099923"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679099923"><span class="hs-identifier hs-var">ex</span></a></span></span><span> </span><span id="local-6989586621679099924"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679099924"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span id="local-6989586621679099925"><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679099925"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Reference -&gt; RawContent -&gt; LabelledContent
</span><span class="hs-identifier hs-var">llcc</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UID -&gt; Reference
</span><span class="hs-identifier hs-var">makeFigRef'</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679099925"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(RawContent -&gt; LabelledContent) -&gt; RawContent -&gt; LabelledContent
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Sentence -&gt; String -&gt; RawContent
</span><span class="hs-identifier hs-var">fig</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Sentence
</span><span class="hs-identifier hs-var">S</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Sentence) -&gt; String -&gt; Sentence
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UID -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679099925"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(String -&gt; RawContent) -&gt; String -&gt; RawContent
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#traceyGraphPath"><span class="hs-identifier hs-var">traceyGraphPath</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679099923"><span class="hs-identifier hs-var">ex</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679099924"><span class="hs-identifier hs-var">fp</span></a></span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span class="annot"><span class="hs-comment">-- | Traceability graph file names.</span></span><span>
</span><span id="line-178"></span><span class="annot"><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#traceGFiles"><span class="hs-identifier hs-type">traceGFiles</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-179"></span><span class="annot"><span class="hs-comment">-- | Traceabiliy graph reference 'UID's.</span></span><span>
</span><span id="line-180"></span><span class="annot"><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#traceGUIDs"><span class="hs-identifier hs-type">traceGUIDs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">UID</span></span><span class="hs-special">]</span><span>
</span><span id="line-181"></span><span class="annot"><span class="hs-comment">-- | Create reference paths to traceability graphs given an example name. For @.pdf@ links</span></span><span>
</span><span id="line-182"></span><span class="annot"><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#traceyGraphPaths"><span class="hs-identifier hs-type">traceyGraphPaths</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-183"></span><span class="annot"><span class="hs-comment">-- | Create references to traceability graphs given an example name. Primarily used for reference database in examples.</span></span><span>
</span><span id="line-184"></span><span class="annot"><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#traceyGraphGetRefs"><span class="hs-identifier hs-type">traceyGraphGetRefs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Reference</span></span><span class="hs-special">]</span><span>
</span><span id="line-185"></span><span class="annot"><span class="hs-comment">-- | Gets the path of a traceability graph given an example folder name and the graph name. For @.png@ files</span></span><span>
</span><span id="line-186"></span><span class="annot"><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#traceyGraphPath"><span class="hs-identifier hs-type">traceyGraphPath</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span id="traceGFiles"><span class="annot"><span class="annottext">traceGFiles :: [String]
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#traceGFiles"><span class="hs-identifier hs-var hs-var">traceGFiles</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;avsa&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;avsall&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;refvsref&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;allvsr&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;allvsall&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-189"></span><span id="traceGUIDs"><span class="annot"><span class="annottext">traceGUIDs :: [UID]
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#traceGUIDs"><span class="hs-identifier hs-var hs-var">traceGUIDs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String -&gt; UID) -&gt; [String] -&gt; [UID]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; UID
</span><span class="hs-identifier hs-var">mkUid</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;TraceGraphAvsA&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;TraceGraphAvsAll&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;TraceGraphRefvsRef&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;TraceGraphAllvsR&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;TraceGraphAllvsAll&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-190"></span><span id="traceyGraphPaths"><span class="annot"><span class="annottext">traceyGraphPaths :: String -&gt; [String]
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#traceyGraphPaths"><span class="hs-identifier hs-var hs-var">traceyGraphPaths</span></a></span></span><span> </span><span id="local-6989586621679099931"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679099931"><span class="hs-identifier hs-var">ex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; [String] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679099932"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679099932"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#resourcePath"><span class="hs-identifier hs-var">resourcePath</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Char) -&gt; String -&gt; String
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char
</span><span class="hs-identifier hs-var">toLower</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679099931"><span class="hs-identifier hs-var">ex</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;/&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679099932"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.svg&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#traceGFiles"><span class="hs-identifier hs-var">traceGFiles</span></a></span><span>
</span><span id="line-191"></span><span id="traceyGraphGetRefs"><span class="annot"><span class="annottext">traceyGraphGetRefs :: String -&gt; [Reference]
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#traceyGraphGetRefs"><span class="hs-identifier hs-var hs-var">traceyGraphGetRefs</span></a></span></span><span> </span><span id="local-6989586621679099934"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679099934"><span class="hs-identifier hs-var">ex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(UID -&gt; Reference) -&gt; [UID] -&gt; [Reference]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">UID -&gt; Reference
</span><span class="hs-identifier hs-var">makeFigRef'</span></span><span> </span><span class="annot"><span class="annottext">[UID]
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#traceGUIDs"><span class="hs-identifier hs-var">traceGUIDs</span></a></span><span> </span><span class="annot"><span class="annottext">[Reference] -&gt; [Reference] -&gt; [Reference]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">(UID -&gt; String -&gt; Reference) -&gt; [UID] -&gt; [String] -&gt; [Reference]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679099935"><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679099935"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679099936"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679099936"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UID -&gt; LblType -&gt; ShortName -&gt; Reference
</span><span class="hs-identifier hs-var">Reference</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679099935"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">UID -&gt; String -&gt; UID
</span><span class="hs-operator hs-var">+++.</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Link&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; LblType
</span><span class="hs-identifier hs-var">URI</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679099936"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Sentence -&gt; ShortName
</span><span class="hs-identifier hs-var">shortname'</span></span><span> </span><span class="annot"><span class="annottext">(Sentence -&gt; ShortName) -&gt; Sentence -&gt; ShortName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Sentence
</span><span class="hs-identifier hs-var">S</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Sentence) -&gt; String -&gt; Sentence
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UID -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679099935"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[UID]
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#traceGUIDs"><span class="hs-identifier hs-var">traceGUIDs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; [String]
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#traceyGraphPaths"><span class="hs-identifier hs-var">traceyGraphPaths</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; [String]) -&gt; String -&gt; [String]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Char) -&gt; String -&gt; String
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char
</span><span class="hs-identifier hs-var">toLower</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679099934"><span class="hs-identifier hs-var">ex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span class="hs-comment">-- for actual use in creating the graph figures</span><span>
</span><span id="line-193"></span><span id="traceyGraphPath"><span class="annot"><span class="annottext">traceyGraphPath :: String -&gt; String -&gt; String
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#traceyGraphPath"><span class="hs-identifier hs-var hs-var">traceyGraphPath</span></a></span></span><span> </span><span id="local-6989586621679099940"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679099940"><span class="hs-identifier hs-var">ex</span></a></span></span><span> </span><span id="local-6989586621679099941"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679099941"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#resourcePath"><span class="hs-identifier hs-var">resourcePath</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Char) -&gt; String -&gt; String
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char
</span><span class="hs-identifier hs-var">toLower</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679099940"><span class="hs-identifier hs-var">ex</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;/&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679099941"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.svg&quot;</span></span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span class="annot"><span class="hs-comment">-- | Traceability graphs reference path.</span></span><span>
</span><span id="line-196"></span><span class="annot"><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#resourcePath"><span class="hs-identifier hs-type">resourcePath</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-197"></span><span id="resourcePath"><span class="annot"><span class="annottext">resourcePath :: String
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#resourcePath"><span class="hs-identifier hs-var hs-var">resourcePath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;../../../../traceygraphs/&quot;</span></span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span class="annot"><span class="hs-comment">-- | Helper to create a list of traceability graph references.</span></span><span>
</span><span id="line-200"></span><span class="annot"><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#folderList%27"><span class="hs-identifier hs-type">folderList'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">ItemType</span></span><span class="hs-special">]</span><span>
</span><span id="line-201"></span><span id="folderList%27"><span class="annot"><span class="annottext">folderList' :: [ItemType]
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#folderList%27"><span class="hs-identifier hs-var hs-var">folderList'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(UID -&gt; ItemType) -&gt; [UID] -&gt; [ItemType]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Sentence -&gt; ItemType
</span><span class="hs-identifier hs-var">Flat</span></span><span> </span><span class="annot"><span class="annottext">(Sentence -&gt; ItemType) -&gt; (UID -&gt; Sentence) -&gt; UID -&gt; ItemType
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679099944"><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679099944"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UID -&gt; Sentence -&gt; RefInfo -&gt; Sentence
</span><span class="hs-identifier hs-var">Ref</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UID
</span><a href="#local-6989586621679099944"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">UID -&gt; String -&gt; UID
</span><span class="hs-operator hs-var">+++.</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Link&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Sentence
</span><span class="hs-identifier hs-var">EmptyS</span></span><span> </span><span class="annot"><span class="annottext">RefInfo
</span><span class="hs-identifier hs-var">None</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[UID]
</span><a href="Drasil.DocumentLanguage.TraceabilityGraph.html#traceGUIDs"><span class="hs-identifier hs-var">traceGUIDs</span></a></span><span>
</span><span id="line-202"></span></pre></body></html>