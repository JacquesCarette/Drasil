-- Hoogle documentation, generated by Haddock
-- See Hoogle, http://www.haskell.org/hoogle/


-- | A framework for code and document generation for scientific software - Database SubPackage
--   
--   Please see the README on GitHub at
--   <a>https://github.com/JacquesCarette/Drasil#readme</a>
@package drasil-database
@version 0.1.1.0


-- | Defines types and functions to create a chunk database within Drasil.
module Database.Drasil.ChunkDB

-- | Our chunk databases. Must contain all maps needed in an example. In
--   turn, these maps must contain every chunk definition or concept used
--   in its respective example, else an error is thrown.
data ChunkDB
CDB :: SymbolMap -> TermMap -> ConceptMap -> UnitMap -> DatadefnMap -> InsModelMap -> GendefMap -> TheoryModelMap -> ConceptInstanceMap -> CitationMap -> LabelledContentMap -> ReferenceMap -> TraceMap -> RefbyMap -> ChunkDB
[symbolTable] :: ChunkDB -> SymbolMap
[termTable] :: ChunkDB -> TermMap
[conceptChunkTable] :: ChunkDB -> ConceptMap
[_unitTable] :: ChunkDB -> UnitMap
[_dataDefnTable] :: ChunkDB -> DatadefnMap
[_insmodelTable] :: ChunkDB -> InsModelMap
[_gendefTable] :: ChunkDB -> GendefMap
[_theoryModelTable] :: ChunkDB -> TheoryModelMap
[_conceptinsTable] :: ChunkDB -> ConceptInstanceMap
[_citationTable] :: ChunkDB -> CitationMap
[_labelledcontentTable] :: ChunkDB -> LabelledContentMap
[_refTable] :: ChunkDB -> ReferenceMap
[_traceTable] :: ChunkDB -> TraceMap
[_refbyTable] :: ChunkDB -> RefbyMap
data TermAbbr
TermAbbr :: NP -> Maybe String -> TermAbbr
[longForm] :: TermAbbr -> NP
[shortForm] :: TermAbbr -> Maybe String
data DomDefn
DomDefn :: [UID] -> Sentence -> DomDefn
[domain] :: DomDefn -> [UID]
[definition] :: DomDefn -> Sentence

-- | A reference map, used to hold a <a>UID</a> and where it is referenced
--   (<a>UID</a>s).
type RefbyMap = Map UID [UID]

-- | A traceability map, used to hold the relation between one <a>UID</a>
--   and a list of other <a>UID</a>s.
type TraceMap = Map UID [UID]

-- | The misnomers below (for the following Map types) are not actually a
--   bad thing. We want to ensure data can't be added to a map if it's not
--   coming from a chunk, and there's no point confusing what the map is
--   for. One is for symbols + their units, and the others are for what
--   they state.
type UMap a = Map UID (a, Int)

-- | Smart constructor for chunk databases. Takes in the following:
--   
--   <ul>
--   <li>[<a>Quantity</a>] (for <a>SymbolMap</a>),</li>
--   <li><a>NamedIdea</a>s (for <a>TermMap</a>),</li>
--   <li><a>Concept</a>s (for <a>ConceptMap</a>),</li>
--   <li>Units (something that <a>IsUnit</a> for <a>UnitMap</a>),</li>
--   <li><a>DataDefinition</a>s (for <a>DatadefnMap</a>),</li>
--   <li><a>InstanceModel</a>s (for <a>InsModelMap</a>),</li>
--   <li><a>GenDefn</a>s (for <a>GendefMap</a>),</li>
--   <li><a>TheoryModel</a>s (for <a>TheoryModelMap</a>),</li>
--   <li><a>ConceptInstance</a>s (for <a>ConceptInstanceMap</a>),</li>
--   <li><a>LabelledContent</a>s (for <a>LabelledContentMap</a>). Creates
--   an empty ChunkDB without basic data. cdb in MetaDatabase.Drasil should
--   be preferred over this function as it includes the basic data needed
--   for Drasil.</li>
--   </ul>
cdb' :: (Quantity q, MayHaveUnit q, Concept q, Concept c, IsUnit u) => [q] -> [IdeaDict] -> [c] -> [u] -> [DataDefinition] -> [InstanceModel] -> [GenDefn] -> [TheoryModel] -> [ConceptInstance] -> [LabelledContent] -> [Reference] -> [Citation] -> ChunkDB

-- | General smart constructor for making a <a>UMap</a> out of anything
--   that has a <a>UID</a>.
idMap :: HasUID a => String -> [a] -> Map UID (a, Int)

-- | Smart constructor for a <a>SymbolMap</a>.
symbolMap :: (Quantity c, MayHaveUnit c, Concept c) => [c] -> SymbolMap

-- | Smart constructor for a <a>TermMap</a>.
termMap :: Idea c => [c] -> TermMap

-- | Smart constructor for a <a>ConceptMap</a>.
conceptMap :: Concept c => [c] -> ConceptMap

-- | Smart constructor for a <a>UnitMap</a>.
unitMap :: IsUnit u => [u] -> UnitMap

-- | Smart constructor for a <a>TraceMap</a> given a traceability matrix.
traceMap :: [(UID, [UID])] -> TraceMap

-- | Translates a traceability map into a reference map.
generateRefbyMap :: TraceMap -> RefbyMap

-- | Gets an ordered list of <tt>a</tt> from any <tt>a</tt> that is of type
--   <a>UMap</a>.
asOrderedList :: UMap a -> [a]

-- | Gets the units of a <a>Quantity</a> as <a>UnitDefn</a>s.
collectUnits :: Quantity c => ChunkDB -> [c] -> [UnitDefn]

-- | Search for _any_ chunk that is an instance of <a>Idea</a> and process
--   its "term" and abbreviation.
termResolve :: (NP -> Maybe String -> c) -> ChunkDB -> UID -> c

-- | Find a chunks "term" and abbreviation, if it exists.
termResolve' :: ChunkDB -> UID -> TermAbbr

-- | Looks up a <a>UID</a> in all tables with concepts from the
--   <a>ChunkDB</a>. If nothing is found, an error is thrown.
defResolve :: ([UID] -> Sentence -> c) -> ChunkDB -> UID -> c

-- | Looks up a <a>UID</a> in the symbol table from the <a>ChunkDB</a>. If
--   nothing is found, an error is thrown.
symbResolve :: ChunkDB -> UID -> DefinedQuantityDict

-- | Trace a <a>UID</a> to related <a>UID</a>s.
traceLookup :: UID -> TraceMap -> [UID]

-- | Trace a <a>UID</a> to referenced <a>UID</a>s.
refbyLookup :: UID -> RefbyMap -> [UID]

-- | Looks up a <a>UID</a> in the datadefinition table. If nothing is
--   found, an error is thrown.
datadefnLookup :: UID -> DatadefnMap -> DataDefinition

-- | Looks up a <a>UID</a> in the instance model table. If nothing is
--   found, an error is thrown.
insmodelLookup :: UID -> InsModelMap -> InstanceModel

-- | Looks up a <a>UID</a> in the general definition table. If nothing is
--   found, an error is thrown.
gendefLookup :: UID -> GendefMap -> GenDefn

-- | Looks up a <a>UID</a> in the theory model table. If nothing is found,
--   an error is thrown.
theoryModelLookup :: UID -> TheoryModelMap -> TheoryModel

-- | Looks up a <a>UID</a> in the concept instance table. If nothing is
--   found, an error is thrown.
conceptinsLookup :: UID -> ConceptInstanceMap -> ConceptInstance

-- | Looks up a <a>UID</a> in the reference table from the <a>ChunkDB</a>.
--   If nothing is found, an error is thrown.
refResolve :: UID -> ReferenceMap -> Reference
unitTable :: Lens' ChunkDB UnitMap
traceTable :: Lens' ChunkDB TraceMap
refbyTable :: Lens' ChunkDB RefbyMap
citationTable :: Lens' ChunkDB CitationMap
dataDefnTable :: Lens' ChunkDB DatadefnMap
insmodelTable :: Lens' ChunkDB InsModelMap
gendefTable :: Lens' ChunkDB GendefMap
theoryModelTable :: Lens' ChunkDB TheoryModelMap
conceptinsTable :: Lens' ChunkDB ConceptInstanceMap
labelledcontentTable :: Lens' ChunkDB LabelledContentMap
refTable :: Lens' ChunkDB ReferenceMap
addCdb :: ChunkDB -> ChunkDB -> ChunkDB
defResolve' :: ChunkDB -> UID -> DomDefn

module Database.Drasil.Dump
type ChunkType = String
type DumpedChunkDB = Map ChunkType [UID]
umapDump :: HasUID a => UMap a -> [UID]
dumpChunkDB :: ChunkDB -> DumpedChunkDB


-- | Re-export database types and functions to simplify external use.
module Database.Drasil

-- | Our chunk databases. Must contain all maps needed in an example. In
--   turn, these maps must contain every chunk definition or concept used
--   in its respective example, else an error is thrown.
data ChunkDB
CDB :: SymbolMap -> TermMap -> ConceptMap -> UnitMap -> DatadefnMap -> InsModelMap -> GendefMap -> TheoryModelMap -> ConceptInstanceMap -> CitationMap -> LabelledContentMap -> ReferenceMap -> TraceMap -> RefbyMap -> ChunkDB
[symbolTable] :: ChunkDB -> SymbolMap
[termTable] :: ChunkDB -> TermMap
[conceptChunkTable] :: ChunkDB -> ConceptMap
[_unitTable] :: ChunkDB -> UnitMap
[_dataDefnTable] :: ChunkDB -> DatadefnMap
[_insmodelTable] :: ChunkDB -> InsModelMap
[_gendefTable] :: ChunkDB -> GendefMap
[_theoryModelTable] :: ChunkDB -> TheoryModelMap
[_conceptinsTable] :: ChunkDB -> ConceptInstanceMap
[_citationTable] :: ChunkDB -> CitationMap
[_labelledcontentTable] :: ChunkDB -> LabelledContentMap
[_refTable] :: ChunkDB -> ReferenceMap
[_traceTable] :: ChunkDB -> TraceMap
[_refbyTable] :: ChunkDB -> RefbyMap

-- | A reference map, used to hold a <a>UID</a> and where it is referenced
--   (<a>UID</a>s).
type RefbyMap = Map UID [UID]

-- | A traceability map, used to hold the relation between one <a>UID</a>
--   and a list of other <a>UID</a>s.
type TraceMap = Map UID [UID]

-- | The misnomers below (for the following Map types) are not actually a
--   bad thing. We want to ensure data can't be added to a map if it's not
--   coming from a chunk, and there's no point confusing what the map is
--   for. One is for symbols + their units, and the others are for what
--   they state.
type UMap a = Map UID (a, Int)
data TermAbbr
TermAbbr :: NP -> Maybe String -> TermAbbr
[longForm] :: TermAbbr -> NP
[shortForm] :: TermAbbr -> Maybe String
data DomDefn
DomDefn :: [UID] -> Sentence -> DomDefn
[domain] :: DomDefn -> [UID]
[definition] :: DomDefn -> Sentence

-- | Smart constructor for chunk databases. Takes in the following:
--   
--   <ul>
--   <li>[<a>Quantity</a>] (for <a>SymbolMap</a>),</li>
--   <li><a>NamedIdea</a>s (for <a>TermMap</a>),</li>
--   <li><a>Concept</a>s (for <a>ConceptMap</a>),</li>
--   <li>Units (something that <a>IsUnit</a> for <a>UnitMap</a>),</li>
--   <li><a>DataDefinition</a>s (for <a>DatadefnMap</a>),</li>
--   <li><a>InstanceModel</a>s (for <a>InsModelMap</a>),</li>
--   <li><a>GenDefn</a>s (for <a>GendefMap</a>),</li>
--   <li><a>TheoryModel</a>s (for <a>TheoryModelMap</a>),</li>
--   <li><a>ConceptInstance</a>s (for <a>ConceptInstanceMap</a>),</li>
--   <li><a>LabelledContent</a>s (for <a>LabelledContentMap</a>). Creates
--   an empty ChunkDB without basic data. cdb in MetaDatabase.Drasil should
--   be preferred over this function as it includes the basic data needed
--   for Drasil.</li>
--   </ul>
cdb' :: (Quantity q, MayHaveUnit q, Concept q, Concept c, IsUnit u) => [q] -> [IdeaDict] -> [c] -> [u] -> [DataDefinition] -> [InstanceModel] -> [GenDefn] -> [TheoryModel] -> [ConceptInstance] -> [LabelledContent] -> [Reference] -> [Citation] -> ChunkDB

-- | General smart constructor for making a <a>UMap</a> out of anything
--   that has a <a>UID</a>.
idMap :: HasUID a => String -> [a] -> Map UID (a, Int)

-- | Smart constructor for a <a>SymbolMap</a>.
symbolMap :: (Quantity c, MayHaveUnit c, Concept c) => [c] -> SymbolMap

-- | Smart constructor for a <a>TermMap</a>.
termMap :: Idea c => [c] -> TermMap

-- | Smart constructor for a <a>ConceptMap</a>.
conceptMap :: Concept c => [c] -> ConceptMap

-- | Smart constructor for a <a>UnitMap</a>.
unitMap :: IsUnit u => [u] -> UnitMap

-- | Smart constructor for a <a>TraceMap</a> given a traceability matrix.
traceMap :: [(UID, [UID])] -> TraceMap

-- | Translates a traceability map into a reference map.
generateRefbyMap :: TraceMap -> RefbyMap

-- | Gets an ordered list of <tt>a</tt> from any <tt>a</tt> that is of type
--   <a>UMap</a>.
asOrderedList :: UMap a -> [a]

-- | Gets the units of a <a>Quantity</a> as <a>UnitDefn</a>s.
collectUnits :: Quantity c => ChunkDB -> [c] -> [UnitDefn]

-- | Search for _any_ chunk that is an instance of <a>Idea</a> and process
--   its "term" and abbreviation.
termResolve :: (NP -> Maybe String -> c) -> ChunkDB -> UID -> c

-- | Find a chunks "term" and abbreviation, if it exists.
termResolve' :: ChunkDB -> UID -> TermAbbr

-- | Looks up a <a>UID</a> in all tables with concepts from the
--   <a>ChunkDB</a>. If nothing is found, an error is thrown.
defResolve :: ([UID] -> Sentence -> c) -> ChunkDB -> UID -> c
defResolve' :: ChunkDB -> UID -> DomDefn

-- | Looks up a <a>UID</a> in the symbol table from the <a>ChunkDB</a>. If
--   nothing is found, an error is thrown.
symbResolve :: ChunkDB -> UID -> DefinedQuantityDict

-- | Trace a <a>UID</a> to related <a>UID</a>s.
traceLookup :: UID -> TraceMap -> [UID]

-- | Trace a <a>UID</a> to referenced <a>UID</a>s.
refbyLookup :: UID -> RefbyMap -> [UID]

-- | Looks up a <a>UID</a> in the datadefinition table. If nothing is
--   found, an error is thrown.
datadefnLookup :: UID -> DatadefnMap -> DataDefinition

-- | Looks up a <a>UID</a> in the instance model table. If nothing is
--   found, an error is thrown.
insmodelLookup :: UID -> InsModelMap -> InstanceModel

-- | Looks up a <a>UID</a> in the general definition table. If nothing is
--   found, an error is thrown.
gendefLookup :: UID -> GendefMap -> GenDefn

-- | Looks up a <a>UID</a> in the theory model table. If nothing is found,
--   an error is thrown.
theoryModelLookup :: UID -> TheoryModelMap -> TheoryModel

-- | Looks up a <a>UID</a> in the concept instance table. If nothing is
--   found, an error is thrown.
conceptinsLookup :: UID -> ConceptInstanceMap -> ConceptInstance

-- | Looks up a <a>UID</a> in the reference table from the <a>ChunkDB</a>.
--   If nothing is found, an error is thrown.
refResolve :: UID -> ReferenceMap -> Reference
unitTable :: Lens' ChunkDB UnitMap
traceTable :: Lens' ChunkDB TraceMap
refbyTable :: Lens' ChunkDB RefbyMap
citationTable :: Lens' ChunkDB CitationMap
dataDefnTable :: Lens' ChunkDB DatadefnMap
insmodelTable :: Lens' ChunkDB InsModelMap
gendefTable :: Lens' ChunkDB GendefMap
theoryModelTable :: Lens' ChunkDB TheoryModelMap
conceptinsTable :: Lens' ChunkDB ConceptInstanceMap
labelledcontentTable :: Lens' ChunkDB LabelledContentMap
refTable :: Lens' ChunkDB ReferenceMap
dumpChunkDB :: ChunkDB -> DumpedChunkDB
type DumpedChunkDB = Map ChunkType [UID]
addCdb :: ChunkDB -> ChunkDB -> ChunkDB
