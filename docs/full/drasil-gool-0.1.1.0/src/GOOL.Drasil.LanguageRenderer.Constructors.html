<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- | Generic constructors and smart constructors to be used in renderers</span><span>
</span><span id="line-2"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">GOOL.Drasil.LanguageRenderer.Constructors</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-3"></span><span>  </span><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#mkStmt"><span class="hs-identifier">mkStmt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#mkStmtNoEnd"><span class="hs-identifier">mkStmtNoEnd</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#mkStateVal"><span class="hs-identifier">mkStateVal</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#mkVal"><span class="hs-identifier">mkVal</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#mkStateVar"><span class="hs-identifier">mkStateVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#mkVar"><span class="hs-identifier">mkVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#mkStaticVar"><span class="hs-identifier">mkStaticVar</span></a></span><span class="hs-special">,</span><span> </span><span>
</span><span id="line-4"></span><span>  </span><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#VSOp"><span class="hs-identifier">VSOp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#mkOp"><span class="hs-identifier">mkOp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#unOpPrec"><span class="hs-identifier">unOpPrec</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#compEqualPrec"><span class="hs-identifier">compEqualPrec</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#compPrec"><span class="hs-identifier">compPrec</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#addPrec"><span class="hs-identifier">addPrec</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#multPrec"><span class="hs-identifier">multPrec</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#powerPrec"><span class="hs-identifier">powerPrec</span></a></span><span class="hs-special">,</span><span> </span><span>
</span><span id="line-5"></span><span>  </span><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#andPrec"><span class="hs-identifier">andPrec</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#orPrec"><span class="hs-identifier">orPrec</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#unExpr"><span class="hs-identifier">unExpr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#unExpr%27"><span class="hs-identifier">unExpr'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#unExprNumDbl"><span class="hs-identifier">unExprNumDbl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#typeUnExpr"><span class="hs-identifier">typeUnExpr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#binExpr"><span class="hs-identifier">binExpr</span></a></span><span class="hs-special">,</span><span> </span><span>
</span><span id="line-6"></span><span>  </span><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#binExpr%27"><span class="hs-identifier">binExpr'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#binExprNumDbl%27"><span class="hs-identifier">binExprNumDbl'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#typeBinExpr"><span class="hs-identifier">typeBinExpr</span></a></span><span>
</span><span id="line-7"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html"><span class="hs-identifier">GOOL.Drasil.ClassInterface</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#VSType"><span class="hs-identifier">VSType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#MSStatement"><span class="hs-identifier">MSStatement</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#SVariable"><span class="hs-identifier">SVariable</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#SValue"><span class="hs-identifier">SValue</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#TypeSym"><span class="hs-identifier">TypeSym</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span>
</span><span id="line-10"></span><span>  </span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#TypeElim"><span class="hs-identifier">TypeElim</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#ValueSym"><span class="hs-identifier">ValueSym</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html"><span class="hs-identifier">GOOL.Drasil.RendererClasses</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html#RenderSym"><span class="hs-identifier">RenderSym</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html#VSUnOp"><span class="hs-identifier">VSUnOp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html#VSBinOp"><span class="hs-identifier">VSBinOp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html#UnaryOpSym"><span class="hs-identifier">UnaryOpSym</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>  </span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html#BinaryOpSym"><span class="hs-identifier">BinaryOpSym</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html#OpElim"><span class="hs-identifier">OpElim</span></a></span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html#uOpPrec"><span class="hs-identifier">uOpPrec</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html#bOpPrec"><span class="hs-identifier">bOpPrec</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html#RenderVariable"><span class="hs-identifier">RenderVariable</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span>
</span><span id="line-13"></span><span>  </span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html#RenderValue"><span class="hs-identifier">RenderValue</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html#ValueElim"><span class="hs-identifier">ValueElim</span></a></span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html#valuePrec"><span class="hs-identifier">valuePrec</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html#RenderStatement"><span class="hs-identifier">RenderStatement</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html"><span class="hs-identifier">GOOL.Drasil.RendererClasses</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">RC</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html#uOp"><span class="hs-identifier">uOp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html#bOp"><span class="hs-identifier">bOp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html#value"><span class="hs-identifier">value</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.html"><span class="hs-identifier">GOOL.Drasil.LanguageRenderer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.html#unOpDocD"><span class="hs-identifier">unOpDocD</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.html#unOpDocD%27"><span class="hs-identifier">unOpDocD'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.html#binOpDocD"><span class="hs-identifier">binOpDocD</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.html#binOpDocD%27"><span class="hs-identifier">binOpDocD'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GOOL.Drasil.AST.html"><span class="hs-identifier">GOOL.Drasil.AST</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.AST.html#Terminator"><span class="hs-identifier">Terminator</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GOOL.Drasil.AST.html#Binding"><span class="hs-identifier">Binding</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GOOL.Drasil.AST.html#OpData"><span class="hs-identifier">OpData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GOOL.Drasil.AST.html#od"><span class="hs-identifier">od</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GOOL.Drasil.CodeType.html"><span class="hs-identifier">GOOL.Drasil.CodeType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.CodeType.html#CodeType"><span class="hs-identifier">CodeType</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GOOL.Drasil.Helpers.html"><span class="hs-identifier">GOOL.Drasil.Helpers</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.Helpers.html#toCode"><span class="hs-identifier">toCode</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GOOL.Drasil.Helpers.html#toState"><span class="hs-identifier">toState</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GOOL.Drasil.Helpers.html#on2StateValues"><span class="hs-identifier">on2StateValues</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GOOL.Drasil.State.html"><span class="hs-identifier">GOOL.Drasil.State</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.State.html#VS"><span class="hs-identifier">VS</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.PrettyPrint.HughesPJ</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Doc</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">parens</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">text</span></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Composition</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(.:)</span></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">join</span></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="hs-comment">-- Statements</span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-comment">-- | Constructs a statement terminated by a semi-colon</span><span>
</span><span id="line-28"></span><span id="local-6989586621679390965"><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#mkStmt"><span class="hs-identifier hs-type">mkStmt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html#RenderSym"><span class="hs-identifier hs-type">RenderSym</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390965"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#MSStatement"><span class="hs-identifier hs-type">MSStatement</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390965"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-29"></span><span id="mkStmt"><span class="annot"><span class="annottext">mkStmt :: Doc -&gt; MSStatement r
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#mkStmt"><span class="hs-identifier hs-var hs-var">mkStmt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; Terminator -&gt; MSStatement r)
-&gt; Terminator -&gt; Doc -&gt; MSStatement r
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Terminator -&gt; MSStatement r
forall (r :: * -&gt; *).
RenderStatement r =&gt;
Doc -&gt; Terminator -&gt; MSStatement r
</span><a href="GOOL.Drasil.RendererClasses.html#stmtFromData"><span class="hs-identifier hs-var">stmtFromData</span></a></span><span> </span><span class="annot"><span class="annottext">Terminator
</span><a href="GOOL.Drasil.AST.html#Semi"><span class="hs-identifier hs-var">Semi</span></a></span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-comment">-- | Constructs a statement without a termination character</span><span>
</span><span id="line-32"></span><span id="local-6989586621679390961"><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#mkStmtNoEnd"><span class="hs-identifier hs-type">mkStmtNoEnd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html#RenderSym"><span class="hs-identifier hs-type">RenderSym</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390961"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#MSStatement"><span class="hs-identifier hs-type">MSStatement</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390961"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-33"></span><span id="mkStmtNoEnd"><span class="annot"><span class="annottext">mkStmtNoEnd :: Doc -&gt; MSStatement r
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#mkStmtNoEnd"><span class="hs-identifier hs-var hs-var">mkStmtNoEnd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; Terminator -&gt; MSStatement r)
-&gt; Terminator -&gt; Doc -&gt; MSStatement r
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Terminator -&gt; MSStatement r
forall (r :: * -&gt; *).
RenderStatement r =&gt;
Doc -&gt; Terminator -&gt; MSStatement r
</span><a href="GOOL.Drasil.RendererClasses.html#stmtFromData"><span class="hs-identifier hs-var">stmtFromData</span></a></span><span> </span><span class="annot"><span class="annottext">Terminator
</span><a href="GOOL.Drasil.AST.html#Empty"><span class="hs-identifier hs-var">Empty</span></a></span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span class="hs-comment">-- Values --</span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span class="hs-comment">-- | Constructs a value in a stateful context</span><span>
</span><span id="line-38"></span><span id="local-6989586621679390959"><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#mkStateVal"><span class="hs-identifier hs-type">mkStateVal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html#RenderSym"><span class="hs-identifier hs-type">RenderSym</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390959"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#VSType"><span class="hs-identifier hs-type">VSType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390959"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#SValue"><span class="hs-identifier hs-type">SValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390959"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-39"></span><span id="mkStateVal"><span class="annot"><span class="annottext">mkStateVal :: VSType r -&gt; Doc -&gt; SValue r
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#mkStateVal"><span class="hs-identifier hs-var hs-var">mkStateVal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Int -&gt; VSType r -&gt; Doc -&gt; SValue r
forall (r :: * -&gt; *).
RenderValue r =&gt;
Maybe Int -&gt; VSType r -&gt; Doc -&gt; SValue r
</span><a href="GOOL.Drasil.RendererClasses.html#valFromData"><span class="hs-identifier hs-var">valFromData</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-comment">-- | Constructs a value in a non-stateful context</span><span>
</span><span id="line-42"></span><span id="local-6989586621679390957"><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#mkVal"><span class="hs-identifier hs-type">mkVal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html#RenderSym"><span class="hs-identifier hs-type">RenderSym</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390957"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679390957"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390957"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#SValue"><span class="hs-identifier hs-type">SValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390957"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-43"></span><span id="mkVal"><span class="annot"><span class="annottext">mkVal :: r (Type r) -&gt; Doc -&gt; SValue r
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#mkVal"><span class="hs-identifier hs-var hs-var">mkVal</span></a></span></span><span> </span><span id="local-6989586621679390956"><span class="annot"><span class="annottext">t :: r (Type r)
</span><a href="#local-6989586621679390956"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Int -&gt; VSType r -&gt; Doc -&gt; SValue r
forall (r :: * -&gt; *).
RenderValue r =&gt;
Maybe Int -&gt; VSType r -&gt; Doc -&gt; SValue r
</span><a href="GOOL.Drasil.RendererClasses.html#valFromData"><span class="hs-identifier hs-var">valFromData</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r (Type r) -&gt; VSType r
forall a s. a -&gt; State s a
</span><a href="GOOL.Drasil.Helpers.html#toState"><span class="hs-identifier hs-var">toState</span></a></span><span> </span><span class="annot"><span class="annottext">r (Type r)
</span><a href="#local-6989586621679390956"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-comment">-- Variables --</span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span class="hs-comment">-- | Constructs a dynamic variable in a stateful context</span><span>
</span><span id="line-48"></span><span id="local-6989586621679390955"><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#mkStateVar"><span class="hs-identifier hs-type">mkStateVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html#RenderSym"><span class="hs-identifier hs-type">RenderSym</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390955"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#VSType"><span class="hs-identifier hs-type">VSType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390955"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#SVariable"><span class="hs-identifier hs-type">SVariable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390955"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-49"></span><span id="mkStateVar"><span class="annot"><span class="annottext">mkStateVar :: String -&gt; VSType r -&gt; Doc -&gt; SVariable r
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#mkStateVar"><span class="hs-identifier hs-var hs-var">mkStateVar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Binding -&gt; String -&gt; VSType r -&gt; Doc -&gt; SVariable r
forall (r :: * -&gt; *).
RenderVariable r =&gt;
Binding -&gt; String -&gt; VSType r -&gt; Doc -&gt; SVariable r
</span><a href="GOOL.Drasil.RendererClasses.html#varFromData"><span class="hs-identifier hs-var">varFromData</span></a></span><span> </span><span class="annot"><span class="annottext">Binding
</span><a href="GOOL.Drasil.AST.html#Dynamic"><span class="hs-identifier hs-var">Dynamic</span></a></span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-comment">-- | Constructs a dynamic variable in a non-stateful context</span><span>
</span><span id="line-52"></span><span id="local-6989586621679390952"><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#mkVar"><span class="hs-identifier hs-type">mkVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html#RenderSym"><span class="hs-identifier hs-type">RenderSym</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390952"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679390952"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390952"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#SVariable"><span class="hs-identifier hs-type">SVariable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390952"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-53"></span><span id="mkVar"><span class="annot"><span class="annottext">mkVar :: String -&gt; r (Type r) -&gt; Doc -&gt; SVariable r
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#mkVar"><span class="hs-identifier hs-var hs-var">mkVar</span></a></span></span><span> </span><span id="local-6989586621679390951"><span class="annot"><span class="annottext">n :: String
</span><a href="#local-6989586621679390951"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679390950"><span class="annot"><span class="annottext">t :: r (Type r)
</span><a href="#local-6989586621679390950"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Binding -&gt; String -&gt; VSType r -&gt; Doc -&gt; SVariable r
forall (r :: * -&gt; *).
RenderVariable r =&gt;
Binding -&gt; String -&gt; VSType r -&gt; Doc -&gt; SVariable r
</span><a href="GOOL.Drasil.RendererClasses.html#varFromData"><span class="hs-identifier hs-var">varFromData</span></a></span><span> </span><span class="annot"><span class="annottext">Binding
</span><a href="GOOL.Drasil.AST.html#Dynamic"><span class="hs-identifier hs-var">Dynamic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679390951"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r (Type r) -&gt; VSType r
forall a s. a -&gt; State s a
</span><a href="GOOL.Drasil.Helpers.html#toState"><span class="hs-identifier hs-var">toState</span></a></span><span> </span><span class="annot"><span class="annottext">r (Type r)
</span><a href="#local-6989586621679390950"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-comment">-- | Constructs a static variable in a stateful context</span><span>
</span><span id="line-56"></span><span id="local-6989586621679390949"><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#mkStaticVar"><span class="hs-identifier hs-type">mkStaticVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html#RenderSym"><span class="hs-identifier hs-type">RenderSym</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390949"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#VSType"><span class="hs-identifier hs-type">VSType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390949"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#SVariable"><span class="hs-identifier hs-type">SVariable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390949"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-57"></span><span id="mkStaticVar"><span class="annot"><span class="annottext">mkStaticVar :: String -&gt; VSType r -&gt; Doc -&gt; SVariable r
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#mkStaticVar"><span class="hs-identifier hs-var hs-var">mkStaticVar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Binding -&gt; String -&gt; VSType r -&gt; Doc -&gt; SVariable r
forall (r :: * -&gt; *).
RenderVariable r =&gt;
Binding -&gt; String -&gt; VSType r -&gt; Doc -&gt; SVariable r
</span><a href="GOOL.Drasil.RendererClasses.html#varFromData"><span class="hs-identifier hs-var">varFromData</span></a></span><span> </span><span class="annot"><span class="annottext">Binding
</span><a href="GOOL.Drasil.AST.html#Static"><span class="hs-identifier hs-var">Static</span></a></span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="hs-comment">-- Operators --</span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-keyword">type</span><span> </span><span id="VSOp"><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#VSOp"><span class="hs-identifier hs-var">VSOp</span></a></span></span><span> </span><span id="local-6989586621679390947"><span class="annot"><a href="#local-6989586621679390947"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GOOL.Drasil.State.html#VS"><span class="hs-identifier hs-type">VS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679390947"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="GOOL.Drasil.AST.html#OpData"><span class="hs-identifier hs-type">OpData</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-comment">-- | Construct an operator with given precedence and rendering</span><span>
</span><span id="line-64"></span><span id="local-6989586621679391086"><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#mkOp"><span class="hs-identifier hs-type">mkOp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679391086"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#VSOp"><span class="hs-identifier hs-type">VSOp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391086"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-65"></span><span id="mkOp"><span class="annot"><span class="annottext">mkOp :: Int -&gt; Doc -&gt; VSOp r
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#mkOp"><span class="hs-identifier hs-var hs-var">mkOp</span></a></span></span><span> </span><span id="local-6989586621679390946"><span class="annot"><span class="annottext">p :: Int
</span><a href="#local-6989586621679390946"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679390945"><span class="annot"><span class="annottext">d :: Doc
</span><a href="#local-6989586621679390945"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r OpData -&gt; VSOp r
forall a s. a -&gt; State s a
</span><a href="GOOL.Drasil.Helpers.html#toState"><span class="hs-identifier hs-var">toState</span></a></span><span> </span><span class="annot"><span class="annottext">(r OpData -&gt; VSOp r) -&gt; r OpData -&gt; VSOp r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">OpData -&gt; r OpData
forall (r :: * -&gt; *) a. Monad r =&gt; a -&gt; r a
</span><a href="GOOL.Drasil.Helpers.html#toCode"><span class="hs-identifier hs-var">toCode</span></a></span><span> </span><span class="annot"><span class="annottext">(OpData -&gt; r OpData) -&gt; OpData -&gt; r OpData
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Doc -&gt; OpData
</span><a href="GOOL.Drasil.AST.html#od"><span class="hs-identifier hs-var">od</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679390946"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679390945"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span class="hs-comment">-- | Construct an operator with typical unary-operator precedence</span><span>
</span><span id="line-68"></span><span id="local-6989586621679390944"><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#unOpPrec"><span class="hs-identifier hs-type">unOpPrec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679390944"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#VSOp"><span class="hs-identifier hs-type">VSOp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390944"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-69"></span><span id="unOpPrec"><span class="annot"><span class="annottext">unOpPrec :: String -&gt; VSOp r
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#unOpPrec"><span class="hs-identifier hs-var hs-var">unOpPrec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Doc -&gt; VSOp r
forall (r :: * -&gt; *). Monad r =&gt; Int -&gt; Doc -&gt; VSOp r
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#mkOp"><span class="hs-identifier hs-var">mkOp</span></a></span><span> </span><span class="annot"><span class="hs-number">9</span></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; VSOp r) -&gt; (String -&gt; Doc) -&gt; String -&gt; VSOp r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-comment">-- | Construct an operator with equality-comparison-level precedence</span><span>
</span><span id="line-72"></span><span id="local-6989586621679390942"><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#compEqualPrec"><span class="hs-identifier hs-type">compEqualPrec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679390942"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#VSOp"><span class="hs-identifier hs-type">VSOp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390942"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-73"></span><span id="compEqualPrec"><span class="annot"><span class="annottext">compEqualPrec :: String -&gt; VSOp r
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#compEqualPrec"><span class="hs-identifier hs-var hs-var">compEqualPrec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Doc -&gt; VSOp r
forall (r :: * -&gt; *). Monad r =&gt; Int -&gt; Doc -&gt; VSOp r
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#mkOp"><span class="hs-identifier hs-var">mkOp</span></a></span><span> </span><span class="annot"><span class="hs-number">4</span></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; VSOp r) -&gt; (String -&gt; Doc) -&gt; String -&gt; VSOp r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-comment">-- | Construct an operator with comparison-level precedence</span><span>
</span><span id="line-76"></span><span id="local-6989586621679390941"><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#compPrec"><span class="hs-identifier hs-type">compPrec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679390941"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#VSOp"><span class="hs-identifier hs-type">VSOp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390941"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-77"></span><span id="compPrec"><span class="annot"><span class="annottext">compPrec :: String -&gt; VSOp r
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#compPrec"><span class="hs-identifier hs-var hs-var">compPrec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Doc -&gt; VSOp r
forall (r :: * -&gt; *). Monad r =&gt; Int -&gt; Doc -&gt; VSOp r
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#mkOp"><span class="hs-identifier hs-var">mkOp</span></a></span><span> </span><span class="annot"><span class="hs-number">5</span></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; VSOp r) -&gt; (String -&gt; Doc) -&gt; String -&gt; VSOp r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span class="hs-comment">-- | Construct an operator with addition-level precedence</span><span>
</span><span id="line-80"></span><span id="local-6989586621679390940"><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#addPrec"><span class="hs-identifier hs-type">addPrec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679390940"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#VSOp"><span class="hs-identifier hs-type">VSOp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390940"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-81"></span><span id="addPrec"><span class="annot"><span class="annottext">addPrec :: String -&gt; VSOp r
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#addPrec"><span class="hs-identifier hs-var hs-var">addPrec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Doc -&gt; VSOp r
forall (r :: * -&gt; *). Monad r =&gt; Int -&gt; Doc -&gt; VSOp r
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#mkOp"><span class="hs-identifier hs-var">mkOp</span></a></span><span> </span><span class="annot"><span class="hs-number">6</span></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; VSOp r) -&gt; (String -&gt; Doc) -&gt; String -&gt; VSOp r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="hs-comment">-- | Construct an operator with multiplication-level precedence</span><span>
</span><span id="line-84"></span><span id="local-6989586621679390939"><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#multPrec"><span class="hs-identifier hs-type">multPrec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679390939"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#VSOp"><span class="hs-identifier hs-type">VSOp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390939"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-85"></span><span id="multPrec"><span class="annot"><span class="annottext">multPrec :: String -&gt; VSOp r
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#multPrec"><span class="hs-identifier hs-var hs-var">multPrec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Doc -&gt; VSOp r
forall (r :: * -&gt; *). Monad r =&gt; Int -&gt; Doc -&gt; VSOp r
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#mkOp"><span class="hs-identifier hs-var">mkOp</span></a></span><span> </span><span class="annot"><span class="hs-number">7</span></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; VSOp r) -&gt; (String -&gt; Doc) -&gt; String -&gt; VSOp r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="hs-comment">-- | Construct an operator with exponentiation-level precedence</span><span>
</span><span id="line-88"></span><span id="local-6989586621679390938"><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#powerPrec"><span class="hs-identifier hs-type">powerPrec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679390938"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#VSOp"><span class="hs-identifier hs-type">VSOp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390938"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-89"></span><span id="powerPrec"><span class="annot"><span class="annottext">powerPrec :: String -&gt; VSOp r
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#powerPrec"><span class="hs-identifier hs-var hs-var">powerPrec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Doc -&gt; VSOp r
forall (r :: * -&gt; *). Monad r =&gt; Int -&gt; Doc -&gt; VSOp r
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#mkOp"><span class="hs-identifier hs-var">mkOp</span></a></span><span> </span><span class="annot"><span class="hs-number">8</span></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; VSOp r) -&gt; (String -&gt; Doc) -&gt; String -&gt; VSOp r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-comment">-- | Construct an operator with conjunction-level precedence</span><span>
</span><span id="line-92"></span><span id="local-6989586621679390937"><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#andPrec"><span class="hs-identifier hs-type">andPrec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679390937"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#VSOp"><span class="hs-identifier hs-type">VSOp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390937"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span>
</span><span id="line-93"></span><span id="andPrec"><span class="annot"><span class="annottext">andPrec :: String -&gt; VSOp r
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#andPrec"><span class="hs-identifier hs-var hs-var">andPrec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Doc -&gt; VSOp r
forall (r :: * -&gt; *). Monad r =&gt; Int -&gt; Doc -&gt; VSOp r
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#mkOp"><span class="hs-identifier hs-var">mkOp</span></a></span><span> </span><span class="annot"><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; VSOp r) -&gt; (String -&gt; Doc) -&gt; String -&gt; VSOp r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span class="hs-comment">-- | Construct an operator with disjunction-level precedence</span><span>
</span><span id="line-96"></span><span id="local-6989586621679390936"><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#orPrec"><span class="hs-identifier hs-type">orPrec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679390936"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#VSOp"><span class="hs-identifier hs-type">VSOp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390936"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-97"></span><span id="orPrec"><span class="annot"><span class="annottext">orPrec :: String -&gt; VSOp r
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#orPrec"><span class="hs-identifier hs-var hs-var">orPrec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Doc -&gt; VSOp r
forall (r :: * -&gt; *). Monad r =&gt; Int -&gt; Doc -&gt; VSOp r
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#mkOp"><span class="hs-identifier hs-var">mkOp</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; VSOp r) -&gt; (String -&gt; Doc) -&gt; String -&gt; VSOp r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="hs-comment">-- Expressions --</span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span class="hs-comment">-- | Constructs a unary expression like ln(v), for some operator ln and value v</span><span>
</span><span id="line-102"></span><span id="local-6989586621679390935"><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#unExpr"><span class="hs-identifier hs-type">unExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html#RenderSym"><span class="hs-identifier hs-type">RenderSym</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390935"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html#VSUnOp"><span class="hs-identifier hs-type">VSUnOp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390935"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#SValue"><span class="hs-identifier hs-type">SValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390935"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#SValue"><span class="hs-identifier hs-type">SValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390935"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-103"></span><span id="unExpr"><span class="annot"><span class="annottext">unExpr :: VSUnOp r -&gt; SValue r -&gt; SValue r
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#unExpr"><span class="hs-identifier hs-var hs-var">unExpr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (SValue r) -&gt; SValue r
forall (m :: * -&gt; *) a. Monad m =&gt; m (m a) -&gt; m a
</span><span class="hs-identifier hs-var">join</span></span><span> </span><span class="annot"><span class="annottext">(StateT ValueState Identity (SValue r) -&gt; SValue r)
-&gt; (VSUnOp r -&gt; SValue r -&gt; StateT ValueState Identity (SValue r))
-&gt; VSUnOp r
-&gt; SValue r
-&gt; SValue r
forall c d a b. (c -&gt; d) -&gt; (a -&gt; b -&gt; c) -&gt; a -&gt; b -&gt; d
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">(r (UnaryOp r) -&gt; r (Value r) -&gt; SValue r)
-&gt; VSUnOp r -&gt; SValue r -&gt; StateT ValueState Identity (SValue r)
forall a b c s.
(a -&gt; b -&gt; c) -&gt; State s a -&gt; State s b -&gt; State s c
</span><a href="GOOL.Drasil.Helpers.html#on2StateValues"><span class="hs-identifier hs-var">on2StateValues</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Doc -&gt; Doc -&gt; Doc) -&gt; r (UnaryOp r) -&gt; r (Value r) -&gt; SValue r
forall (r :: * -&gt; *).
RenderSym r =&gt;
(Doc -&gt; Doc -&gt; Doc) -&gt; r (UnaryOp r) -&gt; r (Value r) -&gt; SValue r
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#mkUnExpr"><span class="hs-identifier hs-var">mkUnExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="GOOL.Drasil.LanguageRenderer.html#unOpDocD"><span class="hs-identifier hs-var">unOpDocD</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span class="hs-comment">-- | Constructs a unary expression like -v, for some operator - and value v</span><span>
</span><span id="line-106"></span><span id="local-6989586621679390933"><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#unExpr%27"><span class="hs-identifier hs-type">unExpr'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html#RenderSym"><span class="hs-identifier hs-type">RenderSym</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390933"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html#VSUnOp"><span class="hs-identifier hs-type">VSUnOp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390933"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#SValue"><span class="hs-identifier hs-type">SValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390933"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#SValue"><span class="hs-identifier hs-type">SValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390933"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-107"></span><span id="unExpr%27"><span class="annot"><span class="annottext">unExpr' :: VSUnOp r -&gt; SValue r -&gt; SValue r
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#unExpr%27"><span class="hs-identifier hs-var hs-var">unExpr'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateT ValueState Identity (SValue r) -&gt; SValue r
forall (m :: * -&gt; *) a. Monad m =&gt; m (m a) -&gt; m a
</span><span class="hs-identifier hs-var">join</span></span><span> </span><span class="annot"><span class="annottext">(StateT ValueState Identity (SValue r) -&gt; SValue r)
-&gt; (VSUnOp r -&gt; SValue r -&gt; StateT ValueState Identity (SValue r))
-&gt; VSUnOp r
-&gt; SValue r
-&gt; SValue r
forall c d a b. (c -&gt; d) -&gt; (a -&gt; b -&gt; c) -&gt; a -&gt; b -&gt; d
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">(r (UnaryOp r) -&gt; r (Value r) -&gt; SValue r)
-&gt; VSUnOp r -&gt; SValue r -&gt; StateT ValueState Identity (SValue r)
forall a b c s.
(a -&gt; b -&gt; c) -&gt; State s a -&gt; State s b -&gt; State s c
</span><a href="GOOL.Drasil.Helpers.html#on2StateValues"><span class="hs-identifier hs-var">on2StateValues</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Doc -&gt; Doc -&gt; Doc) -&gt; r (UnaryOp r) -&gt; r (Value r) -&gt; SValue r
forall (r :: * -&gt; *).
RenderSym r =&gt;
(Doc -&gt; Doc -&gt; Doc) -&gt; r (UnaryOp r) -&gt; r (Value r) -&gt; SValue r
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#mkUnExpr"><span class="hs-identifier hs-var">mkUnExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="GOOL.Drasil.LanguageRenderer.html#unOpDocD%27"><span class="hs-identifier hs-var">unOpDocD'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span id="local-6989586621679391058"><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#mkUnExpr"><span class="hs-identifier hs-type">mkUnExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html#RenderSym"><span class="hs-identifier hs-type">RenderSym</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391058"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679391058"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html#UnaryOp"><span class="hs-identifier hs-type">UnaryOp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391058"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span>
</span><span id="line-110"></span><span>  </span><span class="annot"><a href="#local-6989586621679391058"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391058"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#SValue"><span class="hs-identifier hs-type">SValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391058"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-111"></span><span id="mkUnExpr"><span class="annot"><span class="annottext">mkUnExpr :: (Doc -&gt; Doc -&gt; Doc) -&gt; r (UnaryOp r) -&gt; r (Value r) -&gt; SValue r
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#mkUnExpr"><span class="hs-identifier hs-var hs-var">mkUnExpr</span></a></span></span><span> </span><span id="local-6989586621679390932"><span class="annot"><span class="annottext">d :: Doc -&gt; Doc -&gt; Doc
</span><a href="#local-6989586621679390932"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679390931"><span class="annot"><span class="annottext">u :: r (UnaryOp r)
</span><a href="#local-6989586621679390931"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621679390930"><span class="annot"><span class="annottext">v :: r (Value r)
</span><a href="#local-6989586621679390930"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; r (Type r) -&gt; Doc -&gt; SValue r
forall (r :: * -&gt; *).
RenderSym r =&gt;
Int -&gt; r (Type r) -&gt; Doc -&gt; SValue r
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#mkExpr"><span class="hs-identifier hs-var">mkExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r (UnaryOp r) -&gt; Int
forall (r :: * -&gt; *). OpElim r =&gt; r (UnaryOp r) -&gt; Int
</span><a href="GOOL.Drasil.RendererClasses.html#uOpPrec"><span class="hs-identifier hs-var">uOpPrec</span></a></span><span> </span><span class="annot"><span class="annottext">r (UnaryOp r)
</span><a href="#local-6989586621679390931"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r (Value r) -&gt; r (Type r)
forall (r :: * -&gt; *). ValueSym r =&gt; r (Value r) -&gt; r (Type r)
</span><a href="GOOL.Drasil.ClassInterface.html#valueType"><span class="hs-identifier hs-var">valueType</span></a></span><span> </span><span class="annot"><span class="annottext">r (Value r)
</span><a href="#local-6989586621679390930"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="#local-6989586621679390932"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r (UnaryOp r) -&gt; Doc
forall (r :: * -&gt; *). OpElim r =&gt; r (UnaryOp r) -&gt; Doc
</span><a href="GOOL.Drasil.RendererClasses.html#uOp"><span class="hs-identifier hs-var">RC.uOp</span></a></span><span> </span><span class="annot"><span class="annottext">r (UnaryOp r)
</span><a href="#local-6989586621679390931"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r (Value r) -&gt; Doc
forall (r :: * -&gt; *). ValueElim r =&gt; r (Value r) -&gt; Doc
</span><a href="GOOL.Drasil.RendererClasses.html#value"><span class="hs-identifier hs-var">RC.value</span></a></span><span> </span><span class="annot"><span class="annottext">r (Value r)
</span><a href="#local-6989586621679390930"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="hs-comment">-- | To be used in languages where the unary operator returns a double. If the </span><span>
</span><span id="line-114"></span><span class="hs-comment">-- value passed to the operator is a float, this function preserves that type </span><span>
</span><span id="line-115"></span><span class="hs-comment">-- by casting the result to a float.</span><span>
</span><span id="line-116"></span><span id="local-6989586621679390927"><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#unExprNumDbl"><span class="hs-identifier hs-type">unExprNumDbl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html#RenderSym"><span class="hs-identifier hs-type">RenderSym</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390927"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html#VSUnOp"><span class="hs-identifier hs-type">VSUnOp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390927"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#SValue"><span class="hs-identifier hs-type">SValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390927"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#SValue"><span class="hs-identifier hs-type">SValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390927"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-117"></span><span id="unExprNumDbl"><span class="annot"><span class="annottext">unExprNumDbl :: VSUnOp r -&gt; SValue r -&gt; SValue r
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#unExprNumDbl"><span class="hs-identifier hs-var hs-var">unExprNumDbl</span></a></span></span><span> </span><span id="local-6989586621679390926"><span class="annot"><span class="annottext">u' :: VSUnOp r
</span><a href="#local-6989586621679390926"><span class="hs-identifier hs-var">u'</span></a></span></span><span> </span><span id="local-6989586621679390925"><span class="annot"><span class="annottext">v' :: SValue r
</span><a href="#local-6989586621679390925"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-118"></span><span>  </span><span id="local-6989586621679390924"><span class="annot"><span class="annottext">r (UnaryOp r)
</span><a href="#local-6989586621679390924"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VSUnOp r
</span><a href="#local-6989586621679390926"><span class="hs-identifier hs-var">u'</span></a></span><span>
</span><span id="line-119"></span><span>  </span><span id="local-6989586621679390923"><span class="annot"><span class="annottext">r (Value r)
</span><a href="#local-6989586621679390923"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SValue r
</span><a href="#local-6989586621679390925"><span class="hs-identifier hs-var">v'</span></a></span><span>
</span><span id="line-120"></span><span>  </span><span id="local-6989586621679390922"><span class="annot"><span class="annottext">r (Value r)
</span><a href="#local-6989586621679390922"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; Doc -&gt; Doc) -&gt; r (UnaryOp r) -&gt; r (Value r) -&gt; SValue r
forall (r :: * -&gt; *).
RenderSym r =&gt;
(Doc -&gt; Doc -&gt; Doc) -&gt; r (UnaryOp r) -&gt; r (Value r) -&gt; SValue r
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#mkUnExpr"><span class="hs-identifier hs-var">mkUnExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="GOOL.Drasil.LanguageRenderer.html#unOpDocD"><span class="hs-identifier hs-var">unOpDocD</span></a></span><span> </span><span class="annot"><span class="annottext">r (UnaryOp r)
</span><a href="#local-6989586621679390924"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">r (Value r)
</span><a href="#local-6989586621679390923"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-121"></span><span>  </span><span class="annot"><span class="annottext">r (Type r) -&gt; r (Value r) -&gt; SValue r
forall (r :: * -&gt; *).
RenderSym r =&gt;
r (Type r) -&gt; r (Value r) -&gt; SValue r
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#unExprCastFloat"><span class="hs-identifier hs-var">unExprCastFloat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r (Value r) -&gt; r (Type r)
forall (r :: * -&gt; *). ValueSym r =&gt; r (Value r) -&gt; r (Type r)
</span><a href="GOOL.Drasil.ClassInterface.html#valueType"><span class="hs-identifier hs-var">valueType</span></a></span><span> </span><span class="annot"><span class="annottext">r (Value r)
</span><a href="#local-6989586621679390923"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">r (Value r)
</span><a href="#local-6989586621679390922"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span class="hs-comment">-- Only used by unExprNumDbl</span><span>
</span><span id="line-124"></span><span id="local-6989586621679391046"><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#unExprCastFloat"><span class="hs-identifier hs-type">unExprCastFloat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html#RenderSym"><span class="hs-identifier hs-type">RenderSym</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391046"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679391046"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391046"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679391046"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391046"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#SValue"><span class="hs-identifier hs-type">SValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391046"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-125"></span><span id="unExprCastFloat"><span class="annot"><span class="annottext">unExprCastFloat :: r (Type r) -&gt; r (Value r) -&gt; SValue r
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#unExprCastFloat"><span class="hs-identifier hs-var hs-var">unExprCastFloat</span></a></span></span><span> </span><span id="local-6989586621679390920"><span class="annot"><span class="annottext">t :: r (Type r)
</span><a href="#local-6989586621679390920"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CodeType -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
(RenderValue r, TypeSym r) =&gt;
CodeType -&gt; VS (r (Value r)) -&gt; VS (r (Value r))
</span><a href="#local-6989586621679390919"><span class="hs-identifier hs-var">castType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r (Type r) -&gt; CodeType
forall (r :: * -&gt; *). TypeElim r =&gt; r (Type r) -&gt; CodeType
</span><a href="GOOL.Drasil.ClassInterface.html#getType"><span class="hs-identifier hs-var">getType</span></a></span><span> </span><span class="annot"><span class="annottext">r (Type r)
</span><a href="#local-6989586621679390920"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r)
-&gt; (r (Value r) -&gt; SValue r) -&gt; r (Value r) -&gt; SValue r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">r (Value r) -&gt; SValue r
forall a s. a -&gt; State s a
</span><a href="GOOL.Drasil.Helpers.html#toState"><span class="hs-identifier hs-var">toState</span></a></span><span>
</span><span id="line-126"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679390919"><span class="annot"><span class="annottext">castType :: CodeType -&gt; VS (r (Value r)) -&gt; VS (r (Value r))
</span><a href="#local-6989586621679390919"><span class="hs-identifier hs-var hs-var">castType</span></a></span></span><span> </span><span class="annot"><a href="GOOL.Drasil.CodeType.html#Float"><span class="hs-identifier hs-type">Float</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VSType r -&gt; VS (r (Value r)) -&gt; VS (r (Value r))
forall (r :: * -&gt; *).
RenderValue r =&gt;
VSType r -&gt; SValue r -&gt; SValue r
</span><a href="GOOL.Drasil.RendererClasses.html#cast"><span class="hs-identifier hs-var">cast</span></a></span><span> </span><span class="annot"><span class="annottext">VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; VSType r
</span><a href="GOOL.Drasil.ClassInterface.html#float"><span class="hs-identifier hs-var">float</span></a></span><span>
</span><span id="line-127"></span><span>        </span><span class="annot"><a href="#local-6989586621679390919"><span class="hs-identifier hs-var">castType</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VS (r (Value r)) -&gt; VS (r (Value r))
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-128"></span><span>  </span><span>
</span><span id="line-129"></span><span class="hs-comment">-- | To be used when the type of the value is different from the type of the</span><span>
</span><span id="line-130"></span><span class="hs-comment">-- resulting expression. The type of the result is passed as a parameter.</span><span>
</span><span id="line-131"></span><span id="local-6989586621679390913"><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#typeUnExpr"><span class="hs-identifier hs-type">typeUnExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html#RenderSym"><span class="hs-identifier hs-type">RenderSym</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390913"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html#VSUnOp"><span class="hs-identifier hs-type">VSUnOp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390913"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#VSType"><span class="hs-identifier hs-type">VSType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390913"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#SValue"><span class="hs-identifier hs-type">SValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390913"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#SValue"><span class="hs-identifier hs-type">SValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390913"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-132"></span><span id="typeUnExpr"><span class="annot"><span class="annottext">typeUnExpr :: VSUnOp r -&gt; VSType r -&gt; SValue r -&gt; SValue r
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#typeUnExpr"><span class="hs-identifier hs-var hs-var">typeUnExpr</span></a></span></span><span> </span><span id="local-6989586621679390912"><span class="annot"><span class="annottext">u' :: VSUnOp r
</span><a href="#local-6989586621679390912"><span class="hs-identifier hs-var">u'</span></a></span></span><span> </span><span id="local-6989586621679390911"><span class="annot"><span class="annottext">t' :: VSType r
</span><a href="#local-6989586621679390911"><span class="hs-identifier hs-var">t'</span></a></span></span><span> </span><span id="local-6989586621679390910"><span class="annot"><span class="annottext">s' :: SValue r
</span><a href="#local-6989586621679390910"><span class="hs-identifier hs-var">s'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span>
</span><span id="line-133"></span><span>  </span><span id="local-6989586621679390909"><span class="annot"><span class="annottext">r (UnaryOp r)
</span><a href="#local-6989586621679390909"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VSUnOp r
</span><a href="#local-6989586621679390912"><span class="hs-identifier hs-var">u'</span></a></span><span>
</span><span id="line-134"></span><span>  </span><span id="local-6989586621679390908"><span class="annot"><span class="annottext">r (Type r)
</span><a href="#local-6989586621679390908"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VSType r
</span><a href="#local-6989586621679390911"><span class="hs-identifier hs-var">t'</span></a></span><span>
</span><span id="line-135"></span><span>  </span><span id="local-6989586621679390907"><span class="annot"><span class="annottext">r (Value r)
</span><a href="#local-6989586621679390907"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SValue r
</span><a href="#local-6989586621679390910"><span class="hs-identifier hs-var">s'</span></a></span><span>
</span><span id="line-136"></span><span>  </span><span class="annot"><span class="annottext">Int -&gt; r (Type r) -&gt; Doc -&gt; SValue r
forall (r :: * -&gt; *).
RenderSym r =&gt;
Int -&gt; r (Type r) -&gt; Doc -&gt; SValue r
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#mkExpr"><span class="hs-identifier hs-var">mkExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r (UnaryOp r) -&gt; Int
forall (r :: * -&gt; *). OpElim r =&gt; r (UnaryOp r) -&gt; Int
</span><a href="GOOL.Drasil.RendererClasses.html#uOpPrec"><span class="hs-identifier hs-var">uOpPrec</span></a></span><span> </span><span class="annot"><span class="annottext">r (UnaryOp r)
</span><a href="#local-6989586621679390909"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">r (Type r)
</span><a href="#local-6989586621679390908"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="GOOL.Drasil.LanguageRenderer.html#unOpDocD"><span class="hs-identifier hs-var">unOpDocD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r (UnaryOp r) -&gt; Doc
forall (r :: * -&gt; *). OpElim r =&gt; r (UnaryOp r) -&gt; Doc
</span><a href="GOOL.Drasil.RendererClasses.html#uOp"><span class="hs-identifier hs-var">RC.uOp</span></a></span><span> </span><span class="annot"><span class="annottext">r (UnaryOp r)
</span><a href="#local-6989586621679390909"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r (Value r) -&gt; Doc
forall (r :: * -&gt; *). ValueElim r =&gt; r (Value r) -&gt; Doc
</span><a href="GOOL.Drasil.RendererClasses.html#value"><span class="hs-identifier hs-var">RC.value</span></a></span><span> </span><span class="annot"><span class="annottext">r (Value r)
</span><a href="#local-6989586621679390907"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span class="hs-comment">-- | Constructs binary expressions like v + w, for some operator + and values v </span><span>
</span><span id="line-139"></span><span class="hs-comment">-- and w, parenthesizing v and w if needed.</span><span>
</span><span id="line-140"></span><span id="local-6989586621679390906"><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#binExpr"><span class="hs-identifier hs-type">binExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html#RenderSym"><span class="hs-identifier hs-type">RenderSym</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390906"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html#VSBinOp"><span class="hs-identifier hs-type">VSBinOp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390906"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#SValue"><span class="hs-identifier hs-type">SValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390906"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#SValue"><span class="hs-identifier hs-type">SValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390906"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#SValue"><span class="hs-identifier hs-type">SValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390906"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-141"></span><span id="binExpr"><span class="annot"><span class="annottext">binExpr :: VSBinOp r -&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#binExpr"><span class="hs-identifier hs-var hs-var">binExpr</span></a></span></span><span> </span><span id="local-6989586621679390905"><span class="annot"><span class="annottext">b' :: VSBinOp r
</span><a href="#local-6989586621679390905"><span class="hs-identifier hs-var">b'</span></a></span></span><span> </span><span id="local-6989586621679390904"><span class="annot"><span class="annottext">v1' :: SValue r
</span><a href="#local-6989586621679390904"><span class="hs-identifier hs-var">v1'</span></a></span></span><span> </span><span id="local-6989586621679390903"><span class="annot"><span class="annottext">v2' :: SValue r
</span><a href="#local-6989586621679390903"><span class="hs-identifier hs-var">v2'</span></a></span></span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span>
</span><span id="line-142"></span><span>  </span><span id="local-6989586621679390902"><span class="annot"><span class="annottext">r (BinaryOp r)
</span><a href="#local-6989586621679390902"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VSBinOp r
</span><a href="#local-6989586621679390905"><span class="hs-identifier hs-var">b'</span></a></span><span>
</span><span id="line-143"></span><span>  </span><span id="local-6989586621679390901"><span class="annot"><span class="annottext">r (Type r)
</span><a href="#local-6989586621679390901"><span class="hs-identifier hs-var">exprType</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r -&gt; VSType r
forall (r :: * -&gt; *).
RenderSym r =&gt;
SValue r -&gt; SValue r -&gt; VSType r
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#numType"><span class="hs-identifier hs-var">numType</span></a></span><span> </span><span class="annot"><span class="annottext">SValue r
</span><a href="#local-6989586621679390904"><span class="hs-identifier hs-var">v1'</span></a></span><span> </span><span class="annot"><span class="annottext">SValue r
</span><a href="#local-6989586621679390903"><span class="hs-identifier hs-var">v2'</span></a></span><span>
</span><span id="line-144"></span><span>  </span><span id="local-6989586621679390899"><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679390899"><span class="hs-identifier hs-var">exprRender</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(r (BinaryOp r) -&gt; r (Value r) -&gt; r (Value r) -&gt; Doc)
-&gt; VSBinOp r -&gt; SValue r -&gt; SValue r -&gt; VS Doc
forall (r :: * -&gt; *).
(r (BinaryOp r) -&gt; r (Value r) -&gt; r (Value r) -&gt; Doc)
-&gt; VSBinOp r -&gt; SValue r -&gt; SValue r -&gt; VS Doc
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#exprRender%27"><span class="hs-identifier hs-var">exprRender'</span></a></span><span> </span><span class="annot"><span class="annottext">r (BinaryOp r) -&gt; r (Value r) -&gt; r (Value r) -&gt; Doc
forall (r :: * -&gt; *).
RenderSym r =&gt;
r (BinaryOp r) -&gt; r (Value r) -&gt; r (Value r) -&gt; Doc
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#binExprRender"><span class="hs-identifier hs-var">binExprRender</span></a></span><span> </span><span class="annot"><span class="annottext">VSBinOp r
</span><a href="#local-6989586621679390905"><span class="hs-identifier hs-var">b'</span></a></span><span> </span><span class="annot"><span class="annottext">SValue r
</span><a href="#local-6989586621679390904"><span class="hs-identifier hs-var">v1'</span></a></span><span> </span><span class="annot"><span class="annottext">SValue r
</span><a href="#local-6989586621679390903"><span class="hs-identifier hs-var">v2'</span></a></span><span>
</span><span id="line-145"></span><span>  </span><span class="annot"><span class="annottext">Int -&gt; r (Type r) -&gt; Doc -&gt; SValue r
forall (r :: * -&gt; *).
RenderSym r =&gt;
Int -&gt; r (Type r) -&gt; Doc -&gt; SValue r
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#mkExpr"><span class="hs-identifier hs-var">mkExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r (BinaryOp r) -&gt; Int
forall (r :: * -&gt; *). OpElim r =&gt; r (BinaryOp r) -&gt; Int
</span><a href="GOOL.Drasil.RendererClasses.html#bOpPrec"><span class="hs-identifier hs-var">bOpPrec</span></a></span><span> </span><span class="annot"><span class="annottext">r (BinaryOp r)
</span><a href="#local-6989586621679390902"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">r (Type r)
</span><a href="#local-6989586621679390901"><span class="hs-identifier hs-var">exprType</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679390899"><span class="hs-identifier hs-var">exprRender</span></a></span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span class="hs-comment">-- | Constructs binary expressions like pow(v,w), for some operator pow and</span><span>
</span><span id="line-148"></span><span class="hs-comment">-- values v and w</span><span>
</span><span id="line-149"></span><span id="local-6989586621679391027"><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#binExpr%27"><span class="hs-identifier hs-type">binExpr'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html#RenderSym"><span class="hs-identifier hs-type">RenderSym</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391027"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html#VSBinOp"><span class="hs-identifier hs-type">VSBinOp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391027"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#SValue"><span class="hs-identifier hs-type">SValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391027"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#SValue"><span class="hs-identifier hs-type">SValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391027"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#SValue"><span class="hs-identifier hs-type">SValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391027"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-150"></span><span id="binExpr%27"><span class="annot"><span class="annottext">binExpr' :: VSBinOp r -&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#binExpr%27"><span class="hs-identifier hs-var hs-var">binExpr'</span></a></span></span><span> </span><span id="local-6989586621679390896"><span class="annot"><span class="annottext">b' :: VSBinOp r
</span><a href="#local-6989586621679390896"><span class="hs-identifier hs-var">b'</span></a></span></span><span> </span><span id="local-6989586621679390895"><span class="annot"><span class="annottext">v1' :: SValue r
</span><a href="#local-6989586621679390895"><span class="hs-identifier hs-var">v1'</span></a></span></span><span> </span><span id="local-6989586621679390894"><span class="annot"><span class="annottext">v2' :: SValue r
</span><a href="#local-6989586621679390894"><span class="hs-identifier hs-var">v2'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span>
</span><span id="line-151"></span><span>  </span><span id="local-6989586621679390893"><span class="annot"><span class="annottext">r (Type r)
</span><a href="#local-6989586621679390893"><span class="hs-identifier hs-var">exprType</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SValue r -&gt; SValue r -&gt; VSType r
forall (r :: * -&gt; *).
RenderSym r =&gt;
SValue r -&gt; SValue r -&gt; VSType r
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#numType"><span class="hs-identifier hs-var">numType</span></a></span><span> </span><span class="annot"><span class="annottext">SValue r
</span><a href="#local-6989586621679390895"><span class="hs-identifier hs-var">v1'</span></a></span><span> </span><span class="annot"><span class="annottext">SValue r
</span><a href="#local-6989586621679390894"><span class="hs-identifier hs-var">v2'</span></a></span><span>
</span><span id="line-152"></span><span>  </span><span id="local-6989586621679390892"><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679390892"><span class="hs-identifier hs-var">exprRender</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(r (BinaryOp r) -&gt; r (Value r) -&gt; r (Value r) -&gt; Doc)
-&gt; VSBinOp r -&gt; SValue r -&gt; SValue r -&gt; VS Doc
forall (r :: * -&gt; *).
(r (BinaryOp r) -&gt; r (Value r) -&gt; r (Value r) -&gt; Doc)
-&gt; VSBinOp r -&gt; SValue r -&gt; SValue r -&gt; VS Doc
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#exprRender%27"><span class="hs-identifier hs-var">exprRender'</span></a></span><span> </span><span class="annot"><span class="annottext">r (BinaryOp r) -&gt; r (Value r) -&gt; r (Value r) -&gt; Doc
forall (r :: * -&gt; *).
RenderSym r =&gt;
r (BinaryOp r) -&gt; r (Value r) -&gt; r (Value r) -&gt; Doc
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#binOpDocDRend"><span class="hs-identifier hs-var">binOpDocDRend</span></a></span><span> </span><span class="annot"><span class="annottext">VSBinOp r
</span><a href="#local-6989586621679390896"><span class="hs-identifier hs-var">b'</span></a></span><span> </span><span class="annot"><span class="annottext">SValue r
</span><a href="#local-6989586621679390895"><span class="hs-identifier hs-var">v1'</span></a></span><span> </span><span class="annot"><span class="annottext">SValue r
</span><a href="#local-6989586621679390894"><span class="hs-identifier hs-var">v2'</span></a></span><span>
</span><span id="line-153"></span><span>  </span><span class="annot"><span class="annottext">Int -&gt; r (Type r) -&gt; Doc -&gt; SValue r
forall (r :: * -&gt; *).
RenderSym r =&gt;
Int -&gt; r (Type r) -&gt; Doc -&gt; SValue r
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#mkExpr"><span class="hs-identifier hs-var">mkExpr</span></a></span><span> </span><span class="annot"><span class="hs-number">9</span></span><span> </span><span class="annot"><span class="annottext">r (Type r)
</span><a href="#local-6989586621679390893"><span class="hs-identifier hs-var">exprType</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679390892"><span class="hs-identifier hs-var">exprRender</span></a></span><span> </span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span class="hs-comment">-- | To be used in languages where the binary operator returns a double. If </span><span>
</span><span id="line-156"></span><span class="hs-comment">-- either value passed to the operator is a float, this function preserves that </span><span>
</span><span id="line-157"></span><span class="hs-comment">-- type by casting the result to a float.</span><span>
</span><span id="line-158"></span><span id="local-6989586621679390890"><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#binExprNumDbl%27"><span class="hs-identifier hs-type">binExprNumDbl'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html#RenderSym"><span class="hs-identifier hs-type">RenderSym</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390890"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html#VSBinOp"><span class="hs-identifier hs-type">VSBinOp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390890"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#SValue"><span class="hs-identifier hs-type">SValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390890"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#SValue"><span class="hs-identifier hs-type">SValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390890"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#SValue"><span class="hs-identifier hs-type">SValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390890"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-159"></span><span id="binExprNumDbl%27"><span class="annot"><span class="annottext">binExprNumDbl' :: VSBinOp r -&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#binExprNumDbl%27"><span class="hs-identifier hs-var hs-var">binExprNumDbl'</span></a></span></span><span> </span><span id="local-6989586621679390889"><span class="annot"><span class="annottext">b' :: VSBinOp r
</span><a href="#local-6989586621679390889"><span class="hs-identifier hs-var">b'</span></a></span></span><span> </span><span id="local-6989586621679390888"><span class="annot"><span class="annottext">v1' :: SValue r
</span><a href="#local-6989586621679390888"><span class="hs-identifier hs-var">v1'</span></a></span></span><span> </span><span id="local-6989586621679390887"><span class="annot"><span class="annottext">v2' :: SValue r
</span><a href="#local-6989586621679390887"><span class="hs-identifier hs-var">v2'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span>
</span><span id="line-160"></span><span>  </span><span id="local-6989586621679390886"><span class="annot"><span class="annottext">r (Value r)
</span><a href="#local-6989586621679390886"><span class="hs-identifier hs-var">v1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SValue r
</span><a href="#local-6989586621679390888"><span class="hs-identifier hs-var">v1'</span></a></span><span>
</span><span id="line-161"></span><span>  </span><span id="local-6989586621679390885"><span class="annot"><span class="annottext">r (Value r)
</span><a href="#local-6989586621679390885"><span class="hs-identifier hs-var">v2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SValue r
</span><a href="#local-6989586621679390887"><span class="hs-identifier hs-var">v2'</span></a></span><span>
</span><span id="line-162"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679390884"><span class="annot"><span class="annottext">t1 :: r (Type r)
</span><a href="#local-6989586621679390884"><span class="hs-identifier hs-var hs-var">t1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r (Value r) -&gt; r (Type r)
forall (r :: * -&gt; *). ValueSym r =&gt; r (Value r) -&gt; r (Type r)
</span><a href="GOOL.Drasil.ClassInterface.html#valueType"><span class="hs-identifier hs-var">valueType</span></a></span><span> </span><span class="annot"><span class="annottext">r (Value r)
</span><a href="#local-6989586621679390886"><span class="hs-identifier hs-var">v1</span></a></span><span>
</span><span id="line-163"></span><span>      </span><span id="local-6989586621679390883"><span class="annot"><span class="annottext">t2 :: r (Type r)
</span><a href="#local-6989586621679390883"><span class="hs-identifier hs-var hs-var">t2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r (Value r) -&gt; r (Type r)
forall (r :: * -&gt; *). ValueSym r =&gt; r (Value r) -&gt; r (Type r)
</span><a href="GOOL.Drasil.ClassInterface.html#valueType"><span class="hs-identifier hs-var">valueType</span></a></span><span> </span><span class="annot"><span class="annottext">r (Value r)
</span><a href="#local-6989586621679390885"><span class="hs-identifier hs-var">v2</span></a></span><span>
</span><span id="line-164"></span><span>  </span><span id="local-6989586621679390882"><span class="annot"><span class="annottext">r (Value r)
</span><a href="#local-6989586621679390882"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VSBinOp r -&gt; SValue r -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
RenderSym r =&gt;
VSBinOp r -&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#binExpr%27"><span class="hs-identifier hs-var">binExpr'</span></a></span><span> </span><span class="annot"><span class="annottext">VSBinOp r
</span><a href="#local-6989586621679390889"><span class="hs-identifier hs-var">b'</span></a></span><span> </span><span class="annot"><span class="annottext">SValue r
</span><a href="#local-6989586621679390888"><span class="hs-identifier hs-var">v1'</span></a></span><span> </span><span class="annot"><span class="annottext">SValue r
</span><a href="#local-6989586621679390887"><span class="hs-identifier hs-var">v2'</span></a></span><span>
</span><span id="line-165"></span><span>  </span><span class="annot"><span class="annottext">r (Type r) -&gt; r (Type r) -&gt; r (Value r) -&gt; SValue r
forall (r :: * -&gt; *).
RenderSym r =&gt;
r (Type r) -&gt; r (Type r) -&gt; r (Value r) -&gt; SValue r
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#binExprCastFloat"><span class="hs-identifier hs-var">binExprCastFloat</span></a></span><span> </span><span class="annot"><span class="annottext">r (Type r)
</span><a href="#local-6989586621679390884"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">r (Type r)
</span><a href="#local-6989586621679390883"><span class="hs-identifier hs-var">t2</span></a></span><span> </span><span class="annot"><span class="annottext">r (Value r)
</span><a href="#local-6989586621679390882"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span class="hs-comment">-- Only used by binExprNumDbl'</span><span>
</span><span id="line-168"></span><span id="local-6989586621679391026"><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#binExprCastFloat"><span class="hs-identifier hs-type">binExprCastFloat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html#RenderSym"><span class="hs-identifier hs-type">RenderSym</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391026"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679391026"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391026"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679391026"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391026"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679391026"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391026"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span>
</span><span id="line-169"></span><span>  </span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#SValue"><span class="hs-identifier hs-type">SValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391026"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-170"></span><span id="binExprCastFloat"><span class="annot"><span class="annottext">binExprCastFloat :: r (Type r) -&gt; r (Type r) -&gt; r (Value r) -&gt; SValue r
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#binExprCastFloat"><span class="hs-identifier hs-var hs-var">binExprCastFloat</span></a></span></span><span> </span><span id="local-6989586621679390880"><span class="annot"><span class="annottext">t1 :: r (Type r)
</span><a href="#local-6989586621679390880"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621679390879"><span class="annot"><span class="annottext">t2 :: r (Type r)
</span><a href="#local-6989586621679390879"><span class="hs-identifier hs-var">t2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CodeType -&gt; CodeType -&gt; SValue r -&gt; SValue r
forall (r :: * -&gt; *).
(RenderValue r, TypeSym r) =&gt;
CodeType -&gt; CodeType -&gt; VS (r (Value r)) -&gt; VS (r (Value r))
</span><a href="#local-6989586621679390878"><span class="hs-identifier hs-var">castType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r (Type r) -&gt; CodeType
forall (r :: * -&gt; *). TypeElim r =&gt; r (Type r) -&gt; CodeType
</span><a href="GOOL.Drasil.ClassInterface.html#getType"><span class="hs-identifier hs-var">getType</span></a></span><span> </span><span class="annot"><span class="annottext">r (Type r)
</span><a href="#local-6989586621679390880"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r (Type r) -&gt; CodeType
forall (r :: * -&gt; *). TypeElim r =&gt; r (Type r) -&gt; CodeType
</span><a href="GOOL.Drasil.ClassInterface.html#getType"><span class="hs-identifier hs-var">getType</span></a></span><span> </span><span class="annot"><span class="annottext">r (Type r)
</span><a href="#local-6989586621679390879"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(SValue r -&gt; SValue r)
-&gt; (r (Value r) -&gt; SValue r) -&gt; r (Value r) -&gt; SValue r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">r (Value r) -&gt; SValue r
forall a s. a -&gt; State s a
</span><a href="GOOL.Drasil.Helpers.html#toState"><span class="hs-identifier hs-var">toState</span></a></span><span>
</span><span id="line-171"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679390878"><span class="annot"><span class="annottext">castType :: CodeType -&gt; CodeType -&gt; VS (r (Value r)) -&gt; VS (r (Value r))
</span><a href="#local-6989586621679390878"><span class="hs-identifier hs-var hs-var">castType</span></a></span></span><span> </span><span class="annot"><a href="GOOL.Drasil.CodeType.html#Float"><span class="hs-identifier hs-type">Float</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VSType r -&gt; VS (r (Value r)) -&gt; VS (r (Value r))
forall (r :: * -&gt; *).
RenderValue r =&gt;
VSType r -&gt; SValue r -&gt; SValue r
</span><a href="GOOL.Drasil.RendererClasses.html#cast"><span class="hs-identifier hs-var">cast</span></a></span><span> </span><span class="annot"><span class="annottext">VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; VSType r
</span><a href="GOOL.Drasil.ClassInterface.html#float"><span class="hs-identifier hs-var">float</span></a></span><span>
</span><span id="line-172"></span><span>        </span><span class="annot"><a href="#local-6989586621679390878"><span class="hs-identifier hs-var">castType</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="annot"><a href="GOOL.Drasil.CodeType.html#Float"><span class="hs-identifier hs-type">Float</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VSType r -&gt; VS (r (Value r)) -&gt; VS (r (Value r))
forall (r :: * -&gt; *).
RenderValue r =&gt;
VSType r -&gt; SValue r -&gt; SValue r
</span><a href="GOOL.Drasil.RendererClasses.html#cast"><span class="hs-identifier hs-var">cast</span></a></span><span> </span><span class="annot"><span class="annottext">VSType r
forall (r :: * -&gt; *). TypeSym r =&gt; VSType r
</span><a href="GOOL.Drasil.ClassInterface.html#float"><span class="hs-identifier hs-var">float</span></a></span><span>
</span><span id="line-173"></span><span>        </span><span class="annot"><a href="#local-6989586621679390878"><span class="hs-identifier hs-var">castType</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VS (r (Value r)) -&gt; VS (r (Value r))
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span class="hs-comment">-- | To be used when the types of the values are different from the type of the</span><span>
</span><span id="line-176"></span><span class="hs-comment">-- resulting expression. The type of the result is passed as a parameter.</span><span>
</span><span id="line-177"></span><span id="local-6989586621679390877"><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#typeBinExpr"><span class="hs-identifier hs-type">typeBinExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html#RenderSym"><span class="hs-identifier hs-type">RenderSym</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390877"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html#VSBinOp"><span class="hs-identifier hs-type">VSBinOp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390877"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#VSType"><span class="hs-identifier hs-type">VSType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390877"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#SValue"><span class="hs-identifier hs-type">SValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390877"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#SValue"><span class="hs-identifier hs-type">SValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390877"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span>
</span><span id="line-178"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#SValue"><span class="hs-identifier hs-type">SValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390877"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-179"></span><span id="typeBinExpr"><span class="annot"><span class="annottext">typeBinExpr :: VSBinOp r -&gt; VSType r -&gt; SValue r -&gt; SValue r -&gt; SValue r
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#typeBinExpr"><span class="hs-identifier hs-var hs-var">typeBinExpr</span></a></span></span><span> </span><span id="local-6989586621679390876"><span class="annot"><span class="annottext">b' :: VSBinOp r
</span><a href="#local-6989586621679390876"><span class="hs-identifier hs-var">b'</span></a></span></span><span> </span><span id="local-6989586621679390875"><span class="annot"><span class="annottext">t' :: VSType r
</span><a href="#local-6989586621679390875"><span class="hs-identifier hs-var">t'</span></a></span></span><span> </span><span id="local-6989586621679390874"><span class="annot"><span class="annottext">v1' :: SValue r
</span><a href="#local-6989586621679390874"><span class="hs-identifier hs-var">v1'</span></a></span></span><span> </span><span id="local-6989586621679390873"><span class="annot"><span class="annottext">v2' :: SValue r
</span><a href="#local-6989586621679390873"><span class="hs-identifier hs-var">v2'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-180"></span><span>  </span><span id="local-6989586621679390872"><span class="annot"><span class="annottext">r (BinaryOp r)
</span><a href="#local-6989586621679390872"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VSBinOp r
</span><a href="#local-6989586621679390876"><span class="hs-identifier hs-var">b'</span></a></span><span>
</span><span id="line-181"></span><span>  </span><span id="local-6989586621679390871"><span class="annot"><span class="annottext">r (Type r)
</span><a href="#local-6989586621679390871"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VSType r
</span><a href="#local-6989586621679390875"><span class="hs-identifier hs-var">t'</span></a></span><span>
</span><span id="line-182"></span><span>  </span><span id="local-6989586621679390870"><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679390870"><span class="hs-identifier hs-var">bnexr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(r (BinaryOp r) -&gt; r (Value r) -&gt; r (Value r) -&gt; Doc)
-&gt; VSBinOp r -&gt; SValue r -&gt; SValue r -&gt; VS Doc
forall (r :: * -&gt; *).
(r (BinaryOp r) -&gt; r (Value r) -&gt; r (Value r) -&gt; Doc)
-&gt; VSBinOp r -&gt; SValue r -&gt; SValue r -&gt; VS Doc
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#exprRender%27"><span class="hs-identifier hs-var">exprRender'</span></a></span><span> </span><span class="annot"><span class="annottext">r (BinaryOp r) -&gt; r (Value r) -&gt; r (Value r) -&gt; Doc
forall (r :: * -&gt; *).
RenderSym r =&gt;
r (BinaryOp r) -&gt; r (Value r) -&gt; r (Value r) -&gt; Doc
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#binExprRender"><span class="hs-identifier hs-var">binExprRender</span></a></span><span> </span><span class="annot"><span class="annottext">VSBinOp r
</span><a href="#local-6989586621679390876"><span class="hs-identifier hs-var">b'</span></a></span><span> </span><span class="annot"><span class="annottext">SValue r
</span><a href="#local-6989586621679390874"><span class="hs-identifier hs-var">v1'</span></a></span><span> </span><span class="annot"><span class="annottext">SValue r
</span><a href="#local-6989586621679390873"><span class="hs-identifier hs-var">v2'</span></a></span><span>
</span><span id="line-183"></span><span>  </span><span class="annot"><span class="annottext">Int -&gt; r (Type r) -&gt; Doc -&gt; SValue r
forall (r :: * -&gt; *).
RenderSym r =&gt;
Int -&gt; r (Type r) -&gt; Doc -&gt; SValue r
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#mkExpr"><span class="hs-identifier hs-var">mkExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r (BinaryOp r) -&gt; Int
forall (r :: * -&gt; *). OpElim r =&gt; r (BinaryOp r) -&gt; Int
</span><a href="GOOL.Drasil.RendererClasses.html#bOpPrec"><span class="hs-identifier hs-var">bOpPrec</span></a></span><span> </span><span class="annot"><span class="annottext">r (BinaryOp r)
</span><a href="#local-6989586621679390872"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">r (Type r)
</span><a href="#local-6989586621679390871"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679390870"><span class="hs-identifier hs-var">bnexr</span></a></span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span class="hs-comment">-- For numeric binary expressions, checks that both types are numeric and </span><span>
</span><span id="line-186"></span><span class="hs-comment">-- returns result type. Selects the type with lowest precision.</span><span>
</span><span id="line-187"></span><span id="local-6989586621679391032"><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#numType"><span class="hs-identifier hs-type">numType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html#RenderSym"><span class="hs-identifier hs-type">RenderSym</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391032"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#SValue"><span class="hs-identifier hs-type">SValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391032"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#SValue"><span class="hs-identifier hs-type">SValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391032"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#VSType"><span class="hs-identifier hs-type">VSType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391032"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-188"></span><span id="numType"><span class="annot"><span class="annottext">numType :: SValue r -&gt; SValue r -&gt; VSType r
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#numType"><span class="hs-identifier hs-var hs-var">numType</span></a></span></span><span> </span><span id="local-6989586621679390869"><span class="annot"><span class="annottext">v1' :: SValue r
</span><a href="#local-6989586621679390869"><span class="hs-identifier hs-var">v1'</span></a></span></span><span> </span><span id="local-6989586621679390868"><span class="annot"><span class="annottext">v2' :: SValue r
</span><a href="#local-6989586621679390868"><span class="hs-identifier hs-var">v2'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-189"></span><span>  </span><span id="local-6989586621679390867"><span class="annot"><span class="annottext">r (Value r)
</span><a href="#local-6989586621679390867"><span class="hs-identifier hs-var">v1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SValue r
</span><a href="#local-6989586621679390869"><span class="hs-identifier hs-var">v1'</span></a></span><span>
</span><span id="line-190"></span><span>  </span><span id="local-6989586621679390866"><span class="annot"><span class="annottext">r (Value r)
</span><a href="#local-6989586621679390866"><span class="hs-identifier hs-var">v2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SValue r
</span><a href="#local-6989586621679390868"><span class="hs-identifier hs-var">v2'</span></a></span><span>
</span><span id="line-191"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679390865"><span class="annot"><span class="annottext">t1 :: r (Type r)
</span><a href="#local-6989586621679390865"><span class="hs-identifier hs-var hs-var">t1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r (Value r) -&gt; r (Type r)
forall (r :: * -&gt; *). ValueSym r =&gt; r (Value r) -&gt; r (Type r)
</span><a href="GOOL.Drasil.ClassInterface.html#valueType"><span class="hs-identifier hs-var">valueType</span></a></span><span> </span><span class="annot"><span class="annottext">r (Value r)
</span><a href="#local-6989586621679390867"><span class="hs-identifier hs-var">v1</span></a></span><span>
</span><span id="line-192"></span><span>      </span><span id="local-6989586621679390864"><span class="annot"><span class="annottext">t2 :: r (Type r)
</span><a href="#local-6989586621679390864"><span class="hs-identifier hs-var hs-var">t2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r (Value r) -&gt; r (Type r)
forall (r :: * -&gt; *). ValueSym r =&gt; r (Value r) -&gt; r (Type r)
</span><a href="GOOL.Drasil.ClassInterface.html#valueType"><span class="hs-identifier hs-var">valueType</span></a></span><span> </span><span class="annot"><span class="annottext">r (Value r)
</span><a href="#local-6989586621679390866"><span class="hs-identifier hs-var">v2</span></a></span><span>
</span><span id="line-193"></span><span>      </span><span id="local-6989586621679390863"><span class="annot"><span class="annottext">numericType :: CodeType -&gt; CodeType -&gt; r (Type r)
</span><a href="#local-6989586621679390863"><span class="hs-identifier hs-var hs-var">numericType</span></a></span></span><span> </span><span class="annot"><a href="GOOL.Drasil.CodeType.html#Integer"><span class="hs-identifier hs-type">Integer</span></a></span><span> </span><span class="annot"><a href="GOOL.Drasil.CodeType.html#Integer"><span class="hs-identifier hs-type">Integer</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r (Type r)
</span><a href="#local-6989586621679390865"><span class="hs-identifier hs-var">t1</span></a></span><span>
</span><span id="line-194"></span><span>      </span><span class="annot"><a href="#local-6989586621679390863"><span class="hs-identifier hs-var">numericType</span></a></span><span> </span><span class="annot"><a href="GOOL.Drasil.CodeType.html#Float"><span class="hs-identifier hs-type">Float</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r (Type r)
</span><a href="#local-6989586621679390865"><span class="hs-identifier hs-var">t1</span></a></span><span>
</span><span id="line-195"></span><span>      </span><span class="annot"><a href="#local-6989586621679390863"><span class="hs-identifier hs-var">numericType</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="annot"><a href="GOOL.Drasil.CodeType.html#Float"><span class="hs-identifier hs-type">Float</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r (Type r)
</span><a href="#local-6989586621679390864"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-196"></span><span>      </span><span class="annot"><a href="#local-6989586621679390863"><span class="hs-identifier hs-var">numericType</span></a></span><span> </span><span class="annot"><a href="GOOL.Drasil.CodeType.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r (Type r)
</span><a href="#local-6989586621679390865"><span class="hs-identifier hs-var">t1</span></a></span><span>
</span><span id="line-197"></span><span>      </span><span class="annot"><a href="#local-6989586621679390863"><span class="hs-identifier hs-var">numericType</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="annot"><a href="GOOL.Drasil.CodeType.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r (Type r)
</span><a href="#local-6989586621679390864"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-198"></span><span>      </span><span class="annot"><a href="#local-6989586621679390863"><span class="hs-identifier hs-var">numericType</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; r (Type r)
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Numeric types required for numeric expression&quot;</span></span><span>
</span><span id="line-199"></span><span>  </span><span class="annot"><span class="annottext">r (Type r) -&gt; VSType r
forall a s. a -&gt; State s a
</span><a href="GOOL.Drasil.Helpers.html#toState"><span class="hs-identifier hs-var">toState</span></a></span><span> </span><span class="annot"><span class="annottext">(r (Type r) -&gt; VSType r) -&gt; r (Type r) -&gt; VSType r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CodeType -&gt; CodeType -&gt; r (Type r)
</span><a href="#local-6989586621679390863"><span class="hs-identifier hs-var">numericType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r (Type r) -&gt; CodeType
forall (r :: * -&gt; *). TypeElim r =&gt; r (Type r) -&gt; CodeType
</span><a href="GOOL.Drasil.ClassInterface.html#getType"><span class="hs-identifier hs-var">getType</span></a></span><span> </span><span class="annot"><span class="annottext">r (Type r)
</span><a href="#local-6989586621679390865"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r (Type r) -&gt; CodeType
forall (r :: * -&gt; *). TypeElim r =&gt; r (Type r) -&gt; CodeType
</span><a href="GOOL.Drasil.ClassInterface.html#getType"><span class="hs-identifier hs-var">getType</span></a></span><span> </span><span class="annot"><span class="annottext">r (Type r)
</span><a href="#local-6989586621679390864"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span id="local-6989586621679391031"><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#exprRender%27"><span class="hs-identifier hs-type">exprRender'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679391031"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html#BinaryOp"><span class="hs-identifier hs-type">BinaryOp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391031"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679391031"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391031"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679391031"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391031"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span>
</span><span id="line-202"></span><span>  </span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html#VSBinOp"><span class="hs-identifier hs-type">VSBinOp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391031"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#SValue"><span class="hs-identifier hs-type">SValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391031"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#SValue"><span class="hs-identifier hs-type">SValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391031"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.State.html#VS"><span class="hs-identifier hs-type">VS</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span></span><span>
</span><span id="line-203"></span><span id="exprRender%27"><span class="annot"><span class="annottext">exprRender' :: (r (BinaryOp r) -&gt; r (Value r) -&gt; r (Value r) -&gt; Doc)
-&gt; VSBinOp r -&gt; SValue r -&gt; SValue r -&gt; VS Doc
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#exprRender%27"><span class="hs-identifier hs-var hs-var">exprRender'</span></a></span></span><span> </span><span id="local-6989586621679390859"><span class="annot"><span class="annottext">f :: r (BinaryOp r) -&gt; r (Value r) -&gt; r (Value r) -&gt; Doc
</span><a href="#local-6989586621679390859"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679390858"><span class="annot"><span class="annottext">b' :: VSBinOp r
</span><a href="#local-6989586621679390858"><span class="hs-identifier hs-var">b'</span></a></span></span><span> </span><span id="local-6989586621679390857"><span class="annot"><span class="annottext">v1' :: SValue r
</span><a href="#local-6989586621679390857"><span class="hs-identifier hs-var">v1'</span></a></span></span><span> </span><span id="local-6989586621679390856"><span class="annot"><span class="annottext">v2' :: SValue r
</span><a href="#local-6989586621679390856"><span class="hs-identifier hs-var">v2'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span>
</span><span id="line-204"></span><span>  </span><span id="local-6989586621679390855"><span class="annot"><span class="annottext">r (BinaryOp r)
</span><a href="#local-6989586621679390855"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VSBinOp r
</span><a href="#local-6989586621679390858"><span class="hs-identifier hs-var">b'</span></a></span><span> </span><span>
</span><span id="line-205"></span><span>  </span><span id="local-6989586621679390854"><span class="annot"><span class="annottext">r (Value r)
</span><a href="#local-6989586621679390854"><span class="hs-identifier hs-var">v1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SValue r
</span><a href="#local-6989586621679390857"><span class="hs-identifier hs-var">v1'</span></a></span><span>
</span><span id="line-206"></span><span>  </span><span id="local-6989586621679390853"><span class="annot"><span class="annottext">r (Value r)
</span><a href="#local-6989586621679390853"><span class="hs-identifier hs-var">v2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SValue r
</span><a href="#local-6989586621679390856"><span class="hs-identifier hs-var">v2'</span></a></span><span>
</span><span id="line-207"></span><span>  </span><span class="annot"><span class="annottext">Doc -&gt; VS Doc
forall a s. a -&gt; State s a
</span><a href="GOOL.Drasil.Helpers.html#toState"><span class="hs-identifier hs-var">toState</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; VS Doc) -&gt; Doc -&gt; VS Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">r (BinaryOp r) -&gt; r (Value r) -&gt; r (Value r) -&gt; Doc
</span><a href="#local-6989586621679390859"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">r (BinaryOp r)
</span><a href="#local-6989586621679390855"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">r (Value r)
</span><a href="#local-6989586621679390854"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="annot"><span class="annottext">r (Value r)
</span><a href="#local-6989586621679390853"><span class="hs-identifier hs-var">v2</span></a></span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span id="local-6989586621679391054"><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#mkExpr"><span class="hs-identifier hs-type">mkExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html#RenderSym"><span class="hs-identifier hs-type">RenderSym</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391054"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679391054"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391054"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#SValue"><span class="hs-identifier hs-type">SValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391054"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-210"></span><span id="mkExpr"><span class="annot"><span class="annottext">mkExpr :: Int -&gt; r (Type r) -&gt; Doc -&gt; SValue r
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#mkExpr"><span class="hs-identifier hs-var hs-var">mkExpr</span></a></span></span><span> </span><span id="local-6989586621679390852"><span class="annot"><span class="annottext">p :: Int
</span><a href="#local-6989586621679390852"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679390851"><span class="annot"><span class="annottext">t :: r (Type r)
</span><a href="#local-6989586621679390851"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Int -&gt; VSType r -&gt; Doc -&gt; SValue r
forall (r :: * -&gt; *).
RenderValue r =&gt;
Maybe Int -&gt; VSType r -&gt; Doc -&gt; SValue r
</span><a href="GOOL.Drasil.RendererClasses.html#valFromData"><span class="hs-identifier hs-var">valFromData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Maybe Int
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679390852"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r (Type r) -&gt; VSType r
forall a s. a -&gt; State s a
</span><a href="GOOL.Drasil.Helpers.html#toState"><span class="hs-identifier hs-var">toState</span></a></span><span> </span><span class="annot"><span class="annottext">r (Type r)
</span><a href="#local-6989586621679390851"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span id="local-6989586621679390850"><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#binOpDocDRend"><span class="hs-identifier hs-type">binOpDocDRend</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html#RenderSym"><span class="hs-identifier hs-type">RenderSym</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390850"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679390850"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html#BinaryOp"><span class="hs-identifier hs-type">BinaryOp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390850"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679390850"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390850"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span>
</span><span id="line-213"></span><span>  </span><span class="annot"><a href="#local-6989586621679390850"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390850"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span></span><span>
</span><span id="line-214"></span><span id="binOpDocDRend"><span class="annot"><span class="annottext">binOpDocDRend :: r (BinaryOp r) -&gt; r (Value r) -&gt; r (Value r) -&gt; Doc
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#binOpDocDRend"><span class="hs-identifier hs-var hs-var">binOpDocDRend</span></a></span></span><span> </span><span id="local-6989586621679390849"><span class="annot"><span class="annottext">b :: r (BinaryOp r)
</span><a href="#local-6989586621679390849"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679390848"><span class="annot"><span class="annottext">v1 :: r (Value r)
</span><a href="#local-6989586621679390848"><span class="hs-identifier hs-var">v1</span></a></span></span><span> </span><span id="local-6989586621679390847"><span class="annot"><span class="annottext">v2 :: r (Value r)
</span><a href="#local-6989586621679390847"><span class="hs-identifier hs-var">v2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc -&gt; Doc
</span><a href="GOOL.Drasil.LanguageRenderer.html#binOpDocD%27"><span class="hs-identifier hs-var">binOpDocD'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r (BinaryOp r) -&gt; Doc
forall (r :: * -&gt; *). OpElim r =&gt; r (BinaryOp r) -&gt; Doc
</span><a href="GOOL.Drasil.RendererClasses.html#bOp"><span class="hs-identifier hs-var">RC.bOp</span></a></span><span> </span><span class="annot"><span class="annottext">r (BinaryOp r)
</span><a href="#local-6989586621679390849"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r (Value r) -&gt; Doc
forall (r :: * -&gt; *). ValueElim r =&gt; r (Value r) -&gt; Doc
</span><a href="GOOL.Drasil.RendererClasses.html#value"><span class="hs-identifier hs-var">RC.value</span></a></span><span> </span><span class="annot"><span class="annottext">r (Value r)
</span><a href="#local-6989586621679390848"><span class="hs-identifier hs-var">v1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r (Value r) -&gt; Doc
forall (r :: * -&gt; *). ValueElim r =&gt; r (Value r) -&gt; Doc
</span><a href="GOOL.Drasil.RendererClasses.html#value"><span class="hs-identifier hs-var">RC.value</span></a></span><span> </span><span class="annot"><span class="annottext">r (Value r)
</span><a href="#local-6989586621679390847"><span class="hs-identifier hs-var">v2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span class="hs-comment">-- Adds parentheses around an expression passed as the left argument to a </span><span>
</span><span id="line-217"></span><span class="hs-comment">-- left-associative binary operator if the precedence of the expression is less </span><span>
</span><span id="line-218"></span><span class="hs-comment">-- than the precedence of the operator</span><span>
</span><span id="line-219"></span><span id="local-6989586621679391009"><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#exprParensL"><span class="hs-identifier hs-type">exprParensL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html#RenderSym"><span class="hs-identifier hs-type">RenderSym</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391009"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679391009"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html#BinaryOp"><span class="hs-identifier hs-type">BinaryOp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391009"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679391009"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391009"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span></span><span>
</span><span id="line-220"></span><span id="exprParensL"><span class="annot"><span class="annottext">exprParensL :: r (BinaryOp r) -&gt; r (Value r) -&gt; Doc
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#exprParensL"><span class="hs-identifier hs-var hs-var">exprParensL</span></a></span></span><span> </span><span id="local-6989586621679390845"><span class="annot"><span class="annottext">o :: r (BinaryOp r)
</span><a href="#local-6989586621679390845"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679390844"><span class="annot"><span class="annottext">v :: r (Value r)
</span><a href="#local-6989586621679390844"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; (Int -&gt; Bool) -&gt; Maybe Int -&gt; Bool
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">r (BinaryOp r) -&gt; Int
forall (r :: * -&gt; *). OpElim r =&gt; r (BinaryOp r) -&gt; Int
</span><a href="GOOL.Drasil.RendererClasses.html#bOpPrec"><span class="hs-identifier hs-var">bOpPrec</span></a></span><span> </span><span class="annot"><span class="annottext">r (BinaryOp r)
</span><a href="#local-6989586621679390845"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r (Value r) -&gt; Maybe Int
forall (r :: * -&gt; *). ValueElim r =&gt; r (Value r) -&gt; Maybe Int
</span><a href="GOOL.Drasil.RendererClasses.html#valuePrec"><span class="hs-identifier hs-var">valuePrec</span></a></span><span> </span><span class="annot"><span class="annottext">r (Value r)
</span><a href="#local-6989586621679390844"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span>
</span><span id="line-221"></span><span>  </span><span class="annot"><span class="annottext">Doc -&gt; Doc
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; Doc) -&gt; Doc -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">r (Value r) -&gt; Doc
forall (r :: * -&gt; *). ValueElim r =&gt; r (Value r) -&gt; Doc
</span><a href="GOOL.Drasil.RendererClasses.html#value"><span class="hs-identifier hs-var">RC.value</span></a></span><span> </span><span class="annot"><span class="annottext">r (Value r)
</span><a href="#local-6989586621679390844"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span class="hs-comment">-- Adds parentheses around an expression passed as the right argument to a </span><span>
</span><span id="line-224"></span><span class="hs-comment">-- left-associative binary operator if the precedence of the expression is less </span><span>
</span><span id="line-225"></span><span class="hs-comment">-- than or equal to the precedence of the operator</span><span>
</span><span id="line-226"></span><span id="local-6989586621679390841"><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#exprParensR"><span class="hs-identifier hs-type">exprParensR</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html#RenderSym"><span class="hs-identifier hs-type">RenderSym</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390841"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679390841"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html#BinaryOp"><span class="hs-identifier hs-type">BinaryOp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390841"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679390841"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390841"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span></span><span>
</span><span id="line-227"></span><span id="exprParensR"><span class="annot"><span class="annottext">exprParensR :: r (BinaryOp r) -&gt; r (Value r) -&gt; Doc
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#exprParensR"><span class="hs-identifier hs-var hs-var">exprParensR</span></a></span></span><span> </span><span id="local-6989586621679390839"><span class="annot"><span class="annottext">o :: r (BinaryOp r)
</span><a href="#local-6989586621679390839"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679390838"><span class="annot"><span class="annottext">v :: r (Value r)
</span><a href="#local-6989586621679390838"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; (Int -&gt; Bool) -&gt; Maybe Int -&gt; Bool
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">r (BinaryOp r) -&gt; Int
forall (r :: * -&gt; *). OpElim r =&gt; r (BinaryOp r) -&gt; Int
</span><a href="GOOL.Drasil.RendererClasses.html#bOpPrec"><span class="hs-identifier hs-var">bOpPrec</span></a></span><span> </span><span class="annot"><span class="annottext">r (BinaryOp r)
</span><a href="#local-6989586621679390839"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r (Value r) -&gt; Maybe Int
forall (r :: * -&gt; *). ValueElim r =&gt; r (Value r) -&gt; Maybe Int
</span><a href="GOOL.Drasil.RendererClasses.html#valuePrec"><span class="hs-identifier hs-var">valuePrec</span></a></span><span> </span><span class="annot"><span class="annottext">r (Value r)
</span><a href="#local-6989586621679390838"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span>
</span><span id="line-228"></span><span>  </span><span class="annot"><span class="annottext">Doc -&gt; Doc
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; Doc) -&gt; Doc -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">r (Value r) -&gt; Doc
forall (r :: * -&gt; *). ValueElim r =&gt; r (Value r) -&gt; Doc
</span><a href="GOOL.Drasil.RendererClasses.html#value"><span class="hs-identifier hs-var">RC.value</span></a></span><span> </span><span class="annot"><span class="annottext">r (Value r)
</span><a href="#local-6989586621679390838"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span class="hs-comment">-- Renders binary expression, adding parentheses if needed</span><span>
</span><span id="line-231"></span><span id="local-6989586621679391030"><span class="annot"><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#binExprRender"><span class="hs-identifier hs-type">binExprRender</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html#RenderSym"><span class="hs-identifier hs-type">RenderSym</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391030"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>  </span><span class="annot"><a href="#local-6989586621679391030"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.RendererClasses.html#BinaryOp"><span class="hs-identifier hs-type">BinaryOp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391030"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679391030"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391030"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679391030"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GOOL.Drasil.ClassInterface.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391030"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-232"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span></span><span>
</span><span id="line-233"></span><span id="binExprRender"><span class="annot"><span class="annottext">binExprRender :: r (BinaryOp r) -&gt; r (Value r) -&gt; r (Value r) -&gt; Doc
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#binExprRender"><span class="hs-identifier hs-var hs-var">binExprRender</span></a></span></span><span> </span><span id="local-6989586621679390836"><span class="annot"><span class="annottext">b :: r (BinaryOp r)
</span><a href="#local-6989586621679390836"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679390835"><span class="annot"><span class="annottext">v1 :: r (Value r)
</span><a href="#local-6989586621679390835"><span class="hs-identifier hs-var">v1</span></a></span></span><span> </span><span id="local-6989586621679390834"><span class="annot"><span class="annottext">v2 :: r (Value r)
</span><a href="#local-6989586621679390834"><span class="hs-identifier hs-var">v2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-234"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679390833"><span class="annot"><span class="annottext">leftExpr :: Doc
</span><a href="#local-6989586621679390833"><span class="hs-identifier hs-var hs-var">leftExpr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r (BinaryOp r) -&gt; r (Value r) -&gt; Doc
forall (r :: * -&gt; *).
RenderSym r =&gt;
r (BinaryOp r) -&gt; r (Value r) -&gt; Doc
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#exprParensL"><span class="hs-identifier hs-var">exprParensL</span></a></span><span> </span><span class="annot"><span class="annottext">r (BinaryOp r)
</span><a href="#local-6989586621679390836"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">r (Value r)
</span><a href="#local-6989586621679390835"><span class="hs-identifier hs-var">v1</span></a></span><span>
</span><span id="line-235"></span><span>      </span><span id="local-6989586621679390832"><span class="annot"><span class="annottext">rightExpr :: Doc
</span><a href="#local-6989586621679390832"><span class="hs-identifier hs-var hs-var">rightExpr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r (BinaryOp r) -&gt; r (Value r) -&gt; Doc
forall (r :: * -&gt; *).
RenderSym r =&gt;
r (BinaryOp r) -&gt; r (Value r) -&gt; Doc
</span><a href="GOOL.Drasil.LanguageRenderer.Constructors.html#exprParensR"><span class="hs-identifier hs-var">exprParensR</span></a></span><span> </span><span class="annot"><span class="annottext">r (BinaryOp r)
</span><a href="#local-6989586621679390836"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">r (Value r)
</span><a href="#local-6989586621679390834"><span class="hs-identifier hs-var">v2</span></a></span><span>
</span><span id="line-236"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc -&gt; Doc
</span><a href="GOOL.Drasil.LanguageRenderer.html#binOpDocD"><span class="hs-identifier hs-var">binOpDocD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r (BinaryOp r) -&gt; Doc
forall (r :: * -&gt; *). OpElim r =&gt; r (BinaryOp r) -&gt; Doc
</span><a href="GOOL.Drasil.RendererClasses.html#bOp"><span class="hs-identifier hs-var">RC.bOp</span></a></span><span> </span><span class="annot"><span class="annottext">r (BinaryOp r)
</span><a href="#local-6989586621679390836"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679390833"><span class="hs-identifier hs-var">leftExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679390832"><span class="hs-identifier hs-var">rightExpr</span></a></span></pre></body></html>