<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="annot"><span class="hs-comment">-- | Functions that create sentences from other data</span></span><span>
</span><span id="line-2"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Language.Drasil.Sentence.Generators</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-3"></span><span>  </span><span class="annot"><a href="Language.Drasil.Sentence.Generators.html#fromSource"><span class="hs-identifier">fromSource</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Sentence.Generators.html#fterms"><span class="hs-identifier">fterms</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Sentence.Generators.html#getTandS"><span class="hs-identifier">getTandS</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-4"></span><span>  </span><span class="hs-comment">-- this does not belong here...</span><span>
</span><span id="line-5"></span><span>  </span><span class="annot"><a href="Language.Drasil.Sentence.Generators.html#checkValidStr"><span class="hs-identifier">checkValidStr</span></a></span><span>
</span><span id="line-6"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(^.)</span></span><span class="hs-special">)</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.Classes.html"><span class="hs-identifier">Language.Drasil.Classes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Chunk.NamedIdea.html#NamedIdea"><span class="hs-identifier">NamedIdea</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Classes.html#Quantity"><span class="hs-identifier">Quantity</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.Development.Sentence.html"><span class="hs-identifier">Language.Drasil.Development.Sentence</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Development.Sentence.html#phrase"><span class="hs-identifier">phrase</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.Label.Type.html"><span class="hs-identifier">Language.Drasil.Label.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Label.Type.html#Referable"><span class="hs-identifier">Referable</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.NounPhrase.Core.html"><span class="hs-identifier">Language.Drasil.NounPhrase.Core</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.NounPhrase.Core.html#NP"><span class="hs-identifier">NP</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.Reference.html"><span class="hs-identifier">Language.Drasil.Reference</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Reference.html#refS"><span class="hs-identifier">refS</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.Sentence.html"><span class="hs-identifier">Language.Drasil.Sentence</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Sentence.html#Sentence"><span class="hs-identifier">Sentence</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Sentence.html#S"><span class="hs-identifier">S</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><a href="Language.Drasil.Sentence.html#%2B%3A%2B"><span class="hs-operator">(+:+)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Sentence.html#sParen"><span class="hs-identifier">sParen</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Sentence.html#ch"><span class="hs-identifier">ch</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Drasil.ShortName.html"><span class="hs-identifier">Language.Drasil.ShortName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.ShortName.html#HasShortName"><span class="hs-identifier">HasShortName</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="annot"><span class="hs-comment">-- | Wraps &quot;from @reference@&quot; in parentheses.</span></span><span>
</span><span id="line-19"></span><span id="local-6989586621679388353"><span class="annot"><a href="Language.Drasil.Sentence.Generators.html#fromSource"><span class="hs-identifier hs-type">fromSource</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Label.Type.html#Referable"><span class="hs-identifier hs-type">Referable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679388353"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.ShortName.html#HasShortName"><span class="hs-identifier hs-type">HasShortName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679388353"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679388353"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Sentence.html#Sentence"><span class="hs-identifier hs-type">Sentence</span></a></span></span><span>
</span><span id="line-20"></span><span id="fromSource"><span class="annot"><span class="annottext">fromSource :: forall r. (Referable r, HasShortName r) =&gt; r -&gt; Sentence
</span><a href="Language.Drasil.Sentence.Generators.html#fromSource"><span class="hs-identifier hs-var hs-var">fromSource</span></a></span></span><span> </span><span id="local-6989586621679388418"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679388418"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Sentence -&gt; Sentence
</span><a href="Language.Drasil.Sentence.html#sParen"><span class="hs-identifier hs-var">sParen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Sentence
</span><a href="Language.Drasil.Sentence.html#S"><span class="hs-identifier hs-var">S</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;from&quot;</span></span><span> </span><span class="annot"><span class="annottext">Sentence -&gt; Sentence -&gt; Sentence
</span><a href="Language.Drasil.Sentence.html#%2B%3A%2B"><span class="hs-operator hs-var">+:+</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; Sentence
forall r.
(HasUID r, HasRefAddress r, HasShortName r) =&gt;
r -&gt; Sentence
</span><a href="Language.Drasil.Reference.html#refS"><span class="hs-identifier hs-var">refS</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679388418"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-comment">-- | Apply a binary function to the terms of two named ideas, instead of to the named</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- ideas themselves. Ex. @fterms compoundPhrase t1 t2@ instead of</span><span>
</span><span id="line-24"></span><span class="hs-comment">-- @compoundPhrase (t1 ^. term) (t2 ^. term)@.</span><span>
</span><span id="line-25"></span><span id="local-6989586621679388362"><span id="local-6989586621679388364"><span id="local-6989586621679388366"><span class="annot"><a href="Language.Drasil.Sentence.Generators.html#fterms"><span class="hs-identifier hs-type">fterms</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Chunk.NamedIdea.html#NamedIdea"><span class="hs-identifier hs-type">NamedIdea</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679388362"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Drasil.Chunk.NamedIdea.html#NamedIdea"><span class="hs-identifier hs-type">NamedIdea</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679388364"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.NounPhrase.Core.html#NP"><span class="hs-identifier hs-type">NP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.NounPhrase.Core.html#NP"><span class="hs-identifier hs-type">NP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679388366"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679388362"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679388364"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679388366"><span class="hs-identifier hs-type">t</span></a></span></span></span></span><span>
</span><span id="line-26"></span><span id="fterms"><span class="annot"><span class="annottext">fterms :: forall c d t.
(NamedIdea c, NamedIdea d) =&gt;
(NP -&gt; NP -&gt; t) -&gt; c -&gt; d -&gt; t
</span><a href="Language.Drasil.Sentence.Generators.html#fterms"><span class="hs-identifier hs-var hs-var">fterms</span></a></span></span><span> </span><span id="local-6989586621679388426"><span class="annot"><span class="annottext">NP -&gt; NP -&gt; t
</span><a href="#local-6989586621679388426"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679388427"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679388427"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679388428"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679388428"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NP -&gt; NP -&gt; t
</span><a href="#local-6989586621679388426"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679388427"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">c -&gt; Getting NP c NP -&gt; NP
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting NP c NP
forall c. NamedIdea c =&gt; Lens' c NP
Lens' c NP
</span><a href="Language.Drasil.Chunk.NamedIdea.html#term"><span class="hs-identifier hs-var">term</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679388428"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">d -&gt; Getting NP d NP -&gt; NP
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting NP d NP
forall c. NamedIdea c =&gt; Lens' c NP
Lens' d NP
</span><a href="Language.Drasil.Chunk.NamedIdea.html#term"><span class="hs-identifier hs-var">term</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span class="annot"><span class="hs-comment">-- | Used when you want to say a term followed by its symbol. ex. &quot;...using the Force F in...&quot;.</span></span><span>
</span><span id="line-29"></span><span id="local-6989586621679388377"><span class="annot"><a href="Language.Drasil.Sentence.Generators.html#getTandS"><span class="hs-identifier hs-type">getTandS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Drasil.Classes.html#Quantity"><span class="hs-identifier hs-type">Quantity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679388377"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679388377"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Drasil.Sentence.html#Sentence"><span class="hs-identifier hs-type">Sentence</span></a></span></span><span>
</span><span id="line-30"></span><span id="getTandS"><span class="annot"><span class="annottext">getTandS :: forall a. Quantity a =&gt; a -&gt; Sentence
</span><a href="Language.Drasil.Sentence.Generators.html#getTandS"><span class="hs-identifier hs-var hs-var">getTandS</span></a></span></span><span> </span><span id="local-6989586621679388442"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679388442"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Sentence
forall n. NamedIdea n =&gt; n -&gt; Sentence
</span><a href="Language.Drasil.Development.Sentence.html#phrase"><span class="hs-identifier hs-var">phrase</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679388442"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Sentence -&gt; Sentence -&gt; Sentence
</span><a href="Language.Drasil.Sentence.html#%2B%3A%2B"><span class="hs-operator hs-var">+:+</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Sentence
forall c. (HasUID c, HasSymbol c) =&gt; c -&gt; Sentence
</span><a href="Language.Drasil.Sentence.html#ch"><span class="hs-identifier hs-var">ch</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679388442"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span class="hs-comment">-- | Uses an 'Either' type to check if a 'String' is valid -</span><span>
</span><span id="line-33"></span><span class="hs-comment">-- 'Left' with error message if there is an invalid 'Char' in 'String', else 'Right' with 'String'.</span><span>
</span><span id="line-34"></span><span class="annot"><a href="Language.Drasil.Sentence.Generators.html#checkValidStr"><span class="hs-identifier hs-type">checkValidStr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-35"></span><span id="checkValidStr"><span class="annot"><span class="annottext">checkValidStr :: String -&gt; String -&gt; Either String String
</span><a href="Language.Drasil.Sentence.Generators.html#checkValidStr"><span class="hs-identifier hs-var hs-var">checkValidStr</span></a></span></span><span> </span><span id="local-6989586621679388443"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679388443"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String String
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679388443"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-36"></span><span class="annot"><a href="Language.Drasil.Sentence.Generators.html#checkValidStr"><span class="hs-identifier hs-var">checkValidStr</span></a></span><span> </span><span id="local-6989586621679388444"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679388444"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679388445"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679388445"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679388446"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679388446"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679388445"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679388444"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String String
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Either String String) -&gt; String -&gt; Either String String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid character: \'&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679388445"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\' in string \&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679388444"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\&quot;'</span></span><span class="hs-special">]</span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Either String String
</span><a href="Language.Drasil.Sentence.Generators.html#checkValidStr"><span class="hs-identifier hs-var">checkValidStr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679388444"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679388446"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-39"></span></pre></body></html>