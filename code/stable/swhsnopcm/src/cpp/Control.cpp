/** \file Control.cpp
    \author Thulasi Jegatheesan
    \brief Controls the flow of the program
    \note Generated by Drasil v0.1-alpha
*/

#include <string>
#include <vector>

#include "Calculations.hpp"
#include "InputParameters.hpp"
#include "OutputFormat.hpp"

using std::string;
using std::vector;

/** \brief Controls the flow of the program
    \param argc Number of command-line arguments
    \param argv List of command-line arguments
    \return exit code
*/
int main(int argc, const char *argv[]) {
    string filename = argv[1];
    const double pi = 3.14159265;
    const double L_min = 0.1;
    const double L_max = 50.0;
    const double rho_W_min = 950.0;
    const double rho_W_max = 1000.0;
    const double A_C_max = 100000.0;
    const double C_W_min = 4170.0;
    const double C_W_max = 4210.0;
    const double h_C_min = 10.0;
    const double h_C_max = 10000.0;
    const double t_final_max = 86400.0;
    const double AR_min = 1.0e-2;
    const double AR_max = 100.0;
    double A_C;
    double C_W;
    double h_C;
    double T_init;
    double t_final;
    double L;
    double T_C;
    double t_step;
    double rho_W;
    double D;
    double A_tol;
    double R_tol;
    double E_W;
    double V_tank;
    get_input(filename, A_C, C_W, h_C, T_init, t_final, L, T_C, t_step, rho_W, D, A_tol, R_tol, E_W);
    V_tank = derived_values(D, L, pi);
    input_constraints(A_C, C_W, h_C, T_init, t_final, L, T_C, t_step, rho_W, D, E_W, A_C_max, C_W_min, C_W_max, h_C_min, h_C_max, t_final_max, L_min, L_max, rho_W_min, rho_W_max, AR_min, AR_max);
    double V_W = func_V_W(V_tank);
    double m_W = func_m_W(rho_W, V_W);
    double tau_W = func_tau_W(C_W, h_C, A_C, m_W);
    vector<double> T_W = func_T_W(T_C, T_init, t_final, A_tol, R_tol, t_step, tau_W);
    write_output(E_W, T_W);
    
    return 0;
}
